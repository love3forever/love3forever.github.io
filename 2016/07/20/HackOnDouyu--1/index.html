<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Hack On Douyu -- 1"/>







  <link rel="alternate" href="/default" title="搬砖工的日常">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.4.x" />



<link rel="canonical" href="http://eclipsesv.com/2016/07/20/HackOnDouyu--1/"/>


<meta name="description" content="距离上次更新又有一段时间了，毕业答辩之后，确实和同学们一起出去嗨了一段时间，由于还没入职，在家清净的环境中可以好好学一下一直感兴趣的东西啦。">
<meta property="og:type" content="article">
<meta property="og:title" content="Hack On Douyu -- 1">
<meta property="og:url" content="http://eclipsesv.com/2016/07/20/HackOnDouyu--1/index.html">
<meta property="og:site_name" content="搬砖工的日常">
<meta property="og:description" content="距离上次更新又有一段时间了，毕业答辩之后，确实和同学们一起出去嗨了一段时间，由于还没入职，在家清净的环境中可以好好学一下一直感兴趣的东西啦。">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="https://o3sw4xojp.qnssl.com/Douyufandanmu.gif">
<meta property="og:updated_time" content="2017-06-15T06:38:30.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hack On Douyu -- 1">
<meta name="twitter:description" content="距离上次更新又有一段时间了，毕业答辩之后，确实和同学们一起出去嗨了一段时间，由于还没入职，在家清净的环境中可以好好学一下一直感兴趣的东西啦。">
<meta name="twitter:image" content="https://o3sw4xojp.qnssl.com/Douyufandanmu.gif">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.4.x" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />





<script>
  var CONFIG = {
    search: true,
    searchPath: "/search.xml",
    fancybox: true,
    toc: true,
  }
</script>




  



    <title> Hack On Douyu -- 1 · 搬砖工的日常 </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">搬砖工的日常</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">搬砖工的日常</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
      
        <li class="menu-search">
          <form>
            <i class="iconfont icon-search" id="open-search"></i>
            <input type="text" class="search-input" id="search-input" />
            <i class="iconfont icon-close" id="close-search"></i>
          </form>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Hack On Douyu -- 1
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2016年7月20日
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#开播房间数据获取"><span class="toc-text">开播房间数据获取</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#弹幕数据获取"><span class="toc-text">弹幕数据获取</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#后续内容"><span class="toc-text">后续内容</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p>距离上次更新又有一段时间了，毕业答辩之后，确实和同学们一起出去嗨了一段时间，由于还没入职，在家清净的环境中可以好好学一下一直感兴趣的东西啦。</p>
<a id="more"></a>
<p>一直对网络爬虫很感兴趣，所以就开始学习很想学的python，用了之后也是感觉非常棒。期间抓过包括知乎、豆瓣、煎蛋还有个壁纸网站的数据，而抓去最多的还是直播网站斗鱼。数据抓下来之后如何使用是个问题，我的办法是用这些数据通过python的web框架flask搭建一个网站，也算是这段时间的学习成果。网站的构建自然少不了前端，也是硬着头皮学习了bootstrap，了解了一些css、javascript的知识。这段时间的学习成果主要是<a href="https://github.com/wangmengcn/LearningFlask" target="_blank" rel="external">LearningFlask</a>、<a href="https://github.com/wangmengcn/BeautifulPics" target="_blank" rel="external">BeautifulPics</a>、<a href="https://github.com/wangmengcn/Danmu" target="_blank" rel="external">Danmu</a>和<a href="https://github.com/wangmengcn/DouyuFan" target="_blank" rel="external">DouyuFan</a>这四个项目（由于也是刚接触python，代码质量可能不是太高 －。－）。而最后这个DouyuFan算是对前边几个项目的总结。DouyuFan主要是通过斗鱼网站弹幕信息的抓取，获取直播礼物的分布情况，历史数据记录以及当前最热门房间信息。<br>接下来我就用三次分别介绍我在数据抓取、后台搭建以及前后端数据通讯中学到的知识和遇到的问题。</p>
<h1 id="开播房间数据获取"><a href="#开播房间数据获取" class="headerlink" title="开播房间数据获取"></a>开播房间数据获取</h1><p>使用python抓取过数据的同学肯定对<a href="http://docs.python-requests.org/en/master/" target="_blank" rel="external">request</a>和<a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" target="_blank" rel="external">Beautiful Soup</a>这两个库不陌生。<br>号称http for humans的requests缺失不是沽名钓誉，他在页面数据的抓取上确实简单明了。<br>通常情况下，requests和Beautiful Soup配合使用。以对斗鱼当前直播房间的抓取为例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># -*- coding: utf-8 -*-</div><div class="line">from bs4 import BeautifulSoup  # 导入BeautifulSoup，提取网页中目标元素</div><div class="line">import re						# re 正则表达式，在快速查找和过滤元素中有出色表现</div><div class="line">import requests					# reqeusts 用以获取页面数据</div><div class="line">from datetime import datetime</div><div class="line">from pymongo import MongoClient</div></pre></td></tr></table></figure>
<p>首先导入上述这几个库，然后可以伪造http请求header，这样可以减少爬虫被服务器ban掉的可能。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">HOST = &quot;http://www.douyu.com&quot;</div><div class="line">Directory_url = &quot;http://www.douyu.com/directory?isAjax=1&quot;</div><div class="line">Qurystr = &quot;/?page=1&amp;isAjax=1&quot;</div><div class="line"></div><div class="line">agent = &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.86 Safari/537.36&apos;</div><div class="line">accept = &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</div><div class="line">connection = &quot;keep-alive&quot;</div><div class="line">CacheControl = &quot;no-cache&quot;</div><div class="line">UpgradeInsecureRequests = 1</div><div class="line">headers = &#123;</div><div class="line">    &apos;User-Agent&apos;: agent,</div><div class="line">    &apos;Host&apos;: HOST,</div><div class="line">    &apos;Accept&apos;: accept,</div><div class="line">    &apos;Cache-Control&apos;: CacheControl,</div><div class="line">    &apos;Connection&apos;: connection,</div><div class="line">    &apos;Upgrade-InsecureRequests&apos;: UpgradeInsecureRequests</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后就是开播房间数据的获取和入库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">cli = MongoClient(host=&quot;ip&quot;,port=xxx)</div><div class="line">db = cli[&quot;Douyu&quot;]</div><div class="line">col = db[&quot;Roominfo&quot;]</div><div class="line"></div><div class="line"></div><div class="line">def get_roominfo(data):</div><div class="line">    if data:</div><div class="line">        firstpage = BeautifulSoup(data)</div><div class="line">        roomlist = firstpage.select(&apos;li&apos;)</div><div class="line">        print len(roomlist)</div><div class="line">        if roomlist:</div><div class="line">            for room in roomlist:</div><div class="line">                try:</div><div class="line">                    roomid = room[&quot;data-rid&quot;]</div><div class="line">                    roomtitle = room.a[&quot;title&quot;]</div><div class="line">                    roomtitle = roomtitle.encode(&apos;utf-8&apos;)</div><div class="line">                    roomowner = room.select(&quot;p &gt; span&quot;)</div><div class="line">                    roomtag = room.select(&quot;div &gt; span&quot;)</div><div class="line">                    roomimg = room.a</div><div class="line">                    roomtag = roomtag[0].string</div><div class="line">                    date = datetime.now()</div><div class="line">                    # now = datetime.datetime(</div><div class="line">                    # date.year, date.month, date.day, date.hour, date.minute)</div><div class="line">                    if len(roomowner) == 2:</div><div class="line">                        zbname = roomowner[0].string</div><div class="line">                        audience = roomowner[1].get_text()</div><div class="line">                        audience = audience.encode(&apos;utf-8&apos;).decode(&apos;utf-8&apos;)</div><div class="line">                        image = roomimg.span.img[&quot;data-original&quot;]</div><div class="line">                        word = u&quot;万&quot;    # 在页面中获取的房间人数以万为单位的str需要转换为int型，以便入库</div><div class="line">                        if word in audience:</div><div class="line">                            r = re.compile(r&apos;(\d+)(\.?)(\d*)&apos;)</div><div class="line">                            data = r.match(audience).group(0)</div><div class="line">                            audience = int(float(data) * 10000)</div><div class="line">                        else:</div><div class="line">                            audience = int(audience)</div><div class="line">                        roominfo = &#123;</div><div class="line">                            &quot;roomid&quot;: int(roomid),</div><div class="line">                            &quot;roomtitle&quot;: roomtitle,</div><div class="line">                            &quot;anchor&quot;: zbname,</div><div class="line">                            &quot;audience&quot;: audience,</div><div class="line">                            &quot;tag&quot;: roomtag,</div><div class="line">                            &quot;date&quot;: date,</div><div class="line">                            &quot;img&quot; : image</div><div class="line">                        &#125;</div><div class="line">                        col.insert_one(roominfo)</div><div class="line">                    # print roomid,&quot;:&quot;,roomtitle</div><div class="line">                except Exception, e:</div><div class="line">                    pass</div><div class="line"></div><div class="line"></div><div class="line">def insert_info():</div><div class="line">    session = requests.session()</div><div class="line">    pagecontent = session.get(Directory_url).text</div><div class="line">    pagesoup = BeautifulSoup(pagecontent)</div><div class="line">    games = pagesoup.select(&apos;a&apos;)</div><div class="line">    col.drop()</div><div class="line">    for game in games:</div><div class="line">        links = game[&quot;href&quot;]</div><div class="line">        gameurl = HOST + links + Qurystr</div><div class="line">        print gameurl</div><div class="line">        gamedata = session.get(gameurl).text</div><div class="line">        get_roominfo(gamedata)</div></pre></td></tr></table></figure>
<p>我平常习惯使用mongodb作为数据存储，首先建立与数据库的连接，然后通过获取<a href="http://www.douyu.com/directory?isAjax=1" target="_blank" rel="external">斗鱼当前所有房间分类</a>，接着逐一获取每个分类中开播的房间数据，并记录每个房间的roomid（房间号，斗鱼直播间唯一标识）、roomtitle（房间标题）、anchor（主播id）、audience（观众人数）、tag（房间所属分类）、date（数据获取时间）、img（直播间封面图片）。通过定时执行此脚本，可以获取当前观众人数最多的房间(通常大都是lol的直播 ＝。＝)，也可以在之后通过roomid查询到关于对应直播间必要的信息。</p>
<h1 id="弹幕数据获取"><a href="#弹幕数据获取" class="headerlink" title="弹幕数据获取"></a>弹幕数据获取</h1><p>经常看斗鱼直播的同学肯定知道“弹幕大神”这个词，我最初想要抓取弹幕的目的是想通过大量的获取直播间弹幕数据进行一些自然语言分析，由于那些东西一直没学习，也就没再弄，但是，通过弹幕，可以获取到在全频道广播的火箭信息，长时间监测这些数据应该也是一件有意思的事情。<br>说干就干，想要获取到直播间的弹幕数据不同于上边所说的页面数据抓取，好在斗鱼官方也提供了一个获取弹幕的途径(斗鱼弹幕服务器第三方接入协议)[<a href="http://dev-bbs.douyutv.com/forum.php?mod=viewthread&amp;tid=109]，文档中对如何获取弹幕数据、以及弹幕信息类型有具体的说明，这也大大降低了获取弹幕数据的难度。" target="_blank" rel="external">http://dev-bbs.douyutv.com/forum.php?mod=viewthread&amp;tid=109]，文档中对如何获取弹幕数据、以及弹幕信息类型有具体的说明，这也大大降低了获取弹幕数据的难度。</a><br>看过这个协议之后，通过建立与弹幕服务器的tcp连接，可以不断的获取到弹幕数据，我使用的是(socket)[<a href="https://docs.python.org/2/library/socket.html]这个库。" target="_blank" rel="external">https://docs.python.org/2/library/socket.html]这个库。</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">HOST = &apos;openbarrage.douyutv.com&apos;</div><div class="line">PORT = 8601</div><div class="line">RID = 97376</div><div class="line">LOGIN_INFO = &quot;type@=loginreq/username@=qq_aPSMdfM5&quot; + \</div><div class="line">    &quot;/password@=1234567890123456/roomid@=&quot; + str(RID) + &quot;/&quot;</div><div class="line">JION_GROUP = &quot;type@=joingroup/rid@=&quot; + str(RID) + &quot;/gid@=-9999&quot; + &quot;/&quot;</div><div class="line">ROOM_ID = &quot;type@=qrl/rid@=&quot; + str(RID) + &quot;/&quot;</div><div class="line">KEEP_ALIVE = &quot;type@=keeplive/tick@=&quot; + \</div><div class="line">    str(int(time.time())) + &quot;/vbw@=0/k@=19beba41da8ac2b4c7895a66cab81e23/&quot;</div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div></pre></td></tr></table></figure>
<p>在这里，需要注意几个变量： host port roomid gid 。其中HOST是弹幕服务器地址，port是对外开放的端口，roomid则是主播间对应的id，gid是要加入的弹幕频道，－9999频道可以获取到所有弹幕，也就是“海量弹幕”频道。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">def get_Hotroom():</div><div class="line">    hotroom = roomcol.find().limit(1).sort(</div><div class="line">        [(&quot;audience&quot;, pymongo.DESCENDING), (&quot;date&quot;, pymongo.DESCENDING)])</div><div class="line">    for item in hotroom:</div><div class="line">        return item[&quot;roomid&quot;]</div><div class="line">        </div><div class="line">def create_Conn():</div><div class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line">    s.connect((HOST, PORT))</div><div class="line">    RID = get_Hotroom()</div><div class="line">    print &quot;当前最热房间:&quot;, RID</div><div class="line">    LOGIN_INFO = &quot;type@=loginreq/username@=qq_aPSMdfM5&quot; + \</div><div class="line">        &quot;/password@=1234567890123456/roomid@=&quot; + str(RID) + &quot;/&quot;</div><div class="line">    print LOGIN_INFO</div><div class="line">    JION_GROUP = &quot;type@=joingroup/rid@=&quot; + str(RID) + &quot;/gid@=-9999&quot; + &quot;/&quot;</div><div class="line">    print JION_GROUP</div><div class="line">    s.sendall(tranMsg(LOGIN_INFO))</div><div class="line">    s.sendall(tranMsg(JION_GROUP))</div><div class="line">    return s</div></pre></td></tr></table></figure>
<p>之后，通过get_Hotroom()获取到当前最热门房间（人数最多的房间），通过create_Conn()建立与服务器的连接。连接建立之后就可以开心的获取并保存弹幕数据了:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">def insert_msg(sock):</div><div class="line">    sendtime = 0</div><div class="line">    while True:</div><div class="line">        if sendtime % 20 == 0:</div><div class="line">            print &quot;----------Keep Alive---------&quot;</div><div class="line">            try:</div><div class="line">                sock.sendall(tranMsg(KEEP_ALIVE))</div><div class="line">            except socket.error:</div><div class="line">                print &quot;alive error&quot;</div><div class="line">                sock = create_Conn()</div><div class="line">                insert_msg(sock)</div><div class="line">        sendtime += 1</div><div class="line">        print sendtime</div><div class="line">        try:</div><div class="line">            data = sock.recv(4000)</div><div class="line">            if data:</div><div class="line">                strdata = repr(data)</div><div class="line">                if &quot;type@=spbc&quot; in strdata:</div><div class="line">                    get_rocket(data)</div><div class="line">                if &quot;type@=chatmsg&quot; in strdata:</div><div class="line">                    get_chatmsg(data)</div><div class="line">        except socket.error:</div><div class="line">            print &quot;chat error&quot;</div><div class="line">            sock = create_Conn()</div><div class="line">            insert_msg(sock)</div><div class="line">        time.sleep(1)</div></pre></td></tr></table></figure>
<p>每20秒向服务器发送一条KEEP_ALIVE用以使连接保活，通过获取到的数据特点，将普通聊天弹幕和火箭广播弹幕区分开来，并且保存在不同的数据库中从而为之后提供不同的用途。<br>弹幕数据获取大致是这样的：<br><img src="https://o3sw4xojp.qnssl.com/Douyufandanmu.gif" alt="获取弹幕"></p>
<h1 id="后续内容"><a href="#后续内容" class="headerlink" title="后续内容"></a>后续内容</h1><p>至此，此项目的数据获取工作已经完成，在接下来两篇内容会分别介绍如何使用这些数据构建页面，以及在此过程中遇到的问题。</p>

      
    </div>

    
      
      



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="https://o3sw4xojp.qnssl.com/wpay.jpg" title="wechat">
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="https://o3sw4xojp.qnssl.com/apay.jpg" title="alipay">
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2016/07/23/HackOnDouyu--2/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Hack On Douyu -- 2</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2016/04/22/0422/">
        <span class="next-text nav-default">硕士论文致谢</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://eclipse-sv.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
  </div>


        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:eclipse_sv@163.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/love3forever" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
    
    
      
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2017

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">eclipsesv</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  
  <script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://eclipsesv.com/2016/07/20/HackOnDouyu--1/';
        this.page.identifier = '2016/07/20/HackOnDouyu--1/';
        this.page.title = 'Hack On Douyu -- 1';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//eclipse-sv.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>

  




    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.4.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.4.x"></script>

    
  <script type="text/html" id="search-result">
    <article class="post">
      <header class="post-header">
        <h1 class="post-title">
          <a href="$url$" class="post-link">
            $title$
          </a>
        </h1>
      </header>
      <div class="post-content">
        $content$
        <div class="read-more">
          <a href="$url$" class="read-more-link">
            阅读更多
          </a>
        </div>
      </div>
    </article>
  </script>
  <script type="text/html" id="no-search-result">
    <div class="no-result">
      <h2>No result found!</h2>
    </div>
  </script>
  <script type="text/javascript" src="/js/src/search.js?v=2.4.x"></script>

  </body>
</html>
