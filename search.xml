<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[ç¦»çº¿ç¯å¢ƒpythoné¡¹ç›®çš„éƒ¨ç½²]]></title>
      <url>/2017/10/24/%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83python%E9%A1%B9%E7%9B%AE%E7%9A%84%E9%83%A8%E7%BD%B2/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘è‡ªå·±å‚ä¸çš„ä¸€ä¸ªé¡¹ç›®æ¥è¿‘å°¾å£°ï¼Œéœ€è¦æŠŠä»£ç éƒ¨ç½²åˆ°ç”²æ–¹æä¾›çš„æœåŠ¡å™¨ã€‚æœ¬æ¥æƒ³ç€æ²¡æœ‰ä»€ä¹ˆå›°éš¾ï¼Œè°çŸ¥é“ç”²æ–¹æä¾›çš„æœåŠ¡å™¨éœ€è¦è¿æ¥åˆ°vpnå ¡å’æœºä¹‹åæ‰èƒ½è¿æ¥ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ˜¯ä¸èƒ½ä¸å¤–ç½‘ç›´æ¥è¿æ¥çš„ã€‚çŸ¥é“çœŸç›¸çš„æˆ‘çœ¼æ³ªæ‰ä¸‹æ¥ã€‚<br><a id="more"></a><br>å¹³å¸¸çš„å¼€å‘ä¸­ï¼Œç”¨æƒ¯äº†<code>pip install xxxx</code>æˆ–è€…æ˜¯<code>pip install -r requirements.txt</code>ï¼Œæ²¡æ€ä¹ˆè€ƒè™‘è¿‡å¦‚ä½•åœ¨ä¸å¤–ç½‘éš”ç¦»å¹¶ä¸”æ˜¯ä¸€ä¸ªè£¸æœºçš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²pythoné¡¹ç›®(å½“ç„¶ï¼Œå¦‚æœé¡¹ç›®ä¾èµ–æ¯”è¾ƒå°‘ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½æºç å®‰è£…ï¼Œå¦‚æœä¾èµ–æ¯”è¾ƒå¤šå°±ä¼šæ¯”è¾ƒéº»çƒ¦)ã€‚<br>ç»è¿‡ä¸€ç•ªæœç´¢å‘ç°äº†ä¸€æ¬¾ç¥å™¨ï¼š<a href="https://github.com/wolever/pip2pi" target="_blank" rel="external">pip2pi</a>ï¼Œå®ƒèƒ½å¤ŸæŠŠå½“å‰é¡¹ç›®çš„ä¾èµ–é¡¹æ”¾ç½®åœ¨ä¸€ä¸ªç›®å½•ä¸­ï¼Œç„¶åæŠŠè¿™äº›ä¾èµ–æ”¾åˆ°æœåŠ¡å™¨ä¸Šå†ä½¿ç”¨<code>pip</code>å®‰è£…ã€‚</p>
<h1 id="å…·ä½“ç”¨æ³•"><a href="#å…·ä½“ç”¨æ³•" class="headerlink" title="å…·ä½“ç”¨æ³•"></a>å…·ä½“ç”¨æ³•</h1><p>åœ¨ä½¿ç”¨<code>pip2pi</code>æ‰“åŒ…é¡¹ç›®ä¾èµ–ä¹‹å‰ï¼Œéœ€è¦æ‰¾ä¸€ä¸ªå’ŒæœåŠ¡å™¨ç¯å¢ƒç›¸åŒçš„è™šæ‹Ÿæœºï¼šæ¯”å¦‚è¯´æœåŠ¡å™¨æ“ä½œç³»ç»Ÿæ˜¯centos6.5ã€pythonç‰ˆæœ¬æ˜¯2.7ï¼Œé‚£å°±éœ€è¦è‡ªå·±å¼„ä¸ªè™šæ‹ŸæœºæŠŠç¯å¢ƒæä¸€è‡´å†ä¸‹è½½ä¾èµ–é¡¹ã€‚<br>è¯¦ç»†æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä¸ºäº†é¿å…å¤šä½™ä¾èµ–çš„å¼•å…¥ï¼Œæœ€å¥½æ˜¯ç”¨<code>virtualenv</code>åˆ›å»ºä¸€ä¸ªéš”ç¦»ç¯å¢ƒï¼š<code>virtualenv packages</code></li>
<li><p>è·å–å½“å‰é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–ï¼Œè¿›å…¥éš”ç¦»ç¯å¢ƒï¼Œå°†é¡¹ç›®çš„ä¾èµ–é¡¹å®Œæ•´ä¸‹è½½ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cd /path/to/project</div><div class="line">pip freeze &gt; requirements.txt</div><div class="line">cp requirements.txt /path/to/packages/</div><div class="line"></div><div class="line">cd /path/to/packages</div><div class="line">source bin/active</div><div class="line">pip install pip2pi</div><div class="line">mkdir dependences</div><div class="line">pip2pi /path/to/packages/dependences --no-use-wheel -r requirements.txt</div></pre></td></tr></table></figure>
</li>
<li><p>å°†ä¸‹è½½å¥½çš„ä¾èµ–é¡¹æ”¾åœ¨æœåŠ¡å™¨ï¼Œæ‰§è¡Œå‘½ä»¤å®‰è£…ä¾èµ–ï¼Œç¬¬ä¸€éå®‰è£…å¯èƒ½è·³è¿‡æŸäº›ä¾èµ–é¡¹ï¼Œå¯ä»¥å¤šæ¬¡æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install --no-index --find-links=file:///path_to/packages/dependences -r requirements.txt</div></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      
        
        <tags>
            
            <tag> python </tag>
            
            <tag> ç¦»çº¿ç¯å¢ƒ </tag>
            
            <tag> pip2pi </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åœ¨vulträ¸Šæ­å»ºshadowsocks]]></title>
      <url>/2017/10/13/%E5%9C%A8vultr%E4%B8%8A%E6%90%AD%E5%BB%BAshadowsock/</url>
      <content type="html"><![CDATA[<p>ä¸ºå•¥çªç„¶æƒ³è¦è‡ªå·±æ­ä¸€ä¸ªshadowsockså‘¢ï¼Œäº‹æƒ…çš„èµ·å› æ˜¯è¿™æ ·çš„ï¼š<a href="https://github.com/getlantern/forum" target="_blank" rel="external">è“ç¯</a>è¿™ä¸ªé¡¹ç›®åœ¨<a href="https://github.com/trending" target="_blank" rel="external">git trending</a>ä¸Šè¿ç»­ä¸Šæ¦œå¤šæ—¥ï¼Œçœ‹äº†è¯„è®ºå‘ç°åŸæ¥è¿™ä¸ªä¸œè¥¿æ˜¯ä¸ªvpnï¼Œå¾ˆå¤šäººç”¨æ¥å½“æ¢¯å­ã€‚å› ä¸ºæœ€è¿‘ç§ç§åŸå› è¿™ä¸ªæ¢¯å­ç°åœ¨ç”¨ä¸æˆäº†ï¼Œæ‰€ä»¥å¾ˆå¤šç”¨æˆ·è·‘æ¥åæ§½ã€‚æˆ‘ä¸€ç›´æ¯”è¾ƒæ‡’ï¼Œéƒ½æ˜¯ç›´æ¥ä¹°çš„ç°æˆçš„vpnï¼Œç°åœ¨ä¸€ç›´åœ¨ç”¨è¿™ä¸ªå®˜ç½‘ç»å¸¸ä¸Šä¸å»çš„<a href="https://netfits.net.cn/" target="_blank" rel="external">netfits</a>ï¼Œæ€»ä½“æ„Ÿè§‰è¿˜è¡Œï¼Œå°±æ˜¯ä»·æ ¼æœ‰ç‚¹è´µï¼Œæ‰€ä»¥è¶ç€è¿™ä¸ªåä¸€é•¿å‡ä¹‹åçš„ç¬¬ä¸€ä¸ªå‘¨äº”ä¸‹åˆæ¥æç‚¹äº‹æƒ…ï¼Œæ­ä¸€ä¸ªè‡ªå·±çš„ssæœåŠ¡å™¨ã€‚<br><img src="https://o3sw4xojp.qnssl.com/lantern.png" alt="lantern.png"><br><a id="more"></a><br>ç»è¿‡ä¸€ç•ªå¯¹æ¯”ï¼Œæˆ‘æœ€ç»ˆé€‰æ‹©ä½¿ç”¨<a href="https://www.vultr.com/" target="_blank" rel="external">vultr</a>çš„ä¸»æœº(ä¸»è¦æ˜¯å› ä¸ºä»·æ ¼ä¸è´µè¿˜å¯ä»¥ç”¨æ”¯ä»˜å®æ”¯ä»˜ğŸ˜‚)ï¼Œæœ¬æ¥æƒ³ç”¨æ—¥æœ¬çš„èŠ‚ç‚¹ï¼Œæ­å®Œä¹‹åå‘ç°pingä¸åˆ°ä¸»æœºï¼Œæœ€ç»ˆé€‰æ‹©äº†æ–°åŠ å¡çš„èŠ‚ç‚¹ï¼Œæ­é…1000GB/5$/æœˆçš„å¥—é¤(ä¸€ä¸ªæœˆ30å¤šå—ï¼Œnetfitsæ€•æ˜¯åªæœ‰10GBå§)ã€‚<br><img src="https://o3sw4xojp.qnssl.com/conf.png" alt="conf.png"></p>
<h1 id="shadowsocksæœåŠ¡å®‰è£…"><a href="#shadowsocksæœåŠ¡å®‰è£…" class="headerlink" title="shadowsocksæœåŠ¡å®‰è£…"></a>shadowsocksæœåŠ¡å®‰è£…</h1><p>å®‰è£…è¿‡ç¨‹ååˆ†ç®€å•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</div><div class="line">&gt; chmod +x shadowsocks.sh</div><div class="line">&gt; ./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log</div></pre></td></tr></table></figure></p>
<p>ä¸‰æ¡å‘½ä»¤ï¼Œå¤–åŠ é…ç½®å¯†ç ã€å¼€æ”¾ç«¯å£ã€åŠ å¯†æ–¹å¼è¿™äº›å°±è¡Œã€‚<br>å¦‚æœåæœŸéœ€è¦ä¿®æ”¹é…ç½®ï¼Œå»ä¿®æ”¹<code>/etc/shadowsocks.json</code>è¿™ä¸ªæ–‡ä»¶å³å¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</div><div class="line">    &quot;server_port&quot;:33333,</div><div class="line">    &quot;local_address&quot;:&quot;127.0.0.1&quot;,</div><div class="line">    &quot;local_port&quot;:1080,</div><div class="line">    &quot;password&quot;:&quot;abc@123&quot;,</div><div class="line">    &quot;timeout&quot;:300,</div><div class="line">    &quot;method&quot;:&quot;aes-256-cfb&quot;,</div><div class="line">    &quot;fast_open&quot;:true</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="shadowsockså®¢æˆ·ç«¯é…ç½®"><a href="#shadowsockså®¢æˆ·ç«¯é…ç½®" class="headerlink" title="shadowsockså®¢æˆ·ç«¯é…ç½®"></a>shadowsockså®¢æˆ·ç«¯é…ç½®</h1><p>æœåŠ¡é…å¥½ä¹‹åï¼Œä¸‹è½½è‡ªå·±éœ€è¦çš„å®¢æˆ·ç«¯å°±è¡Œï¼š<a href="https://github.com/shadowsocks/shadowsocks-windows" target="_blank" rel="external">windowsç‰ˆæœ¬</a>ã€<a href="https://github.com/shadowsocks/ShadowsocksX-NG" target="_blank" rel="external">macç‰ˆæœ¬</a>ã€‚<br>æ‰‹æœºçš„è¯ï¼Œæˆ‘åœ¨app storeé‡Œè¾¹æ‰¾äº†ä¸ªä¸€ä¸ª18å—é’±çš„shadoWingyåº”ç”¨ï¼Œä¹Ÿæ˜¯éœ€è¦ç®€å•çš„é…ç½®ä¸€ä¸‹å°±è¡Œäº†ã€‚</p>
]]></content>
      
        <categories>
            
            <category> çæ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> vultr </tag>
            
            <tag> shadowsock </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ä¸€æ¬¡å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹]]></title>
      <url>/2017/09/26/%E4%B8%80%E6%AC%A1%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨åšä¸€ä¸ªå°å‹çš„mongodbè¿ç»´å·¥å…·ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­æƒ³è¦å®ç°mongodbæ•°æ®åº“å¤‡ä»½çš„åŠŸèƒ½ï¼šå‰ç«¯é¡µé¢æä¾›ä¸€ä¸ªæŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»ä¹‹åå‘åç«¯postæƒ³è¦å¤‡ä»½å“ªä¸ªæ•°æ®åº“ï¼Œåç«¯æ¥åˆ°è¯·æ±‚ä¹‹åå°†è¿™ä¸ªä»»åŠ¡å‘ç»™å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œåœ¨æ•°æ®åº“å®Œæˆå¤‡ä»½ä¹‹åï¼Œåç«¯æ¨é€ä¸€ä¸ªåŒ…å«æ­¤æ¬¡å¤‡ä»½è¯¦æƒ…çš„æ¶ˆæ¯ç»™å‰ç«¯é¡µé¢ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªèƒ½å¤Ÿä¸‹è½½æ­¤å¤‡ä»½æ–‡ä»¶çš„é“¾æ¥ã€‚<br>æˆ‘çš„å®ç°æ–¹æ³•å¯ä»¥ç”¨ä¸‹è¾¹è¿™ä¸ªå›¾æ¥è¡¨è¾¾ï¼š<br><img src="https://o3sw4xojp.qnssl.com/task-flow.png" alt="task-flow.png"><br><a id="more"></a></p>
<h1 id="å®ç°è¿‡ç¨‹å’Œé‡åˆ°çš„é—®é¢˜"><a href="#å®ç°è¿‡ç¨‹å’Œé‡åˆ°çš„é—®é¢˜" class="headerlink" title="å®ç°è¿‡ç¨‹å’Œé‡åˆ°çš„é—®é¢˜"></a>å®ç°è¿‡ç¨‹å’Œé‡åˆ°çš„é—®é¢˜</h1><p>é¦–å…ˆï¼Œä»‹ç»ä¸€ä¸‹æˆ‘åœ¨è¿™é‡Œç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯ç»„æˆï¼šå‰ç«¯ç›´æ¥ä½¿ç”¨vueï¼Œåç«¯ä½¿ç”¨flaskæä¾›restfulæœåŠ¡ï¼Œä½¿ç”¨flask-jwtæ¥æ‰©å±•ç”¨æˆ·è®¤è¯çš„åŠŸèƒ½ã€ä½¿ç”¨flask-socketioæ‰©å±•ç»™å‰åç«¯ä¹‹é—´å¢åŠ websocketçš„é€šè®¯æ–¹å¼ã€‚Celeryå½“ä½œå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œé•¿è€—æ—¶çš„ä»»åŠ¡ã€‚ä½¿ç”¨Fabricæ¥æ‰§è¡Œä¸€äº›æµç¨‹åŒ–çš„ä»»åŠ¡(æ¯”å¦‚åœ¨æœåŠ¡å™¨æœ¬åœ°æ‰§è¡Œæ•°æ®åº“å¤‡ä»½)ã€‚Redisåœ¨è¿™é‡Œå……å½“æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè´Ÿè´£flaskå’Œceleryä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡(å¤šäºäº†flask-socketioè¿™ä¸ªåº“)ã€‚</p>
<h2 id="jwtæƒé™è®¤è¯"><a href="#jwtæƒé™è®¤è¯" class="headerlink" title="jwtæƒé™è®¤è¯"></a>jwtæƒé™è®¤è¯</h2><p>ç°åœ¨çš„webå¼€å‘ï¼Œéƒ½é€æ¸åå‘å‰åç«¯åˆ†ç¦»çš„æ¨¡å¼ï¼Œå‰åç«¯ä¹‹é—´çš„é€šè®¯å¤§éƒ½æ˜¯é€šè¿‡æ•°æ®æ¥å£çš„å½¢å¼æ¥è¿›è¡Œã€‚é‚£ä¹ˆå‰ç«¯å‘æ¥ä¸€ä¸ªæ•°æ®è¯·æ±‚ï¼Œåç«¯è¯¥å¦‚ä½•çŸ¥é“æ˜¯è°åœ¨è¯·æ±‚æ•°æ®ã€æ•°æ®è¯·æ±‚è€…æœ‰æ²¡æœ‰æƒé™è®¿é—®è¿™äº›æ•°æ®èµ„æºå‘¢ï¼Ÿæˆ‘è¿™æ¬¡å°è¯•ä½¿ç”¨JWT(JSON Web Tokens)æ¥è¿›è¡Œç”¨æˆ·è®¤è¯ã€‚<br>ç”±äºåç«¯ä½¿ç”¨çš„æ˜¯flask+flask-restfulæ¥æä¾›restæ•°æ®æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥æ‰¾åˆ°ä¸€ä¸ªflaskçš„jwtæ‰©å±•:<a href="https://pythonhosted.org/Flask-JWT/" target="_blank" rel="external">Flask-JWT</a>ã€‚åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¹Ÿååˆ†æ–¹ä¾¿ï¼Œä½ éœ€è¦åšçš„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>åˆ›å»ºUserï¼š<br>åˆ›å»ºUserçš„ç›®çš„æ˜¯åœ¨ä¹‹åçš„è®¤è¯è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡Userçš„usernameå’Œpassowrdæ¥ç”Ÿæˆtokenã€‚è¿™é‡Œçš„Userå¿…é¡»çš„ä¸‰ä¸ªå±æ€§ï¼šusernameã€passwordã€idã€‚</li>
<li><p>å®Œæˆjwtçš„åŸºç¡€é…ç½®ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># jwtç›¸å…³</div><div class="line">jwt_config = &#123;</div><div class="line">    &apos;JWT_SECRET_KEY&apos;: &apos;jwt_secret&apos;,</div><div class="line">    &apos;JWT_AUTH_URL_RULE&apos;: &apos;/api/v1/auth&apos;,</div><div class="line">    &apos;JWT_EXPIRATION_DELTA&apos;: timedelta(days=1)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœflaskè‡ªèº«çš„é…ç½®æ²¡æœ‰<code>SECRET_KEY</code>è¿™ä¸€é¡¹ï¼Œjwtå¿…é¡»è‡ªå·±é…ç½®<code>JWT_SECRET_KEY</code>ï¼Œå¦åˆ™flask-jwtä¼šåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æŠ¥é”™ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TypeError: Expecting a string- or bytes-formatted key.</div></pre></td></tr></table></figure>
<p> å¦å¤–ä¸€äº›å…¶ä»–çš„ç›¸å…³é…ç½®ï¼Œéƒ½å¯ä»¥åœ¨flask-jwtçš„æ–‡æ¡£ä¸­æ‰¾åˆ°ã€‚</p>
</li>
<li><p>å®ç°jwtè®¤è¯è¿‡ç¨‹æ–¹æ³•</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">def authenticate(username, password):</div><div class="line">    # ç”¨æˆ·èº«ä»½è®¤è¯</div><div class="line">    user = User(username, password)</div><div class="line">    flag, _ = user.check_password()</div><div class="line">    if flag:</div><div class="line">        return user</div><div class="line">    else:</div><div class="line">        return None</div><div class="line"></div><div class="line">def identity(payload):</div><div class="line">    print(payload)</div><div class="line">    if payload:</div><div class="line">        user_id = payload[&apos;identity&apos;]</div><div class="line">        # è¿”å›å€¼ä¸ºä¹‹åçš„current_identity</div><div class="line">        return User.gen_user_by_id(user_id)</div><div class="line">    else:</div><div class="line">        return None</div></pre></td></tr></table></figure>
</li>
<li><p>å®Œæˆjwté…ç½®</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app = Flask(__name__)</div><div class="line">app.config.update(jwt_config)</div><div class="line">jwt = JWT(app, authenticate, identity)</div></pre></td></tr></table></figure>
<p> é€šè¿‡ä¸Šè¿°çš„å‡ ä¸ªæ­¥éª¤ï¼Œå°±å¯ä»¥ç®€å•çš„æ„å»ºä¸€ä¸ªç”±jwtæ¥å®ˆæŠ¤çš„æ•°æ®æœåŠ¡äº†ï¼Œåœ¨åˆæ¬¡è®¤è¯è·å–tokençš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å‘<code>JWT_AUTH_URL_RULE</code>æ‰€æŒ‡å‘çš„url postè‡ªå·±çš„ç”¨æˆ·åå’Œå¯†ç å³å¯ã€‚</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">â†’ http POST http://localhost:11111/api/v1/auth username=aaa password=bbb</div><div class="line">HTTP/1.1 200 OK</div><div class="line">Connection: keep-alive</div><div class="line">Content-Length: 226</div><div class="line">Content-Type: application/json</div><div class="line">Date: Wed, 27 Sep 2017 05:12:54 GMT</div><div class="line"></div><div class="line">&#123;</div><div class="line">    &quot;access_token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZGVudGl0eSI6IjU5YjVlZDM3NzY0NTBiZjBhYjc1ODE3OCIsImlhdCI6MTUwNjQ4OTE3NCwibmJmIjoxNTA2NDg5MTc0LCJleHAiOjE1MDY1NzU1NzR9.1mZhsu7JU_mAV88TtPmG70iV9Z78QBf0bKKiAGqP6ZE&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>@jwt_requiredå’Œcurrent_identity<br>åŠ å…¥jwtæ˜¯æƒ³è®©å®ƒæ¥ä¿æŠ¤æˆ‘çš„æ•°æ®æœåŠ¡ï¼Œè¿™ä¸ªå®ç°è¿‡ç¨‹ååˆ†ç®€å•ï¼Œåªéœ€è¦åœ¨éœ€è¦ä¿æŠ¤çš„åœ°æ–¹æ·»åŠ <code>@jwt_required</code>è¿™ä¸ªè£…é¥°å™¨å³å¯ï¼Œè€Œä»flask_jwtä¸­å¼•å…¥çš„<code>current_identity</code>æ›´æ˜¯èƒ½å¤Ÿè·å¾—å½“å‰è¯·æ±‚æ•°æ®çš„ç”¨æˆ·æ˜¯è°ï¼Œå°±åƒä¹‹å‰é€šè¿‡flask_loginä¸­é€šè¿‡<code>current_user</code>è·å–å½“å‰ç”¨æˆ·ä¸€æ ·ã€‚</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">from flask_jwt import jwt_required, current_app, current_identity</div><div class="line"></div><div class="line">@api_mongo.resource(&apos;/&lt;string:db&gt;/status&apos;)</div><div class="line">class DatabaseStatus(Resource):</div><div class="line">    &quot;&quot;&quot;docstring for DatabaseStatus&quot;&quot;&quot;</div><div class="line">    @jwt_required()</div><div class="line">    def get(self, db):</div><div class="line">        try:</div><div class="line">            db = mongo.get_database(db)</div><div class="line">            data = db.command(&quot;dbstats&quot;)</div><div class="line">        except Exception as e:</div><div class="line">            print(str(e))</div><div class="line">            abort(404)</div><div class="line">        else:</div><div class="line">            return make_response(jsonify(data))</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="vue-resourceè·å–åç«¯æ•°æ®"><a href="#vue-resourceè·å–åç«¯æ•°æ®" class="headerlink" title="vue-resourceè·å–åç«¯æ•°æ®"></a>vue-resourceè·å–åç«¯æ•°æ®</h2><p>åœ¨é¦–æ¬¡è¿›è¡Œç”¨æˆ·è®¤è¯çš„æ—¶å€™ï¼Œå°†ä»åç«¯è·å–çš„tokenæ”¾åœ¨localStorageä¸­ï¼Œç„¶ååœ¨æ¯æ¬¡è®¿é—®å—ä¿æŠ¤çš„èµ„æºçš„æ—¶å€™ï¼Œåœ¨è¯·æ±‚çš„çš„headeré‡Œè¾¹å¢åŠ <code>Authorization</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// ç”¨æˆ·åˆæ¬¡è®¤è¯</div><div class="line">this.$http.post(&apos;/api/v1/auth&apos;, JSON.stringify(&#123;username: this.username,password:this.password&#125;)).then(response=&gt;&#123;</div><div class="line">  console.log(response) </div><div class="line">  localStorage.setItem(&apos;jwt_token&apos;,response.data[&apos;access_token&apos;])</div><div class="line">  this.$message(&apos;ç™»é™†æˆåŠŸ&apos;)</div><div class="line">  this.$router.push(&apos;/&apos;)</div><div class="line">&#125;, response=&gt;&#123;</div><div class="line">  this.$message(&apos;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&apos;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">// è®¿é—®å—ä¿æŠ¤èµ„æº</div><div class="line">this.$http.get(&apos;/api/v1/mongo/&apos;+db+&apos;/colstatus&apos;,&#123;&apos;headers&apos;:&#123;&apos;Authorization&apos;:&apos;JWT &apos;+localStorage.getItem(&apos;jwt_token&apos;)&#125;&#125;).then(response=&gt;&#123;</div><div class="line">  console.log(response)</div><div class="line">  this.colData = response.body</div><div class="line">&#125;, response=&gt;&#123;</div><div class="line">  this.$message(&apos;è·å–æ•°æ®åº“è¯¦æƒ…å¤±è´¥&apos;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="å¼‚æ­¥æ‰§è¡Œä»»åŠ¡"><a href="#å¼‚æ­¥æ‰§è¡Œä»»åŠ¡" class="headerlink" title="å¼‚æ­¥æ‰§è¡Œä»»åŠ¡"></a>å¼‚æ­¥æ‰§è¡Œä»»åŠ¡</h2><p>è¿™æ¬¡è¦å®ç°çš„ä»»åŠ¡æ˜¯å®ŒæˆmongodbæŒ‡å®šåº“çš„å¤‡ä»½ï¼Œç”±äº<code>pymongo</code>ä¸­å¹¶æ²¡æœ‰ç±»ä¼¼mongodbè‡ªå¸¦å·¥å…·<code>mongodump</code>é‚£æ ·çš„æ–¹æ³•ï¼Œæ‰€ä»¥æƒ³äº†ä¸ªåŠæ³•è®©å¼‚æ­¥ä»»åŠ¡é€šè¿‡<code>fabric</code>æ‰§è¡Œå‘½ä»¤å®Œæˆæ•°æ®åº“å¤‡ä»½ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">import os</div><div class="line">from time import time</div><div class="line">from datetime import datetime</div><div class="line">from flask_socketio import SocketIO</div><div class="line">from pymongo import MongoClient</div><div class="line">from gridfs import GridFSBucket</div><div class="line">from functionModules.taskQueue.celery_app import app</div><div class="line">from fabric.api import local</div><div class="line"></div><div class="line"></div><div class="line">@app.task</div><div class="line">def mongodump(cmd_str, dump_path, dump_root, dump_name, username, db_name, db_col):</div><div class="line">    dump_start = time()</div><div class="line">    gfs, col = init_mongo()</div><div class="line">    tar_path = &apos;./dump_tars/&#123;&#125;.tar.gz&apos;.format(dump_name)</div><div class="line">    tar_filename = &apos;&#123;&#125;.tar.gz&apos;.format(dump_name)</div><div class="line">    local(cmd_str)</div><div class="line">    local(&apos;cd &#123;&#125;&apos;.format(dump_path))</div><div class="line">    local(&apos;pwd&apos;)</div><div class="line">    local(&apos;tar zcvf &#123;&#125; -C &#123;&#125; .&apos;.format(tar_path, dump_path))</div><div class="line">    print(&apos;å¤‡ä»½æ–‡ä»¶å‹ç¼©å®Œæ¯•&apos;)</div><div class="line">    with open(tar_path, &apos;rb&apos;) as df:</div><div class="line">        g_upload = gfs.open_upload_stream(</div><div class="line">            tar_filename, metadata=&#123;&apos;contentType&apos;: &apos;application/x-compressed&apos;&#125;)</div><div class="line">        g_upload.write(df.read())</div><div class="line">        g_upload.close()</div><div class="line">        print(&quot;æ–‡ä»¶ä¸Šä¼ å®Œæ¯•&quot;)</div><div class="line">        dump_over = time()</div><div class="line">        dump_cost = round(dump_over - dump_start, 2)</div><div class="line">        dump_result = &#123;</div><div class="line">            &apos;dump_name&apos;: tar_filename,</div><div class="line">            &apos;operator&apos;: username,</div><div class="line">            &apos;complete_time&apos;: datetime.now().strftime(&apos;%Y-%m-%d %H-%M&apos;),</div><div class="line"></div><div class="line">            &apos;file_size&apos;: get_FileSize(tar_path),</div><div class="line">            &apos;time_cost&apos;: dump_cost,</div><div class="line">            &apos;db_name&apos;: db_name,</div><div class="line">            &apos;col_name&apos;: db_col</div><div class="line">        &#125;</div><div class="line">        col.insert_one(dump_result)</div><div class="line">        print(&apos;å¤‡ä»½æµç¨‹å®Œæˆ&apos;)</div><div class="line">    try:</div><div class="line">        from eventlet import monkey_patch</div><div class="line">        monkey_patch()</div><div class="line">        socketio = SocketIO(message_queue=&apos;redis://localhost:6379/10&apos;)</div><div class="line">        socketio.emit(&apos;mongo dump&apos;, &apos;mongodump complete&apos;)</div><div class="line">    except Exception as e:</div><div class="line">        print(str(e))</div><div class="line"></div><div class="line"></div><div class="line">def get_FileSize(filePath):</div><div class="line">    filePath = unicode(filePath, &apos;utf8&apos;)</div><div class="line">    fsize = os.path.getsize(filePath)</div><div class="line">    fsize = fsize / float(1024 * 1024)</div><div class="line">    return round(fsize, 2)</div><div class="line"></div><div class="line"></div><div class="line">def init_mongo():</div><div class="line">    mongo = MongoClient()</div><div class="line">    db = mongo[&apos;mongodump&apos;]</div><div class="line">    gfs = GridFSBucket(db)</div><div class="line">    col = db[&apos;dump_info&apos;]</div><div class="line">    return gfs, col</div></pre></td></tr></table></figure></p>
<p>æ•´ä¸ªä»»åŠ¡ä¸»è¦æ˜¯æƒ³è¦å®ç°ï¼š</p>
<ol>
<li>æŒ‡å®šmongodbåº“çš„å¤‡ä»½</li>
<li>å°†mongodbå¤‡ä»½æ–‡ä»¶å¤¹å‹ç¼©</li>
<li>å°†å‹ç¼©æ–‡ä»¶ä¸Šä¼ åˆ°mongodbçš„gridfsä¸­æŒä¹…å­˜å‚¨</li>
<li>å°†æ­¤æ¬¡å¤‡ä»½è¯¦æƒ…å­˜å…¥æ•°æ®åº“ä¸­</li>
<li>ä»»åŠ¡å®Œæˆä¹‹åé€šè¿‡websocketé€šçŸ¥ä¸»ç¨‹åºä»»åŠ¡å®Œæˆ</li>
</ol>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ï¼Œä¸»è¦ç¢°åˆ°äº†è¿™æ ·å‡ ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>ä½¿ç”¨<code>tar zcvf</code>å‹ç¼©æ–‡ä»¶çš„æ—¶å€™ï¼Œå‘ç°å‹ç¼©åŒ…åœ¨è§£å‹çš„æ—¶å€™ï¼Œè§£å‹å‡ºæ¥çš„æ–‡ä»¶åŒ…å«äº†è¢«å‹ç¼©æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œè§£å†³åŠæ³•å°±æ˜¯ï¼š<code>tar zcvf xx.tar.gz -C /path/to/floder .</code>,ä¸€å®šä¸èƒ½å¿˜è®°æœ€åçš„é‚£ä¸ª<code>.</code></li>
<li><p>ä¸å¾—ä¸è¯´ï¼Œ<code>flask-socketio</code>è¿™ä¸ªåº“çœŸçš„æ˜¯å¾ˆæ£’ï¼Œé€šè¿‡</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">socketio = SocketIO(message_queue=&apos;redis://localhost:6379/10&apos;)</div><div class="line">socketio.emit(&apos;mongo dump&apos;, &apos;mongodump complete&apos;)</div></pre></td></tr></table></figure>
<p> è¿™æ ·çš„æ–¹å¼å°±å¯ä»¥åœ¨Celeryçš„è¿›ç¨‹ä¸­è§¦å‘ä¸»è¿›ç¨‹(flask)websocketäº‹ä»¶ï¼Œè¿™ä¸ªä¸»è¦å½’åŠŸäºredisçš„pub/sub(è¿™ä¸ªç­‰ä¸‹å†è¯´)</p>
</li>
</ol>
<h2 id="å’Œredisç»“åˆçš„flask-socketio"><a href="#å’Œredisç»“åˆçš„flask-socketio" class="headerlink" title="å’Œredisç»“åˆçš„flask-socketio"></a>å’Œredisç»“åˆçš„flask-socketio</h2><p>ä¹‹å‰ä¸€ç›´è‹¦æ¼çš„æ˜¯ï¼Œåœ¨ä¸»è¿›ç¨‹(flask)è°ƒç”¨celeryçš„taskä¹‹åï¼Œæˆ‘è¯¥å¦‚ä½•æ‰çŸ¥é“ä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µã€‚å½“ç„¶ï¼Œåƒè¿™æ ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">celery_task_result = celery_tasks.mongodump.apply_async(</div><div class="line">    (dump_cmd_str, &apos;&#123;&#125;&#123;&#125;&apos;.format(dump_root, dump_dir), dump_root, dump_dir, username, dump_db, dump_col))</div><div class="line">while not celery_task_result.ready():</div><div class="line">    time.sleep(1)</div></pre></td></tr></table></figure></p>
<p>çš„ç¡®å¯ä»¥è·å¾—å¼‚æ­¥æ‰§è¡Œä»»åŠ¡çš„çŠ¶æ€ï¼Œä½†æ˜¯è¿™æ ·ä¼šä½¿ä¸»è¿›ç¨‹é˜»å¡ï¼Œä¸æ˜¯ä¸€ä¸ªå¯å–çš„æ–¹æ³•ã€‚ç›´åˆ°åœ¨æˆ‘é‡æ–°çœ‹äº†å¥½å‡ é<code>flask-socketio</code>æ–‡æ¡£ä¹‹åæ‰å‘ç°è¿™äº›å†…å®¹ï¼Œç½‘é¡µé“¾æ¥åœ¨æ­¤ï¼š<a href="https://flask-socketio.readthedocs.io/en/latest/" target="_blank" rel="external">flask-socketioæ–‡æ¡£</a>ï¼š<br><img src="https://o3sw4xojp.qnssl.com/flask-socketio.png" alt="flask-socketio.png"><br>å¦‚æœçœŸå¦‚æ–‡æ¡£å†…å®¹æ‰€è¯´ï¼Œæˆ‘ç”¨redisåšä¸ºflask-socketioçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œceleryåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥éšæ—¶æŠŠå®ƒè‡ªå·±æ‰§è¡Œçš„ä»»åŠ¡çŠ¶æ€é€šè¿‡è¿™ä¸ªæ¶ˆæ¯é˜Ÿåˆ—è§¦å‘å¯¹åº”çš„æ–‡ä»¶ã€‚äºæ˜¯ï¼Œæˆ‘èµ¶ç´§ä¿®æ”¹ä»£ç :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># socketioç›¸å…³</div><div class="line">socketio = SocketIO(app, message_queue=&apos;redis://localhost:6379/10&apos;,</div><div class="line">                    async_mode=&apos;eventlet&apos;)</div></pre></td></tr></table></figure></p>
<p>ä¸€è¾¹æ”¹ä»£ç ä¸€éyyï¼Œè¿™ä¸‹nbäº†ï¼Œè°çŸ¥é“é‡æ–°æ‰§è¡Œç¨‹åºå‘ç°è¿™æ ·çš„æŠ¥é”™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RuntimeError:Redis requires a monkey patched socket library to work with evnetlet</div></pre></td></tr></table></figure></p>
<p>æŸ¥çœ‹äº†æºç å¹¶ä¸”åˆgoogleä¹‹åï¼Œåœ¨åˆå§‹åŒ–socketioçš„æ—¶å€™ç®€å•çš„ä½¿ç”¨eventletçš„monkey patchå³å¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">from eventlet import monkey_patch</div><div class="line"></div><div class="line">monkey_patch()</div></pre></td></tr></table></figure></p>
<p>ç»è¿‡è¿™ä¸€ç•ªæ“ä½œï¼Œç°åœ¨socketioçš„æ¶ˆæ¯éƒ½æ˜¯é€šè¿‡redisæ¥ä¼ é€’ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ç›´è§‚çš„åœ¨<code>redis-cli</code>ä¸­çœ‹åˆ°:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">â†’ redis-cli       </div><div class="line">127.0.0.1:6379&gt; select 10</div><div class="line">OK</div><div class="line">127.0.0.1:6379[10]&gt; SUBSCRIBE flask-socketio  # ä½¿ç”¨redisåšæ¶ˆæ¯é˜Ÿåˆ—ï¼Œé»˜è®¤channelæ˜¯flask-socketio</div><div class="line">Reading messages... (press Ctrl-C to quit)</div><div class="line">1) &quot;subscribe&quot;</div><div class="line">2) &quot;flask-socketio&quot;</div><div class="line">3) (integer) 1</div><div class="line">1) &quot;message&quot;</div><div class="line">2) &quot;flask-socketio&quot;</div><div class="line">3) &quot;(dp0\nS&apos;skip_sid&apos;\np1\nNsS&apos;room&apos;\np2\nNsS&apos;namespace&apos;\np3\nS&apos;/&apos;\np4\nsS&apos;event&apos;\np5\nS&apos;mongo dump&apos;\np6\nsS&apos;callback&apos;\np7\nNsS&apos;data&apos;\np8\nS&apos;mongodump complete&apos;\np9\nsS&apos;method&apos;\np10\nS&apos;emit&apos;\np11\ns.&quot;</div></pre></td></tr></table></figure></p>
<p><strong>è¿™æ ·ï¼Œåªéœ€è¦åœ¨åç«¯å†™å¥½å¯¹åº”çš„äº‹ä»¶ï¼Œceleryåœ¨æ‰§è¡Œå®Œæˆåè§¦å‘äº‹ä»¶ï¼Œå‰ç«¯è®¢é˜…äº†è¯¥äº‹ä»¶çš„åœ°æ–¹ä½œå‡ºå¯¹åº”çš„å“åº”å³å¯ã€‚</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">this.socket = io(&apos;http://localhost:11111&apos;)</div><div class="line">this.socket.on(&apos;mongo dump&apos;,(dumpmsg)=&gt;&#123;</div><div class="line">  console.log(`mongo dump: $&#123;dumpmsg&#125;`)</div><div class="line">  this.$notify(&#123;</div><div class="line">    title: &apos;æˆåŠŸ&apos;,</div><div class="line">    message: dumpmsg,</div><div class="line">    type: &apos;success&apos;</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><img src="https://o3sw4xojp.qnssl.com/socket-message.png" alt="socket-message.png"></p>
<h2 id="flaskæ–‡ä»¶ä¸‹è½½"><a href="#flaskæ–‡ä»¶ä¸‹è½½" class="headerlink" title="flaskæ–‡ä»¶ä¸‹è½½"></a>flaskæ–‡ä»¶ä¸‹è½½</h2><p>å…¶å®ä¸Šè¾¹è®²äº†ä¸€å¤§å †ï¼ŒåŸºæœ¬ä¸Šå·²ç»èµ°å®Œäº†æ•´ä¸ªå¼‚æ­¥ä»»åŠ¡çš„æ•´ä¸ªè¿‡ç¨‹ã€‚ä½†æ˜¯æ–‡ä»¶å®Œæˆå¤‡ä»½ï¼Œæœ€ç»ˆè¿˜æ˜¯è¦æä¾›ä¸€ä¸ªä¸‹è½½é“¾æ¥ï¼Œä¸»è¦æ˜¯ä¸ºäº†è®©å®æ–½äººå‘˜æ‹¿ç€è¿™å¥—å¤‡ä»½å»ç»™ç”¨æˆ·è¿˜åŸæ•°æ®ç”¨ã€‚<br>åœ¨flaské‡Œè¾¹ï¼Œè·å–mongodb gridfsä¸­æ–‡ä»¶å¹¶æä¾›ä¸‹è½½é€šè¿‡è¿™æ ·çš„æ–¹å¼å³å¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">from pymongo import MongoClient</div><div class="line">from gridfs import GridFSBucket</div><div class="line">mongo = MongoClient()</div><div class="line">dump_db = mongo[&apos;mongodump&apos;]</div><div class="line">dump_info_col = dump_db[&apos;dump_info&apos;]</div><div class="line">gfs = GridFSBucket(dump_db)</div><div class="line"></div><div class="line">@bp_mongo_file.route(&apos;/dumpdownload/&lt;string:filename&gt;&apos;)</div><div class="line">def mongofile_download(filename):</div><div class="line">    if filename:</div><div class="line">        try:</div><div class="line">            grid_out = gfs.open_download_stream_by_name(filename)</div><div class="line">        except Exception:</div><div class="line">            abort(404)</div><div class="line">        else:</div><div class="line">            contents = grid_out.read()</div><div class="line">            if contents:</div><div class="line">                response = make_response(contents)</div><div class="line">                response.headers[&apos;Content-Type&apos;] = &apos;application/x-compressed&apos;</div><div class="line">                response.headers[&quot;Content-Disposition&quot;] = \</div><div class="line">                    &quot;attachment; filename=&#123;&#125;&quot;.format(filename)</div><div class="line">                return response</div></pre></td></tr></table></figure></p>
<p>è€Œåœ¨vueå‰ç«¯ï¼Œåªéœ€è¦åœ¨å¯¹åº”çš„ä½ç½®æ·»åŠ ä¸‹è½½é“¾æ¥å³å¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;a :href=&quot;getDownloadLink(scope.row.dump_name)&quot;&gt;ç‚¹å‡»ä¸‹è½½&lt;/a&gt;</div><div class="line"></div><div class="line">getDownloadLink:function(filename)&#123;</div><div class="line">  return &apos;http://localhost:11111/mongofile/dumpdownload/&apos;+filename</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>è¿™ä¸ªåŠŸèƒ½çš„å¼€å‘åªæ˜¯ä¸ªå¼€å§‹ï¼Œä¸è¿‡åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘æœ‰å‡ ç‚¹æ„Ÿå—ï¼š</p>
<ol>
<li>å¿…é¡»è¦é‡è§†å®˜æ–¹æ–‡æ¡£çš„åŠ›é‡</li>
<li>åœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œé™¤äº†googleï¼Œæ·±å…¥ä¸‹å»ç ”ç©¶æºä»£ç æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„æ–¹æ³•</li>
<li>ä¸œè¥¿è¦æ´»å­¦æ´»ç”¨ï¼Œç°åœ¨çœ‹æ¥flask-socketioä½¿ç”¨redisåšä¸ºæ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼ï¼Œå…¶å®æˆ‘åœ¨è¯»ç ”çš„æ—¶å€™ç”¨nodeå®ç°è¿‡ç±»ä¼¼çš„ä¸œè¥¿ã€‚åº“å¯ä»¥ç”¨ç°æˆçš„ï¼Œä½†æ˜¯æ€ç»´ä¸èƒ½åƒµåŒ–ã€‚</li>
<li>åšä¸œè¥¿ä¹‹å‰è¦æœ‰æ¸…æ™°çš„é€»è¾‘ï¼Œæœ€å¥½èƒ½å¤Ÿç”»æˆå›¾</li>
</ol>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> celery </tag>
            
            <tag> fabric </tag>
            
            <tag> mongodb </tag>
            
            <tag> websocket </tag>
            
            <tag> redis </tag>
            
            <tag> jwt </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mongodbä½¿ç”¨æ€»ç»“]]></title>
      <url>/2017/09/18/mongodb%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>æœ¬æƒ³ä¸Šå‘¨æœ«å†™å¥½è¿™ç¯‡æ€»ç»“çš„ï¼Œæ— å¥ˆä¸€èµ·å¼€é»‘çš„æ—¶é—´æ€»æ˜¯è¿‡å¾—å¾ˆå¿«ï¼Œå°±å·äº†ä¸ªæ‡’ï¼Œå¹¶ä¸”è¿˜å­¦äº†ä¸ªæ–°èœï¼šè¥¿çº¢æŸ¿ç‰›è…©.jpgã€‚æ‰€ä»¥å°±æŠŠæ€»ç»“çš„äº‹æƒ…æ”¾åˆ°ä»Šå¤©æ¥äº†ã€‚<br>åˆæ¬¡æ¥è§¦mongodbè¿˜æ˜¯åœ¨ç ”ä¸€åˆšå…¥å­¦çš„æ—¶å€™ï¼Œé‚£æ—¶å€™æ¥è§¦çš„ä¸œè¥¿å°‘ï¼Œå¾ˆå¤šæ¦‚å¿µéƒ½ä¸æ¸…æ¥šï¼Œåˆ°ç°åœ¨å·®ä¸å¤šå·²ç»æœ‰ä¸‰å¹´äº†ï¼Œæ‰€ä»¥æ€»ç»“ä¸€ä¸‹æˆ‘ç”¨mongodbåšäº†å“ªäº›äº‹æƒ…è¿˜æ˜¯æ¯”è¾ƒæœ‰æ„ä¹‰çš„ã€‚<br><a id="more"></a></p>
<h2 id="æˆ‘çš„ä½¿ç”¨åœºæ™¯"><a href="#æˆ‘çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="æˆ‘çš„ä½¿ç”¨åœºæ™¯"></a>æˆ‘çš„ä½¿ç”¨åœºæ™¯</h2><p>å…³äºmongodbçš„ä»‹ç»ï¼Œæˆ‘åœ¨è¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚mongodbåœ¨æˆ‘è¿™é‡Œä¸»è¦çš„ç”¨é€”æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<pre><code>1. æµ·é‡ç“¦ç‰‡æ•°æ®å­˜å‚¨ç®¡ç†
2. çŸ¢é‡æ•°æ®å­˜å‚¨ç®¡ç†
3. ä¸€èˆ¬æ€§jsonæ•°æ®å­˜å‚¨ç®¡ç†
</code></pre><p>ä¸‹é¢ä¼šåˆ†åˆ«æ ¹æ®ä½¿ç”¨åœºæ™¯æ€»ç»“åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°çš„mongodbç‰¹æ€§ã€‚</p>
<h2 id="æµ·é‡ç“¦ç‰‡æ•°æ®å­˜å‚¨ç®¡ç†"><a href="#æµ·é‡ç“¦ç‰‡æ•°æ®å­˜å‚¨ç®¡ç†" class="headerlink" title="æµ·é‡ç“¦ç‰‡æ•°æ®å­˜å‚¨ç®¡ç†"></a>æµ·é‡ç“¦ç‰‡æ•°æ®å­˜å‚¨ç®¡ç†</h2><p>è¿™é‡Œè¯´çš„æµ·é‡ç“¦ç‰‡æ•°æ®ï¼Œå¯ä»¥æŠŠå®ƒå½“ä½œæ˜¯å¤§é‡å°æ–‡ä»¶ã€‚å…·ä½“çš„åº”ç”¨å¯ä»¥çœ‹<a href="https://eclipsesv.com/2015/07/31/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E7%BC%93%E5%AD%98%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">æœåŠ¡å™¨ç«¯ç¼“å­˜ç¯å¢ƒé…ç½®</a>å’Œ<a href="https://eclipsesv.com/2015/08/17/Mongodb%E5%89%AF%E6%9C%AC%E9%9B%86%E5%9C%A8nginx-gridfs%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/">Mongodbå‰¯æœ¬é›†åœ¨nginx-gridfsä¸­çš„ä½¿ç”¨</a>ç›¸å…³çš„å‡ ç¯‡åšå®¢ã€‚é€šè¿‡<a href="http://nginx.org/" target="_blank" rel="external">nginx</a>+<a href="https://github.com/mdirolf/nginx-gridfs" target="_blank" rel="external">nginx-gridfs</a>çš„ç®€å•é…ç½®å’Œéå¸¸ç®€å•çš„luaé€»è¾‘æ§åˆ¶è„šæœ¬ï¼Œå°±å¯ä»¥ç›´æ¥æ ¹æ®è¯·æ±‚urlæ¥è·å–mongodb gridfsä¸­å¯¹åº”çš„æ–‡ä»¶ã€‚<br>ç”±äºé‚£æ—¶å€™æ‰åˆšæ¥è§¦è¿™äº›ä¸œè¥¿ï¼Œæœ‰å¾ˆå¤šç°åœ¨çœ‹æ¥æ¯”è¾ƒç®€å•çš„é—®é¢˜ï¼Œéƒ½ç»•äº†ä¸å°‘å¼¯å­ï¼Œæ¯”å¦‚è¯´ï¼šä¸çŸ¥é“mongodbå¦‚ä½•å¤‡ä»½æ•°æ®(æ‰€ä»¥æ›´åˆ«æè¿˜åŸå¤‡ä»½äº†)ï¼Œæ¯æ¬¡è¿ç§»æ•°æ®åº“éƒ½æ˜¯ç›´æ¥æ‹·è´dbæ–‡ä»¶å¤¹(ä¸åŒæ•°æ®åº“ç‰ˆæœ¬å’Œä¸åŒçš„æ“ä½œç³»ç»Ÿç»å¸¸ä¼šå¯¼è‡´å¤±è´¥)ï¼›ä¸çŸ¥é“æ•°æ®åº“ç´¢å¼•æ˜¯ä»€ä¹ˆç”¨ï¼Œåœ¨æ•°æ®é‡è¾ƒå¤§çš„æ—¶å€™ç»å¸¸æŸ¥è¯¢è¶…æ—¶ï¼›ä¸æ‡‚æ“ä½œç³»ç»Ÿï¼Œåœ¨æœåŠ¡å™¨ä¸Šå¿…é¡»æœ‰å›¾å½¢ç•Œé¢æ‰å¯ä»¥æ“ä½œâ€¦<br>åœ¨ç”¨æƒ¯äº†è¿™å¥—ç»„åˆä¹‹åï¼Œåè¾¹è¿˜åœ¨nginxå’Œmongodbä¸­é—´åŠ äº†redisä½œä¸ºç¼“å­˜ï¼Œä»¥æå‡æ•°æ®ç´¢å¼•æ•ˆç‡ã€åœ¨ä¸€ä¸ªå…¨æ™¯åœ°å›¾é¡¹ç›®ä¸­ï¼Œä½¿ç”¨gridfsæ¥ç®¡ç†å¤§é‡çš„å…¨æ™¯å›¾ç‰‡ã€ç°åœ¨å·¥ä½œçš„é¡¹ç›®ä¸­ï¼Œä¹Ÿå°è¯•ä½¿ç”¨mongodbæ¥ç®¡ç†ç“¦ç‰‡æ•°æ®ã€‚</p>
<h2 id="çŸ¢é‡æ•°æ®å­˜å‚¨å’Œç®¡ç†"><a href="#çŸ¢é‡æ•°æ®å­˜å‚¨å’Œç®¡ç†" class="headerlink" title="çŸ¢é‡æ•°æ®å­˜å‚¨å’Œç®¡ç†"></a>çŸ¢é‡æ•°æ®å­˜å‚¨å’Œç®¡ç†</h2><p>è¿™é‡Œè¯´çš„çŸ¢é‡æ•°æ®æŒ‡çš„æ˜¯ESRIå…¬å¸å¼€å‘çš„shapefileã€‚åœ¨ä¹‹å‰çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨mongodbç®¡ç†çŸ¢é‡æ•°æ®ï¼Œä¸»è¦æ˜¯æƒ³è¦ç®¡ç†çŸ¢é‡æ•°æ®ä¸­åŒ…å«çš„ç©ºé—´å’Œå±æ€§ä¿¡æ¯ï¼Œæ‰€ä»¥å°†shapefileè½¬ä¸ºgeojsonä¹‹åå†ç”±mongodbç®¡ç†æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚é€šå¸¸å¯ä»¥ä½¿ç”¨gdalæ¥å®Œæˆshapefileâ€“&gt;geojsonè¿™ä¸€æ­¥çš„è½¬æ¢å·¥ä½œã€‚å®Œæˆæ•°æ®è½¬æ¢ä¹‹åï¼Œmongodbå¯ä»¥å¾ˆæ–¹ä¾¿çš„å­˜å‚¨å’Œç»„ç»‡geojsonæ•°æ®ã€‚åœ¨è¿›è¡Œç©ºé—´æ•°æ®çš„ç´¢å¼•çš„æ—¶å€™ï¼Œmongodbçš„2då’Œ2dsphereç´¢å¼•æä¾›çš„ä¸€ç³»åˆ—æ“ä½œèƒ½å¤Ÿå®Œæˆå¾ˆå¤šä»»åŠ¡ï¼š<br><strong>2dsphere</strong>ç´¢å¼•ä»…æ”¯æŒçƒé¢æŸ¥è¯¢ï¼Œ<strong>2d</strong>ç´¢å¼•æ”¯æŒå¹³é¢æŸ¥è¯¢å’Œéƒ¨åˆ†çƒé¢æŸ¥è¯¢ã€‚è¿™ä¸¤ä¸ªç´¢å¼•æ”¯æŒçš„æ“ä½œä¸»è¦æœ‰ä»¥ä¸‹è¿™äº›ï¼š</p>
<ol>
<li><p>$near<br> å®šä¹‰ï¼šåœ¨ä¸€æ¬¡ç©ºé—´æŸ¥è¯¢ä¸­ï¼ŒæŒ‡å®šä¸€ä¸ªç‚¹ï¼ŒæŒ‰ç…§ç¦»æŒ‡å®šç‚¹è·ç¦»ç”±è¿‘åˆ°è¿œçš„é¡ºåºè¿”å›æŸ¥è¯¢ç»“æœã€‚è¿™ä¸ªæŒ‡å®šç‚¹å¯ä»¥æ˜¯ä¸€ä¸ªgeopointæˆ–è€…æ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„åæ ‡ç‚¹ã€‚<br> åœ¨ä½¿ç”¨$nearè¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œæ ¹æ®æŒ‡å®šç‚¹ç±»å‹çš„ä¸åŒéœ€è¦ä¸åŒçš„ç©ºé—´ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šç‚¹æ˜¯ä¸€ä¸ªgeopointåˆ™éœ€è¦æŸ¥è¯¢çš„å­—æ®µå»ºç«‹2dsphereç´¢å¼•ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„åæ ‡ç‚¹ï¼Œåˆ™éœ€è¦å»ºç«‹2dç´¢å¼•ã€‚<br> è¿›è¡Œ$nearæŸ¥è¯¢çš„æ—¶å€™ï¼Œä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">   &lt;location field&gt;: &#123;</div><div class="line">     $near: &#123;</div><div class="line">       $geometry: &#123;</div><div class="line">          type: &quot;Point&quot; ,</div><div class="line">          coordinates: [ &lt;longitude&gt; , &lt;latitude&gt; ]</div><div class="line">       &#125;,</div><div class="line">       $maxDistance: &lt;distance in meters&gt;,</div><div class="line">       $minDistance: &lt;distance in meters&gt;</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> âš ï¸<br> è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæŒ‡å®šç‚¹æ˜¯geopointï¼Œå¯ä»¥åœ¨æŸ¥è¯¢çš„æ—¶å€™æŒ‡å®šminDistanceï¼›å¦‚æœæŒ‡å®šç‚¹æ˜¯ä¼ ç»Ÿåæ ‡ç‚¹çš„æ—¶å€™ï¼ŒminDistanceä¸å¯ç”¨ï¼Œå¹¶ä¸”maxDistanceä»¥å¼§åº¦ä¸ºå•ä½ã€‚<br> åœ¨åˆ†äº†ç‰‡çš„æ•°æ®åº“ä¸­ï¼Œ$nearæ˜¯ä¸å¯ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨geoNearå‘½ä»¤æˆ–è€…$geoNearè¿›è¡Œèšåˆæ“ä½œã€‚</p>
</li>
<li>$nearSphere<br> æ­¤æ–¹æ³•å’Œ$nearåŠŸèƒ½ä¸€è‡´ã€‚</li>
<li><p>$geoWithin<br> å®šä¹‰ï¼šå°†å¤„äºæŒ‡å®šåŒºåŸŸå†…çš„æ‰€æœ‰å…ƒç´ è¿”å›ã€‚æŒ‡å®šåŒºåŸŸå¯ä»¥æ˜¯geojsonæ ¼å¼çš„<code>Polygon</code>æˆ–è€…<code>MultiPolygon</code>æˆ–è€…æ˜¯ä¼ ç»Ÿåæ ‡å¯¹åºåˆ—ã€‚<br> ä½¿ç”¨è¯­æ³•:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">   &lt;location field&gt;: &#123;</div><div class="line">      $geoWithin: &#123;</div><div class="line">         $geometry: &#123;</div><div class="line">            type: &lt;&quot;Polygon&quot; or &quot;MultiPolygon&quot;&gt; ,</div><div class="line">            coordinates: [ &lt;coordinates&gt; ]</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;æˆ–è€…æ˜¯</div><div class="line">&#123;</div><div class="line">   &lt;location field&gt;: &#123;</div><div class="line">      $geoWithin: &#123; &lt;shape operator&gt;: &lt;coordinates&gt; &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> æ ¹æ®æŒ‡å®šåŒºåŸŸæ„é€ çš„æ–¹å¼ä¸åŒï¼Œä½¿ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œå¦‚æœæŒ‡å®šåŒºåŸŸæ˜¯geojsonæ ¼å¼çš„å°±ç”¨<code>$geometry</code>æ“ä½œç¬¦ï¼Œå¦‚æœæŒ‡å®šåŒºåŸŸæ˜¯ä¼ ç»Ÿåæ ‡å¯¹ï¼Œå¯ç”¨çš„æ“ä½œç¬¦å°±æœ‰ï¼š<code>$box</code>ã€<code>$polygon</code>ã€<code>$center</code>å’Œ<code>$centerSphere</code>ã€‚<br> âš ï¸<br> $geoWithinä¸éœ€è¦ä¸“é—¨åˆ›å»ºç©ºé—´æ‰€ä»¥ï¼Œä½†æ˜¯æœ‰ç©ºé—´ç´¢å¼•å¯ä»¥æé«˜æ£€ç´¢æ•ˆç‡ï¼Œå¹¶ä¸”<code>2dsphere</code>å’Œ<code>2d</code>ç´¢å¼•å‡æ”¯æŒ<code>$geoWithin</code>ã€‚<br> $geoWithinè¿”å›çš„ç»“æœæ˜¯æ— åºçš„ï¼Œæ‰€ä»¥å®ƒçš„æŸ¥è¯¢é€šå¸¸è¦æ¯”<code>$near</code>æˆ–è€…æ˜¯<code>$geoNear</code>å¿«ã€‚<br> å¦‚æœæŒ‡å®šåŒºåŸŸè¿‡å¤§(è¶…è¿‡åŠçƒé¢)çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šmongodbçš„ç©ºé—´å‚è€ƒï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">db.places.find(</div><div class="line">   &#123;</div><div class="line">     loc: &#123;</div><div class="line">       $geoWithin: &#123;</div><div class="line">          $geometry: &#123;</div><div class="line">             type : &quot;Polygon&quot; ,</div><div class="line">             coordinates: [</div><div class="line">               [</div><div class="line">                 [ -100, 60 ], [ -100, 0 ], [ -100, -60 ], [ 100, -60 ], [ 100, 60 ], [ -100, 60 ]</div><div class="line">               ]</div><div class="line">             ],</div><div class="line">             crs: &#123;</div><div class="line">                type: &quot;name&quot;,</div><div class="line">                properties: &#123; name: &quot;urn:x-mongodb:crs:strictwinding:EPSG:4326&quot; &#125;</div><div class="line">             &#125;</div><div class="line">          &#125;</div><div class="line">       &#125;</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<p> åœ¨ä½¿ç”¨<code>$box</code>æ“ä½œç¬¦çš„æ—¶å€™ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &lt;location field&gt;: &#123;</div><div class="line">     $geoWithin: &#123;</div><div class="line">        $box: [</div><div class="line">          [ &lt;bottom left coordinates&gt; ],</div><div class="line">          [ &lt;upper right coordinates&gt; ]</div><div class="line">        ]</div><div class="line">     &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> åœ¨ä½¿ç”¨<code>$polygon</code>æ“ä½œç¬¦çš„æ—¶å€™ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">   &lt;location field&gt;: &#123;</div><div class="line">      $geoWithin: &#123;</div><div class="line">         $polygon: [ [ &lt;x1&gt; , &lt;y1&gt; ], [ &lt;x2&gt; , &lt;y2&gt; ], [ &lt;x3&gt; , &lt;y3&gt; ], ... ]</div><div class="line">      &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> åœ¨ä½¿ç”¨<code>$center</code>çš„æ—¶å€™ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">   &lt;location field&gt;: &#123;</div><div class="line">      $geoWithin: &#123; $center: [ [ &lt;x&gt;, &lt;y&gt; ] , &lt;radius&gt; ] &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> åœ¨ä½¿ç”¨<code>$centerSphere</code>çš„æ—¶å€™ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">   &lt;location field&gt;: &#123;</div><div class="line">      $geoWithin: &#123; $centerSphere: [ [ &lt;x&gt;, &lt;y&gt; ], &lt;radius&gt; ] &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>$geoIntersects<br> å®šä¹‰ï¼šè¿”å›å’ŒæŒ‡å®šåŒºåŸŸç›¸äº¤çš„å…ƒç´ ï¼ŒæŒ‡å®šåŒºåŸŸé€šå¸¸æ˜¯ä¸€ä¸ªgeojsonæ ¼å¼çš„<code>Polygon</code>ã€‚<br> ä½¿ç”¨è¯­æ³•ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &lt;location field&gt;: &#123;</div><div class="line">     $geoIntersects: &#123;</div><div class="line">        $geometry: &#123;</div><div class="line">           type: &quot;&lt;GeoJSON object type&gt;&quot; ,</div><div class="line">           coordinates: [ &lt;coordinates&gt; ]</div><div class="line">        &#125;</div><div class="line">     &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> âš ï¸<br> å’Œ<code>$geoWithin</code>ä¸€æ ·ï¼Œ<code>$geoIntersects</code>ä¸éœ€è¦ä¸“é—¨åˆ›å»ºç©ºé—´ç´¢å¼•ï¼Œä½†æ˜¯ç©ºé—´ç´¢å¼•èƒ½å¤Ÿæå‡æ£€ç´¢æ•ˆç‡ï¼Œä½†æ˜¯å®ƒä»…æ”¯æŒ<code>2dsphere</code>ç´¢å¼•ã€‚<br> åœ¨è¿›è¡Œè¶…è¿‡åŠçƒé¢çš„æ£€ç´¢æ—¶ï¼ŒåŒæ ·éœ€è¦æŒ‡å®šç©ºé—´å‚è€ƒï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">db.places.find(</div><div class="line">   &#123;</div><div class="line">     loc: &#123;</div><div class="line">       $geoIntersects: &#123;</div><div class="line">          $geometry: &#123;</div><div class="line">             type : &quot;Polygon&quot;,</div><div class="line">             coordinates: [</div><div class="line">               [</div><div class="line">                 [ -100, 60 ], [ -100, 0 ], [ -100, -60 ], [ 100, -60 ], [ 100, 60 ], [ -100, 60 ]</div><div class="line">               ]</div><div class="line">             ],</div><div class="line">             crs: &#123;</div><div class="line">                type: &quot;name&quot;,</div><div class="line">                properties: &#123; name: &quot;urn:x-mongodb:crs:strictwinding:EPSG:4326&quot; &#125;</div><div class="line">             &#125;</div><div class="line">          &#125;</div><div class="line">       &#125;</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
</li>
</ol>
<p>é€šè¿‡ä¸Šè¿°çš„å‡ ä¸ªæ–¹æ³•ï¼Œèƒ½è¿‡æ»¡è¶³ç©ºé—´æ•°æ®çš„å¸¸è§„ç´¢å¼•éœ€æ±‚ã€‚<br>ä¸Šè¿°ä¸¤ç§åœºæ™¯ä¸»è¦æ˜¯ä¸ºäº†åº”å¯¹å’Œç©ºé—´ä¿¡æ¯ç›¸å…³çš„æ•°æ®ï¼Œåœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œæ›´å¤šçš„æ˜¯æ™®é€šçš„jsonæ ¼å¼æ•°æ®ã€‚</p>
<h2 id="ä¸€èˆ¬æ€§jsonæ ¼å¼æ•°æ®å­˜å‚¨ç®¡ç†"><a href="#ä¸€èˆ¬æ€§jsonæ ¼å¼æ•°æ®å­˜å‚¨ç®¡ç†" class="headerlink" title="ä¸€èˆ¬æ€§jsonæ ¼å¼æ•°æ®å­˜å‚¨ç®¡ç†"></a>ä¸€èˆ¬æ€§jsonæ ¼å¼æ•°æ®å­˜å‚¨ç®¡ç†</h2><p>åœ¨æ›´å¤šçš„æ—¶å€™ï¼Œä½¿ç”¨mongodbä¸»è¦æ˜¯ç”¨æ¥ç»™webæœåŠ¡æä¾›æ•°æ®ã€‚ç°åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ–¹å¼ï¼Œå‰åç«¯ä¹‹é—´çš„äº¤äº’è½¬å˜ä¸ºæ•°æ®çš„äº¤äº’ï¼Œæˆ‘çš„å¥—è·¯å°±æ˜¯vue+flask-restful+mongodbã€‚<br>ç”±äºmongodbå¯¹jsonæ ¼å¼çš„æ•°æ®å­˜å‚¨æœ‰å…ˆå¤©çš„ä¼˜åŠ¿ï¼Œæ‰€ä»¥åœ¨å†™ä»£ç çš„æ—¶å€™ä¼šå‰©å¾ˆå¤šäº‹ï¼Œåˆç†çš„ä½¿ç”¨mongodbçš„ä¸€äº›ç‰¹æ€§ä¼šæœ‰æ›´å¤§çš„ä¾¿åˆ©ã€‚</p>
<h3 id="aggregation"><a href="#aggregation" class="headerlink" title="aggregation"></a>aggregation</h3><p>ä¹‹å‰è®°å½•è¿‡mongodbçš„aggreagtionç›¸å…³çš„å†…å®¹:<a href="https://eclipsesv.com/2016/11/23/mongodb_Aggregation/">Mongodb Aggregation Pipleline</a>å’Œ<a href="https://eclipsesv.com/2017/07/25/mongodb%E6%9C%80%E8%BF%91%E9%A2%91%E7%B9%81%E9%9C%80%E8%A6%81%E7%9C%8B%E7%9A%84%E6%96%87%E6%A1%A3/">mongodbæœ€è¿‘é¢‘ç¹çœ‹çš„æ–‡æ¡£</a>ã€‚<br>ç”±äºmongodbå¯¹è·¨è¡¨æŸ¥è¯¢æ”¯æŒçš„ä¸æ˜¯å¾ˆå¥½ï¼Œæ‰€ä»¥åœ¨æ•°æ®å­˜å‚¨çš„æ—¶å€™ç»å¸¸ä¼šå°½å¯èƒ½çš„å°†æ‰€éœ€è¦çš„æ•°æ®éƒ½æ”¾åœ¨åŒä¸€ä¸ªdocumenté‡Œè¾¹ã€‚ä½†æ˜¯åœ¨å®é™…è¿›è¡Œæ•°æ®è¯·æ±‚çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦å¯¹è·å–åˆ°çš„æ•°æ®è¿›è¡Œå¯¹åº”çš„å¤„ç†ï¼Œè¿™ä¸ªæ—¶å€™mongodbçš„aggregationå°±èƒ½èµ·åˆ°ä½œç”¨ã€‚ç›´æ¥åˆ©ç”¨æ•°æ®åº“çš„èƒ½åŠ›å®Œæˆæ•°æ®å¤„ç†ï¼Œé€šå¸¸ä¼šæ¯”æ‹¿åˆ°æ•°æ®ä¹‹åå†é€šè¿‡è‡ªå·±çš„ä»£ç å®Œæˆæ•°æ®å¤„ç†è¦å¥½å¾—å¤šã€‚</p>
<h3 id="ttlç´¢å¼•å’Œexplain"><a href="#ttlç´¢å¼•å’Œexplain" class="headerlink" title="ttlç´¢å¼•å’Œexplain()"></a>ttlç´¢å¼•å’Œexplain()</h3><p>è¿™ä¸¤ä¸ªç‚¹åœ¨ä¹‹å‰çš„ä¸€ä¸ªåšå®¢é‡Œè¾¹æåˆ°è¿‡ï¼š<a href="https://eclipsesv.com/2016/11/25/%E8%AF%BBMongodb%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E6%9C%89%E6%84%9F/">è¯»Mongodbæƒå¨æŒ‡å—æœ‰æ„Ÿ</a>ã€‚<br>ttlç´¢å¼•å¯ç”¨çš„é¢è¿˜æ˜¯æŒºå¹¿çš„ï¼Œç”¨ä»¥è®°å½•ç¼“å­˜è¿‡æœŸã€éªŒè¯ç æˆ–è€…å„ç±»æ—¶æ•ˆæ€§çš„æ•°æ®ã€‚<br>explain()æ–¹æ³•åœ¨è¿›è¡Œæ•°æ®åº“æ€§èƒ½è°ƒä¼˜çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šæœ‰å¾ˆå¥½çš„æ•ˆæœã€‚</p>
<h3 id="æ•°æ®å¤‡ä»½å’Œè¿˜åŸ"><a href="#æ•°æ®å¤‡ä»½å’Œè¿˜åŸ" class="headerlink" title="æ•°æ®å¤‡ä»½å’Œè¿˜åŸ"></a>æ•°æ®å¤‡ä»½å’Œè¿˜åŸ</h3><p>æ•´åº“çš„è¿˜åŸå’Œå¤‡ä»½ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡mongodbè‡ªå¸¦çš„å·¥å…·<code>mongodump</code>å’Œ<code>mongorestore</code>æ¥å®Œæˆï¼š<br>é€šè¿‡<code>mongodump -d database_name -o /path/to/dump_dir --gzip</code>æ¥å®Œæˆå¤‡ä»½ï¼Œ<code>mongorestore -d database_name --dir /path/to/dump_dir --gzip</code>æ¥å®Œæˆè¿˜åŸã€‚<br>å½“ç„¶ï¼Œå¦‚æœä¸¤ä¸ªæ•°æ®åº“å®ä¾‹åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨mongoä¸­æ‰§è¡Œå‘½ä»¤æ¥å®Œæˆdatabaseæˆ–è€…æ˜¯collectionçš„è¿ç§»ï¼š<br>ä½¿ç”¨cloneCollectionå‘½ä»¤æˆ–è€…db.cloneCollection()æ¥å®Œæˆcollectionçš„æ•°æ®è¿ç§»ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">db.runCommand( &#123; cloneCollection: &quot;users.profiles&quot;,</div><div class="line">                 from: &quot;mongodb.example.net:27017&quot;,</div><div class="line">                 query: &#123; &apos;active&apos; : true &#125;</div><div class="line">               &#125; )</div><div class="line"></div><div class="line">db.cloneCollection(&apos;mongodb.example.net:27017&apos;, &apos;users.profile&apos;,</div><div class="line">                    &#123; &apos;active&apos; : true &#125; )</div></pre></td></tr></table></figure></p>
<p>âš ï¸<br>mongosä¸æ”¯æŒä¸Šè¿°ä¸¤ç§æ–¹æ³•ï¼Œå¹¶ä¸”å¦‚æœç›®æ ‡æœåŠ¡å™¨çš„mongodbå®ä¾‹å¼€å¯<code>authorization</code>è¿™ä¸¤ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ä¸å¯ä»¥ç”¨çš„ã€‚<br>ç±»ä¼¼çš„ï¼Œä½¿ç”¨ä¸‹è¾¹ä¸¤ä¸ªæ–¹æ³•æ¥å®Œæˆæ•´ä¸ªåº“çš„æ‹·è´ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">use importdb</div><div class="line">db.cloneDatabase(&quot;hostname&quot;)</div><div class="line"></div><div class="line">&#123; clone: &quot;db1.example.net:27017&quot; &#125;</div></pre></td></tr></table></figure></p>
<h3 id="pymongoçš„ä½¿ç”¨"><a href="#pymongoçš„ä½¿ç”¨" class="headerlink" title="pymongoçš„ä½¿ç”¨"></a>pymongoçš„ä½¿ç”¨</h3><p>ä½¿ç”¨flask-restfulæä¾›æ•°æ®æœåŠ¡ï¼Œç”¨åˆ°mongodbçš„åœ°æ–¹æˆ‘éƒ½æ˜¯ç›´æ¥ä½¿ç”¨pymongoæ¥æ“ä½œæ•°æ®åº“ã€‚åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æœ‰å‡ ç‚¹ï¼Œå¯ä»¥è®°ä¸‹ï¼š</p>
<ol>
<li>åœ¨ä½¿ç”¨flaskçš„jsonifyçš„æ—¶å€™ï¼Œä¸èƒ½ç›´æ¥æŠŠmongodbè¿”å›çš„ä¸€æ•´æ¡æ•°æ®jsonifyï¼Œè¿™æ˜¯å› ä¸ºObjectIdä¸èƒ½ç›´æ¥è½¬ä¸ºjsonï¼Œé€šå¸¸æˆ‘åœ¨æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ä¸è¿”å›ObjectId</li>
<li>åœ¨è¿›è¡Œæ’åºæˆ–è€…å»ºç«‹ç´¢å¼•çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°<code>ASCENDING</code>å’Œ<code>DESCENDING</code>ï¼Œå‡åºå’Œé™åºã€‚éœ€è¦<code>from pymongo import DESCENDING, ASCENDING</code>ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–ä¸€äº›ç´¢å¼•ç±»å‹ï¼Œä¹Ÿéƒ½éœ€è¦ä»pymongoä¸­ç›´æ¥import</li>
<li><p>åœ¨æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œå°†æ•´ä¸ªæ•°æ®é›†è¿”å›ï¼Œç„¶åé€æ¡æ“ä½œã€‚æ•´ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šè€—è´¹è¾ƒé•¿çš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦è®¾ç½®<code>no_cursor_timeout</code>ï¼Œå°±åƒè¿™æ ·ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">def gen_playlists():</div><div class="line">    playlists = col.find(&#123;&#125;, &#123;&apos;_id&apos;: 0&#125;, no_cursor_timeout=True)</div><div class="line">    for playlist in playlists:</div><div class="line">        yield playlist</div><div class="line">    playlists.close()</div></pre></td></tr></table></figure>
<p> <code>no_cursor_timeout</code>é»˜è®¤è®¾ç½®ä¸º<code>False</code>ï¼Œå¦‚æœ<code>find()</code>è¿”å›çš„ç»“æœé›†ä¸­çš„æŸä¸ª<code>cursor</code>åœ¨ååˆ†é’Ÿä»¥å†…æ²¡æœ‰è¢«æ“ä½œï¼Œè¿™ä¸ªæŸ¥è¯¢ç»“æœå°±ä¼šè¢«å…³é—­ã€‚åœ¨å°†<code>no_cursor_timeout</code>è®¾ç½®ä¸º<code>True</code>çš„æ—¶å€™ï¼Œéœ€è¦åœ¨æ•°æ®æ“ä½œå®Œæˆä¹‹åæ‰‹åŠ¨å…³é—­æŸ¥è¯¢ç»“æœã€‚</p>
</li>
<li>ç»™mongodbè®¾ç½®ç”¨æˆ·åå¯†ç æ˜¯ä¿è¯æ•°æ®å®‰å…¨çš„ä¸€ä¸ªå¸¸ç”¨æ–¹æ³•ï¼Œè¿™ç¯‡<a href="https://eclipsesv.com/2017/01/17/mongodb%E5%B8%A6%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E4%BD%BF%E7%94%A8/">mongodbå¸¦å¯†ç éªŒè¯ä½¿ç”¨</a>åšå®¢é‡Œè¾¹æœ‰è¯¦ç»†çš„è¯´æ˜ã€‚</li>
</ol>
<h2 id="æœªç”¨åˆ°çš„ç‰¹æ€§"><a href="#æœªç”¨åˆ°çš„ç‰¹æ€§" class="headerlink" title="æœªç”¨åˆ°çš„ç‰¹æ€§"></a>æœªç”¨åˆ°çš„ç‰¹æ€§</h2><p>è™½è¯´æ˜¯å‰å‰ååå·®ä¸å¤šå·²ç»ç”¨äº†ä¸‰å¹´çš„mongodbï¼Œä½†æ€»ä½“è¯´æ¥ä¹Ÿå°±è¾¾åˆ°äº†ä¼šç”¨çš„ç¨‹åº¦ã€‚mongodbçš„åˆ†ç‰‡åˆ°ç°åœ¨ä¹Ÿæ²¡æœ‰å®é™…çš„åº”ç”¨ç»éªŒï¼Œå¾ˆå¤šæœ‰ç”¨çš„ç´¢å¼•ç±»å‹ä¹Ÿéƒ½æ²¡ç”¨è¿‡ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰å®å®åœ¨åœ¨ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½çš„ç»éªŒï¼Œæ‰€ä»¥è¿˜æœ‰å¾ˆå¤šè¦å­¦çš„ã€‚å¤§è‡´ä»ä¸€ä¸‹å‡ ç‚¹åŠªåŠ›ï¼š</p>
<ol>
<li>ä»”ç»†é˜…è¯»å®˜æ–¹æ–‡æ¡£</li>
<li>åœ¨ä»¥åçš„å°é¡¹ç›®ä¸­å°½é‡ä½¿ç”¨æ›´å¤šçš„æ•°æ®åº“æ–°ç‰¹æ€§</li>
<li>é™¤äº†pymongoä»¥å¤–ï¼Œå…¶ä»–çš„driverä¹Ÿæ¥è§¦ä½¿ç”¨</li>
<li>å°è¯•å­¦ä¹ mongodbå†…éƒ¨å®ç°ç»†èŠ‚ï¼Œæ¯”å¦‚geohashç®—æ³•çš„å®ç°</li>
</ol>
]]></content>
      
        
        <tags>
            
            <tag> mongodb </tag>
            
            <tag> æ€»ç»“ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[proxyåœ¨çˆ¬è™«ä¸­çš„ä½¿ç”¨å§¿åŠ¿]]></title>
      <url>/2017/08/28/proxy%E5%9C%A8%E7%88%AC%E8%99%AB%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8%E5%A7%BF%E5%8A%BF/</url>
      <content type="html"><![CDATA[<p>é€šè¿‡çˆ¬è™«è·å–æ•°æ®ä¼šç»å¸¸è¢«æœåŠ¡å™¨banæ‰ipï¼Œæ‰€ä»¥æœ‰ä¸ªæœ‰æ•ˆçš„proxy poolååˆ†å¿…è¦ã€‚è¿™å‡ å¤©åœ¨çˆ¬ç½‘æ˜“äº‘éŸ³ä¹çš„ç”¨æˆ·æ•°æ®ï¼Œé¡ºä¾¿æäº†ä¸ª<a href="https://github.com/love3forever/proxyHunter" target="_blank" rel="external">proxyhunter</a>ï¼Œå¹¶ä¸”å°è¯•å‘å¸ƒæˆpipåŒ…ï¼š<a href="https://pypi.python.org/pypi/proxyhunter/0.0.1" target="_blank" rel="external">proxyhunter</a>ï¼Œæ–¹ä¾¿ä»¥åçš„ä½¿ç”¨ã€‚ä¸‹é¢ä¸»è¦è¯´ä¸‹<strong>requests</strong>åœ¨è¿›è¡Œè¯·æ±‚çš„æ—¶å€™ï¼Œproxyå¦‚ä½•è®¾ç½®ï¼Œä»¥åŠæˆ‘è¿™ä¸ªproxyhunterå¦‚ä½•ä½¿ç”¨ã€‚<br><a id="more"></a><br>è¿™é‡Œè·å–çš„proxyéƒ½æ˜¯å…è´¹çš„ï¼Œæ¥è‡ª<a href="http://www.kuaidaili.com/" target="_blank" rel="external">http://www.kuaidaili.com/</a>ã€‚å¦‚æœå¯¹proxyæœ‰æ¯”è¾ƒé«˜çš„è¦æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ä»˜è´¹ç‰ˆçš„ï¼Œæˆ‘ä¹°äº†ä¸€å‘¨çš„å¼€æ”¾ä»£ç†ï¼Œå’Œå…è´¹çš„æ¯”èµ·æ¥ï¼Œè¿”å›çš„ä»£ç†åˆ—è¡¨ä¸­å¯ç”¨çš„æ¯”ä¾‹ç›¸å¯¹æ¥è¯´è¿˜æ˜¯æŒºé«˜çš„ã€‚</p>
<h1 id="requestçš„proxy"><a href="#requestçš„proxy" class="headerlink" title="requestçš„proxy"></a>requestçš„proxy</h1><p>åœ¨åˆ©ç”¨requestsè¿›è¡Œæ•°æ®è¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®proxyæ¥æŒ‡å®šè¯·æ±‚çš„proxyï¼Œå½“ç„¶ï¼Œå¦‚æœproxyä¸å¯ç”¨ï¼Œè¯·æ±‚æ˜¯æ— æ³•è¿”å›æ‰€éœ€è¦çš„æ•°æ®çš„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">def test_proxy(current_proxy):</div><div class="line">    # param: current_proxyæ˜¯ä¸€ä¸ªç”±hostå’Œportæ„æˆçš„tuple</div><div class="line">    # å°†è·å¾—çš„proxyé€šè¿‡&apos;http://ip.cn/&apos;æµ‹è¯•ï¼Œå¦‚æœå¯ç”¨è¿”å›True</div><div class="line">    proxies = dict()</div><div class="line">    if current_proxy:</div><div class="line">        proxies[&apos;http&apos;] = &quot;http://&#123;&#125;:&#123;&#125;&quot;.format(*current_proxy)</div><div class="line">        proxies[&apos;https&apos;] = &quot;http://&#123;&#125;:&#123;&#125;&quot;.format(*current_proxy)</div><div class="line">        try:</div><div class="line">            test_response = requests.get(</div><div class="line">                &apos;http://ip.cn/&apos;, timeout=5, proxies=proxies)</div><div class="line">        except Exception:</div><div class="line">            return False</div><div class="line">        else:</div><div class="line">            if test_response.status_code == 200:</div><div class="line">                test_soup = BeautifulSoup(test_response.content, &apos;lxml&apos;)</div><div class="line">                ip_info = test_soup.select(&apos;.well&apos;)</div><div class="line">                if ip_info:</div><div class="line">                    print(ip_info)</div><div class="line">                    return True</div><div class="line">            else:</div><div class="line">                return False</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é€šè¿‡requestè°ƒç”¨getçš„æ—¶å€™ï¼Œè®¾ç½®<code>proxies=proxies</code>å³å¯ã€‚<br>é€šè¿‡è¯·æ±‚<code>http://ip.cn/</code>å¯ä»¥æŸ¥è¯¢åˆ°å½“å‰çš„ipå’Œportï¼Œå‰ææ˜¯å½“å‰çš„proxyå¯ç”¨ã€‚</p>
<h1 id="proxyhunter"><a href="#proxyhunter" class="headerlink" title="proxyhunter"></a>proxyhunter</h1><p>ç”±äºæ˜¯ç¬¬ä¸€æ¬¡å‘pypiæäº¤pythonåŒ…ï¼Œè¿˜æ˜¯æœ‰å¿…è¦è®°å½•ä¸€ä¸‹è¿‡ç¨‹ï¼š</p>
<ol>
<li>ç¬¬ä¸€æ­¥å½“ç„¶æ˜¯<a href="https://pypi.python.org/pypi?%3Aaction=register_form" target="_blank" rel="external">æ³¨å†Œç”¨æˆ·</a></li>
<li>åœ¨å®Œæˆæ³¨å†Œå’Œé‚®ç®±éªŒè¯ä¹‹åï¼Œå¯ä»¥å®‰è£…ä¸€ä¸ª<a href="https://pypi.python.org/pypi/twine" target="_blank" rel="external">twine</a>ï¼Œç¨åä¸Šä¼ åŒ…ä¼šç”¨åˆ°è¿™ä¸ªå·¥å…·</li>
<li><p>æ‰“åŒ…ä»£ç ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">â”œâ”€â”€ LICENSE</div><div class="line">â”œâ”€â”€ README.md</div><div class="line">â”œâ”€â”€ proxyhunter</div><div class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</div><div class="line">â”‚Â Â  â””â”€â”€ huntingOn.py</div><div class="line">â”œâ”€â”€ requirements.txt</div><div class="line">â””â”€â”€ setup.py</div></pre></td></tr></table></figure>
<p> åˆå§‹æƒ…å†µä¸‹ï¼Œè‡ªå·±çš„ä»£ç æ”¾åœ¨proxyhunterç›®å½•ä¸­ï¼Œç¼–å†™æ‰“åŒ…ç›¸å…³ä»£ç ï¼Œåœ¨<code>setup.py</code>ä¸­ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">from setuptools import setup, find_packages</div><div class="line"></div><div class="line">setup(</div><div class="line">    name=&quot;proxyhunter&quot;,</div><div class="line">    version=&quot;0.0.1&quot;,</div><div class="line">    keywords=(&quot;pip&quot;, &quot;http&quot;, &quot;http proxy&quot;),</div><div class="line">    description=&quot;free available http proxy from web&quot;,</div><div class="line">    long_description=&quot;proxy hunter&quot;,</div><div class="line">    license=&quot;MIT Licence&quot;,</div><div class="line"></div><div class="line">    url=&quot;https://eclipsesv.com&quot;,</div><div class="line">    author=&quot;wangmengcn&quot;,</div><div class="line">    author_email=&quot;eclipse_sv@163.com&quot;,</div><div class="line"></div><div class="line">    packages=find_packages(),</div><div class="line">    include_package_data=True,</div><div class="line">    platforms=&quot;any&quot;,</div><div class="line">    install_requires=[&quot;requests&quot;, &quot;lxml&quot;, &quot;bs4&quot;]</div><div class="line">)</div></pre></td></tr></table></figure>
<p> è¿™é‡Œè¾¹çš„é…ç½®æ ¹æ®è‡ªå·±è¦å‘å¸ƒåŒ…çš„å…·ä½“æƒ…å†µè€Œå®šã€‚<br> ç„¶åå°±å¯ä»¥é€šè¿‡</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">python setup.py bdist_egg   # easy_install</div><div class="line">python setup.py sdist       # pip</div></pre></td></tr></table></figure>
<p> åœ¨distç›®å½•ä¸­ç”Ÿæˆå¯¹åº”æ–‡ä»¶ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">â”œâ”€â”€ proxyhunter-0.0.1-py2.7.egg</div><div class="line">â””â”€â”€ proxyhunter-0.0.1.tar.gz</div></pre></td></tr></table></figure>
<p> è¿™æ ·å°±å®Œæˆäº†ä»£ç çš„æ‰“åŒ…ã€‚ğŸºğŸºğŸº</p>
</li>
<li>å‘å¸ƒä»£ç <br>ä½¿ç”¨åˆšæ‰å®‰è£…çš„å·¥å…·<strong>twine</strong>:<code>twine upload dist/*</code><br>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å¯¹åº”å†…å®¹å³å¯ã€‚<br>è¿™æ—¶å€™ï¼Œç›®å½•ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„:<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">â”œâ”€â”€ LICENSE</div><div class="line">â”œâ”€â”€ README.md</div><div class="line">â”œâ”€â”€ build</div><div class="line">â”‚Â Â  â”œâ”€â”€ bdist.macosx-10.12-intel</div><div class="line">â”‚Â Â  â””â”€â”€ lib</div><div class="line">â”‚Â Â      â””â”€â”€ proxyhunter</div><div class="line">â”‚Â Â          â”œâ”€â”€ __init__.py</div><div class="line">â”‚Â Â          â””â”€â”€ huntingOn.py</div><div class="line">â”œâ”€â”€ dist</div><div class="line">â”‚Â Â  â”œâ”€â”€ proxyhunter-0.0.1-py2.7.egg</div><div class="line">â”‚Â Â  â””â”€â”€ proxyhunter-0.0.1.tar.gz</div><div class="line">â”œâ”€â”€ proxyhunter</div><div class="line">â”‚Â Â  â”œâ”€â”€ __init__.py</div><div class="line">â”‚Â Â  â””â”€â”€ huntingOn.py</div><div class="line">â”œâ”€â”€ proxyhunter.egg-info</div><div class="line">â”‚Â Â  â”œâ”€â”€ PKG-INFO</div><div class="line">â”‚Â Â  â”œâ”€â”€ SOURCES.txt</div><div class="line">â”‚Â Â  â”œâ”€â”€ dependency_links.txt</div><div class="line">â”‚Â Â  â”œâ”€â”€ requires.txt</div><div class="line">â”‚Â Â  â””â”€â”€ top_level.txt</div><div class="line">â”œâ”€â”€ requirements.txt</div><div class="line">â””â”€â”€ setup.py</div></pre></td></tr></table></figure>
</li>
</ol>
<p>å¹¶ä¸”ï¼Œç½‘ç«™ä¸Šå¯ä»¥çœ‹åˆ°<a href="https://pypi.python.org/pypi/proxyhunter/0.0.1" target="_blank" rel="external">ç›¸å…³çš„å†…å®¹</a>ã€‚</p>
<h2 id="proxyhunterç”¨æ³•"><a href="#proxyhunterç”¨æ³•" class="headerlink" title="proxyhunterç”¨æ³•"></a>proxyhunterç”¨æ³•</h2><p>ç”±äºç°åœ¨å·²ç»æ‰“åŒ…äº†ï¼Œç”¨çš„æ—¶å€™ä¹Ÿä¼šååˆ†ç®€å•ï¼š</p>
<ol>
<li>å®‰è£…<br><code>pip install proxyhunter</code></li>
<li>ä½¿ç”¨<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">In [1]: from proxyhunter.huntingOn import Hunter</div><div class="line"></div><div class="line">In [2]: hunter = Hunter()</div><div class="line"></div><div class="line">In [3]: for proxy in hunter:</div><div class="line">   ...:     print proxy</div><div class="line">   ...:</div><div class="line">wating for new proxy</div><div class="line">wating for new proxy</div><div class="line">[&lt;div class=&quot;well&quot;&gt;&lt;p&gt;\u60a8\u73b0\u5728\u7684 IP\uff1a&lt;code&gt;60.174.237.43&lt;/code&gt;&lt;/p&gt;&lt;p&gt;\u6240\u5728\u5730\u7406\u4f4d\u7f6e\uff1a&lt;code&gt;\u5b89\u5fbd\u7701\u5de2\u6e56\u5e02 \u7535\u4fe1&lt;/code&gt;&lt;/p&gt;&lt;p&gt;GeoIP: Hefei, Anhui, China&lt;/p&gt;&lt;/div&gt;]</div><div class="line">(u&apos;60.174.237.43&apos;, u&apos;9999&apos;)</div></pre></td></tr></table></figure>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> requests </tag>
            
            <tag> http proxy </tag>
            
            <tag> pip </tag>
            
            <tag> proxyhunter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[pythoné­”æœ¯æ–¹æ³•æŒ‡å—[è½¬]]]></title>
      <url>/2017/08/22/python%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95%E6%8C%87%E5%8D%97/</url>
      <content type="html"><![CDATA[<p>è½¬è‡ª<a href="http://pycoders-weekly-chinese.readthedocs.io/en/latest/issue6/a-guide-to-pythons-magic-methods.html" target="_blank" rel="external">Python é­”æœ¯æ–¹æ³•æŒ‡å—</a><br><a id="more"></a><br>æ–‡ç« ä¸»è¦åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>å…¥é—¨</li>
<li>æ„é€ å’Œåˆå§‹åŒ–</li>
<li>æ„é€ å®šåˆ¶ç±»<ul>
<li>ç”¨äºæ¯”è¾ƒçš„é­”æœ¯æ–¹æ³•</li>
<li>ç”¨äºæ•°å€¼å¤„ç†çš„é­”æœ¯æ–¹æ³•</li>
</ul>
</li>
<li>è¡¨ç°ä½ çš„ç±»</li>
<li>æ§åˆ¶å±æ€§è®¿é—®</li>
<li>åˆ›å»ºå®šåˆ¶åºåˆ—</li>
<li>åå°„</li>
<li>å¯ä»¥è°ƒç”¨çš„å¯¹è±¡</li>
<li>ä¼šè¯ç®¡ç†å™¨</li>
<li>åˆ›å»ºæè¿°å™¨å¯¹è±¡</li>
<li>æŒä¹…åŒ–å¯¹è±¡</li>
<li>æ€»ç»“</li>
<li>é™„å½•</li>
</ul>
<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>æ­¤æ•™ç¨‹ä¸ºæˆ‘çš„æ•°ç¯‡æ–‡ç« ä¸­çš„ä¸€ä¸ªé‡ç‚¹ã€‚ä¸»é¢˜æ˜¯é­”æœ¯æ–¹æ³•ã€‚<br>ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•?ä»–ä»¬æ˜¯é¢å‘å¯¹è±¡çš„Pythonçš„ä¸€åˆ‡ã€‚ä»–ä»¬æ˜¯å¯ä»¥ç»™ä½ çš„ç±»å¢åŠ â€magicâ€çš„ç‰¹æ®Šæ–¹æ³•ã€‚ä»–ä»¬æ€»æ˜¯è¢«åŒä¸‹åˆ’çº¿æ‰€åŒ…å›´(e.g. <code>__init__</code> æˆ–è€… <code>__lt__</code>)ã€‚ç„¶è€Œä»–ä»¬çš„æ–‡æ¡£å´è¿œæ²¡æœ‰æä¾›åº”è¯¥æœ‰çš„å†…å®¹ã€‚Pythonä¸­æ‰€æœ‰çš„é­”æœ¯æ–¹æ³•å‡åœ¨Pythonå®˜æ–¹æ–‡æ¡£ä¸­æœ‰ç›¸åº”æè¿°ï¼Œä½†æ˜¯å¯¹äºä»–ä»¬çš„æè¿°æ¯”è¾ƒæ··ä¹±è€Œä¸”ç»„ç»‡æ¯”è¾ƒæ¾æ•£ã€‚å¾ˆéš¾æ‰¾åˆ°æœ‰ä¸€ä¸ªä¾‹å­(ä¹Ÿè®¸ä»–ä»¬åŸæœ¬æ‰“ç®—çš„å¾ˆå¥½ï¼Œåœ¨å¼€å§‹è¯­è¨€å‚è€ƒä¸­æœ‰æè¿°å¾ˆè¯¦ç»†ï¼Œç„¶è€Œéšä¹‹è€Œæ¥çš„ç¡®æ˜¯æ¯ç‡¥çš„è¯­æ³•æè¿°ç­‰ç­‰)ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸ºäº†ä¿®è¡¥æˆ‘è®¤ä¸ºPythonæ–‡æ¡£åº”è¯¥ä¿®è¡¥çš„ç‘•ç–µï¼Œæˆ‘å†³å®šç»™Pythonä¸­çš„é­”æœ¯æ–¹æ³•æä¾›ä¸€äº›ç”¨å¹³æ·¡çš„è¯­è¨€å’Œå®ä¾‹é©±ä½¿çš„æ–‡æ¡£ã€‚æˆ‘åœ¨å¼€å§‹å·²ç»å†™äº†æ•°ç¯‡åšæ–‡ï¼Œç°åœ¨åœ¨è¿™ç¯‡æ–‡ç« ä¸­å¯¹ä»–ä»¬è¿›è¡Œæ€»ç»“ã€‚</p>
<p>æˆ‘å¸Œæœ›ä½ èƒ½å¤Ÿå–œæ¬¢è¿™ç¯‡æ–‡ç« ã€‚ä½ å¯ä»¥å°†ä¹‹å½“åšä¸€ä¸ªæ•™ç¨‹ï¼Œä¸€ä¸ªè¡¥ä¹ èµ„æ–™ï¼Œæˆ–è€…ä¸€ä¸ªå‚è€ƒã€‚æœ¬æ–‡ç« çš„ç›®çš„ä»…ä»…æ˜¯ä¸ºPythonä¸­çš„é­”æœ¯æ–¹æ³•æä¾›ä¸€ä¸ªå‹å¥½çš„æ•™ç¨‹ã€‚</p>
<h2 id="æ„é€ å’Œåˆå§‹åŒ–"><a href="#æ„é€ å’Œåˆå§‹åŒ–" class="headerlink" title="æ„é€ å’Œåˆå§‹åŒ–"></a>æ„é€ å’Œåˆå§‹åŒ–</h2><p>æ¯ä¸ªäººéƒ½çŸ¥é“ä¸€ä¸ªæœ€åŸºæœ¬çš„é­”æœ¯æ–¹æ³•ï¼Œ <code>__init__</code> ã€‚é€šè¿‡æ­¤æ–¹æ³•æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå¯¹è±¡çš„åˆå§‹æ“ä½œã€‚ç„¶è€Œï¼Œå½“æˆ‘è°ƒç”¨ <code>x = SomeClass()</code> çš„æ—¶å€™ï¼Œ <code>__init__</code> å¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„æ–¹æ³•ã€‚å®é™…ä¸Šï¼Œè¿˜æœ‰ä¸€ä¸ªå«åš <code>__new__</code> çš„æ–¹æ³•ï¼Œæ¥æ„é€ è¿™ä¸ªå®ä¾‹ã€‚ç„¶åç»™åœ¨å¼€å§‹åˆ›å»ºæ—¶å€™çš„åˆå§‹åŒ–å‡½æ•°æ¥ä¼ é€’å‚æ•°ã€‚åœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„å¦ä¸€ç«¯ï¼Œä¹Ÿæœ‰ä¸€ä¸ª <code>__del__</code> æ–¹æ³•ã€‚æˆ‘ä»¬ç°åœ¨æ¥è¿‘è·ç¦»çš„çœ‹ä¸€çœ‹è¿™ä¸‰ä¸ªæ–¹æ³•:</p>
<p><code>__new__(cls, [...)</code><br><code>__new__</code> æ˜¯åœ¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹åŒ–çš„æ—¶å€™æ‰€è°ƒç”¨çš„ç¬¬ä¸€ä¸ªæ–¹æ³•ã€‚å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¿™ä¸ªç±»ï¼Œå…¶ä»–çš„å‚æ•°æ˜¯ç”¨æ¥ç›´æ¥ä¼ é€’ç»™ <code>__init__</code> æ–¹æ³•ã€‚ <code>__new__</code> æ–¹æ³•ç›¸å½“ä¸å¸¸ç”¨,ä½†æ˜¯å®ƒæœ‰è‡ªå·±çš„ç‰¹æ€§ï¼Œç‰¹åˆ«æ˜¯å½“ç»§æ‰¿ä¸€ä¸ªä¸å¯å˜çš„ç±»å‹æ¯”å¦‚ä¸€ä¸ªtupleæˆ–è€…stringã€‚æˆ‘ä¸å¸Œæœ›åœ¨ <code>__new__</code> ä¸Šæœ‰å¤ªå¤šç»†èŠ‚ï¼Œå› ä¸ºå¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨å¤„ï¼Œä½†æ˜¯åœ¨ <code>Pythonæ–‡æ¡£ &lt;http://www.python.org/download/releases/2.2/descrintro/#__new__&gt;</code>_ ä¸­æœ‰è¯¦ç»†çš„é˜è¿°ã€‚</p>
<p><code>__init__(self, [â€¦)</code><br>æ­¤æ–¹æ³•ä¸ºç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚å½“æ„é€ å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™çš„ä»»ä½•å‚æ•°éƒ½å°†ä¼šä¼ ç»™å®ƒã€‚(æ¯”å¦‚å¦‚æœæˆ‘ä»¬è°ƒç”¨ <code>x = SomeClass(10, &#39;foo&#39;)</code>)ï¼Œé‚£ä¹ˆ <code>__init__</code>  å°†ä¼šå¾—åˆ°ä¸¤ä¸ªå‚æ•°10å’Œfooã€‚ <code>__init__</code> åœ¨Pythonçš„ç±»å®šä¹‰ä¸­è¢«å¹¿æ³›ç”¨åˆ°ã€‚</p>
<p><code>__del__(self)</code><br>å¦‚æœ <code>__new__</code> å’Œ <code>__init__</code> æ˜¯å¯¹è±¡çš„æ„é€ å™¨çš„è¯ï¼Œé‚£ä¹ˆ <code>__del__</code> å°±æ˜¯ææ„å™¨ã€‚å®ƒä¸å®ç°è¯­å¥ <code>del x</code> (ä»¥ä¸Šä»£ç å°†ä¸ä¼šç¿»è¯‘ä¸º <code>x.__del__()</code> )ã€‚å®ƒå®šä¹‰çš„æ˜¯å½“ä¸€ä¸ªå¯¹è±¡è¿›è¡Œåƒåœ¾å›æ”¶æ—¶å€™çš„è¡Œä¸ºã€‚å½“ä¸€ä¸ªå¯¹è±¡åœ¨åˆ é™¤çš„æ—¶éœ€è¦æ›´å¤šçš„æ¸…æ´å·¥ä½œçš„æ—¶å€™æ­¤æ–¹æ³•ä¼šå¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚å¥—æ¥å­—å¯¹è±¡æˆ–è€…æ˜¯æ–‡ä»¶å¯¹è±¡ã€‚æ³¨æ„ï¼Œå¦‚æœè§£é‡Šå™¨é€€å‡ºçš„æ—¶å€™å¯¹è±¡è¿˜å­˜å­˜åœ¨ï¼Œå°±ä¸èƒ½ä¿è¯ <code>__del__</code> èƒ½å¤Ÿè¢«æ‰§è¡Œï¼Œæ‰€ä»¥ <code>__del__</code> canâ€™t serve as a replacement for good coding practices ()<del>~</del>~~</p>
<p>æ”¾åœ¨ä¸€èµ·çš„è¯ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ª <code>__init__</code> å’Œ <code>__del__</code> å®é™…ä½¿ç”¨çš„ä¾‹å­ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">from os.path import join</div><div class="line"></div><div class="line">class FileObject:</div><div class="line">    &apos;&apos;&apos;ç»™æ–‡ä»¶å¯¹è±¡è¿›è¡ŒåŒ…è£…ä»è€Œç¡®è®¤åœ¨åˆ é™¤æ—¶æ–‡ä»¶æµå…³é—­&apos;&apos;&apos;</div><div class="line"></div><div class="line">    def __init__(self, filepath=&apos;~&apos;, filename=&apos;sample.txt&apos;):</div><div class="line">        #è¯»å†™æ¨¡å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ </div><div class="line">        self.file = open(join(filepath, filename), &apos;r+&apos;)</div><div class="line"></div><div class="line">    def __del__(self):</div><div class="line">        self.file.close()</div><div class="line">        del self.file</div></pre></td></tr></table></figure></p>
<h1 id="è®©å®šåˆ¶çš„ç±»å·¥ä½œèµ·æ¥"><a href="#è®©å®šåˆ¶çš„ç±»å·¥ä½œèµ·æ¥" class="headerlink" title="è®©å®šåˆ¶çš„ç±»å·¥ä½œèµ·æ¥"></a>è®©å®šåˆ¶çš„ç±»å·¥ä½œèµ·æ¥</h1><p>ä½¿ç”¨Pythonçš„é­”æœ¯æ–¹æ³•çš„æœ€å¤§ä¼˜åŠ¿åœ¨äºä»–ä»¬æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥è®©å¯¹è±¡å¯ä»¥è¡¨ç°çš„åƒå†…ç½®ç±»å‹ä¸€æ ·ã€‚é‚£æ„å‘³ç€ä½ å¯ä»¥é¿å…ä¸‘é™‹çš„ï¼Œè¿åç›´è§‰çš„ï¼Œä¸æ ‡å‡†çš„çš„æ“ä½œæ–¹æ³•ã€‚åœ¨ä¸€äº›è¯­è¨€ä¸­ï¼Œæœ‰ä¸€äº›æ“ä½œå¾ˆå¸¸ç”¨æ¯”å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">if instance.equals(other_instance):</div><div class="line">    # do something</div></pre></td></tr></table></figure></p>
<p>åœ¨Pythonä¸­ä½ å¯ä»¥è¿™æ ·ã€‚ä½†æ˜¯è¿™ä¼šè®©äººè¿·æƒ‘ä¸”äº§ç”Ÿä¸å¿…è¦çš„å†—ä½™ã€‚ç›¸åŒçš„æ“ä½œå› ä¸ºä¸åŒçš„åº“ä¼šä½¿ç”¨ä¸åŒçš„åå­—ï¼Œè¿™æ ·ä¼šäº§ç”Ÿä¸å¿…è¦çš„å·¥ä½œã€‚ç„¶è€Œæœ‰äº†é­”æœ¯æ–¹æ³•çš„åŠ›é‡ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–¹æ³•(æœ¬ä¾‹ä¸­ä¸º <code>__eq__</code> )ï¼Œå°±è¯´æ˜äº†æˆ‘ä»¬çš„æ„æ€ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">if instance == other_instance:</div><div class="line">        #do something</div></pre></td></tr></table></figure></p>
<p>è¿™åªæ˜¯é­”æœ¯æ–¹æ³•çš„åŠŸèƒ½çš„ä¸€å°éƒ¨åˆ†ã€‚å®ƒè®©ä½ å¯ä»¥å®šä¹‰ç¬¦å·çš„å«ä¹‰æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„ç±»ä¸­ä½¿ç”¨ã€‚å°±åƒå†…ç½®ç±»å‹ä¸€æ ·ã€‚</p>
<h2 id="ç”¨äºæ¯”è¾ƒçš„é­”æœ¯æ–¹æ³•"><a href="#ç”¨äºæ¯”è¾ƒçš„é­”æœ¯æ–¹æ³•" class="headerlink" title="ç”¨äºæ¯”è¾ƒçš„é­”æœ¯æ–¹æ³•"></a>ç”¨äºæ¯”è¾ƒçš„é­”æœ¯æ–¹æ³•</h2><p>Pythonå¯¹å®ç°å¯¹è±¡çš„æ¯”è¾ƒï¼Œä½¿ç”¨é­”æœ¯æ–¹æ³•è¿›è¡Œäº†å¤§çš„é€†è½¬ï¼Œä½¿ä»–ä»¬éå¸¸ç›´è§‚è€Œä¸æ˜¯ç¬¨æ‹™çš„æ–¹æ³•è°ƒç”¨ã€‚è€Œä¸”è¿˜æä¾›äº†ä¸€ç§æ–¹æ³•å¯ä»¥é‡å†™Pythonå¯¹å¯¹è±¡æ¯”è¾ƒçš„é»˜è®¤è¡Œä¸º(é€šè¿‡å¼•ç”¨)ã€‚ä»¥ä¸‹æ˜¯è¿™äº›æ–¹æ³•å’Œä»–ä»¬çš„ä½œç”¨ã€‚</p>
<p><code>__cmp__(self, other)</code><br><code>__cmp__</code> æ˜¯æœ€åŸºæœ¬çš„ç”¨äºæ¯”è¾ƒçš„é­”æœ¯æ–¹æ³•ã€‚å®ƒå®é™…ä¸Šå®ç°äº†æ‰€æœ‰çš„æ¯”è¾ƒç¬¦å·(&lt;,==,!=,etc.)ï¼Œä½†æ˜¯å®ƒçš„è¡¨ç°å¹¶ä¸ä¼šæ€»æ˜¯å¦‚ä½ æ‰€æ„¿(æ¯”å¦‚ï¼Œå½“ä¸€ä¸ªå®ä¾‹ä¸å¦ä¸€ä¸ªå®ä¾‹ç›¸ç­‰æ˜¯é€šè¿‡ä¸€ä¸ªè§„åˆ™æ¥åˆ¤æ–­ï¼Œè€Œä¸€ä¸ªå®ä¾‹å¤§äºå¦å¤–ä¸€ä¸ªå®ä¾‹æ˜¯é€šè¿‡å¦å¤–ä¸€ä¸ªè§„åˆ™æ¥åˆ¤æ–­)ã€‚å¦‚æœ <code>self &lt; other</code> çš„è¯ <code>__cmp__</code> åº”è¯¥è¿”å›ä¸€ä¸ªè´Ÿæ•°ï¼Œå½“ <code>self == other</code> çš„æ—¶å€™ä¼šè¿”å›0 ï¼Œè€Œå½“ <code>self &gt; other</code> çš„æ—¶å€™ä¼šè¿”å›æ­£æ•°ã€‚é€šå¸¸æœ€å¥½çš„ä¸€ç§æ–¹å¼æ˜¯å»åˆ†åˆ«å®šä¹‰æ¯ä¸€ä¸ªæ¯”è¾ƒç¬¦å·è€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†ä»–ä»¬éƒ½å®šä¹‰ã€‚ä½†æ˜¯ <code>__cmp__</code> æ–¹æ³•æ˜¯ä½ æƒ³è¦å®ç°æ‰€æœ‰çš„æ¯”è¾ƒç¬¦å·è€Œä¸€ä¸ªä¿æŒæ¸…æ¥šæ˜ç™½çš„ä¸€ä¸ªå¥½çš„æ–¹æ³•ã€‚</p>
<p><code>__eq__(self, other)</code><br>å®šä¹‰äº†ç­‰å·çš„è¡Œä¸º, <code>==</code> ã€‚</p>
<p><code>__ne__(self, other)</code><br>å®šä¹‰äº†ä¸ç­‰å·çš„è¡Œä¸º, <code>!=</code> ã€‚</p>
<p><code>__lt__(self, other)</code><br>å®šä¹‰äº†å°äºå·çš„è¡Œä¸ºï¼Œ <code>&lt;</code> ã€‚</p>
<p><code>__gt__(self, other)</code><br>å®šä¹‰äº†å¤§äºç­‰äºå·çš„è¡Œä¸ºï¼Œ <code>&gt;=</code> ã€‚</p>
<p>ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œåˆ›å»ºä¸€ä¸ªç±»æ¥è¡¨ç°ä¸€ä¸ªè¯è¯­ã€‚æˆ‘ä»¬ä¹Ÿè®¸ä¼šæƒ³è¦æ¯”è¾ƒå•è¯çš„å­—å…¸åº(é€šè¿‡å­—æ¯è¡¨)ï¼Œé€šè¿‡é»˜è®¤çš„å­—ç¬¦ä¸²æ¯”è¾ƒçš„æ–¹æ³•å°±å¯ä»¥å®ç°ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿæƒ³è¦é€šè¿‡ä¸€äº›å…¶ä»–çš„æ ‡å‡†æ¥å®ç°ï¼Œæ¯”å¦‚å•è¯é•¿åº¦æˆ–è€…éŸ³èŠ‚æ•°é‡ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ¥æ¯”è¾ƒé•¿åº¦å®ç°ã€‚ä»¥ä¸‹æ˜¯å®ç°ä»£ç :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">class Word(str):</div><div class="line">&apos;&apos;&apos;å­˜å‚¨å•è¯çš„ç±»ï¼Œå®šä¹‰æ¯”è¾ƒå•è¯çš„å‡ ç§æ–¹æ³•&apos;&apos;&apos;</div><div class="line"></div><div class="line">    def __new__(cls, word):</div><div class="line">        # æ³¨æ„æˆ‘ä»¬å¿…é¡»è¦ç”¨åˆ°__new__æ–¹æ³•ï¼Œå› ä¸ºstræ˜¯ä¸å¯å˜ç±»å‹</div><div class="line">        # æ‰€ä»¥æˆ‘ä»¬å¿…é¡»åœ¨åˆ›å»ºçš„æ—¶å€™å°†å®ƒåˆå§‹åŒ–</div><div class="line">        if &apos; &apos; in word:</div><div class="line">            print &quot;Value contains spaces. Truncating to first space.&quot;</div><div class="line">            word = word[:word.index(&apos; &apos;)] #å•è¯æ˜¯ç¬¬ä¸€ä¸ªç©ºæ ¼ä¹‹å‰çš„æ‰€æœ‰å­—ç¬¦</div><div class="line">        return str.__new__(cls, word)</div><div class="line"></div><div class="line">    def __gt__(self, other):</div><div class="line">        return len(self) &gt; len(other)</div><div class="line">    def __lt__(self, other):</div><div class="line">        return len(self) &lt; len(other)</div><div class="line">    def __ge__(self, other):</div><div class="line">        return len(self) &gt;= len(other)</div><div class="line">    def __le__(self, other):</div><div class="line">        return len(self) &lt;= len(other)</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸¤ä¸ª <code>Words</code> å¯¹è±¡(é€šè¿‡ä½¿ç”¨ <code>Word(&#39;foo&#39;)</code> å’Œ <code>Word(&#39;bar&#39;)</code> ç„¶åé€šè¿‡é•¿åº¦æ¥æ¯”è¾ƒå®ƒä»¬ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰å®šä¹‰ <code>__eq__</code> å’Œ <code>__ne__</code> æ–¹æ³•ã€‚è¿™æ˜¯å› ä¸ºå°†ä¼šäº§ç”Ÿä¸€äº›æ€ªå¼‚çš„ç»“æœ(æ¯”å¦‚ <code>Word(&#39;foo&#39;) == Word(&#39;bar&#39;)</code> å°†ä¼šè¿”å›true)ã€‚è¿™å¯¹äºæµ‹è¯•åŸºäºé•¿åº¦çš„æ¯”è¾ƒä¸æ˜¯å¾ˆæœ‰æ„ä¹‰ã€‚æ‰€ä»¥æˆ‘ä»¬é€€å›å»ï¼Œç”¨ <code>str</code> å†…ç½®æ¥è¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>ç°åœ¨ä½ çŸ¥é“ä½ ä¸å¿…å®šä¹‰æ¯ä¸€ä¸ªæ¯”è¾ƒçš„é­”æœ¯æ–¹æ³•ä»è€Œè¿›è¡Œä¸°å¯Œçš„æ¯”è¾ƒã€‚æ ‡å‡†åº“ä¸­å¾ˆå‹å¥½çš„åœ¨ <code>functiontols</code> ä¸­æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªç±»çš„è£…é¥°å™¨å®šä¹‰äº†æ‰€æœ‰çš„ä¸°å¯Œçš„æ¯”è¾ƒå‡½æ•°ã€‚å¦‚æœä½ åªæ˜¯å®šä¹‰ <code>__eq__</code> å’Œå¦å¤–ä¸€ä¸ª(e.g. <code>__gt__</code>, <code>__lt__</code>,etc.)è¿™ä¸ªç‰¹æ€§ä»…ä»…åœ¨Python 2.7ä¸­å­˜åœ¨ï¼Œä½†æ˜¯ä½ å¦‚æœæœ‰æœºä¼šç¢°åˆ°çš„è¯ï¼Œé‚£ä¹ˆå°†ä¼šèŠ‚çœå¤§é‡çš„æ—¶é—´å’Œå·¥ä½œé‡ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨ä½ å®šä¹‰çš„ç±»å‰æ”¾ç½® <code>@total_ordering</code> æ¥ä½¿ç”¨ã€‚</p>
<h2 id="æ•°å€¼å¤„ç†çš„é­”æœ¯æ–¹æ³•"><a href="#æ•°å€¼å¤„ç†çš„é­”æœ¯æ–¹æ³•" class="headerlink" title="æ•°å€¼å¤„ç†çš„é­”æœ¯æ–¹æ³•"></a>æ•°å€¼å¤„ç†çš„é­”æœ¯æ–¹æ³•</h2><p>å¦‚åŒä½ åœ¨é€šè¿‡æ¯”è¾ƒç¬¦æ¥æ¯”è¾ƒç±»çš„å®ä¾‹çš„æ—¶å€™æ¥åˆ›å»ºå¾ˆå¤šæ–¹æ³•ï¼Œä½ ä¹Ÿå¯ä»¥å®šä¹‰ä¸€äº›æ•°å€¼ç¬¦å·çš„ç‰¹æ€§ã€‚ç³»ç´§ä½ çš„å®‰å…¨å¸¦ï¼Œæ¥å§ï¼Œè¿™é‡Œæœ‰å¾ˆå¤šå†…å®¹ã€‚ä¸ºäº†ç»„ç»‡æ–¹ä¾¿ï¼Œæˆ‘å°†ä¼šæŠŠæ•°å€¼å¤„ç†çš„æ–¹æ³•æ¥åˆ†æˆäº”ç±»:ä¸€å…ƒæ“ä½œç¬¦ï¼Œæ™®é€šç®—æ•°æ“ä½œç¬¦ï¼Œåå°„ç®—æ•°æ“ä½œç¬¦(ä¹‹åä¼šè¯¦ç»†è¯´æ˜),å¢é‡èµ‹å€¼ï¼Œå’Œç±»å‹è½¬æ¢ã€‚</p>
<h2 id="ä¸€å…ƒæ“ä½œç¬¦å’Œå‡½æ•°"><a href="#ä¸€å…ƒæ“ä½œç¬¦å’Œå‡½æ•°" class="headerlink" title="ä¸€å…ƒæ“ä½œç¬¦å’Œå‡½æ•°"></a>ä¸€å…ƒæ“ä½œç¬¦å’Œå‡½æ•°</h2><p>ä»…ä»…æœ‰ä¸€ä¸ªæ“ä½œä½çš„ä¸€å…ƒæ“ä½œç¬¦å’Œå‡½æ•°ã€‚æ¯”å¦‚ç»å¯¹å€¼ï¼Œè´Ÿç­‰ã€‚</p>
<p><code>__pos__(self)</code><br>å®ç°æ­£å·çš„ç‰¹æ€§(æ¯”å¦‚ <code>+some_object</code>)</p>
<p><code>__neg__(self)</code><br>å®ç°è´Ÿå·çš„ç‰¹æ€§(æ¯”å¦‚ <code>-some_object</code>)</p>
<p><code>__abs__(self)</code><br>å®ç°å†…ç½® <code>abs()</code> å‡½æ•°çš„ç‰¹æ€§ã€‚</p>
<p><code>__invert__(self)</code><br>å®ç° <code>~</code> ç¬¦å·çš„ç‰¹æ€§ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸ªç‰¹æ€§ã€‚ä½ å¯ä»¥æŸ¥çœ‹ <code>Wikipediaä¸­çš„è¿™ç¯‡æ–‡ç«  &lt;http://en.wikipedia.org/wiki/Bitwise_operation#NOT&gt;</code>_</p>
<h2 id="æ™®é€šç®—æ•°æ“ä½œç¬¦"><a href="#æ™®é€šç®—æ•°æ“ä½œç¬¦" class="headerlink" title="æ™®é€šç®—æ•°æ“ä½œç¬¦"></a>æ™®é€šç®—æ•°æ“ä½œç¬¦</h2><p>ç°åœ¨æˆ‘ä»¬ä»…ä»…è¦†ç›–äº†æ™®é€šçš„äºŒè¿›åˆ¶æ“ä½œç¬¦:+,-,*å’Œç±»ä¼¼ç¬¦å·ã€‚è¿™äº›ç¬¦å·å¤§éƒ¨åˆ†æ¥è¯´éƒ½æµ…æ˜¾æ˜“æ‡‚ã€‚</p>
<p><code>__add__(self, other)</code><br>å®ç°åŠ æ³•ã€‚<br><code>__sub__(self, other)</code><br>å®ç°å‡æ³•ã€‚<br><code>__mul__(self, other)</code><br>å®ç°ä¹˜æ³•ã€‚<br><code>__floordiv__(self, other)</code><br>å®ç° <code>//</code> ç¬¦å·å®ç°çš„æ•´æ•°é™¤æ³•ã€‚<br><code>__div__(self, other)</code><br>å®ç° <code>/</code> ç¬¦å·å®ç°çš„é™¤æ³•ã€‚<br><code>__truediv__(self, other)</code><br>å®ç°çœŸé™¤æ³•ã€‚æ³¨æ„åªæœ‰åªç”¨äº† <code>from __future__ import division</code> çš„æ—¶å€™æ‰ä¼šèµ·ä½œç”¨ã€‚<br><code>__mod__(self, other)</code><br>å®ç°å–æ¨¡ç®—æ³• <code>%</code><br><code>__divmod___(self, other)</code><br>å®ç°å†…ç½® <code>divmod()</code> ç®—æ³•<br><code>__pow__</code><br>å®ç°ä½¿ç”¨ <code>**</code> çš„æŒ‡æ•°è¿ç®—<br><code>__lshift__(self, other)</code><br>å®ç°ä½¿ç”¨ <code>&lt;&lt;</code> çš„æŒ‰ä½å·¦ç§»åŠ¨<br><code>__rshift__(self, other)</code><br>å®ç°ä½¿ç”¨ <code>&gt;&gt;</code> çš„æŒ‰ä½å·¦ç§»åŠ¨<br><code>__and__(self, other)</code><br>å®ç°ä½¿ç”¨ <code>&amp;</code> çš„æŒ‰ä½ä¸<br><code>__or__(self, other)</code><br>å®ç°ä½¿ç”¨ <code>|</code> çš„æŒ‰ä½æˆ–<br><code>__xor__(self, other)</code><br>å®ç°ä½¿ç”¨ <code>^</code> çš„æŒ‰ä½å¼‚æˆ–</p>
<h2 id="åè¿ç®—"><a href="#åè¿ç®—" class="headerlink" title="åè¿ç®—"></a>åè¿ç®—</h2><p>ä¸‹é¢æˆ‘å°†ä¼šè®²è§£ä¸€äº›åè¿ç®—çš„çŸ¥è¯†ã€‚æœ‰äº›æ¦‚å¿µä½ å¯èƒ½ä¼šè®¤ä¸ºææ…Œæˆ–è€…æ˜¯é™Œç”Ÿã€‚ä½†æ˜¯å®é™…ä¸Šéå¸¸ç®€å•ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">some_object + other</div></pre></td></tr></table></figure></p>
<p>è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„åŠ æ³•è¿ç®—ï¼Œåè¿ç®—æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯æŠŠæ“ä½œæ•°è°ƒæ¢äº†ä½ç½®:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">other + some_object</div></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥ï¼Œé™¤äº†å½“ä¸å…¶ä»–å¯¹è±¡æ“ä½œçš„æ—¶å€™è‡ªå·±ä¼šæˆä¸ºç¬¬äºŒä¸ªæ“ä½œæ•°ä¹‹å¤–ï¼Œæ‰€æœ‰çš„è¿™äº›é­”æœ¯æ–¹æ³•éƒ½ä¸æ™®é€šçš„æ“ä½œæ˜¯ç›¸åŒçš„ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåè¿ç®—çš„ç»“æœæ˜¯ä¸æ™®é€šè¿ç®—ç›¸åŒçš„ã€‚æ‰€ä»¥ä½ å¯ä»¥ä½ å¯ä»¥å°† <code>__radd__</code> ä¸ <code>__add__</code> ç­‰ä»·ã€‚</p>
<p><code>__radd__(self, other)</code><br>å®ç°ååŠ <br><code>__rsub__(self, other)</code><br>å®ç°åå‡<br><code>__rmul__(self, other)</code><br>å®ç°åä¹˜<br><code>__rfloordiv__(self, other)</code><br>å®ç° <code>//</code> ç¬¦å·çš„åé™¤<br><code>__rdiv__(self, other)</code><br>å®ç° <code>/</code> ç¬¦å·çš„åé™¤<br><code>__rtruediv__(self, other)</code><br>å®ç°åçœŸé™¤ï¼Œåªæœ‰å½“ <code>from __future__ import division</code> çš„æ—¶å€™ä¼šèµ·ä½œç”¨<br><code>__rmod__(self, other)</code><br>å®ç° <code>%</code> ç¬¦å·çš„åå–æ¨¡è¿ç®—<br><code>__rdivmod__(self, other)</code><br>å½“ <code>divmod(other, self)</code> è¢«è°ƒç”¨æ—¶ï¼Œå®ç°å†…ç½® <code>divmod()</code> çš„åè¿ç®—<br><code>__rpow__</code><br>å®ç° <code>**</code> ç¬¦å·çš„åè¿ç®—<br><code>__rlshift__(self, other)</code><br>å®ç° <code>&lt;&lt;</code> ç¬¦å·çš„åå·¦ä½ç§»<br><code>__rrshift__(self, other)</code><br>å®ç° <code>&gt;&gt;</code> ç¬¦å·çš„åå³ä½ç§»<br><code>__rand__(self, other)</code><br>å®ç° <code>&amp;</code> ç¬¦å·çš„åä¸è¿ç®—<br><code>__ror__(self, other)</code><br>å®ç° <code>|</code> ç¬¦å·çš„åæˆ–è¿ç®—<br><code>__xor__(self, other)</code><br>å®ç° <code>^</code> ç¬¦å·çš„åå¼‚æˆ–è¿ç®—</p>
<h2 id="å¢é‡èµ‹å€¼"><a href="#å¢é‡èµ‹å€¼" class="headerlink" title="å¢é‡èµ‹å€¼"></a>å¢é‡èµ‹å€¼</h2><p>Pythonä¹Ÿæœ‰å¤§é‡çš„é­”æœ¯æ–¹æ³•å¯ä»¥æ¥å®šåˆ¶å¢é‡èµ‹å€¼è¯­å¥ã€‚ä½ ä¹Ÿè®¸å¯¹å¢é‡èµ‹å€¼å·²ç»å¾ˆç†Ÿæ‚‰ï¼Œå®ƒå°†æ“ä½œç¬¦ä¸èµ‹å€¼æ¥ç»“åˆèµ·æ¥ã€‚å¦‚æœä½ ä»ç„¶ä¸æ¸…æ¥šæˆ‘åœ¨è¯´ä»€ä¹ˆçš„è¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">x = 5</div><div class="line">x += 1 # in other words x = x + 1</div></pre></td></tr></table></figure></p>
<p><code>__iadd__(self, other)</code><br>å®ç°èµ‹å€¼åŠ æ³•<br><code>__isub__(self, other)</code><br>å®ç°èµ‹å€¼å‡æ³•<br><code>__imul__(self, other)</code><br>å®ç°èµ‹å€¼ä¹˜æ³•<br><code>__ifloordiv__(self, other)</code><br>å®ç° <code>//=</code> çš„èµ‹å€¼åœ°æ¿é™¤<br><code>__idiv__(self, other)</code><br>å®ç°ç¬¦å· <code>/=</code> çš„èµ‹å€¼é™¤<br><code>__itruediv__(self, other)</code><br>å®ç°èµ‹å€¼çœŸé™¤,åªæœ‰ä½¿ç”¨ <code>from __future__ import division</code> çš„æ—¶å€™æ‰èƒ½ä½¿ç”¨<br><code>__imod_(self, other)</code><br>å®ç°ç¬¦å· <code>%=</code> çš„èµ‹å€¼å–æ¨¡<br><code>__ipow__</code><br>å®ç°ç¬¦å· <code>**=</code> çš„èµ‹å€¼å¹‚è¿ç®—<br><code>__ilshift__(self, other)</code><br>å®ç°ç¬¦å· <code>&lt;&lt;=</code> çš„èµ‹å€¼ä½å·¦ç§»<br><code>__irshift__(self, other)</code><br>å®ç°ç¬¦å· <code>&gt;&gt;=</code> çš„èµ‹å€¼ä½å³ç§»<br><code>__iand__(self, other)</code><br>å®ç°ç¬¦å· <code>&amp;=</code> çš„èµ‹å€¼ä½ä¸<br><code>__ior__(self, other)</code><br>å®ç°ç¬¦å· <code>|=</code> çš„èµ‹å€¼ä½æˆ–<br><code>__ixor__(self, other)</code><br>å®ç°ç¬¦å· <code>|=</code> çš„èµ‹å€¼ä½å¼‚æˆ–</p>
<h2 id="ç±»å‹è½¬æ¢é­”æœ¯æ–¹æ³•"><a href="#ç±»å‹è½¬æ¢é­”æœ¯æ–¹æ³•" class="headerlink" title="ç±»å‹è½¬æ¢é­”æœ¯æ–¹æ³•"></a>ç±»å‹è½¬æ¢é­”æœ¯æ–¹æ³•</h2><p>Pythonä¹Ÿæœ‰å¾ˆå¤šçš„é­”æœ¯æ–¹æ³•æ¥å®ç°ç±»ä¼¼ <code>float()</code> çš„å†…ç½®ç±»å‹è½¬æ¢ç‰¹æ€§ã€‚<br><code>__int__(self)</code><br>å®ç°æ•´å½¢çš„å¼ºåˆ¶è½¬æ¢<br><code>__long__(self)</code><br>å®ç°é•¿æ•´å½¢çš„å¼ºåˆ¶è½¬æ¢<br><code>__float__(self)</code><br>å®ç°æµ®ç‚¹å‹çš„å¼ºåˆ¶è½¬æ¢<br><code>__complex__(self)</code><br>å®ç°å¤æ•°çš„å¼ºåˆ¶è½¬æ¢<br><code>__oct__(self)</code><br>å®ç°å…«è¿›åˆ¶çš„å¼ºåˆ¶è½¬æ¢<br><code>__hex__(self)</code><br>å®ç°äºŒè¿›åˆ¶çš„å¼ºåˆ¶è½¬æ¢<br><code>__index__(self)</code><br>å½“å¯¹è±¡æ˜¯è¢«åº”ç”¨åœ¨åˆ‡ç‰‡è¡¨è¾¾å¼ä¸­æ—¶ï¼Œå®ç°æ•´å½¢å¼ºåˆ¶è½¬æ¢ï¼Œå¦‚æœä½ å®šä¹‰äº†ä¸€ä¸ªå¯èƒ½åœ¨åˆ‡ç‰‡æ—¶ç”¨åˆ°çš„å®šåˆ¶çš„æ•°å€¼å‹,ä½ åº”è¯¥å®šä¹‰ <code>__index__</code> (è¯¦è§PEP357)<br><code>__trunc__(self)</code><br>å½“ä½¿ç”¨ <code>math.trunc(self)</code> çš„æ—¶å€™è¢«è°ƒç”¨ã€‚ <code>__trunc__</code> åº”è¯¥è¿”å›æ•°å€¼è¢«æˆªå–æˆæ•´å½¢(é€šå¸¸ä¸ºé•¿æ•´å½¢)çš„å€¼<br><code>__coerce__(self, other)</code><br>å®ç°æ··åˆæ¨¡å¼ç®—æ•°ã€‚å¦‚æœç±»å‹è½¬æ¢ä¸å¯èƒ½çš„è¯ï¼Œé‚£ä¹ˆ <code>__coerce__</code> å°†ä¼šè¿”å› <code>None</code> ,å¦åˆ™ä»–å°†å¯¹ <code>self</code> å’Œ <code>other</code> è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º2çš„tupleï¼Œä¸¤ä¸ªä¸ºç›¸åŒçš„ç±»å‹ã€‚</p>
<h1 id="è¡¨ç°ä½ çš„ç±»"><a href="#è¡¨ç°ä½ çš„ç±»" class="headerlink" title="è¡¨ç°ä½ çš„ç±»"></a>è¡¨ç°ä½ çš„ç±»</h1><p>å¦‚æœæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²æ¥è¡¨ç¤ºä¸€ä¸ªç±»å°†ä¼šéå¸¸æœ‰ç”¨ã€‚åœ¨Pythonä¸­ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å®ç°ç±»å®šä¹‰å†…ç½®çš„ä¸€äº›å‡½æ•°çš„è¿”å›å€¼ã€‚<br><code>__str__(self)</code><br>å®šä¹‰å½“ <code>str()</code> è°ƒç”¨çš„æ—¶å€™çš„è¿”å›å€¼<br><code>__repr__(self)</code><br>å®šä¹‰ <code>repr()</code> è¢«è°ƒç”¨çš„æ—¶å€™çš„è¿”å›å€¼ã€‚ <code>str()</code> å’Œ <code>repr()</code> çš„ä¸»è¦åŒºåˆ«åœ¨äº <code>repr()</code> è¿”å›çš„æ˜¯æœºå™¨å¯è¯»çš„è¾“å‡ºï¼Œè€Œ <code>str()</code> è¿”å›çš„æ˜¯äººç±»å¯è¯»çš„ã€‚<br><code>__unicode__(self)</code><br>å®šä¹‰å½“ <code>unicode()</code> è°ƒç”¨çš„æ—¶å€™çš„è¿”å›å€¼ã€‚ <code>unicode()</code> å’Œ <code>str()</code> å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯unicodeå­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼Œå¦‚aæœå¯¹ä½ çš„ç±»è°ƒç”¨ <code>str()</code>  ç„¶è€Œä½ åªå®šä¹‰äº† <code>__unicode__()</code> ï¼Œé‚£ä¹ˆå°†ä¸ä¼šå·¥ä½œã€‚ä½ åº”è¯¥å®šä¹‰ <code>__str__()</code> æ¥ç¡®ä¿è°ƒç”¨æ—¶èƒ½è¿”å›æ­£ç¡®çš„å€¼ã€‚</p>
<p><code>__hash__(self)</code><br>å®šä¹‰å½“ <code>hash()</code> è°ƒç”¨çš„æ—¶å€™çš„è¿”å›å€¼ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•´å½¢ï¼Œç”¨æ¥åœ¨å­—å…¸ä¸­è¿›è¡Œå¿«é€Ÿæ¯”è¾ƒ<br><code>__nonzero__(self)</code><br>å®šä¹‰å½“ <code>bool()</code> è°ƒç”¨çš„æ—¶å€™çš„è¿”å›å€¼ã€‚æœ¬æ–¹æ³•åº”è¯¥è¿”å›Trueæˆ–è€…Falseï¼Œå–å†³äºä½ æƒ³è®©å®ƒè¿”å›çš„å€¼ã€‚</p>
<h1 id="æ§åˆ¶å±æ€§è®¿é—®"><a href="#æ§åˆ¶å±æ€§è®¿é—®" class="headerlink" title="æ§åˆ¶å±æ€§è®¿é—®"></a>æ§åˆ¶å±æ€§è®¿é—®</h1><p>è®¸å¤šä»å…¶ä»–è¯­è¨€è½¬åˆ°Pythonçš„äººä¼šæŠ±æ€¨å®ƒç¼ºä¹ç±»çš„çœŸæ­£å°è£…ã€‚(æ²¡æœ‰åŠæ³•å®šä¹‰ç§æœ‰å˜é‡ï¼Œç„¶åå®šä¹‰å…¬å…±çš„getterå’Œsetter)ã€‚Pythonå…¶å®å¯ä»¥é€šè¿‡é­”æœ¯æ–¹æ³•æ¥å®Œæˆå°è£…ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹:</p>
<p><code>__getattr__(self, name)</code><br>ä½ å¯ä»¥å®šä¹‰å½“ç”¨æˆ·è¯•å›¾è·å–ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶çš„è¡Œä¸ºã€‚è¿™é€‚ç”¨äºå¯¹æ™®é€šæ‹¼å†™é”™è¯¯çš„è·å–å’Œé‡å®šå‘ï¼Œå¯¹è·å–ä¸€äº›ä¸å»ºè®®çš„å±æ€§æ—¶å€™ç»™å‡ºè­¦å‘Š(å¦‚æœä½ æ„¿æ„ä½ ä¹Ÿå¯ä»¥è®¡ç®—å¹¶ä¸”ç»™å‡ºä¸€ä¸ªå€¼)æˆ–è€…å¤„ç†ä¸€ä¸ª <code>AttributeError</code> ã€‚åªæœ‰å½“è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™ä¼šè¢«è¿”å›ã€‚ç„¶è€Œï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå°è£…çš„è§£å†³æ–¹æ¡ˆã€‚<br><code>__setattr__(self, name, value)</code><br>ä¸ <code>__getattr__</code> ä¸åŒï¼Œ <code>__setattr__</code> æ˜¯ä¸€ä¸ªå°è£…çš„è§£å†³æ–¹æ¡ˆã€‚æ— è®ºå±æ€§æ˜¯å¦å­˜åœ¨ï¼Œå®ƒéƒ½å…è®¸ä½ å®šä¹‰å¯¹å¯¹å±æ€§çš„èµ‹å€¼è¡Œä¸ºï¼Œä»¥ä¸ºè¿™ä½ å¯ä»¥å¯¹å±æ€§çš„å€¼è¿›è¡Œä¸ªæ€§å®šåˆ¶ã€‚ä½†æ˜¯ä½ å¿…é¡»å¯¹ä½¿ç”¨ <code>__setattr__</code> ç‰¹åˆ«å°å¿ƒã€‚ä¹‹åæˆ‘ä»¬ä¼šè¯¦ç»†é˜è¿°ã€‚<br><code>__delattr__</code><br>ä¸ <code>__setattr__</code> ç›¸åŒï¼Œä½†æ˜¯åŠŸèƒ½æ˜¯åˆ é™¤ä¸€ä¸ªå±æ€§è€Œä¸æ˜¯è®¾ç½®ä»–ä»¬ã€‚æ³¨æ„ä¸ <code>__setattr__</code> ç›¸åŒï¼Œé˜²æ­¢æ— é™é€’å½’ç°è±¡å‘ç”Ÿã€‚(åœ¨å®ç° <code>__delattr__</code> çš„æ—¶å€™è°ƒç”¨ <code>del self.name</code> å³ä¼šå‘ç”Ÿ)<br><code>__getattribute__(self, name)</code><br><code>__getattribute__</code> ä¸å®ƒçš„åŒä¼´ <code>__setattr__</code> å’Œ <code>__delattr__</code> é…åˆéå¸¸å¥½ã€‚ä½†æ˜¯æˆ‘ä¸å»ºè®®ä½¿ç”¨å®ƒã€‚åªæœ‰åœ¨æ–°ç±»å‹ç±»å®šä¹‰ä¸­æ‰èƒ½ä½¿ç”¨ <code>__getattribute__</code> (åœ¨æœ€æ–°ç‰ˆæœ¬Pythonä¸­æ‰€æœ‰çš„ç±»éƒ½æ˜¯æ–°ç±»å‹ï¼Œåœ¨è€ç‰ˆæœ¬ä¸­ä½ å¯ä»¥é€šè¿‡ç»§æ‰¿ <code>object</code> æ¥åˆ¶ä½œä¸€ä¸ªæ–°ç±»ã€‚è¿™æ ·ä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªå±æ€§å€¼çš„è®¿é—®è§„åˆ™ã€‚æœ‰æ—¶ä¹Ÿä¼šäº§ç”Ÿä¸€äº›å¸å½’ç°è±¡ã€‚(è¿™æ—¶å€™ä½ å¯ä»¥è°ƒç”¨åŸºç±»çš„ <code>__getattribute__</code> æ–¹æ³•æ¥é˜²æ­¢æ­¤ç°è±¡çš„å‘ç”Ÿã€‚)å®ƒå¯ä»¥æ¶ˆé™¤å¯¹ <code>__getattr__</code> çš„ä½¿ç”¨ï¼Œå¦‚æœå®ƒè¢«æ˜ç¡®è°ƒç”¨æˆ–è€…ä¸€ä¸ª <code>AttributeError</code> è¢«æŠ›å‡ºï¼Œé‚£ä¹ˆå½“å®ç° <code>__getattribute__</code> ä¹‹åæ‰èƒ½è¢«è°ƒç”¨ã€‚æ­¤æ–¹æ³•æ˜¯å¦è¢«ä½¿ç”¨å…¶å®æœ€ç»ˆå–å†³äºä½ çš„é€‰æ‹©ã€‚)æˆ‘ä¸å»ºè®®ä½¿ç”¨å®ƒå› ä¸ºå®ƒçš„ä½¿ç”¨å‡ ç‡è¾ƒå°(æˆ‘ä»¬åœ¨å–å¾—ä¸€ä¸ªå€¼è€Œä¸æ˜¯è®¾ç½®ä¸€ä¸ªå€¼çš„æ—¶å€™æœ‰ç‰¹æ®Šçš„è¡Œä¸ºæ˜¯éå¸¸ç½•è§çš„ã€‚)è€Œä¸”å®ƒä¸èƒ½é¿å…ä¼šå‡ºç°bugã€‚</p>
<p>åœ¨è¿›è¡Œå±æ€§è®¿é—®æ§åˆ¶å®šä¹‰çš„æ—¶å€™ä½ å¯èƒ½ä¼šå¾ˆå®¹æ˜“çš„å¼•èµ·ä¸€ä¸ªé”™è¯¯ã€‚è€ƒè™‘ä¸‹é¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">def __setattr__(self, name, value):</div><div class="line">    self.name = value</div><div class="line">    #æ¯å½“å±æ€§è¢«èµ‹å€¼çš„æ—¶å€™ï¼Œ `__setattr__()` ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ ·å°±é€ æˆäº†é€’å½’è°ƒç”¨ã€‚</div><div class="line">    #è¿™æ„å‘³è¿™ä¼šè°ƒç”¨ `self.__setattr__(&apos;name&apos;, value)` ï¼Œæ¯æ¬¡æ–¹æ³•ä¼šè°ƒç”¨è‡ªå·±ã€‚è¿™æ ·ä¼šé€ æˆç¨‹åºå´©æºƒã€‚</div><div class="line"></div><div class="line">def __setattr__(self, name, value):</div><div class="line">    self.__dict__[name] = value  #ç»™ç±»ä¸­çš„å±æ€§ååˆ†é…å€¼</div><div class="line">    #å®šåˆ¶ç‰¹æœ‰å±æ€§</div></pre></td></tr></table></figure>
<p>Pythonçš„é­”æœ¯æ–¹æ³•éå¸¸å¼ºå¤§ï¼Œç„¶è€Œéšä¹‹è€Œæ¥çš„åˆ™æ˜¯è´£ä»»ã€‚äº†è§£æ­£ç¡®çš„æ–¹æ³•å»ä½¿ç”¨éå¸¸é‡è¦ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯¹äºå®šåˆ¶å±æ€§è®¿é—®æƒé™äº†è§£äº†å¤šå°‘å‘¢ã€‚å®ƒä¸åº”è¯¥è¢«è½»æ˜“çš„ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œå®ƒéå¸¸å¼ºå¤§ã€‚ä½†æ˜¯å®ƒå­˜åœ¨çš„åŸå› æ˜¯:Python ä¸ä¼šè¯•å›¾å°†ä¸€äº›ä¸å¥½çš„ä¸œè¥¿å˜å¾—ä¸å¯èƒ½ï¼Œè€Œæ˜¯è®©å®ƒä»¬éš¾ä»¥å®ç°ã€‚è‡ªç”±æ˜¯è‡³é«˜æ— ä¸Šçš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥åšä»»ä½•ä½ æƒ³åšçš„ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„å±æ€§æ§åˆ¶çš„ä¾‹å­(æˆ‘ä»¬ä½¿ç”¨ <code>super</code> å› ä¸ºä¸æ˜¯æ‰€æœ‰çš„ç±»éƒ½æœ‰ <code>__dict__</code> å±æ€§):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">class AccessCounter:</div><div class="line">    &apos;&apos;&apos;ä¸€ä¸ªåŒ…å«è®¡æ•°å™¨çš„æ§åˆ¶æƒé™çš„ç±»æ¯å½“å€¼è¢«æ”¹å˜æ—¶è®¡æ•°å™¨ä¼šåŠ ä¸€&apos;&apos;&apos;</div><div class="line"></div><div class="line">    def __init__(self, val):</div><div class="line">        super(AccessCounter, self).__setattr__(&apos;counter&apos;, 0)</div><div class="line">        super(AccessCounter, self).__setattr__(&apos;value&apos;, val)</div><div class="line"></div><div class="line">    def __setattr__(self, name, value):</div><div class="line">        if name == &apos;value&apos;:</div><div class="line">            super(AccessCounter, self).__setattr__(&apos;counter&apos;, self.counter + 1)</div><div class="line">    #å¦‚æœä½ ä¸æƒ³è®©å…¶ä»–å±æ€§è¢«è®¿é—®çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥æŠ›å‡º AttributeError(name) å¼‚å¸¸</div><div class="line">        super(AccessCounter, self).__setattr__(name, value)</div><div class="line"></div><div class="line">    def __delattr__(self, name):</div><div class="line">        if name == &apos;value&apos;:</div><div class="line">            super(AccessCounter, self).__setattr__(&apos;counter&apos;, self.counter + 1)</div><div class="line">        super(AccessCounter, self).__delattr__(name)]</div></pre></td></tr></table></figure></p>
<h1 id="åˆ›å»ºå®šåˆ¶çš„åºåˆ—"><a href="#åˆ›å»ºå®šåˆ¶çš„åºåˆ—" class="headerlink" title="åˆ›å»ºå®šåˆ¶çš„åºåˆ—"></a>åˆ›å»ºå®šåˆ¶çš„åºåˆ—</h1><p>æœ‰å¾ˆå¤šæ–¹æ³•è®©ä½ çš„Pythonç±»è¡Œä¸ºå¯ä»¥åƒå†…ç½®çš„åºåˆ—(dict, tuple,list, stringç­‰ç­‰)ã€‚è¿™æ˜¯ç›®å‰ä¸ºæ­¢æˆ‘æœ€å–œæ¬¢çš„é­”æœ¯æ–¹æ³•,å› ä¸ºå®ƒç»™ä½ å¾ˆæçš„æ§åˆ¶æƒé™è€Œä¸”è®©å¾ˆå¤šå‡½æ•°åœ¨ä½ çš„ç±»å®ä¾‹ä¸Šå·¥ä½œçš„å¾ˆå‡ºè‰²ã€‚ä½†æ˜¯åœ¨å¼€å§‹ä¹‹å‰ï¼Œéœ€è¦å…ˆè®²ä¸€äº›å¿…é¡»æ¡ä»¶ã€‚</p>
<h2 id="å¿…é¡»æ¡ä»¶"><a href="#å¿…é¡»æ¡ä»¶" class="headerlink" title="å¿…é¡»æ¡ä»¶"></a>å¿…é¡»æ¡ä»¶</h2><p>ç°åœ¨æˆ‘ä»¬å¼€å§‹è®²å¦‚ä½•åœ¨Pythonä¸­åˆ›å»ºå®šåˆ¶çš„åºåˆ—ï¼Œè¿™ä¸ªæ—¶å€™è¯¥è®²ä¸€è®²åè®®ã€‚åè®®(Protocols)ä¸å…¶ä»–è¯­è¨€ä¸­çš„æ¥å£å¾ˆç›¸ä¼¼ã€‚å®ƒç»™ä½ å¾ˆå¤šä½ å¿…é¡»å®šä¹‰çš„æ–¹æ³•ã€‚ç„¶è€Œåœ¨Pythonä¸­çš„åè®®æ˜¯å¾ˆä¸æ­£å¼çš„ï¼Œä¸éœ€è¦æ˜ç¡®å£°æ˜å®ç°ã€‚äº‹å®ä¸Šï¼Œä»–ä»¬æ›´åƒä¸€ç§æŒ‡å—ã€‚</p>
<p>æˆ‘ä»¬ä¸ºä»€ä¹ˆç°åœ¨è®¨è®ºåè®®ï¼Ÿå› ä¸ºå¦‚æœè¦å®šåˆ¶å®¹å™¨ç±»å‹çš„è¯éœ€è¦ç”¨åˆ°è¿™äº›åè®®ã€‚é¦–å…ˆï¼Œå®ç°ä¸å˜å®¹å™¨çš„è¯æœ‰ä¸€ä¸ªåè®®:å®ç°ä¸å¯å˜å®¹å™¨ï¼Œä½ åªèƒ½å®šä¹‰ <code>__len__</code> å’Œ <code>__getitem__</code> (ä¸€ä¼šä¼šè®²æ›´å¤š)ã€‚å¯å˜å®¹å™¨åè®®åˆ™éœ€è¦æ‰€æœ‰ä¸å¯å˜å®¹å™¨çš„æ‰€æœ‰å¦å¤–è¿˜éœ€è¦ <code>__setitem__</code> å’Œ <code>__delitem__</code> ã€‚æœ€ç»ˆï¼Œå¦‚æœä½ å¸Œæœ›ä½ çš„å¯¹è±¡æ˜¯å¯è¿­ä»£çš„è¯ï¼Œä½ éœ€è¦å®šä¹‰ <code>__iter__</code> ä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚è¿­ä»£å™¨å¿…é¡»éµå¾ªè¿­ä»£å™¨åè®®ï¼Œéœ€è¦æœ‰ <code>__iter__</code> (è¿”å›å®ƒæœ¬èº«) å’Œ <code>next</code> ã€‚</p>
<h2 id="å®¹å™¨çš„é­”æ³•"><a href="#å®¹å™¨çš„é­”æ³•" class="headerlink" title="å®¹å™¨çš„é­”æ³•"></a>å®¹å™¨çš„é­”æ³•</h2><p>è¿™äº›æ˜¯å®¹å™¨ä½¿ç”¨çš„é­”æœ¯æ–¹æ³•ã€‚<br><code>__len__(self)</code><br>ç„¶ä¼šå®¹å™¨é•¿åº¦ã€‚å¯¹äºå¯å˜ä¸å¯å˜å®¹å™¨éƒ½éœ€è¦æœ‰çš„åè®®çš„ä¸€éƒ¨åˆ†ã€‚<br><code>__getitem__(self, key)</code><br>å®šä¹‰å½“ä¸€ä¸ªæ¡ç›®è¢«è®¿é—®æ—¶ï¼Œä½¿ç”¨ç¬¦å· <code>self[key]</code> ã€‚è¿™ä¹Ÿæ˜¯ä¸å¯å˜å®¹å™¨å’Œå¯å˜å®¹å™¨éƒ½è¦æœ‰çš„åè®®çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœé”®çš„ç±»å‹é”™è¯¯å’Œ <code>KeyError</code> æˆ–è€…æ²¡æœ‰åˆé€‚çš„å€¼ã€‚é‚£ä¹ˆåº”è¯¥æŠ›å‡ºé€‚å½“çš„ <code>TypeError</code> å¼‚å¸¸ã€‚<br><code>__setitem__(self, key, value)</code><br>å®šä¹‰å½“ä¸€ä¸ªæ¡ç›®è¢«èµ‹å€¼æ—¶çš„è¡Œä¸º,ä½¿ç”¨ <code>self[key] = value</code> ã€‚è¿™ä¹Ÿæ˜¯å¯å˜å®¹å™¨å’Œä¸å¯å˜å®¹å™¨åè®®ä¸­éƒ½è¦æœ‰çš„ä¸€éƒ¨åˆ†ã€‚<br><code>__delitem__(self, key)</code><br>å®šä¹‰å½“ä¸€ä¸ªæ¡ç›®è¢«åˆ é™¤æ—¶çš„è¡Œä¸º(æ¯”å¦‚ <code>del self[key]</code>)ã€‚è¿™åªæ˜¯å¯å˜å®¹å™¨åè®®ä¸­çš„ä¸€éƒ¨åˆ†ã€‚å½“ä½¿ç”¨ä¸€ä¸ªæ— æ•ˆçš„é”®æ—¶åº”è¯¥æŠ›å‡ºé€‚å½“çš„å¼‚å¸¸ã€‚<br><code>__iter__(self)</code><br>è¿”å›ä¸€ä¸ªå®¹å™¨çš„è¿­ä»£å™¨ã€‚å¾ˆå¤šæƒ…å†µä¸‹ä¼šè¿”å›è¿­ä»£å™¨ï¼Œå°¤å…¶æ˜¯å½“å†…ç½®çš„ <code>iter()</code> æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œæˆ–è€…å½“ä½¿ç”¨ <code>for x in container</code> æ–¹å¼å¾ªç¯çš„æ—¶å€™ã€‚è¿­ä»£å™¨æ˜¯ä»–ä»¬æœ¬èº«çš„å¯¹è±¡ï¼Œä»–ä»¬å¿…é¡»å®šä¹‰è¿”å› <code>self</code> çš„ <code>__iter__</code> æ–¹æ³•ã€‚<br><code>__reversed__(self)</code><br>å®ç°å½“ <code>reversed()</code> è¢«è°ƒç”¨æ—¶çš„è¡Œä¸ºã€‚åº”è¯¥è¿”å›åˆ—è¡¨çš„åè½¬ç‰ˆæœ¬ã€‚<br><code>__contains__(self, item)</code><br>å½“è°ƒç”¨ <code>in</code> å’Œ <code>not in</code> æ¥æµ‹è¯•æˆå‘˜æ˜¯å¦å­˜åœ¨æ—¶å€™ <code>__contains__</code> è¢«å®šä¹‰ã€‚ä½ é—®ä¸ºä»€ä¹ˆè¿™ä¸ªä¸æ˜¯åºåˆ—åè®®çš„ä¸€éƒ¨åˆ†ï¼Ÿé‚£æ˜¯å› ä¸ºå½“ <code>__contains__</code> æ²¡æœ‰è¢«å®šä¹‰çš„æ—¶å€™ï¼ŒPythonä¼šè¿­ä»£è¿™ä¸ªåºåˆ—å¹¶ä¸”å½“æ‰¾åˆ°éœ€è¦çš„å€¼æ—¶ä¼šè¿”å› <code>True</code> ã€‚<br><code>__concat__(self, other)</code><br>æœ€ç»ˆï¼Œä½ å¯ä»¥é€šè¿‡ <code>__concat__</code> æ¥å®šä¹‰å½“ç”¨å…¶ä»–çš„æ¥è¿æ¥ä¸¤ä¸ªåºåˆ—æ—¶å€™çš„è¡Œä¸ºã€‚å½“ <code>+</code> æ“ä½œç¬¦è¢«è°ƒç”¨æ—¶å€™ä¼šè¿”å›ä¸€ä¸ª <code>self</code> å’Œ <code>other.__concat__</code> è¢«è°ƒç”¨åçš„ç»“æœäº§ç”Ÿçš„æ–°åºåˆ—ã€‚</p>
<h2 id="ä¸€ä¸ªä¾‹å­"><a href="#ä¸€ä¸ªä¾‹å­" class="headerlink" title="ä¸€ä¸ªä¾‹å­"></a>ä¸€ä¸ªä¾‹å­</h2><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€çœ‹ä½ å¯èƒ½åœ¨å…¶ä»–è¯­è¨€ä¸­ ç”¨åˆ°çš„å‡½æ•°æ„é€ è¯­å¥çš„å®ç°(æ¯”å¦‚ Haskell)ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">class FunctionalList:</div><div class="line">&apos;&apos;&apos;ä¸€ä¸ªå°è£…äº†ä¸€äº›é™„åŠ é­”æœ¯æ–¹æ³•æ¯”å¦‚ head, tail, init, last, drop, å’Œtakeçš„åˆ—è¡¨ç±»ã€‚</div><div class="line">&apos;&apos;&apos;</div><div class="line"></div><div class="line">def __init__(self, values=None):</div><div class="line">if values is None:</div><div class="line">    self.values = []</div><div class="line">else:</div><div class="line">    self.values = values</div><div class="line"></div><div class="line">def __len__(self):</div><div class="line">    return len(self.values)</div><div class="line"></div><div class="line">def __getitem__(self, key):</div><div class="line">    #å¦‚æœé”®çš„ç±»å‹æˆ–è€…å€¼æ— æ•ˆï¼Œåˆ—è¡¨å€¼å°†ä¼šæŠ›å‡ºé”™è¯¯</div><div class="line">    return self.values[key]</div><div class="line"></div><div class="line">def __setitem__(self, key, value):</div><div class="line">    self.values[key] = value</div><div class="line"></div><div class="line">def __delitem__(self, key):</div><div class="line">    del self.values[key]</div><div class="line"></div><div class="line">def __iter__(self):</div><div class="line">    return iter(self.values)</div><div class="line"></div><div class="line">def __reversed__(self):</div><div class="line">    return reversed(self.values)</div><div class="line"></div><div class="line">def append(self, value):</div><div class="line">    self.values.append(value)</div><div class="line">def head(self):</div><div class="line">    return self.values[0]</div><div class="line">def tail(self):</div><div class="line">    return self.values[1:]</div><div class="line">def init(self):</div><div class="line">    #è¿”å›ä¸€ç›´åˆ°æœ«å°¾çš„æ‰€æœ‰å…ƒç´ </div><div class="line">    return self.values[:-1]</div><div class="line">def last(self):</div><div class="line">    #è¿”å›æœ«å°¾å…ƒç´ </div><div class="line">    return self.values[-1]</div><div class="line">def drop(self, n):</div><div class="line">    #è¿”å›é™¤å‰nä¸ªå¤–çš„æ‰€æœ‰å…ƒç´ </div><div class="line">    return self.values[n:]</div><div class="line">def take(self, n):</div><div class="line">    #è¿”å›å‰nä¸ªå…ƒç´ </div><div class="line">    return self.values[:n]</div></pre></td></tr></table></figure></p>
<h1 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h1><p>ä½ å¯ä»¥é€šè¿‡é­”æœ¯æ–¹æ³•æ§åˆ¶æ§åˆ¶ä½¿ç”¨ <code>isinstance()</code> å’Œ <code>issubclass()</code> å†…ç½®æ–¹æ³•çš„åå°„è¡Œä¸ºã€‚è¿™äº›é­”æœ¯æ–¹æ³•æ˜¯:</p>
<p><code>__instancecheck__(self, instance)</code></p>
<p>æ£€æŸ¥ä¸€ä¸ªå®ä¾‹æ˜¯ä¸æ˜¯ä½ å®šä¹‰çš„ç±»çš„å®ä¾‹</p>
<p><code>__subclasscheck__(self, subclass)</code></p>
<p>æ£€æŸ¥ä¸€ä¸ªç±»æ˜¯ä¸æ˜¯ä½ å®šä¹‰çš„ç±»çš„å­ç±»</p>
<p>è¿™äº›æ–¹æ³•çš„ç”¨ä¾‹ä¼¼ä¹å¾ˆå°‘ï¼Œè¿™ä¹Ÿè®¸æ˜¯çœŸçš„ã€‚æˆ‘ä¸ä¼šèŠ±æ›´å¤šçš„æ—¶é—´åœ¨è¿™äº›é­”æœ¯æ–¹æ³•ä¸Šå› ä¸ºä»–ä»¬å¹¶ä¸æ˜¯å¾ˆé‡è¦ï¼Œä½†æ˜¯ä»–ä»¬çš„ç¡®ååº”äº†Python ä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€äº›åŸºæœ¬ç‰¹æ€§:éå¸¸å®¹æ˜“çš„å»åšä¸€äº›äº‹æƒ…ï¼Œå³ä½¿å¹¶ä¸æ˜¯å¾ˆå¿…é¡»ã€‚è¿™äº›é­”æœ¯æ–¹æ³•çœ‹èµ·æ¥å¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯å½“ä½ éœ€è¦çš„æ—¶å€™ä½ ä¼šå¾ˆé«˜å…´æœ‰è¿™ç§ç‰¹æ€§ã€‚</p>
<h1 id="å¯ä»¥è°ƒç”¨çš„å¯¹è±¡"><a href="#å¯ä»¥è°ƒç”¨çš„å¯¹è±¡" class="headerlink" title="å¯ä»¥è°ƒç”¨çš„å¯¹è±¡"></a>å¯ä»¥è°ƒç”¨çš„å¯¹è±¡</h1><p>ä½ ä¹Ÿè®¸å·²ç»çŸ¥é“ï¼Œåœ¨Pythonä¸­ï¼Œæ–¹æ³•ä¹Ÿæ˜¯ä¸€ç§é«˜ç­‰çš„å¯¹è±¡ã€‚è¿™æ„å‘³ç€ä»–ä»¬ä¹Ÿå¯ä»¥è¢«ä¼ é€’åˆ°æ–¹æ³•ä¸­å°±åƒå…¶ä»–å¯¹è±¡ä¸€æ ·ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æƒŠäººçš„ç‰¹æ€§ã€‚<br>åœ¨Pythonä¸­ï¼Œä¸€ä¸ªç‰¹æ®Šçš„é­”æœ¯æ–¹æ³•å¯ä»¥è®©ç±»çš„å®ä¾‹çš„è¡Œä¸ºè¡¨ç°çš„åƒå‡½æ•°ä¸€æ ·ï¼Œä½ å¯ä»¥è°ƒç”¨ä»–ä»¬ï¼Œå°†ä¸€ä¸ªå‡½æ•°å½“åšä¸€ä¸ªå‚æ•°ä¼ åˆ°å¦å¤–ä¸€ä¸ªå‡½æ•°ä¸­ç­‰ç­‰ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç‰¹æ€§è®©Pythonç¼–ç¨‹æ›´åŠ èˆ’é€‚ç”œç¾ã€‚<br><code>__call__(self, [args...])</code>  </p>
<p>å…è®¸ä¸€ä¸ªç±»çš„å®ä¾‹åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ã€‚å®è´¨ä¸Šè¯´ï¼Œè¿™æ„å‘³ç€ <code>x()</code> ä¸ <code>x.__call__()</code> æ˜¯ç›¸åŒçš„ã€‚æ³¨æ„ <code>__call__</code> å‚æ•°å¯å˜ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥å®šä¹‰ <code>__call__</code> ä¸ºå…¶ä»–ä½ æƒ³è¦çš„å‡½æ•°ï¼Œæ— è®ºæœ‰å¤šå°‘ä¸ªå‚æ•°ã€‚</p>
<p><code>__call__</code> åœ¨é‚£äº›ç±»çš„å®ä¾‹ç»å¸¸æ”¹å˜çŠ¶æ€çš„æ—¶å€™ä¼šéå¸¸æœ‰æ•ˆã€‚è°ƒç”¨è¿™ä¸ªå®ä¾‹æ˜¯ä¸€ç§æ”¹å˜è¿™ä¸ªå¯¹è±¡çŠ¶æ€çš„ç›´æ¥å’Œä¼˜é›…çš„åšæ³•ã€‚ç”¨ä¸€ä¸ªå®ä¾‹æ¥è¡¨è¾¾æœ€å¥½ä¸è¿‡äº†:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">class Entity:</div><div class="line">&apos;&apos;&apos;è°ƒç”¨å®ä½“æ¥æ”¹å˜å®ä½“çš„ä½ç½®ã€‚&apos;&apos;&apos;</div><div class="line"></div><div class="line">def __init__(self, size, x, y):</div><div class="line">    self.x, self.y = x, y</div><div class="line">    self.size = size</div><div class="line"></div><div class="line">def __call__(self, x, y):</div><div class="line">    &apos;&apos;&apos;æ”¹å˜å®ä½“çš„ä½ç½®&apos;&apos;&apos;</div><div class="line">    self.x, self.y = x, y</div></pre></td></tr></table></figure></p>
<h1 id="ä¼šè¯ç®¡ç†"><a href="#ä¼šè¯ç®¡ç†" class="headerlink" title="ä¼šè¯ç®¡ç†"></a>ä¼šè¯ç®¡ç†</h1><p>åœ¨Python 2.5ä¸­ï¼Œä¸ºäº†ä»£ç åˆ©ç”¨å®šä¹‰äº†ä¸€ä¸ªæ–°çš„å…³é”®è¯ <code>with</code> è¯­å¥ã€‚ä¼šè¯æ§åˆ¶åœ¨Pythonä¸­ä¸ç½•è§(ä¹‹å‰æ˜¯ä½œä¸ºåº“çš„ä¸€éƒ¨åˆ†è¢«å®ç°)ï¼Œç›´åˆ° <code>PEP343 &lt;http://www.python.org/dev/peps/pep-0343/&gt;</code>_ è¢«æ·»åŠ åã€‚å®ƒè¢«æˆä¸ºä¸€çº§è¯­è¨€ç»“æ„ã€‚ä½ ä¹Ÿè®¸ä¹‹å‰çœ‹åˆ°è¿™æ ·çš„è¯­å¥:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">with open(&apos;foo.txt&apos;) as bar:</div><div class="line">    perform some action with bar</div></pre></td></tr></table></figure>
<p>å›è¯æ§åˆ¶å™¨é€šè¿‡åŒ…è£…ä¸€ä¸ª <code>with</code> è¯­å¥æ¥è®¾ç½®å’Œæ¸…ç†è¡Œä¸ºã€‚å›è¯æ§åˆ¶å™¨çš„è¡Œä¸ºé€šè¿‡ä¸¤ä¸ªé­”æœ¯æ–¹æ³•æ¥å®šä¹‰:<br><code>__enter__(self)</code><br>å®šä¹‰å½“ä½¿ç”¨ <code>with</code> è¯­å¥çš„æ—¶å€™ä¼šè¯ç®¡ç†å™¨åº”è¯¥åˆå§‹å—è¢«åˆ›å»ºçš„æ—¶å€™çš„è¡Œä¸ºã€‚æ³¨æ„ <code>__enter__</code> çš„è¿”å›å€¼è¢« <code>with</code> è¯­å¥çš„ç›®æ ‡æˆ–è€… <code>as</code> åçš„åå­—ç»‘å®šã€‚<br><code>__exit__(self, exception_type, exception_value, traceback)</code><br>å®šä¹‰å½“ä¸€ä¸ªä»£ç å—è¢«æ‰§è¡Œæˆ–è€…ç»ˆæ­¢åä¼šè¯ç®¡ç†å™¨åº”è¯¥åšä»€ä¹ˆã€‚å®ƒå¯ä»¥è¢«ç”¨æ¥å¤„ç†å¼‚å¸¸ï¼Œæ¸…é™¤å·¥ä½œæˆ–è€…åšä¸€äº›ä»£ç å—æ‰§è¡Œå®Œæ¯•ä¹‹åçš„æ—¥å¸¸å·¥ä½œã€‚å¦‚æœä»£ç å—æ‰§è¡ŒæˆåŠŸï¼Œ <code>exception_type</code> , <code>exception_value</code> , å’Œ <code>traceback</code> å°†ä¼šæ˜¯ <code>None</code> ã€‚å¦åˆ™çš„è¯ä½ å¯ä»¥é€‰æ‹©å¤„ç†è¿™ä¸ªå¼‚å¸¸æˆ–è€…æ˜¯ç›´æ¥äº¤ç»™ç”¨æˆ·å¤„ç†ã€‚å¦‚æœä½ æƒ³å¤„ç†è¿™ä¸ªå¼‚å¸¸çš„è¯ï¼Œç¡®è®¤ <code>__exit__</code> åœ¨æ‰€æœ‰ç»“æŸä¹‹åä¼šè¿”å› <code>True</code> ã€‚å¦‚æœä½ æƒ³è®©å¼‚å¸¸è¢«ä¼šè¯ç®¡ç†å™¨å¤„ç†çš„è¯ï¼Œé‚£ä¹ˆå°±è¿™æ ·å¤„ç†ã€‚</p>
<p><code>__enter</code> å’Œ <code>__exit__</code> å¯¹äºæ˜ç¡®æœ‰å®šä¹‰å¥½çš„å’Œæ—¥å¸¸è¡Œä¸ºçš„è®¾ç½®å’Œæ¸…æ´å·¥ä½œçš„ç±»å¾ˆæœ‰å¸®åŠ©ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥åˆ›å»ºä¸€èˆ¬çš„å¯ä»¥åŒ…è£…å…¶ä»–å¯¹è±¡çš„ä¼šè¯ç®¡ç†å™¨ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">class Closer:</div><div class="line">&apos;&apos;&apos;é€šè¿‡withè¯­å¥å’Œä¸€ä¸ªcloseæ–¹æ³•æ¥å…³é—­ä¸€ä¸ªå¯¹è±¡çš„ä¼šè¯ç®¡ç†å™¨&apos;&apos;&apos;</div><div class="line"></div><div class="line">def __init__(self, obj):</div><div class="line">    self.obj = obj</div><div class="line"></div><div class="line">def __enter__(self):</div><div class="line">    return self.obj # bound to target</div><div class="line"></div><div class="line">def __exit__(self, exception_type, exception_val, trace):</div><div class="line">    try:</div><div class="line">        self.obj.close()</div><div class="line">    except AttributeError: # obj isn&apos;t closable</div><div class="line">        print &apos;Not closable.&apos;</div><div class="line">        return True # exception handled successfully</div></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>Closer</code> çš„ä¾‹å­ï¼Œä½¿ç”¨ä¸€ä¸ªFTPé“¾æ¥æ¥è¯æ˜(ä¸€ä¸ªå¯å…³é—­çš„å¥—æ¥å­—):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from magicmethods import Closer</div><div class="line">&gt;&gt;&gt; from ftplib import FTP</div><div class="line">&gt;&gt;&gt; with Closer(FTP(&apos;ftp.somesite.com&apos;)) as conn:</div><div class="line">...     conn.dir()</div><div class="line">...</div><div class="line">&gt;&gt;&gt; conn.dir()</div><div class="line">&gt;&gt;&gt; with Closer(int(5)) as i:</div><div class="line">...     i += 1</div><div class="line">...</div><div class="line">Not closable.</div><div class="line">&gt;&gt;&gt; i</div><div class="line">6</div></pre></td></tr></table></figure></p>
<p>ä½ å·²ç»çœ‹åˆ°äº†æˆ‘ä»¬çš„åŒ…è£…å™¨å¦‚ä½•é™é»˜çš„å¤„ç†é€‚å½“å’Œä¸é€‚å½“çš„ä½¿ç”¨è¡Œä¸ºã€‚è¿™æ˜¯ä¼šè¯ç®¡ç†å™¨å’Œé­”æœ¯æ–¹æ³•çš„å¼ºå¤§åŠŸèƒ½ã€‚</p>
<h1 id="åˆ›å»ºå¯¹è±¡çš„æè¿°å™¨"><a href="#åˆ›å»ºå¯¹è±¡çš„æè¿°å™¨" class="headerlink" title="åˆ›å»ºå¯¹è±¡çš„æè¿°å™¨"></a>åˆ›å»ºå¯¹è±¡çš„æè¿°å™¨</h1><p>æè¿°å™¨æ˜¯é€šè¿‡å¾—åˆ°ï¼Œè®¾ç½®ï¼Œåˆ é™¤çš„æ—¶å€™è¢«è®¿é—®çš„ç±»ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¿®æ”¹å…¶ä»–çš„å¯¹è±¡ã€‚æè¿°å™¨å¹¶ä¸æ˜¯é¼“åŠ±çš„ï¼Œä»–ä»¬æ³¨å®šè¢«ä¸€ä¸ªæ‰€æœ‰è€…ç±»æ‰€æŒæœ‰ã€‚å½“åˆ›å»ºé¢å‘å¯¹è±¡çš„æ•°æ®åº“æˆ–è€…ç±»ï¼Œé‡Œé¢å«æœ‰ç›¸äº’ä¾èµ–çš„å±æ€§æ—¶ï¼Œæè¿°å™¨å°†ä¼šéå¸¸æœ‰ç”¨ã€‚ä¸€ç§å…¸å‹çš„ä½¿ç”¨æ–¹æ³•æ˜¯ç”¨ä¸åŒçš„å•ä½è¡¨ç¤ºåŒä¸€ä¸ªæ•°å€¼ï¼Œæˆ–è€…è¡¨ç¤ºæŸä¸ªæ•°æ®çš„é™„åŠ å±æ€§(æ¯”å¦‚åæ ‡ç³»ä¸ŠæŸä¸ªç‚¹åŒ…å«äº†è¿™ä¸ªç‚¹åˆ°è¿œç‚¹çš„è·ç¦»ä¿¡æ¯)ã€‚</p>
<p>ä¸ºäº†æ„å»ºä¸€ä¸ªæè¿°å™¨ï¼Œä¸€ä¸ªç±»å¿…é¡»æœ‰è‡³å°‘ <code>__get__</code> æˆ–è€… <code>__set__</code> å…¶ä¸­ä¸€ä¸ªï¼Œå¹¶ä¸” <code>__delete__</code> è¢«å®ç°ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›é­”æœ¯æ–¹æ³•ã€‚<br><code>__get__(self, instance, owner)</code><br>å®šä¹‰å½“æè¿°å™¨çš„å€¼è¢«å–å¾—çš„æ—¶å€™çš„è¡Œä¸ºï¼Œ <code>instance</code> æ˜¯æ‹¥æœ‰è€…å¯¹è±¡çš„ä¸€ä¸ªå®ä¾‹ã€‚ <code>owner</code> æ˜¯æ‹¥æœ‰è€…ç±»æœ¬èº«ã€‚<br><code>__set__(self, instance, value)</code><br>å®šä¹‰å½“æè¿°å™¨å€¼è¢«æ”¹å˜æ—¶å€™çš„è¡Œä¸ºã€‚ <code>instance</code> æ˜¯æ‹¥æœ‰è€…ç±»çš„ä¸€ä¸ªå®ä¾‹ <code>value</code> æ˜¯è¦è®¾ç½®çš„å€¼ã€‚<br><code>__delete__(self, instance)</code><br>å®šä¹‰å½“æè¿°å™¨çš„å€¼è¢«åˆ é™¤çš„è¡Œä¸ºã€‚<code>instance</code> æ˜¯æ‹¥æœ‰è€…å¯¹è±¡çš„å®ä¾‹ã€‚<br>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæè¿°å™¨çš„å®ä¾‹:å•ä½è½¬æ¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">class Meter(object):</div><div class="line">&apos;&apos;&apos;Descriptor for a meter.&apos;&apos;&apos;</div><div class="line"></div><div class="line">    def __init__(self, value=0.0):</div><div class="line">    self.value = float(value)</div><div class="line">    def __get__(self, instance, owner):</div><div class="line">    return self.value</div><div class="line">    def __set__(self, instance, value):</div><div class="line">    self.value = float(value)</div><div class="line"></div><div class="line">class Foot(object):</div><div class="line">    &apos;&apos;&apos;Descriptor for a foot.&apos;&apos;&apos;</div><div class="line"></div><div class="line">    def __get__(self, instance, owner):</div><div class="line">    return instance.meter * 3.2808</div><div class="line">    def __set__(self, instance, value):</div><div class="line">    instance.meter = float(value) / 3.2808</div><div class="line"></div><div class="line">class Distance(object):</div><div class="line">    &apos;&apos;&apos;Class to represent distance holding two descriptors for feet and</div><div class="line">    meters.&apos;&apos;&apos;</div><div class="line">    meter = Meter()</div><div class="line">    foot = Foot()</div></pre></td></tr></table></figure>
<h1 id="å‚¨å­˜ä½ çš„å¯¹è±¡"><a href="#å‚¨å­˜ä½ çš„å¯¹è±¡" class="headerlink" title="å‚¨å­˜ä½ çš„å¯¹è±¡"></a>å‚¨å­˜ä½ çš„å¯¹è±¡</h1><p>å¦‚æœä½ æ¥è§¦è¿‡å…¶ä»–çš„ Pythonerï¼Œä½ å¯èƒ½å·²ç»å¬è¯´è¿‡ Pickle äº†ï¼Œ Pickle æ˜¯ç”¨æ¥åºåˆ—åŒ– Python æ•°æ®ç»“æ„çš„æ¨¡å—ï¼Œåœ¨ä½ éœ€è¦æš‚æ—¶å­˜å‚¨ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼ˆæ¯”å¦‚ç¼“å­˜ï¼‰ï¼Œè¿™ä¸ªæ¨¡å—éå¸¸çš„æœ‰ç”¨ï¼Œä¸è¿‡è¿™åŒæ—¶ä¹Ÿæ˜¯éšæ‚£çš„è¯ç”Ÿåœ°ã€‚</p>
<p>åºåˆ—åŒ–æ•°æ®æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä»–ä¸ä»…ä»…æ‹¥æœ‰ç›¸å…³çš„æ¨¡å—ï¼ˆ <code>Pickle</code> , <code>cPickle</code> ï¼‰ï¼Œè¿˜æœ‰è‡ªå·±çš„åè®®ä»¥åŠé­”æœ¯æ–¹æ³•ï¼Œä¸è¿‡é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè®¨è®ºä¸‹å…³äºåºåˆ—åŒ–å†…å»ºæ•°æ®ç»“æ„çš„æ–¹æ³•ã€‚</p>
<h2 id="Pickling-ç®€å•ä¾‹å­"><a href="#Pickling-ç®€å•ä¾‹å­" class="headerlink" title="Pickling: ç®€å•ä¾‹å­"></a>Pickling: ç®€å•ä¾‹å­</h2><p>è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ Pickleï¼Œæ¯”å¦‚è¯´ä½ ç°åœ¨éœ€è¦ä¸´æ—¶å‚¨å­˜ä¸€ä¸ªå­—å…¸ï¼Œä½ å¯ä»¥æŠŠå®ƒå†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œå¹¶ä¸”è¦å°å¿ƒç¿¼ç¿¼çš„ç¡®ä¿æ ¼å¼æ­£ç¡®ï¼Œä¹‹åå†ç”¨ exec() æˆ–è€…å¤„ç†æ–‡ä»¶è¾“å…¥æ¥æ¢å¤æ•°æ®ï¼Œå®é™…ä¸Šè¿™æ˜¯å¾ˆä¸å®‰å…¨çš„ï¼Œå¦‚æœä½ ä½¿ç”¨æ–‡æœ¬å­˜å‚¨äº†ä¸€äº›é‡è¦çš„æ•°æ®ï¼Œä»»ä½•æ–¹å¼çš„æ”¹å˜éƒ½å¯èƒ½ä¼šå½±å“åˆ°ä½ çš„ç¨‹åºï¼Œè½»åˆ™ç¨‹åºå´©æºƒï¼Œé‡åˆ™è¢«æ¶æ„ç¨‹åºåˆ©ç”¨ï¼Œæ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ç”¨ Pickle ä»£æ›¿è¿™ç§æ–¹å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">import pickle</div><div class="line"></div><div class="line">data = &#123;&apos;foo&apos;: [1, 2, 3],</div><div class="line">        &apos;bar&apos;: (&apos;Hello&apos;, &apos;world!&apos;),</div><div class="line">        &apos;baz&apos;: True&#125;</div><div class="line">jar = open(&apos;data.pkl&apos;, &apos;wb&apos;)</div><div class="line">pickle.dump(data, jar) # write the pickled data to the file jar</div><div class="line">jar.close()</div></pre></td></tr></table></figure>
<p>å—¯ï¼Œè¿‡äº†å‡ ä¸ªå°æ—¶ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°å®ƒäº†ï¼Œåªéœ€æŠŠå®ƒ unpickle äº†å°±è¡Œäº†ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">import pickle</div><div class="line"></div><div class="line">pkl_file = open(&apos;data.pkl&apos;, &apos;rb&apos;) # connect to the pickled data</div><div class="line">data = pickle.load(pkl_file) # load it into a variable</div><div class="line">print data</div><div class="line">pkl_file.close()</div></pre></td></tr></table></figure></p>
<p>æ­£å¦‚ä½ æœŸæœ›çš„ï¼Œæ•°æ®åŸå°ä¸åŠ¨çš„å›æ¥äº†ï¼</p>
<p>åŒæ—¶è¦ç»™ä½ ä¸€å¥å¿ å‘Šï¼š pickle å¹¶ä¸æ˜¯å¾ˆå®Œç¾ï¼Œ Pickle æ–‡ä»¶å¾ˆå®¹æ˜“è¢«ä¸å°å¿ƒæˆ–è€…æ•…æ„æŸåï¼Œ Pickle æ–‡ä»¶æ¯”çº¯æ–‡æœ¬æ–‡ä»¶è¦ç¨å¾®å®‰å…¨ä¸€ç‚¹ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥è¢«åˆ©ç”¨è¿è¡Œæ¶æ„ç¨‹åºã€‚ Pickle ä¸æ˜¯è·¨ç‰ˆæœ¬å…¼å®¹çš„ï¼ˆè¯‘æ³¨ï¼šæœ€è¿‘åˆšå¥½åœ¨ ã€ŠPython Cookbookã€‹ä¸Šçœ‹åˆ°ç›¸å…³è®¨è®ºï¼Œä¹¦ä¸­æè¿°çš„ Pickle æ˜¯è·¨ç‰ˆæœ¬å…¼å®¹çš„ï¼Œæ­¤ç‚¹å¾…éªŒè¯ï¼‰ï¼Œæ‰€ä»¥å°½é‡ä¸è¦å»åˆ†å‘ Pickle è¿‡çš„æ–‡æœ¬ï¼Œå› ä¸ºåˆ«äººå¹¶ä¸ä¸€å®šèƒ½å¤Ÿæ‰“å¼€ã€‚ä¸è¿‡åœ¨åšç¼“å­˜æˆ–è€…å…¶ä»–éœ€è¦åºåˆ—åŒ–æ•°æ®çš„æ—¶å€™ï¼Œ Pickle è¿˜æ˜¯å¾ˆæœ‰ç”¨å¤„çš„ã€‚</p>
<h2 id="åºåˆ—åŒ–ä½ è‡ªå·±çš„å¯¹è±¡"><a href="#åºåˆ—åŒ–ä½ è‡ªå·±çš„å¯¹è±¡" class="headerlink" title="åºåˆ—åŒ–ä½ è‡ªå·±çš„å¯¹è±¡"></a>åºåˆ—åŒ–ä½ è‡ªå·±çš„å¯¹è±¡</h2><p>Pickle å¹¶ä¸æ˜¯åªæ”¯æŒå†…å»ºæ•°æ®ç»“æœï¼Œä»»ä½•éµå¾ª Pickle åè®®çš„ç±»éƒ½å¯ä»¥ï¼ŒPickle åè®®ä¸º Python å¯¹è±¡è§„å®šäº†4ä¸ªå¯é€‰æ–¹æ³•æ¥è‡ªå®šä¹‰ Pickle è¡Œä¸ºï¼ˆå¯¹äº C æ‰©å±•çš„ cPickle æ¨¡å—ä¼šæœ‰ä¸€äº›ä¸åŒï¼Œä½†æ˜¯è¿™å¹¶ä¸åœ¨æˆ‘ä»¬çš„è®¨è®ºèŒƒå›´å†…ï¼‰ï¼š</p>
<p><code>__getinitargs__(self)</code></p>
<p>å¦‚æœä½ å¸Œæœ›åœ¨é€†åºåˆ—åŒ–çš„åŒæ—¶è°ƒç”¨ <code>__init__</code> ï¼Œä½ å¯ä»¥å®šä¹‰ <code>__getinitargs__</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åº”è¯¥è¿”å›ä¸€ç³»åˆ—ä½ æƒ³è¢« <code>__init__</code> è°ƒç”¨çš„å‚æ•°ï¼Œæ³¨æ„è¿™ä¸ªæ–¹æ³•åªå¯¹è€æ ·å¼çš„ç±»èµ·ä½œç”¨ã€‚</p>
<p><code>__getnewargs__(self)</code></p>
<p>å¯¹äºæ–°å¼çš„ç±»ï¼Œä½ å¯ä»¥å®šä¹‰ä»»ä½•åœ¨é‡å»ºå¯¹è±¡æ—¶å€™ä¼ é€’åˆ° <code>__new__</code> æ–¹æ³•ä¸­çš„å‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•ä¹Ÿåº”è¯¥è¿”å›ä¸€ç³»åˆ—çš„è¢« <code>__new__</code> è°ƒç”¨çš„å‚æ•°ã€‚</p>
<p><code>__getstate__(self)</code></p>
<p>ä½ å¯ä»¥è‡ªå®šä¹‰å½“å¯¹è±¡è¢«åºåˆ—åŒ–æ—¶è¿”å›çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ <code>__dict</code> æ–¹æ³•ï¼Œå½“é€†åºåˆ—åŒ–å¯¹è±¡çš„æ—¶å€™ï¼Œè¿”å›çš„çŠ¶æ€å°†ä¼šè¢« <code>__setstate__</code> æ–¹æ³•è°ƒç”¨ã€‚</p>
<p><code>__setstate__(self, state)</code></p>
<p>åœ¨å¯¹è±¡é€†åºåˆ—åŒ–çš„æ—¶å€™ï¼Œå¦‚æœ <code>__setstate__</code> å®šä¹‰è¿‡çš„è¯ï¼Œå¯¹è±¡çš„çŠ¶æ€å°†è¢«ä¼ ç»™å®ƒè€Œä¸æ˜¯ä¼ ç»™ <code>__dict__</code> ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯å’Œ <code>__getstate__</code> é…å¯¹çš„ï¼Œå½“è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½è¢«å®šä¹‰çš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥å®Œå…¨æ§åˆ¶æ•´ä¸ªåºåˆ—åŒ–ä¸é€†åºåˆ—åŒ–çš„è¿‡ç¨‹äº†ã€‚</p>
<h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><p>æˆ‘ä»¬ä»¥ Slate ä¸ºä¾‹ï¼Œè¿™æ˜¯ä¸€æ®µè®°å½•ä¸€ä¸ªå€¼ä»¥åŠè¿™ä¸ªå€¼æ˜¯ä½•æ—¶è¢«å†™å…¥çš„ç¨‹åºï¼Œä½†æ˜¯ï¼Œè¿™ä¸ª Slate æœ‰ä¸€ç‚¹ç‰¹æ®Šçš„åœ°æ–¹ï¼Œå½“å‰å€¼ä¸ä¼šè¢«ä¿å­˜ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">import time</div><div class="line"></div><div class="line">class Slate:</div><div class="line">    &apos;&apos;&apos;Class to store a string and a changelog, and forget its value when</div><div class="line">    pickled.&apos;&apos;&apos;</div><div class="line"></div><div class="line">    def __init__(self, value):</div><div class="line">        self.value = value</div><div class="line">        self.last_change = time.asctime()</div><div class="line">        self.history = &#123;&#125;</div><div class="line"></div><div class="line">    def change(self, new_value):</div><div class="line">        # Change the value. Commit last value to history</div><div class="line">        self.history[self.last_change] = self.value</div><div class="line">        self.value = new_value</div><div class="line">        self.last_change = time.asctime()</div><div class="line"></div><div class="line">    def print_changes(self):</div><div class="line">        print &apos;Changelog for Slate object:&apos;</div><div class="line">        for k, v in self.history.items():</div><div class="line">            print &apos;%s\t %s&apos; % (k, v)</div><div class="line"></div><div class="line">    def __getstate__(self):</div><div class="line">        # Deliberately do not return self.value or self.last_change.</div><div class="line">        # We want to have a &quot;blank slate&quot; when we unpickle.</div><div class="line">        return self.history</div><div class="line"></div><div class="line">    def __setstate__(self, state):</div><div class="line">        # Make self.history = state and last_change and value undefined</div><div class="line">        self.history = state</div><div class="line">        self.value, self.last_change = None, None</div></pre></td></tr></table></figure></p>
<h1 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h1><p>è¿™ä»½æŒ‡å—çš„å¸Œæœ›ä¸ºæ‰€æœ‰äººéƒ½èƒ½å¸¦æ¥ä¸€äº›çŸ¥è¯†ï¼Œå³ä½¿ä½ æ˜¯ Python å¤§ç‰›æˆ–è€…å¯¹äºç²¾é€šäºé¢å‘å¯¹è±¡å¼€å‘ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ª Python åˆå­¦è€…ï¼Œé˜…è¯»è¿™ç¯‡æ–‡ç« ä¹‹åä½ å·²ç»è·å¾—äº†ç¼–å†™ä¸°å¯Œï¼Œä¼˜é›…ï¼Œçµæ´»çš„ç±»çš„çŸ¥è¯†åŸºç¡€äº†ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªæœ‰ä¸€äº›ç»éªŒçš„ Python ç¨‹åºå‘˜ï¼Œä½ å¯èƒ½ä¼šå‘ç°ä¸€äº›èƒ½è®©ä½ å†™çš„ä»£ç æ›´ç®€æ´çš„æ–¹æ³•ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ª Python å¤§ç‰›ï¼Œå¯èƒ½ä¼šå¸®åŠ©ä½ æƒ³èµ·æ¥ä¸€äº›ä½ å·²ç»é—å¿˜çš„çŸ¥è¯†ï¼Œæˆ–è€…ä¸€äº›ä½ è¿˜æ²¡å¬è¯´è¿‡çš„æ–°åŠŸèƒ½ã€‚ä¸ç®¡ä½ ç°åœ¨æœ‰å¤šå°‘ç»éªŒï¼Œæˆ‘å¸Œæœ›è¿™æ¬¡å¯¹äº Python ç‰¹æ®Šæ–¹æ³•çš„æ—…ç¨‹èƒ½å¤Ÿå¸¦ç»™ä½ ä¸€äº›å¸®åŠ©ï¼ˆç”¨åŒå…³è¯­çœŸçš„å¾ˆä¸é”™ XDï¼‰ï¼ˆè¯‘æ³¨: è¿™é‡Œçš„åŒå…³åœ¨äºæ ‡é¢˜ä¸º Magic Methods è¿™é‡Œæ˜¯ ç¥å¥‡çš„æ—…ç¨‹ ï¼Œä¸è¿‡ç”±äºä¸­è‹±è¯­åºçš„é—®é¢˜ï¼Œç›´è¯‘ç•¥æ˜¾å¤´é‡è„šè½»ï¼Œæ‰€ä»¥ç¨å¾®å˜åŒ–äº†ä¸‹æ„æ€ï¼Œä¸¢æ‰äº†åŒå…³çš„å«ä¹‰ï¼‰ã€‚</p>
<h1 id="é™„å½•ï¼šå¦‚ä½•è°ƒç”¨é­”æœ¯æ–¹æ³•"><a href="#é™„å½•ï¼šå¦‚ä½•è°ƒç”¨é­”æœ¯æ–¹æ³•" class="headerlink" title="é™„å½•ï¼šå¦‚ä½•è°ƒç”¨é­”æœ¯æ–¹æ³•"></a>é™„å½•ï¼šå¦‚ä½•è°ƒç”¨é­”æœ¯æ–¹æ³•</h1><p>ä¸€äº›é­”æœ¯æ–¹æ³•ç›´æ¥å’Œå†…å»ºå‡½æ•°ç›¸å¯¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨ä»–ä»¬çš„æ–¹æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¦å¤–ä¸€ç§ä¸æ˜¯ç‰¹åˆ«æ˜æ˜¾çš„è°ƒç”¨æ–¹æ³•ï¼Œè¿™ä¸ªé™„å½•ä»‹ç»äº†å¾ˆå¤šå¹¶ä¸æ˜¯å¾ˆæ˜æ˜¾çš„é­”æœ¯æ–¹æ³•çš„è°ƒç”¨å½¢å¼ã€‚</p>
<table>
<thead>
<tr>
<th>é­”æœ¯æ–¹æ³•</th>
<th>è°ƒç”¨æ–¹å¼</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>new</strong>(cls [,â€¦])</td>
<td>instance = MyClass(arg1, arg2)</td>
<td><strong>new</strong> åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™è¢«è°ƒç”¨</td>
</tr>
<tr>
<td><strong>init</strong>(self [,â€¦])</td>
<td>instance = MyClass(arg1, arg2)</td>
<td><strong>init</strong> åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™è¢«è°ƒç”¨</td>
</tr>
<tr>
<td><strong>cmp</strong>(self, other)</td>
<td>self == other, self &gt; other, ç­‰ã€‚</td>
<td>åœ¨æ¯”è¾ƒçš„æ—¶å€™è°ƒç”¨</td>
</tr>
<tr>
<td><strong>pos</strong>(self)</td>
<td></td>
<td>self</td>
<td>ä¸€å…ƒåŠ è¿ç®—ç¬¦</td>
</tr>
<tr>
<td><strong>neg</strong>(self)</td>
<td>-self</td>
<td>ä¸€å…ƒå‡è¿ç®—ç¬¦</td>
</tr>
<tr>
<td><strong>invert</strong>(self)</td>
<td>~self</td>
<td>å–åè¿ç®—ç¬¦</td>
</tr>
<tr>
<td><strong>index</strong>(self)</td>
<td>x[self]</td>
<td>å¯¹è±¡è¢«ä½œä¸ºç´¢å¼•ä½¿ç”¨çš„æ—¶å€™</td>
</tr>
<tr>
<td><strong>nonzero</strong>(self)</td>
<td>bool(self)</td>
<td>å¯¹è±¡çš„å¸ƒå°”å€¼</td>
</tr>
<tr>
<td><strong>getattr</strong>(self, name)</td>
<td>self.name # name ä¸å­˜åœ¨</td>
<td>è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶</td>
</tr>
<tr>
<td><strong>setattr</strong>(self, name, val)</td>
<td>self.name = val</td>
<td>å¯¹ä¸€ä¸ªå±æ€§èµ‹å€¼æ—¶</td>
</tr>
<tr>
<td><strong>delattr</strong>(self, name)</td>
<td>del self.name</td>
<td>åˆ é™¤ä¸€ä¸ªå±æ€§æ—¶</td>
</tr>
<tr>
<td>__getattribute(self, name)</td>
<td>self.name</td>
<td>è®¿é—®ä»»ä½•å±æ€§æ—¶</td>
</tr>
<tr>
<td><strong>getitem</strong>(self, key)</td>
<td>self[key]</td>
<td>ä½¿ç”¨ç´¢å¼•è®¿é—®å…ƒç´ æ—¶</td>
</tr>
<tr>
<td><strong>setitem</strong>(self, key, val)</td>
<td>self[key] = val</td>
<td>å¯¹æŸä¸ªç´¢å¼•å€¼èµ‹å€¼æ—¶</td>
</tr>
<tr>
<td><strong>delitem</strong>(self, key)</td>
<td>del self[key]</td>
<td>åˆ é™¤æŸä¸ªç´¢å¼•å€¼æ—¶</td>
</tr>
<tr>
<td><strong>iter</strong>(self)</td>
<td>for x in self</td>
<td>è¿­ä»£æ—¶</td>
</tr>
<tr>
<td><strong>contains</strong>(self, value)</td>
<td>value in self, value not in self</td>
<td>ä½¿ç”¨ in æ“ä½œæµ‹è¯•å…³ç³»æ—¶</td>
</tr>
<tr>
<td><strong>concat</strong>(self, value)</td>
<td>self</td>
<td>other</td>
<td>è¿æ¥ä¸¤ä¸ªå¯¹è±¡æ—¶</td>
</tr>
<tr>
<td><strong>call</strong>(self [,â€¦])</td>
<td>self(args)</td>
<td>â€œè°ƒç”¨â€å¯¹è±¡æ—¶</td>
</tr>
<tr>
<td><strong>enter</strong>(self)</td>
<td>with self as x:</td>
<td>with è¯­å¥ç¯å¢ƒç®¡ç†</td>
</tr>
<tr>
<td><strong>exit</strong>(self, exc, val, trace)</td>
<td>with self as x:</td>
<td>with è¯­å¥ç¯å¢ƒç®¡ç†</td>
</tr>
<tr>
<td><strong>getstate</strong>(self)</td>
<td>pickle.dump(pkl_file, self)</td>
<td>åºåˆ—åŒ–</td>
</tr>
<tr>
<td><strong>setstate</strong>(self)</td>
<td>data = pickle.load(pkl_file)</td>
<td>åºåˆ—åŒ–</td>
</tr>
</tbody>
</table>
<p>å¸Œæœ›è¿™ä¸ªè¡¨æ ¼å¯¹ä½ å¯¹äºä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ–¹æ³•è¿™ä¸ªé—®é¢˜æœ‰æ‰€å¸®åŠ©ã€‚</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> é­”æœ¯æ–¹æ³• </tag>
            
            <tag> oop </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å¯¹è±¡å¼•ç”¨ã€å¯å˜æ€§[æµç•…çš„Python]]]></title>
      <url>/2017/08/20/fluent_python_chapter8/</url>
      <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹åœ¨è¯»ã€Šæµç¨‹çš„pythonã€‹æ—¶å¯¹è‡ªå·±æœ‰ç”¨çš„çŸ¥è¯†ç‚¹ã€‚<br><a id="more"></a></p>
<h1 id="1-å˜é‡ä¸æ˜¯ç›’å­"><a href="#1-å˜é‡ä¸æ˜¯ç›’å­" class="headerlink" title="1. å˜é‡ä¸æ˜¯ç›’å­"></a>1. å˜é‡ä¸æ˜¯ç›’å­</h1><p>è¿›è¡Œèµ‹å€¼æ“ä½œçš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯å°†ä¸€ä¸ªå¯¹è±¡æ”¾åœ¨å˜é‡æ„æˆçš„<code>ç›’å­</code>ä¸­ã€‚å®é™…ä¸Šï¼Œåœ¨è¿›è¡Œèµ‹å€¼æ“ä½œçš„æ—¶å€™ï¼Œç­‰å·å³è¾¹çš„å¯¹è±¡æ˜¯åœ¨å®ƒè¢«åˆ›å»ºä¹‹åæ‰æŠŠç­‰å·å·¦è¾¹çš„å˜é‡åˆ†é…ç»™å®ƒï¼Œç›¸å½“äºç»™è¿™ä¸ªå¯¹è±¡è´´ä¸Šäº†ä¸€ä¸ªæ ‡ç­¾ğŸ·ï¸ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">In [1]: class Gizmo:</div><div class="line">   ...:     def __init__(self):</div><div class="line">   ...:         print(id(self))</div><div class="line">   ...:</div><div class="line"></div><div class="line">In [2]: x = Gizmo()</div><div class="line">4418370088</div><div class="line"></div><div class="line">In [3]: y = Gizmo()[0]</div><div class="line">4418271496</div><div class="line">---------------------------------------------------------------------------</div><div class="line">AttributeError                            Traceback (most recent call last)</div><div class="line">&lt;ipython-input-3-81d29164ac5d&gt; in &lt;module&gt;()</div><div class="line">----&gt; 1 y = Gizmo()[0]</div><div class="line"></div><div class="line">AttributeError: Gizmo instance has no attribute &apos;__getitem__&apos;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å°†å˜é‡xåˆ†é…ç»™ç±»Gizmoçš„ä¸€ä¸ªå®ä¾‹ä¹‹å‰ï¼ŒGizmoçš„å®ä¾‹å·²ç»è¢«åˆ›å»ºã€‚</p>
<h1 id="2-æ ‡è¯†ã€ç›¸ç­‰æ€§å’Œåˆ«å"><a href="#2-æ ‡è¯†ã€ç›¸ç­‰æ€§å’Œåˆ«å" class="headerlink" title="2. æ ‡è¯†ã€ç›¸ç­‰æ€§å’Œåˆ«å"></a>2. æ ‡è¯†ã€ç›¸ç­‰æ€§å’Œåˆ«å</h1><p>æ­£å¦‚ä¸Šè¾¹æ‰€è¯´ï¼Œå˜é‡ç›¸å½“äºæ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ ‡ç­¾ï¼Œå½“ç„¶ï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥è¢«è´´ä¸Šè®¸å¤šæ ‡ç­¾ï¼Œå³å¤šä¸ªå˜é‡ç»‘å®šåŒä¸€ä¸ªå¯¹è±¡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">In [4]: list1 = [0,1,2,3,4,5]</div><div class="line"></div><div class="line">In [5]: list2 = list1</div><div class="line"></div><div class="line">In [6]: list2</div><div class="line">Out[6]: [0, 1, 2, 3, 4, 5]</div><div class="line"></div><div class="line">In [7]: list2.append(6)</div><div class="line"></div><div class="line">In [8]: list1</div><div class="line">Out[8]: [0, 1, 2, 3, 4, 5, 6]</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°list1å’Œlist2æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„ä¸åŒæ ‡ç­¾ã€‚<br>ä½†æ˜¯ï¼Œå¦‚ä½•æ‰èƒ½åˆ¤æ–­ä¸¤ä¸ªå˜é‡æ˜¯å¦ç»‘å®šçš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">In [9]: list3 = [0,1,2,3,4,5,6]</div><div class="line"></div><div class="line">In [10]: list3 == list1 == list2</div><div class="line">Out[10]: True</div></pre></td></tr></table></figure></p>
<p>æ¥ç€ä¸Šè¾¹çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªå«åšlist3çš„å˜é‡ï¼Œå®ƒå’Œlist1ã€list2æ˜¯ç›¸ç­‰çš„ï¼Œä½†æ˜¯å®ƒä»¬ä¸‰ä¸ªç»‘å®šçš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡å—ï¼Ÿpythonå®˜æ–¹æ–‡æ¡£ä¸­æœ‰è¿™æ ·çš„æè¿°ï¼š</p>
<blockquote>
<p>æ¯ä¸ªå˜é‡éƒ½æœ‰æ ‡è¯†ã€ç±»å‹å’Œå€¼ã€‚å¯¹è±¡ä¸€æ—¦åˆ›å»ºï¼Œå®ƒçš„æ ‡è¯†ç»å¯¹ä¸ä¼šå˜åŒ–ï¼›ä½ å¯ä»¥æŠŠæ ‡è¯†å½“ä½œè¯¥å¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚isè¿ç®—ç¬¦ç”¨ä»¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ ‡è¯†ï¼Œå†…å»ºå‡½æ•°<code>id()</code>è¿”å›å¯¹è±¡æ ‡è¯†çš„æ•´æ•°è¡¨ç¤ºã€‚</p>
</blockquote>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">In [12]: list1 is list2</div><div class="line">Out[12]: True</div><div class="line"></div><div class="line">In [13]: list3 is list1</div><div class="line">Out[13]: False</div><div class="line"></div><div class="line">In [14]: id(list1)</div><div class="line">Out[14]: 4418368144</div><div class="line"></div><div class="line">In [15]: id(list2)</div><div class="line">Out[15]: 4418368144</div><div class="line"></div><div class="line">In [16]: id(list3)</div><div class="line">Out[16]: 4418128064</div></pre></td></tr></table></figure>

å¯ä»¥çœ‹åˆ°`list1 is list2`å¹¶ä¸”`id(list1) == id(list2)`,è¿™è¯´æ˜list1å’Œlist2ç»‘å®šçš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œlist3åˆ™å’Œlist1æˆ–è€…list2ç»‘å®šçš„æ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œå³ä½¿æ˜¯`list3 == list1 == list2`
</code></pre><h1 id="3-è¿ç®—ç¬¦iså’Œ"><a href="#3-è¿ç®—ç¬¦iså’Œ" class="headerlink" title="3. è¿ç®—ç¬¦iså’Œ=="></a>3. è¿ç®—ç¬¦<code>is</code>å’Œ<code>==</code></h1><p>é€šè¿‡ä¸Šè¾¹çš„ä¾‹å­ï¼Œæœ‰ä¸ªç›´è§‚çš„å°è±¡å°±æ˜¯</p>
<blockquote>
<p><code>is</code>ç”¨äºæ¯”è¾ƒå¯¹è±¡çš„æ ‡è¯†ï¼Œ<code>==</code>ç”¨äºæ¯”è¾ƒå¯¹è±¡çš„å€¼</p>
</blockquote>
<pre><code>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šæ›´å¤šçš„ä½¿ç”¨`==`è¿›è¡Œå¯¹è±¡é—´çš„å€¼çš„æ¯”è¾ƒï¼Œä½†æ˜¯åœ¨&lt;strong&gt;å˜é‡å’Œå•ä¾‹å€¼ä¹‹é—´çš„æ¯”è¾ƒï¼Œæ›´åº”è¯¥ä½¿ç”¨`is`&lt;/strong&gt;ã€‚è¿™æ˜¯å› ä¸º: &lt;strong&gt;`is`è¿ç®—ç¬¦æ¯”`==`æ›´å¿«ï¼Œå› ä¸ºå®ƒä¸èƒ½é‡è½½ï¼Œè¿™æ ·pythonä¸ç”¨å¯»æ‰¾å¹¶è°ƒç”¨ç‰¹æ®Šæ–¹æ³•ï¼Œè€Œæ˜¯ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªæ•´æ•°IDã€‚`a == b`æ˜¯è¯­æ³•ç³–ï¼Œç­‰åŒäºæ‰§è¡Œ`a.__eq__(b)`ã€‚ç»§æ‰¿è‡ªobjectçš„`__eq__`æ–¹æ³•æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå¯¹è±¡çš„IDï¼Œç»“æœå’Œ`is`ä¸€æ ·ï¼Œä½†æ˜¯å¤šæ•°å†…ç½®ç±»å‹éƒ½å®šä¹‰äº†æ›´æœ‰æ„ä¹‰çš„æ–¹å¼ï¼Œè¦†ç›–äº†`__eq__`ï¼Œè¿™æ ·å°±å¯èƒ½ä¼šç»™ç›¸ç­‰æ€§æµ‹è¯•å¸¦æ¥æ›´å¤šå¤æ‚çš„å¤„ç†å·¥ä½œã€‚&lt;/strong&gt;
</code></pre><h1 id="4-å…ƒç»„çš„ç›¸å¯¹ä¸å¯å˜æ€§"><a href="#4-å…ƒç»„çš„ç›¸å¯¹ä¸å¯å˜æ€§" class="headerlink" title="4. å…ƒç»„çš„ç›¸å¯¹ä¸å¯å˜æ€§"></a>4. å…ƒç»„çš„ç›¸å¯¹ä¸å¯å˜æ€§</h1><p>å…ƒç»„ä¸å¤šæ•°pythonçš„é›†åˆç±»å‹ä¸€æ ·ï¼ˆè¿™é‡Œçš„ä¸€æ ·æŒ‡çš„æ˜¯ï¼šåˆ—è¡¨ã€å­—å…¸ã€é›†ç­‰è€Œä¸åŒ…æ‹¬åƒæ˜¯strï¼Œbyteså’Œarray.arrayè¿™æ ·çš„å•ä¸€ç±»å‹åºåˆ—ï¼Œå®ƒä»¬ä¿å­˜çš„ä¸æ˜¯å¼•ç”¨ï¼Œè€Œæ˜¯åœ¨è¿ç»­å†…å­˜ä¸­ä¿å­˜çš„æ•°æ®æœ¬èº«ï¼‰ï¼Œä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœå¼•ç”¨çš„å…ƒç´ æ˜¯å¯å˜çš„ï¼Œå³ä½¿å…ƒç»„æœ¬èº«ä¸å˜ï¼Œå®ƒå…¶ä¸­çš„å…ƒç´ ä¹Ÿæ˜¯å¯å˜çš„ã€‚<strong>å…ƒç»„çš„ä¸å¯å˜æ€§ï¼ŒæŒ‡çš„æ˜¯å®ƒå…¶ä¸­ä¿å­˜çš„å¼•ç”¨ä¸å˜ï¼ˆæ•°æ®ç»“æ„å’Œç‰©ç†å†…å®¹ï¼‰ï¼Œä¸å¼•ç”¨çš„å¯¹è±¡æ— å…³</strong></p>
<h1 id="5-copyå’Œdeepcopy"><a href="#5-copyå’Œdeepcopy" class="headerlink" title="5. copyå’Œdeepcopy"></a>5. copyå’Œdeepcopy</h1><p>ç”±ä¸Šè¾¹çš„ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œåƒåˆ—è¡¨ã€å­—å…¸ç­‰é›†åˆç±»å‹ï¼Œå®ƒä»¬å†…éƒ¨ä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥å°±ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">In [33]: l1 = [3,[4,5,6],(7,8,9)]</div><div class="line"></div><div class="line">In [34]: l2 = list(l1)</div><div class="line"></div><div class="line">In [35]: l2</div><div class="line">Out[35]: [3, [4, 5, 6], (7, 8, 9)]</div><div class="line"></div><div class="line">In [36]: l1.append(0)</div><div class="line"></div><div class="line">In [37]: l1[1].append(&apos;x&apos;)</div><div class="line"></div><div class="line">In [38]: print(l1)</div><div class="line">[3, [4, 5, 6, &apos;x&apos;], (7, 8, 9), 0]</div><div class="line"></div><div class="line">In [39]: print(l2)</div><div class="line">[3, [4, 5, 6, &apos;x&apos;], (7, 8, 9)]</div><div class="line"></div><div class="line">In [40]: l2[1] += [&apos;y&apos;,&apos;z&apos;]</div><div class="line"></div><div class="line">In [41]: l2[2] += (&apos;x&apos;,&apos;y&apos;,&apos;z&apos;)</div><div class="line"></div><div class="line">In [42]: l1</div><div class="line">Out[42]: [3, [4, 5, 6, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;], (7, 8, 9), 0]</div><div class="line"></div><div class="line">In [43]: l2</div><div class="line">Out[43]: [3, [4, 5, 6, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;], (7, 8, 9, &apos;x&apos;, &apos;y&apos;, &apos;z&apos;)]</div></pre></td></tr></table></figure></p>
<p>In [33]å’ŒIn [34]è¿›è¡Œäº†ç®€å•çš„åˆ—è¡¨å¤åˆ¶ï¼Œé€šè¿‡å†…ç½®çš„æ„é€ å‡½æ•°æ¥å®Œæˆèµ‹å€¼ã€‚è¿™ä¸ªæ—¶å€™<code>l1 == l2</code>å¹¶ä¸”<code>l1 is not l2</code>å®ƒä»¬ç»‘å®šäº†ä¸åŒçš„å¯¹è±¡ã€‚æ‰€ä»¥In [36]ä¸­l1.append(0)å¹¶ä¸ä¼šå¯¹l2é€ æˆå½±å“ã€‚<br>ä½†æ˜¯ç”±äºåˆ—è¡¨å†…éƒ¨ä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥<code>l1[1] == [4,5,6]</code>ï¼Œå¦‚æœå¯¹l1[1]è¿›è¡Œæ“ä½œï¼Œl2è‡ªç„¶ä¼šæ”¶åˆ°å½±å“ã€‚<br>In [40]å’ŒIn [41]åˆ†åˆ«å¯¹l2[1]å’Œl2[2]è¿›è¡Œæ“ä½œï¼Œåˆ—è¡¨åœ¨è¿›è¡Œ<code>+=</code>æ“ä½œä¹‹åï¼Œä¼šå°±åœ°ä¿®æ”¹åˆ—è¡¨ï¼Œä½†å¯¹äºå…ƒç»„æ¥è¯´<code>+=</code>æ“ä½œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç»„ç„¶åé‡æ–°ç»‘å®šç»™å˜é‡<strong>l2[2]</strong>ï¼Œè¿™æ ·<code>l1[2]</code>å’Œ<code>l2[2]</code>å°±ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚ï¼ˆä¸ªäººè§‰å¾—ï¼Œä¸Šè¾¹çš„è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å½“ä½œä¸€é“ä¼˜ç§€çš„é¢è¯•é¢˜ç›®ğŸ˜Šï¼‰</p>
<blockquote>
<p>å¯¹<code>+=</code>æˆ–è€…<code>*=</code>æ‰€åšçš„å¢é‡å¤åˆ¶æ“ä½œæ¥è¯´ï¼Œå¦‚æœæ“ä½œç¬¦å·¦ä¾§ç»‘å®šçš„æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¦‚æœæ˜¯å¯å˜å¯¹è±¡ï¼Œä¼šå°±åœ°ä¿®æ”¹</p>
</blockquote>
<pre><code>é»˜è®¤æƒ…å†µä¸‹ï¼Œpythonè¿›è¡Œçš„å¤åˆ¶éƒ½æ˜¯æµ…å¤åˆ¶ï¼ˆå‰¯æœ¬å…±äº«å†…éƒ¨å¯¹è±¡çš„å¼•ç”¨ï¼‰,é€šè¿‡copyæ¨¡å—æä¾›çš„deepcopyå’Œcopyå¯ä»¥ä¸ºä»»ä½•å¯¹è±¡åšæ·±å¤åˆ¶æˆ–è€…æµ…å¤åˆ¶ã€‚
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">In [55]: class Bus:</div><div class="line">    ...:     def __init__(self,passengers=None):</div><div class="line">    ...:         if passengers is None:</div><div class="line">    ...:             self.passengers = []</div><div class="line">    ...:         else:</div><div class="line">    ...:             self.passengers = passengers</div><div class="line">    ...:     def pick(self,name):</div><div class="line">    ...:         self.passengers.append(name)</div><div class="line">    ...:     def drop(self,name):</div><div class="line">    ...:         self.passengers.remove(name)</div><div class="line">    ...:</div><div class="line"></div><div class="line">In [56]: import copy</div><div class="line"></div><div class="line">In [57]: bus1 = Bus([&apos;wm&apos;,&apos;ws&apos;,&apos;ls&apos;,&apos;gjy&apos;])</div><div class="line"></div><div class="line">In [58]: bus2 = copy.copy(bus1)</div><div class="line"></div><div class="line">In [59]: bus3 = copy.deepcopy(bus1)</div><div class="line"></div><div class="line">In [60]: map(id,[bus1,bus2,bus3])</div><div class="line">Out[60]: [4418132448, 4416805992, 4416805920]</div><div class="line"></div><div class="line">In [61]: bus1.drop(&apos;wm&apos;)</div><div class="line"></div><div class="line">In [62]: bus2.passengers</div><div class="line">Out[62]: [&apos;ws&apos;, &apos;ls&apos;, &apos;gjy&apos;]</div><div class="line"></div><div class="line">In [63]: bus3.passengers</div><div class="line">Out[63]: [&apos;wm&apos;, &apos;ws&apos;, &apos;ls&apos;, &apos;gjy&apos;]</div><div class="line"></div><div class="line">In [64]: map(id,[bus1.passengers,bus2.passengers,bus3.passengers])</div><div class="line">Out[64]: [4419499288, 4419499288, 4418048440]</div></pre></td></tr></table></figure>

å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡deepcopyï¼Œbus3å’Œbus1ä¹‹é—´å¹¶æ²¡æœ‰å…±äº«å†…éƒ¨å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œé€šè¿‡copyç”Ÿæˆçš„bus2çš„`passengers`å’Œbus1æ˜¯ç›¸åŒçš„å¯¹è±¡ã€‚
</code></pre><h1 id="6-ä¸è¦ä½¿ç”¨å¯å˜ç±»å‹ä½œä¸ºå‚æ•°çš„é»˜è®¤å€¼"><a href="#6-ä¸è¦ä½¿ç”¨å¯å˜ç±»å‹ä½œä¸ºå‚æ•°çš„é»˜è®¤å€¼" class="headerlink" title="6. ä¸è¦ä½¿ç”¨å¯å˜ç±»å‹ä½œä¸ºå‚æ•°çš„é»˜è®¤å€¼"></a>6. ä¸è¦ä½¿ç”¨å¯å˜ç±»å‹ä½œä¸ºå‚æ•°çš„é»˜è®¤å€¼</h1><p>é€šè¿‡ä¸‹è¾¹çš„ä¾‹å­å¯ä»¥è¯æ˜ä¸Šè¾¹çš„è¿™æ¡å¿ å‘Šï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">In [67]: class HauntedBus:</div><div class="line">    ...:     def __init__(self,passengers=[]):</div><div class="line">    ...:         self.passengers = passengers</div><div class="line">    ...:     def pick(self,name):</div><div class="line">    ...:         self.passengers.append(name)</div><div class="line">    ...:     def drop(self,name):</div><div class="line">    ...:         self.passengers.remove(name)</div><div class="line">    ...:</div><div class="line"></div><div class="line">In [68]: bus1 = HauntedBus([&apos;wm&apos;,&apos;ws&apos;,&apos;ls&apos;])</div><div class="line"></div><div class="line">In [69]: bus1.passengers</div><div class="line">Out[69]: [&apos;wm&apos;, &apos;ws&apos;, &apos;ls&apos;]</div><div class="line"></div><div class="line">In [70]: bus1.pick(&apos;gjy&apos;)</div><div class="line"></div><div class="line">In [71]: bus1.drop(&apos;ws&apos;)</div><div class="line"></div><div class="line">In [72]: bus1.passengers</div><div class="line">Out[72]: [&apos;wm&apos;, &apos;ls&apos;, &apos;gjy&apos;]</div><div class="line"></div><div class="line">In [73]: bus2 = HauntedBus()</div><div class="line"></div><div class="line">In [74]: bus2.pick(&apos;wm&apos;)</div><div class="line"></div><div class="line">In [76]: bus2.passengers</div><div class="line">Out[76]: [&apos;wm&apos;]</div><div class="line"></div><div class="line">In [77]: bus3 = HauntedBus()</div><div class="line"></div><div class="line">In [78]: bus3.pick(&apos;ws&apos;)</div><div class="line"></div><div class="line">In [79]: bus3.passengers</div><div class="line">Out[79]: [&apos;wm&apos;, &apos;ws&apos;]</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ²¡æœ‰å®šä¹‰åˆå§‹ä¹˜å®¢çš„HauntedBuså®ä¾‹ä¼šå…±äº«åŒä¸€ä¸ªä¹˜å®¢åˆ—è¡¨ï¼Œè¿™æ˜¯å› ä¸º<code>self.passengers</code>å˜æˆäº†<code>passengers</code>å‚æ•°é»˜è®¤å€¼çš„åˆ«åï¼Œé»˜è®¤å€¼åœ¨å®šä¹‰å‡½æ•°æ—¶è®¡ç®—ï¼Œå› æ­¤é»˜è®¤å€¼å˜æˆäº†å‡½æ•°å¯¹è±¡çš„å±æ€§ï¼Œå› æ­¤ï¼Œå¦‚æœé»˜è®¤å€¼æ˜¯å¯å˜å¯¹è±¡ï¼Œå¹¶ä¸”ä¿®æ”¹äº†å®ƒçš„å€¼ï¼Œé‚£ä¹ˆåç»­çš„å‡½æ•°è°ƒç”¨éƒ½ä¼šæ”¶åˆ°å½±å“ã€‚</p>
<h1 id="7-é˜²å¾¡å¯å˜å‚æ•°"><a href="#7-é˜²å¾¡å¯å˜å‚æ•°" class="headerlink" title="7. é˜²å¾¡å¯å˜å‚æ•°"></a>7. é˜²å¾¡å¯å˜å‚æ•°</h1><p>å¦‚æœä¸€ä¸ªå‡½æ•°æ¥å—çš„æ˜¯å¯å˜å‚æ•°ï¼Œé‚£ä¹ˆåº”è¯¥è°¨æ…çš„è€ƒè™‘æ˜¯å¦æƒ³è¦ä¿®æ”¹ä¼ å…¥çš„å‚æ•°ï¼Œæ˜¯å¦æƒ³è¦å°†å¯¹è¿™ä¸ªå¯å˜å¯¹è±¡çš„ä¿®æ”¹ä½œç”¨åˆ°å‡½æ•°ä½“ä¹‹å¤–ï¼Ÿ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">In [81]: overwatch_team = [&apos;wm&apos;,&apos;ws&apos;,&apos;ls&apos;,&apos;gjy&apos;,&apos;ll&apos;]</div><div class="line"></div><div class="line">In [82]: class Twilightbus:</div><div class="line">    ...:     def __init__(self,passengers=None):</div><div class="line">    ...:         if passengers is None:</div><div class="line">    ...:             self.passengers = []</div><div class="line">    ...:         else:</div><div class="line">    ...:             self.passengers = passengers</div><div class="line">    ...:     def pick(self,name):</div><div class="line">    ...:         self.passengers.append(name)</div><div class="line">    ...:     def drop(self,name):</div><div class="line">    ...:         self.passengers.remove(name)</div><div class="line">    ...:</div><div class="line"></div><div class="line">In [83]: bus = Twilightbus(overwatch_team)</div><div class="line"></div><div class="line">In [84]: bus.drop(&apos;wm&apos;)</div><div class="line"></div><div class="line">In [85]: bus.drop(&apos;ws&apos;)</div><div class="line"></div><div class="line">In [86]: overwatch_team</div><div class="line">Out[86]: [&apos;ls&apos;, &apos;gjy&apos;, &apos;ll&apos;]</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°Twilightbuså¯ä»¥è®©ä¹˜å®¢è«åå…¶å¦™çš„é”€å£°åŒ¿è¿¹ğŸ˜¨ã€‚è¿™æ˜¯å› ä¸ºï¼Œåœ¨å°†å‚æ•°passengerä¼ ç»™Twilightbusçš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯å°†<code>self.passengers</code>å˜æˆäº†passengersçš„åˆ«åï¼Œæ‰€ä»¥æ¯å½“ä¹˜å®¢ä¸‹è½¦æ‰§è¡Œ<code>drop()</code>çš„æ—¶å€™ï¼Œç›´æ¥å°†ä¹˜å®¢ä»åˆ—è¡¨ä¸­æŠ¹å»ã€‚<br>å¦‚æœæƒ³è¦é¿å…è¿™ç§çŠ¶å†µï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–å‡½æ•°ä¸­åšä¸€äº›ä¿®æ”¹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">def __init__(self,passengers):</div><div class="line">    if passengers is None:</div><div class="line">        self.passengers = []</div><div class="line">    else:</div><div class="line">        self.passengers = list(passengers)</div></pre></td></tr></table></figure></p>
<p>ç»è¿‡ä¸Šè¾¹è¿™æ ·çš„å†…éƒ¨å¤„ç†ï¼Œå°±ä¸ä¼šå‘ç”Ÿä¸Šè¾¹çš„å¹½çµå·´å£«æ¡ˆä»¶ã€‚æ‰€ä»¥ï¼Œåœ¨ç±»ä¸­ç›´æ¥æŠŠå‚æ•°å¤åˆ¶ç»™å®ä¾‹å˜é‡ä»¥å‰ä¸€å®šè¦è€ƒè™‘æ¸…æ¥šã€‚</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> è¯»ä¹¦ </tag>
            
            <tag> å¯å˜ç±»å‹ </tag>
            
            <tag> æ·±æµ…æ‹·è´ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Iterables,Iteratorså’ŒGenerators]]></title>
      <url>/2017/08/10/Iterables,Iterators%E5%92%8CGenerators/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘ä¸€æ®µæ—¶é—´éƒ½åœ¨ç ”ç©¶pythoné‡Œè¾¹çš„ä¸€äº›æ¦‚å¿µ:<strong>iterator,iterableå’Œgenerator</strong>.çœ‹åˆ°<a href="http://nvie.com/posts/iterators-vs-generators/" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>å†™çš„ååˆ†ä¸é”™,åŸºæœ¬ä¸Šè®²æ¸…æ¥šäº†è¿™ä¸‰ä¸ªä¸œè¥¿éƒ½æ˜¯ä»€ä¹ˆä»¥åŠä»–ä»¬ä¹‹é—´çš„å…³ç³».è¿™å½“ç„¶å€¼å¾—è®°å½•ä¸€ä¸‹ğŸ˜Š.<br>æ‰€è°“ä¸€å›¾èƒœåƒè¨€,è¿™ç¯‡æ–‡ç« ä¸­çš„è¿™ä¸ªå…³ç³»å›¾è®©äººä¸€ç›®äº†ç„¶.<br><img src="https://o3sw4xojp.qnssl.com/relationships.png" alt="relationships.png"><br><a id="more"></a></p>
<h1 id="çº ç»“æ‰€åœ¨"><a href="#çº ç»“æ‰€åœ¨" class="headerlink" title="çº ç»“æ‰€åœ¨"></a>çº ç»“æ‰€åœ¨</h1><p>å¦‚æœå¯¹<strong>iterator,iterableå’Œgenerator</strong>çš„æ¦‚å¿µæ¯”è¾ƒçº ç»“,ä¸€èˆ¬ä¸»è¦æ˜¯æ²¡æœ‰åŒºåˆ†æ¸…æ¥š:</p>
<ul>
<li>container</li>
<li>iterable</li>
<li>iterator</li>
<li>generator</li>
<li>generator expression</li>
<li>[list,set,dict] comprehension</li>
</ul>
<p>ä¸‹é¢æŒ‰ç…§åŸæ–‡ä¸­è®²è§£çš„é‚£æ ·,å¯¹ä¸Šè¾¹å‡ ä¸ªæ¦‚å¿µé€ä¸€è§£é‡Š:</p>
<h1 id="container"><a href="#container" class="headerlink" title="container"></a>container</h1><p>åœ¨pythonä¸­containeræ˜¯ä¸€ç±»ç”¨äºå­˜æ”¾å„ç§å…ƒç´ (item)çš„å®¹å™¨,å¹¶ä¸”å®ƒèƒ½å¤Ÿåˆ¤æ–­ä¸€ä¸ªitemæ˜¯å¦åœ¨containerä¸­.<strong>ä¸€èˆ¬æ¥è¯´</strong>å®ƒä¼šå°†å®ƒå†…éƒ¨çš„å…ƒç´ éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­,å¹¶ä¸”èƒ½å¤Ÿé€ä¸€è¿”å›å®ƒå†…éƒ¨çš„æ¯ä¸ªå…ƒç´ .ä¸€äº›æ¯”è¾ƒå…¸å‹çš„ç±»å‹éƒ½æ˜¯container:</p>
<ul>
<li>list,dequeâ€¦</li>
<li>set,fronzensetsâ€¦</li>
<li>dict,defaultdict,OrderedDict,Counterâ€¦</li>
<li>tuple,namedtupleâ€¦</li>
<li>str</li>
</ul>
<p>containerç›¸å¯¹æ¥è¯´æ¯”è¾ƒå®¹æ˜“ç†è§£,å› ä¸ºå®ƒå°±åƒæ˜¯ç°å®ç”Ÿæ´»ä¸­çš„ä¸€äº›çœŸå®å®¹å™¨,ç”¨æ¥å­˜æ”¾å„ç§ä¸œè¥¿.å¹¶ä¸”containerå¯ä»¥å¾ˆå®¹æ˜“çš„åˆ¤æ–­ä¸€ä¸ªitemæ˜¯å¦æ˜¯å®ƒçš„ä¸€ä¸ªå…ƒç´ ,å‡ ä¸ªğŸŒ°:</p>
<ul>
<li><p>å¯¹äºlistã€setã€tuple</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; assert 1 in [1, 2, 3]      # lists</div><div class="line">&gt;&gt;&gt; assert 4 not in [1, 2, 3]</div><div class="line">&gt;&gt;&gt; assert 1 in &#123;1, 2, 3&#125;      # sets</div><div class="line">&gt;&gt;&gt; assert 4 not in &#123;1, 2, 3&#125;</div><div class="line">&gt;&gt;&gt; assert 1 in (1, 2, 3)      # tuples</div><div class="line">&gt;&gt;&gt; assert 4 not in (1, 2, 3)</div></pre></td></tr></table></figure>
</li>
<li><p>å¯¹äºdict,å¯ä»¥ç›´æ¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦æ˜¯å®ƒçš„key</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; d = &#123;1: &apos;foo&apos;, 2: &apos;bar&apos;, 3: &apos;qux&apos;&#125;</div><div class="line">&gt;&gt;&gt; assert 1 in d</div><div class="line">&gt;&gt;&gt; assert 4 not in d</div><div class="line">&gt;&gt;&gt; assert &apos;foo&apos; not in d  # &apos;foo&apos; is not a _key_ in the dict</div><div class="line">&gt;&gt;&gt; assert &apos;foo&apos; in d.values()</div></pre></td></tr></table></figure>
</li>
<li><p>å¯¹äºstring,å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦æˆ–è€…å­ä¸²æ˜¯å¦æ˜¯è¿™ä¸ªstringçš„ç»„æˆéƒ¨åˆ†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; s = &apos;foobar&apos;</div><div class="line">&gt;&gt;&gt; assert &apos;b&apos; in s</div><div class="line">&gt;&gt;&gt; assert &apos;x&apos; not in s</div><div class="line">&gt;&gt;&gt; assert &apos;foo&apos; in s  # a string &quot;contains&quot; all its substrings</div></pre></td></tr></table></figure>
</li>
</ul>
<p>ä¸Šè¾¹ä¸€ä¸‹ä¾‹å­è¯´æ˜å¯¹äºcontaineræ¥è¯´,åˆ¤æ–­ä¸€ä¸ªitemæ˜¯å¦æ˜¯å®ƒå…¶ä¸­çš„ä¸€ä¸ªå…ƒç´ ååˆ†ç›´æ¥ã€æ–¹ä¾¿.å°¤å…¶å¯¹äºstringæ¥è¯´,è™½ç„¶å®ƒå¹¶æ²¡æœ‰å°†å®ƒçš„æ‰€æœ‰å­ä¸²éƒ½æ”¾åœ¨å†…å­˜ä¸­,ä½†ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡<code>in</code>æ¥è¿›è¡Œå­ä¸²æ£€æµ‹.<br><strong>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯:</strong>ä¸Šè¾¹æˆ‘ä»¬å…³æ³¨çš„ä¸»è¦æ˜¯containerçš„<code>æˆå‘˜æ£€æµ‹</code>,å¹¶ä¸”ä¸€èˆ¬æ¥è¯´,containerä¹Ÿéƒ½å¯ä»¥é€ä¸€è¿”å›å®ƒå†…éƒ¨çš„æ¯ä¸ªå…ƒç´ ,æ¯”å¦‚:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [16]: a = [1,2,3,[4,5]]</div><div class="line"></div><div class="line">In [17]: for item in a:</div><div class="line">    ...:     print item</div><div class="line">    ...:</div><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">[4,5]</div></pre></td></tr></table></figure></p>
<p>ä½†èƒ½é€ä¸€è¿”å›containerä¸­æ¯ä¸ªå…ƒç´ å¹¶ä¸æ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªcontainer(æœ‰ç‚¹ç»•ğŸ˜„),è¿™æ˜¯å› ä¸ºå®ƒæ˜¯å¯è¿­ä»£çš„(iterable).ä¹Ÿå°±æ˜¯è¯´å¹¶ä¸æ˜¯æ‰€æœ‰çš„containeréƒ½æ˜¯iterableçš„.æ­£å¦‚ä¸Šè¾¹å›¾ä¸­æ‰€ç¤ºçš„é‚£æ ·<code>a container typically is an iterable</code>.</p>
<h1 id="iterable"><a href="#iterable" class="headerlink" title="iterable"></a>iterable</h1><p>å¦‚ä¸Šæ‰€è¿°,å¤§å¤šæ•°çš„containeréƒ½æ˜¯iterableçš„,ä½†æ˜¯é™¤äº†å„ç§ç±»å‹çš„containerä»¥å¤–,åƒfileæˆ–è€…socketè¿™æ ·ç±»å‹çš„å¯¹è±¡ä¹Ÿéƒ½æ˜¯iterable.ä¸containerä¹‹é—´ä¸åŒçš„æ˜¯,containerå¤§éƒ½æ˜¯åŒ…å«ç€æœ‰é™ä¸ªå…ƒç´ çš„,æˆ–è€…è¯´ä»–ä»¬æœ‰ç€æ˜ç¡®çš„é•¿åº¦,ä½†æ˜¯åƒfileæˆ–è€…socketè¿™æ ·çš„å¯¹è±¡ä»–ä»¬å†…éƒ¨å¯èƒ½ä¼šæœ‰ä¸é‚£ä¹ˆç¡®å®šæ•°é‡çš„æ•°æ®.</p>
<blockquote>
<p>æ‰€ä»¥,ä¸€ä¸ªiterableçš„å¯¹è±¡å¿…é¡»æ˜¯ä¸€ä¸ªèƒ½å¤Ÿé€ä¸€è¿”å›è‡ªèº«åŒ…å«å…ƒç´ çš„å¯¹è±¡,è€Œè¿™ä¸ªå¯¹è±¡è¢«æˆä¸ºiterator.</p>
</blockquote>
<p>iterableå’Œiteratorä¹‹é—´çš„åŒºåˆ«å¯ä»¥é€šè¿‡ä¸‹è¾¹çš„ğŸŒ°çœ‹å‡º:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; x = [1, 2, 3]</div><div class="line">&gt;&gt;&gt; y = iter(x)</div><div class="line">&gt;&gt;&gt; z = iter(x)</div><div class="line">&gt;&gt;&gt; next(y)</div><div class="line">1</div><div class="line">&gt;&gt;&gt; next(y)</div><div class="line">2</div><div class="line">&gt;&gt;&gt; next(z)</div><div class="line">1</div><div class="line">&gt;&gt;&gt; type(x)</div><div class="line">&lt;class &apos;list&apos;&gt;</div><div class="line">&gt;&gt;&gt; type(y)</div><div class="line">&lt;class &apos;list_iterator&apos;&gt;</div></pre></td></tr></table></figure></p>
<p>ä¸Šè¾¹çš„ä¾‹å­ä¸­,xæ˜¯ä¸€ä¸ªiterable(å¯è¿­ä»£å¯¹è±¡),yå’Œzæ˜¯ä¸¤ä¸ªä¸åŒçš„iterator(è¿­ä»£å™¨).yå’Œzèƒ½å¤Ÿåˆ†åˆ«é€ä¸€è¿”å›xä¸­çš„æ¯ä¸ªå…ƒç´ ,å¹¶ä¸”è¿™ä¸¤ä¸ªiteratorä¹‹é—´ä¸ä¼šäº’ç›¸å½±å“è‡ªå·±çš„çŠ¶æ€.</p>
<blockquote>
<p>é€šå¸¸æƒ…å†µä¸‹,ä¸€ä¸ªiterable classä¼šåœ¨å†…éƒ¨å®ç°<code>__iter__()</code>å’Œ<code>__next()</code>æ–¹æ³•,è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥æˆä¸ºå®ç°äº†è¿­ä»£å™¨åè®®,å…¶ä¸­<code>__iter__()</code>æ–¹æ³•è¿”å›è¿­ä»£å™¨å¯¹è±¡iterator,<code>__next()__</code>å®ç°é€ä¸€è¿”å›å…ƒç´ çš„è¿‡ç¨‹.</p>
</blockquote>
<p>æ‰€ä»¥,åœ¨ä½¿ç”¨<code>for item in iterator</code>è¿™æ ·çš„è¯­å¥è¿›è¡Œéå†çš„æ—¶å€™,å…¶å®æ‰§è¡Œè¿‡ç¨‹ç±»ä¼¼äºä¸‹å›¾:<br><img src="https://o3sw4xojp.qnssl.com/iterable-vs-iterator.png" alt="iterable-vs-iterator.png"></p>
<h1 id="iterator"><a href="#iterator" class="headerlink" title="iterator"></a>iterator</h1><p>æ‰€ä»¥è¯´,åˆ°åº•iteratoræ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼ŸğŸ</p>
<blockquote>
<p>ä¸€ä¸ªiteratorå¯¹è±¡å¯ä»¥å½“ä½œæ˜¯ä¸€ä¸ªå·¥å‚,æ¯æ¬¡ä½¿ç”¨next()æ–¹æ³•,éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ¥è‡ªiteratorå†…éƒ¨çš„å€¼,å¹¶ä¸”å®ƒèƒ½å¤Ÿç»´æŠ¤äºæ­¤ç›¸å…³çš„å†…éƒ¨çŠ¶æ€.</p>
</blockquote>
<p>iteratorå†…éƒ¨çš„å…ƒç´ æœ‰æ—¶å€™æ˜¯æœ‰é™çš„,ä½†æœ‰æ—¶å€™ä¹Ÿå¯èƒ½åŒ…å«æ— é™ä¸ªæ•°çš„å…ƒç´ :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from itertools import count</div><div class="line">&gt;&gt;&gt; counter = count(start=13)</div><div class="line">&gt;&gt;&gt; next(counter)</div><div class="line">13</div><div class="line">&gt;&gt;&gt; next(counter)</div><div class="line">14</div></pre></td></tr></table></figure></p>
<p>åˆ©ç”¨itertoolsä¸­çš„ä¸€äº›æ–¹æ³•,å¯ä»¥åˆ©ç”¨æœ‰é™å…ƒç´ çš„iteratorå˜ä¸ºæ— é™å…ƒç´ çš„iterator:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from itertools import cycle</div><div class="line">&gt;&gt;&gt; colors = cycle([&apos;red&apos;, &apos;white&apos;, &apos;blue&apos;])</div><div class="line">&gt;&gt;&gt; next(colors)</div><div class="line">&apos;red&apos;</div><div class="line">&gt;&gt;&gt; next(colors)</div><div class="line">&apos;white&apos;</div><div class="line">&gt;&gt;&gt; next(colors)</div><div class="line">&apos;blue&apos;</div><div class="line">&gt;&gt;&gt; next(colors)</div><div class="line">&apos;red&apos;</div></pre></td></tr></table></figure></p>
<p>æœ‰çš„æ—¶å€™,å¯ä»¥åœ¨æ— é™å…ƒç´ çš„iteratorä¸­åˆ†å‡ºä¸€ä¸ªæœ‰é™å…ƒç´ çš„iterator:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from itertools import islice</div><div class="line">&gt;&gt;&gt; colors = cycle([&apos;red&apos;, &apos;white&apos;, &apos;blue&apos;])  # infinite</div><div class="line">&gt;&gt;&gt; limited = islice(colors, 0, 4)            # finite</div><div class="line">&gt;&gt;&gt; for x in limited:                         # so safe to use for-loop on</div><div class="line">...     print(x)</div><div class="line">red</div><div class="line">white</div><div class="line">blue</div><div class="line">red</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡æ„é€ ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—æ¥çœ‹iteratorå¯¹å†…éƒ¨çŠ¶æ€æ˜¯å¦‚ä½•æ§åˆ¶çš„:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; class fib:</div><div class="line">...     def __init__(self):</div><div class="line">...         self.prev = 0</div><div class="line">...         self.curr = 1</div><div class="line">... </div><div class="line">...     def __iter__(self):</div><div class="line">...         return self</div><div class="line">... </div><div class="line">...     def __next__(self):</div><div class="line">...         value = self.curr</div><div class="line">...         self.curr += self.prev</div><div class="line">...         self.prev = value</div><div class="line">...         return value</div><div class="line">...</div><div class="line">&gt;&gt;&gt; f = fib()</div><div class="line">&gt;&gt;&gt; list(islice(f, 0, 10))</div><div class="line">[1, 1, 2, 3, 5, 8, 13, 21, 34, 55]</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°class fib å®ç°äº†è¿­ä»£å™¨åè®®,æ‰€ä»¥fæ˜¯ä¸€ä¸ªiterator,å¹¶ä¸”æ˜¯iterableçš„.é€šè¿‡ä¸¤ä¸ªå†…éƒ¨å˜é‡<code>prev</code>å’Œ<code>curr</code>,fibèƒ½å¤Ÿåœ¨æ¯æ¬¡ç›¸åº”<code>next()</code>è°ƒç”¨çš„æ—¶å€™è¿”å›å¯¹åº”çš„å€¼.æ¯æ¬¡å¯¹<code>next()</code>çš„å“åº”,å¯¹äºiteratoræ¥è¯´ä¸»è¦æœ‰ä¸¤ä»¶äº‹æƒ…è¦åš:</p>
<ol>
<li>ä¸ºä¸‹ä¸€æ¬¡<code>next()</code>è°ƒç”¨æ”¹å˜å†…éƒ¨çŠ¶æ€</li>
<li>ç”Ÿæˆå½“å‰<code>next()</code>è°ƒç”¨è¦è¿”å›çš„å€¼</li>
</ol>
<blockquote>
<p>ç”±æ­¤å¯ä»¥çœ‹å‡º,iteratorå¯ä»¥å½“ä½œæ˜¯ä¸€ä¸ªæƒ°æ€§æ±‚å€¼çš„å·¥å‚,æ¯æ¬¡<code>next()</code>è°ƒç”¨ä¼šè®©iteratorç”Ÿæˆæ‰€éœ€è¦çš„å€¼,ç„¶ååœ¨ä¸‹ä¸€æ¬¡<code>next()</code>è°ƒç”¨å‰éƒ½ä¿æŒç©ºé—²çŠ¶æ€.ğŸ•¶ï¸</p>
</blockquote>
<h1 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h1><p>generator(ç”Ÿæˆå™¨),å¯ä»¥å½“ä½œä¸€ç§ç‰¹æ®Šçš„iterator(æ›´ä¸ºä¼˜é›…çš„ä¸€ç§).<br>å®ƒèƒ½å¤Ÿç”¨æ›´ä¸ºç®€æ´çš„ä»£ç æ¥å®ç°ä¸Šè¾¹æ–æ³¢é‚£å¥‘æ•°åˆ—,å¹¶ä¸”é¿å…æ‰‹åŠ¨å®ç°<code>__iter()__</code>å’Œ<code>__next()__</code>.<br>ä¸¾ä¸ªğŸ:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">def fib():</div><div class="line">    prev,curr = 0,1</div><div class="line">    while True:</div><div class="line">        yield curr</div><div class="line">        prev,curr = curr,curr+prev</div><div class="line"></div><div class="line">&gt;&gt;&gt; f = fib()</div><div class="line">&gt;&gt;&gt; list(islice(f, 0, 10))</div><div class="line">[1, 1, 2, 3, 5, 8, 13, 21, 34, 55]</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡<code>yield</code>æ¥æ„é€ çš„generator,æ˜¯ä¸æ˜¯æ›´åŠ ä¼˜é›….ğŸ’<br>é€šå¸¸æœ‰ä¸¤ç§æ–¹æ³•èƒ½å¤Ÿæ„é€ ä¸€ä¸ªgenerator:</p>
<ol>
<li>generator function</li>
<li>generator comprehension</li>
</ol>
<p><code>generator function</code>å¾ˆå¥½ç†è§£,è¡¨é¢ä¸Šå’Œæ™®é€šçš„å‡½æ•°æ²¡ä»€ä¹ˆåŒºåˆ«,åªæ˜¯è¿™ä¸ªå‡½æ•°é€šè¿‡å…³é”®å­—<code>yield</code>æ¥è¿”å›å€¼.<br>ç±»ä¼¼äºåˆ—è¡¨æ¨å¯¼å¼æˆ–è€…setã€dict,é€šè¿‡<code>(x for x in rang(10))</code>è¿™æ ·çš„å½¢å¼è¿”å›çš„å°±æ˜¯ä¸€ä¸ªgenerator,è€Œé€šè¿‡åœ†æ‹¬å·<code>()</code>è¿›è¡Œçš„æ¨å¯¼å¼å°±æ˜¯<code>generator comprehension</code>.<br>æ€»çš„æ¥è¯´,generatorèƒ½å¤Ÿéå¸¸æœ‰æ•ˆçš„ç»„ç»‡ä»£ç ,ç”¨æ›´å°‘çš„å˜é‡å’Œæµç¨‹æ§åˆ¶,å¹¶ä¸”ä½¿ç”¨generatorä¼šæ›´å¥½åœ°å‡å°‘å†…å­˜æˆ–è€…cpuçš„è´Ÿè½½.æ‰€ä»¥åƒæˆ‘è¿™æ ·çš„ä»£ç é‡Œè¾¹éå¸ƒäº†å„ç§forå¾ªç¯:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">def something():</div><div class="line">    result = []</div><div class="line">    for ... in ...:</div><div class="line">        result.append(x)</div><div class="line">    return result</div></pre></td></tr></table></figure></p>
<p>è¿˜æ˜¯æŠ“ç´§æ—¶é—´å¥½å¥½æ”¹ä¸€æ”¹å§:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">def iter_something():</div><div class="line">    for ... in ...:</div><div class="line">        yield x</div></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> è¿­ä»£å™¨ </tag>
            
            <tag> ç”Ÿæˆå™¨ </tag>
            
            <tag> å¯è¿­ä»£å¯¹è±¡ </tag>
            
            <tag> iterator </tag>
            
            <tag> generator </tag>
            
            <tag> iterable </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[pythonçš„itertools[è¯»æ–‡æ¡£]]]></title>
      <url>/2017/08/09/python%E7%9A%84itertools/</url>
      <content type="html"><![CDATA[<p>pythonçš„itertoolsåº“å—åˆ°äº†æ¥è‡ªAPL, Haskellå’ŒSMLçš„çµæ„Ÿï¼Œå¹¶ä¸”ç”¨æœ€é€‚åˆpythonè¯­è¨€ç‰¹æ€§çš„å½¢å¼é‡æ„ã€‚å®ƒå·®ä¸å¤šå¯ä»¥è¯´æ˜¯å®šä¹‰äº†ä¸€å¥—é«˜æ•ˆã€èŠ‚çœå†…å­˜çš„æ–¹æ³•ä½¿ç”¨çº¯pythonæ¥æ„å»ºå¼€å‘è€…æ‰€éœ€è¦çš„å„ç§ä¸åŒè¿­ä»£å™¨ã€‚<br><a id="more"></a></p>
<h1 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h1><p>æ ¹æ®itertoolsä¸­æ–¹æ³•çš„è¿”å›ç±»å‹ä¸åŒï¼Œå¯ä»¥å°†è¿™äº›æ–¹æ³•åˆ†ä¸ºä¸‰ç±»ï¼š<br><strong>æ— ç©·è¿­ä»£âˆ</strong></p>
<table>
<thead>
<tr>
<th>è¿­ä»£å™¨</th>
<th>å‚æ•°</th>
<th>è¿”å›å€¼</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>count()</td>
<td>start,[step]</td>
<td>start,start+step,start+2*step,â€¦</td>
<td>count(10) â€“&gt; 10,11,12,13,14,â€¦</td>
</tr>
<tr>
<td>cycle()</td>
<td>p</td>
<td>p0,p1,p2,â€¦,plast,p0,p1,p2â€¦.</td>
<td>cycle([1,2,3,4]) â€“&gt; 1,2,3,4,1,2,3,4,â€¦</td>
</tr>
<tr>
<td>repeat()</td>
<td>p,[n]</td>
<td>p,p,p,â€¦,p æˆ–è€…é‡å¤næ¬¡p</td>
<td>repeat(10,2) â€“&gt; 10,10</td>
</tr>
</tbody>
</table>
<p><strong>å¤„ç†è¾“å…¥è¿­ä»£å™¨âŒ¨ï¸</strong></p>
<table>
<thead>
<tr>
<th>è¿­ä»£å™¨</th>
<th>å‚æ•°</th>
<th>è¿”å›å€¼</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>chain()</td>
<td>p,q,..</td>
<td>p0,p1,..,plast,q0,q1,â€¦,qlast,â€¦.</td>
<td>chain(â€˜abcâ€™,[1,2,3]) â€“&gt; a b c 1 2 3</td>
</tr>
<tr>
<td>compress()</td>
<td>data,selectors</td>
<td>(d[0] if s[0]),(d[1] if s[1])â€¦</td>
<td>compress(â€˜abcdâ€™,[0,1,0,0]) â€“&gt; b</td>
</tr>
<tr>
<td>dropwhile()</td>
<td>pred,seq</td>
<td>seq[n],seq[n+1]â€¦ while pred(seq[n-1]) == False</td>
<td>dropwhile(lambda x:x<3,[1,2,4,0,1]) --=""> 4,0,1</3,[1,2,4,0,1])></td>
</tr>
<tr>
<td>groupby()</td>
<td>iterable,[keyfunc]</td>
<td>æ ¹æ®keyfunc(iterable item)å€¼è¿”å›çš„è¿­ä»£å™¨</td>
<td></td>
</tr>
<tr>
<td>ifilter()</td>
<td>pred,seq</td>
<td>è¿”å›seqä¸­pred(seq[n])ä¸ºçœŸå€¼çš„ä¸€éƒ¨åˆ†å…ƒç´ </td>
<td>ifilter(lambda x:x&gt;3,[1,2,3,4,5,6]) â€“&gt; 4,5,6</td>
</tr>
<tr>
<td>ifilterfalse()</td>
<td>pred,seq</td>
<td>è¿”å›seqä¸­pred(seq[n])ä¸ºå‡çš„ä¸€éƒ¨åˆ†å…ƒç´ </td>
<td>ifilterfalse(lambda x:x&gt;3,[1,2,3,4,5,6]) â€“&gt; 1,2,3</td>
</tr>
<tr>
<td>islice()</td>
<td>seq, [start,] stop [, step]</td>
<td>è¿”å›seq[start:stop:step]çš„åˆ‡ç‰‡</td>
<td>islice(count(10),1,3) -&gt; 11,12</td>
</tr>
<tr>
<td>imap()</td>
<td>func, p, q, â€¦</td>
<td>func(p0, q0), func(p1, q1), â€¦</td>
<td>imap(lambda x,y:x+y,count(0),count(10)) â€“&gt; 10,11,12,â€¦</td>
</tr>
<tr>
<td>starmap()</td>
<td>func, seq</td>
<td>func(<em>seq[0]), func(</em>seq[1]), â€¦</td>
<td>starmap(pow, [(2,5), (3,2), (10,3)]) â€“&gt; 32 9 1000</td>
</tr>
<tr>
<td>tee()</td>
<td>it, n</td>
<td>it1, it2, â€¦ itn splits one iterator into n</td>
<td></td>
</tr>
<tr>
<td>takewhile()</td>
<td>pred,seq</td>
<td>seq[0], seq[1], until pred fails</td>
<td>takewhile(lambda x: x<5, [1,4,6,4,1])="" --=""> 1 4</5,></td>
</tr>
<tr>
<td>izip()</td>
<td>p, q, â€¦</td>
<td>(p[0], q[0]), (p[1], q[1]), â€¦ è¿”å›è¿­ä»£å™¨çš„é•¿åº¦å’Œå‚æ•°ä¸­é•¿åº¦æœ€çŸ­è¿­ä»£å™¨ç›¸åŒ</td>
<td>izip(â€˜ABCDâ€™, â€˜xyâ€™) â€“&gt; Ax By</td>
</tr>
<tr>
<td>izip_longest()</td>
<td>p, q, â€¦</td>
<td>(p[0], q[0]), (p[1], q[1]), â€¦</td>
<td>izip_longest(â€˜ABCDâ€™, â€˜xyâ€™, fillvalue=â€™-â€˜) â€“&gt; Ax By C- D-</td>
</tr>
</tbody>
</table>
<p><strong>ç»„åˆç”Ÿæˆå™¨ğŸˆ</strong> </p>
<table>
<thead>
<tr>
<th>è¿­ä»£å™¨</th>
<th>å‚æ•°</th>
<th>è¿”å›å€¼</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>product()</td>
<td>p, q, â€¦ [repeat=1]</td>
<td>è¿”å›è¾“å…¥å‚æ•°çš„ç¬›å¡å°”ç§¯</td>
</tr>
<tr>
<td>permutations()</td>
<td>p[, r]</td>
<td>è¿”å›ç”±é•¿åº¦ä¸ºrçš„pä¸­å…ƒç´ çš„ç»„åˆï¼Œ<br>æ¯ä¸ªå…ƒç´ ä¸ä¼šé‡å¤å‡ºç°</td>
<td>permutations([1,2],2) â€“&gt;<br> (1, 2), (2, 1)</td>
</tr>
<tr>
<td>combinations()</td>
<td>p, r</td>
<td>æŒ‰ç…§pä¸­å…ƒç´ çš„é¡ºåºæ¥è¿›è¡Œæ’åˆ—ç»„åˆ,<br>æ¯ä¸ªå…ƒç´ ä¸ä¼šé‡å¤å‡ºç°</td>
<td>combinations([2,1],1) â€“&gt;<br> (2,), (1,)</td>
</tr>
<tr>
<td>combinations_with_replacement()</td>
<td>p, r</td>
<td>æŒ‰ç…§pä¸­å…ƒç´ çš„é¡ºåºæ¥è¿›è¡Œæ’åˆ—ç»„åˆï¼Œ<br>æ¯ä¸ªå…ƒç´ å¯ä»¥é‡å¤å‡ºç°</td>
<td>combinations<em>with</em><br>replacement([1,2],2)<br>â€“&gt; (1, 1), (1, 2), (2, 2)</td>
</tr>
</tbody>
</table>
<h1 id="è¯¦è§£"><a href="#è¯¦è§£" class="headerlink" title="è¯¦è§£"></a>è¯¦è§£</h1><p>å¦‚ä¸‹çš„ä¸€äº›æ–¹æ³•éƒ½æ˜¯ç”¨æ¥åˆ›å»ºæˆ–è€…è¿”å›è¿­ä»£å™¨çš„ï¼Œå…¶ä¸­ä¸€äº›ä¼šè¿”å›æ— é™é•¿åº¦çš„è¿­ä»£å™¨ï¼Œå¦‚æœè¦å°†ä»–ä»¬ç”¨åœ¨å¦å¤–çš„å‡½æ•°æˆ–è€…å¾ªç¯ä¸­çš„æ—¶å€™éœ€è¦è¿›è¡Œåˆ‡ç‰‡æ“ä½œã€‚</p>
<ul>
<li><p><code>itertools.chain(*iterables)</code><br>è¾“å…¥å‚æ•°æ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œè¿”å›çš„å†…å®¹æ˜¯å°†è¿™äº›è¿­ä»£å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ æ‹¼æ¥æˆä¸ºä¸€ä¸ªå¤§çš„è¿­ä»£å™¨ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½œå‚æ•°è¾“å…¥çš„è‹¥å¹²ä¸ªè¿­ä»£å™¨å¯ä»¥æ˜¯ä¸åŒçš„ç±»å‹(åŒºåˆ«äºåŒç§ç±»å‹çš„åºåˆ—ç›¸åŠ çš„æ“ä½œï¼Œå¦‚ä¸¤ä¸ªlistç›¸åŠ æˆ–è€…ä¸¤ä¸ªstringç›¸åŠ ).<br><code>itertools.chain(*iterables)</code>ç±»ä¼¼äºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">def chain(*iterables):</div><div class="line">    # chain(&apos;ABC&apos;, &apos;DEF&apos;) --&gt; A B C D E F       </div><div class="line">    for iterable in iterables:</div><div class="line">        for element in iterable:</div><div class="line">            yield element</div></pre></td></tr></table></figure>
</li>
<li><p><code>classmethod chain.from_iterable(iterable)</code><br>å°†è¾“å…¥å‚æ•°iterableä¸­çš„æ¯ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ åˆå¹¶æˆä¸ºä¸€ä¸ªå¤§çš„è¿­ä»£å™¨ï¼Œç±»ä¼¼äºä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">def from_iterable(iterable):</div><div class="line">    # chain.from_iterable([&apos;ABC&apos;, &apos;DEF&apos;]) --&gt; A B C D E F</div><div class="line">    for item in iterable:</div><div class="line">        for element in item:</div><div class="line">            yield element</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.combinations(iterable, r)</code> ğŸ˜¢<br>è¿”å›ä¸€ä¸ªç”±rä¸ªiterableå…ƒç´ ç»„åˆè€Œæˆçš„è¿­ä»£å™¨ï¼Œå¦‚æœiterableä¸­çš„å…ƒç´ æ˜¯ç»è¿‡æ’åºçš„ï¼Œé‚£ä¹ˆè¿”å›çš„æ¯ä¸ªå¯¹è±¡ä¹Ÿéƒ½æ˜¯ç»è¿‡æ’åºçš„ã€‚iterbaleä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æŒ‰ç…§å®ƒåœ¨iterableä¸­æ‰€åœ¨çš„ä½ç½®è¿›è¡Œå¤„ç†ã€‚<code>itertools.combinations(iterable, r)</code>ç±»ä¼¼äºå¦‚ä¸‹ä»£ç è¿‡ç¨‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">def combinations(iterable, r):</div><div class="line">    # combinations(&apos;ABCD&apos;, 2) --&gt; AB AC AD BC BD CD</div><div class="line">    # combinations(range(4), 3) --&gt; 012 013 023 123</div><div class="line">    pool = tuple(iterable)</div><div class="line">    n = len(pool)</div><div class="line">    if r &gt; n:</div><div class="line">        return</div><div class="line">    indices = range(r)</div><div class="line">    yield tuple(pool[i] for i in indices)</div><div class="line">    while True:</div><div class="line">        for i in reversed(range(r)):</div><div class="line">            if indices[i] != i + n - r:</div><div class="line">                break</div><div class="line">        else:</div><div class="line">            return</div><div class="line">        indices[i] += 1</div><div class="line">        for j in range(i+1, r):</div><div class="line">            indices[j] = indices[j-1] + 1</div><div class="line">        yield tuple(pool[i] for i in indices)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>æˆ–è€…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">def combinations(iterable, r):</div><div class="line">    pool = tuple(iterable)</div><div class="line">    n = len(pool)</div><div class="line">    for indices in permutations(range(n), r):</div><div class="line">        if sorted(indices) == list(indices):</div><div class="line">            yield tuple(pool[i] for i in indices)</div></pre></td></tr></table></figure></p>
<ul>
<li><p><code>itertools.compress(data, selectors)</code><br>è¾“å…¥å‚æ•°dataå’Œselectorså‡ä¸ºè¿­ä»£å™¨å¯¹è±¡ï¼Œå¦‚æœselectorä¸­æŸä¸€å…ƒç´ è¿”å›çœŸå€¼ï¼Œåˆ™è¿”å›å¯¹åº”ä½ç½®dataä¸­çš„å…ƒç´ ã€‚ç±»ä¼¼äºä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">def compress(data,selectors):</div><div class="line">    # compress(&apos;ABCDEF&apos;, [1,0,1,0,1,1]) --&gt; A C E F</div><div class="line">    return (d for d,s in izip(data,selectors) if s)</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.count(start=0, step=1)</code><br>ç”¨äºè¿”å›ä¸€ä¸ªæ•°å€¼è¿ç»­çš„è¿­ä»£å™¨ï¼Œå¸¸ä½œä¸º<code>imap()</code>æˆ–è€…<code>izip()</code>çš„å‚æ•°ã€‚ç­‰ä»·äºä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">def count(start=0,step=1):</div><div class="line">    # count(10) --&gt; 10 11 12 13 14 ...</div><div class="line">    # count(2.5, 0.5) -&gt; 2.5 3.0 3.5 ...</div><div class="line">    n = start</div><div class="line">    while True:</div><div class="line">        yield n</div><div class="line">        n += step</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.cycle(iterable)</code><br>é€ä¸ªè¿”å›iterableä¸­çš„å…ƒç´ ï¼Œå¹¶å°†æ¯ä¸ªå…ƒç´ å¤‡ä»½ï¼Œåœ¨iterableä¸­å…ƒç´ è€—å°½çš„æ—¶å€™ï¼Œé‡å¤çš„è¿”å›iterableå¯¹è±¡çš„å¤‡ä»½ã€‚ç­‰ä»·äºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">def cycle(iterable):</div><div class="line">    container = []</div><div class="line">    for item in iterable:</div><div class="line">        yield item</div><div class="line">        container.append(item)</div><div class="line">    while container:</div><div class="line">        for element in container:</div><div class="line">            yield element</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.dropwhile(predicate, iterable)</code><br>å¦‚æœpredicateè¿”å›å€¼ä¸ºTrue,å°±å°†iterableä¸­çš„å…ƒç´ æŠ›å¼ƒï¼Œç›´åˆ°predicateè¿”å›False,è¿”å›iterableä¸­å‰©ä¸‹çš„å…ƒç´ ã€‚ç±»ä¼¼äºä»£ç å®ç°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">def dropwhile(pred,iteration):</div><div class="line">    iterable = iter(iteration)</div><div class="line">    for x in iterable:</div><div class="line">        if not pred(x):</div><div class="line">            yield x</div><div class="line">            break</div><div class="line">    for x in iterable:</div><div class="line">        yield x</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.ifilter(predicate, iterable)</code><br>å¦‚æœiterableä¸­çš„å…ƒç´ elementï¼Œåœ¨æ‰§è¡Œpredicate(element)è¿”å›True,åˆ™å°†è¿™ä¸ªelementè¿”å›ã€‚å¦‚æœpredicateä¸ºNone,åˆ™è¿”å›iterableä¸­çš„çœŸå€¼ã€‚ç±»ä¼¼äºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">def ifilter(pred,iterable):</div><div class="line">    if pred is None:</div><div class="line">        pred = bool</div><div class="line">    for item in iterable:</div><div class="line">        if pred(item):</div><div class="line">            yield item</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.ifilterfalse(predicate, iterable)</code><br>å’Œ<code>itertools.ifilter</code>ç›¸åï¼Œç±»ä¼¼äºä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">def ifileterfalse(pred,iterable):</div><div class="line">    if pred is None:</div><div class="line">        pred = bool</div><div class="line">    for item in iterable:</div><div class="line">        if not pred(item):</div><div class="line">            yield item</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.imap(function, *iterables)</code><br>å°†æ¥è‡ªäºiterablesä¸­å¤šä¸ªè¿­ä»£å™¨ä¸­çš„æ¯æ¬¡å„é€‰å–ä¸€ä¸ªå…ƒç´ ä½œä¸ºfunctionçš„å‚æ•°ï¼Œè¿”å›functionæ‰§è¡Œåçš„ç»“æœ.å¦‚æœfunctionä¸ºç©ºï¼Œç¼ºçœå€¼ä¸ºtupleã€‚åŒºåˆ«äºmapï¼Œimapä¸­çš„è¿­ä»£å™¨å¯ä»¥æ˜¯æ— ç©·åºåˆ—,å¹¶ä¸”imapä¸­å½“æœ€çŸ­çš„è¿­ä»£å™¨ä¸­æ²¡æœ‰å…ƒç´ çš„æ—¶å€™ä¼šç»“æŸï¼Œè€Œä¸æ˜¯ä½¿ç”¨Noneæ¥ä»£æ›¿ã€‚æ‰§è¡Œä»£ç ç±»ä¼¼äºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">def imap(func,*iterables):</div><div class="line">    its = map(iter,iterables)</div><div class="line">    if func is None:</div><div class="line">        func = tuple</div><div class="line">    while True:</div><div class="line">        args = [next(it) for it in its]</div><div class="line">        yield func(*args)</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.islice(iterable, stop) itertools.islice(iterable, start, stop[, step])</code><br>ä¸æ™®é€šçš„sliceæ–¹æ³•ä¸åŒï¼Œisliceçš„å‚æ•°start,stopæˆ–è€…stepä¸èƒ½ä¸ºè´Ÿå€¼ï¼Œç±»ä¼¼äºä»£ç :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">def islice(iterable, *args):</div><div class="line">    # islice(&apos;ABCDEFG&apos;, 2) --&gt; A B</div><div class="line">    # islice(&apos;ABCDEFG&apos;, 2, 4) --&gt; C D</div><div class="line">    # islice(&apos;ABCDEFG&apos;, 2, None) --&gt; C D E F G</div><div class="line">    # islice(&apos;ABCDEFG&apos;, 0, None, 2) --&gt; A C E G</div><div class="line">    s = slice(*args)</div><div class="line">    it = iter(xrange(s.start or 0, s.stop or sys.maxint, s.step or 1))</div><div class="line">    nexti = next(it)</div><div class="line">    for i, element in enumerate(iterable):</div><div class="line">        if i == nexti:</div><div class="line">            yield element</div><div class="line">            nexti = next(it)</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.izip(*iterables)</code><br>ä¸zipä¸åŒï¼Œizipçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªè¿­ä»£å™¨è€Œä¸æ˜¯listå¯¹è±¡ã€‚è¿è¡Œä»£ç ç±»ä¼¼äºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">def izip(*iterables):</div><div class="line">    iters = map(iter,iterables)</div><div class="line">    while iters:</div><div class="line">        yield tuple(map(next,iters))</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.repeat(object[, times])</code><br>ç”Ÿæˆä¸€ä¸ªé‡å¤å‡ºç°object timesæ¬¡çš„è¿­ä»£å™¨ï¼Œç±»ä¼¼ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">def repeat(object,times):</div><div class="line">    if times is None:</div><div class="line">        while True:</div><div class="line">            yield object</div><div class="line">    else:</div><div class="line">        for x in rang(times):</div><div class="line">            yield object</div></pre></td></tr></table></figure>
</li>
<li><p><code>itertools.starmap(function, iterable)</code><br>å®ç°ç±»ä¼¼ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">def starmap(func,iterable):</div><div class="line">    for item in iterable:</div><div class="line">        yield func(*item)</div></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> è¿­ä»£å™¨ </tag>
            
            <tag> æ ‡å‡†åº“ </tag>
            
            <tag> æ–‡æ¡£ </tag>
            
            <tag> itertools </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[python2.7.13å†…å»ºå‡½æ•°[è¯»æ–‡æ¡£]]]></title>
      <url>/2017/08/04/python2.7.13%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘å‡†å¤‡ç³»ç»Ÿçš„çœ‹ä¸€ä¸‹pythonæ–‡æ¡£ï¼Œå¹¶å°†çœ‹åˆ°çš„ä¸œè¥¿è®°ä¸€ä¸‹ï¼Œæ‰€ä»¥<strong>[è¯»æ–‡æ¡£]</strong>å¯èƒ½å°†ä¼šæˆä¸ºä¸€ä¸ªç³»åˆ—ã€‚<br>ç›®å‰åŸºæœ¬çœ‹å®Œäº†å†…å»ºå‡½æ•°éƒ¨åˆ†ï¼Œåç»­ä¼šç»§ç»­æ›´æ–°(passæ ‡è®°è¡¨ç¤ºè¿˜æœªæ›´æ–°å†…å®¹)ã€‚<br><a id="more"></a></p>
<ol>
<li>abs(x)<br> è¿”å›xçš„ç»å¯¹å€¼,xå¯ä»¥æ˜¯ä¸€ä¸ªintå‹ã€longå‹æˆ–è€…æ˜¯floatå‹.</li>
<li><p>all(iterable)<br> è¾“å…¥å‚æ•°ä¸ºä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡,å¦‚æœiterableä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä¸ºTrueæˆ–è€…iterableæ˜¯ä¸€ä¸ªç©ºçš„å¯¹è±¡è¿”å›True,å¦åˆ™è¿”å›False. (New in version 2.5.)</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">all</span><span class="params">(iterable)</span>:</span></div><div class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> iterable:</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> element:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span></div></pre></td></tr></table></figure>
</li>
<li><p>any(iterable)<br> å¦‚æœå‚æ•°iterableä¸­æœ‰ä»»ä¸€ä¸ªå€¼ä¸ºTrueå°±è¿”å›True,å¦åˆ™è¿”å›False,å¦‚æœiterableä¸ºç©º,è¿”å›False. (New in version 2.5.)</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">any</span><span class="params">(iterable)</span>:</span></div><div class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> iterable:</div><div class="line">        <span class="keyword">if</span> element:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">False</span></div></pre></td></tr></table></figure>
</li>
<li><p>basestring() ğŸ­<br> basestringæ˜¯strå’Œunicodeçš„è¶…ç±»,å®ƒä¸èƒ½è¢«å®ä¾‹åŒ–æˆ–è€…è¢«è°ƒç”¨,ä½†å®ƒå¯ä»¥ç”¨æ¥æ£€æµ‹ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯stræˆ–è€…unicodeçš„å®ä¾‹,<code>isinstance(obj,basestring)</code>ç­‰ä»·äº<code>isinstance(obj, (str, unicode))</code>.</p>
</li>
<li><p>bin(x) ğŸ­<br> å‚æ•°xæ˜¯ä¸€ä¸ªintå‹æ•°å­—,ç»“æœè¿”å›xçš„äºŒè¿›åˆ¶å­—ç¬¦ä¸².</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">5</span>]: bin(<span class="number">1</span>)</div><div class="line">Out[<span class="number">5</span>]: <span class="string">'0b1'</span></div><div class="line"></div><div class="line">In [<span class="number">6</span>]: bin(<span class="number">10</span>)</div><div class="line">Out[<span class="number">6</span>]: <span class="string">'0b1010'</span></div></pre></td></tr></table></figure>
</li>
<li><p>class bool([x]) ğŸ­<br> boolå‹æ˜¯intçš„å­—ç±»,å¹¶ä¸”å®ƒä¸èƒ½å†æ´¾ç”Ÿå…¶ä»–çš„ä»»ä½•å­ç±»,å®ƒæœ‰ä¸”ä»…æœ‰ä¸¤ä¸ªå®ä¾‹:True,False.<br> xå‚æ•°åœ¨ç»è¿‡çœŸå€¼åˆ¤æ–­ä¹‹åè¿”å›Trueæˆ–è€…False.</p>
</li>
<li>class bytearray([source[, encoding[, errors]]]) ğŸ­<br> pass</li>
<li>callable(object)<br> å¦‚æœobjectæ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡è¿”å›True,å¦åˆ™è¿”å›False(å¦‚æœè¿”å›ç»“æœä¸ºTrue,ä¸ä»£è¡¨object()å°±ä¸€å®šèƒ½å¤ŸæˆåŠŸ,ä½†æ˜¯å¦‚æœè¿”å›å€¼æ˜¯False,object()ä¸€å®šä¸ä¼šæˆåŠŸ).è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼šç±»éƒ½æ˜¯å¯è°ƒç”¨å¯¹è±¡(è°ƒç”¨ä¸€ä¸ªç±»,ä¼šè¿”å›è¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹),ä½†æ˜¯å¦‚æœæƒ³è¦è®©ç±»å®ä¾‹ä¹Ÿæ˜¯å¯è°ƒç”¨å¯¹è±¡åˆ™éœ€è¦å®ç°è¿™ä¸ªç±»<strong>call</strong>()æ–¹æ³•.</li>
<li><p>chr(i)<br> å‚æ•°iå¿…é¡»æ˜¯ä¸€ä¸ª0-255èŒƒå›´å†…çš„æ•´å‹æ•°å­—,è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²,è¯¥å­—ç¬¦ä¸²çš„ASCIIç æ°å¥½ç­‰äºi.</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">21</span>]: chr(<span class="number">0</span>)</div><div class="line">Out[<span class="number">21</span>]: <span class="string">'\x00'</span></div><div class="line"></div><div class="line">In [<span class="number">22</span>]: chr(<span class="number">97</span>)</div><div class="line">Out[<span class="number">22</span>]: <span class="string">'a'</span></div><div class="line"></div><div class="line">In [<span class="number">23</span>]: chr(<span class="number">98</span>)</div><div class="line">Out[<span class="number">23</span>]: <span class="string">'b'</span></div></pre></td></tr></table></figure>
</li>
<li><p>classmethod(function) (è£…é¥°å™¨) ğŸ…ï¸<br>classmethodæ¥æ”¶ä¸€ä¸ªç±»ä½œä¸ºé»˜è®¤çš„ç¬¬ä¸€ä¸ªå‚æ•°,å°±åƒä¸€ä¸ªå®ä¾‹æ–¹æ³•é»˜è®¤ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å®ä¾‹æœ¬èº«.classmethodæ˜¯ä¸€ä¸ªè£…é¥°å™¨.    ç±»æ–¹æ³•(class method)å¯ä»¥ç›´æ¥é€šè¿‡Date.gen_date(str)è°ƒç”¨,æˆ–è€…é€šè¿‡ç±»å®ä¾‹è°ƒç”¨Date().gen_date(str).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">class Date(object):</div><div class="line">    def __init__(self,month,day,year):</div><div class="line">        # å®ä¾‹æ–¹æ³•,selfå°±æ˜¯å®ä¾‹æœ¬èº«</div><div class="line">        self.month = month</div><div class="line">        self.day = day</div><div class="line">        self.year = year</div><div class="line"></div><div class="line">    @classmethod</div><div class="line">    def gen_date(cls,str):</div><div class="line">        # ç±»æ–¹æ³•,clså°±æ˜¯Dateç±»</div><div class="line">        day, month, year = map(int, date_as_string.split(&apos;-&apos;))</div><div class="line">        date1 = cls(day, month, year)</div><div class="line">        return date1</div></pre></td></tr></table></figure>
</li>
<li><p>cmp(x, y)<br>æ¯”è¾ƒx,yä¸¤ä¸ªå¯¹è±¡,æ ¹æ®æ¯”è¾ƒçš„ç»“æœè¿”å›å¯¹åº”çš„å€¼(å¦‚æœ<code>x&lt;y</code>è¿”å›è´Ÿå€¼,å¦‚æœ<code>x&gt;y</code>è¿”å›æ­£å€¼,å¦‚æœ<code>x==y</code>è¿”å›0)</p>
</li>
<li>compile(source, filename, mode[, flags[, dont_inherit]])<br>pass</li>
<li>class complex([real[, imag]])<br>pass</li>
<li>delattr(object, name)<br>å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡å’Œä¸€ä¸ªå­—ç¬¦ä¸²,delattrçš„ä½œç”¨å°±æ˜¯åˆ é™¤å¯¹è±¡objectåå­—å«åšnameçš„å±æ€§.<code>delattr(x, foo)</code>ç­‰ä»·äº<code>del x.foo</code>.delattræ˜¯å†…å»ºå‡½æ•°setattrçš„é€†æ“ä½œ.</li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class dict(**kwarg)</div><div class="line">   class dict(mapping, **kwarg)</div><div class="line">   class dict(iterable, **kwarg) ğŸ­</div></pre></td></tr></table></figure>
<p>pass</p>
</li>
<li>dir([object])<br>pass</li>
<li>divmod(a, b)<br>å‚æ•°æ˜¯ä¸¤ä¸ªæ•°å­—,å¯ä»¥æ˜¯int,longç”šè‡³floatç±»å‹,è¿”å›å€¼æ˜¯ä¸¤ä¸ªæ•°ç›¸é™¤çš„å•†å’Œä½™æ•°.</li>
<li><p>enumerate(sequence, start=0)<br>å‚æ•°sequenceå¿…é¡»æ˜¯ä¸€ä¸ªåºåˆ—ã€è¿­ä»£å™¨æˆ–è€…å…¶ä»–ä»»ä½•å¯è¿­ä»£å¯¹è±¡,è¿”å›å€¼å¯ä»¥å½“ä½œä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡,å¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç ç†è§£enumerateæ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">def enumerate(sequence, start=0):</div><div class="line">    n = start</div><div class="line">    for elem in sequence:</div><div class="line">        yield n, elem</div><div class="line">        n += 1</div></pre></td></tr></table></figure>
</li>
<li><p>eval(expression[, globals[, locals]])<br>pass</p>
</li>
<li>execfile(filename[, globals[, locals]])<br>pass</li>
<li>file(name[, mode[, buffering]])<br>pass</li>
<li><p>filter(function, iterable) ğŸ…ï¸<br>å‚æ•°functionæ˜¯ä¸€ä¸ªè¿”å›å€¼ä¸ºboolå‹çš„å‡½æ•°,iterableæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡.å¦‚æœiterableæ˜¯ä¸€ä¸ªstringæˆ–è€…tuple,æœ€ç»ˆè¿”å›å€¼ä¹Ÿä¼šä¿ç•™åŸæ¥çš„ç±»å‹,å…¶ä»–çš„ç±»å‹æœ€ç»ˆè¿”å›å€¼æ˜¯listç±»å‹.<br>å¯ä»¥è¿™æ ·ç†è§£filter:<br>filter(function, iterable)ç­‰ä»·äº<br>å¦‚æœfunctionä¸ä¸ºNone:[item for item in iterable if function(item)]<br>å¦‚æœfunctionä¸ºNone:[item for item in iterable if item]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">In [7]: a = (1,2,3,4,5,6)</div><div class="line">In [8]: filter(lambda x:x&gt;3,a)</div><div class="line">Out[8]: (4, 5, 6)</div><div class="line"></div><div class="line">In [11]: filter(lambda x:x==&apos;l&apos;,a)</div><div class="line">Out[11]: &apos;lll&apos;</div><div class="line">In [12]: a = [1,2,3,4,5,6]</div><div class="line"></div><div class="line">In [13]: filter(lambda x:x&gt;3,a)</div><div class="line">Out[13]: [4, 5, 6]</div><div class="line">In [14]: a = [[],[1],[2],[]]</div><div class="line"></div><div class="line">In [15]: filter(None,a)</div><div class="line">Out[15]: [[1], [2]]</div></pre></td></tr></table></figure>
</li>
<li><p>class float([x]) ğŸ­<br>å‚æ•°xå¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—æˆ–è€…å­—ç¬¦ä¸²,è¿”å›å¯¹åº”çš„floatå‹æ•°å­—.</p>
</li>
<li>format(value[, format_spec])<br>pass</li>
<li>class frozenset([iterable]) ğŸ­<br>å‚æ•°æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡,è¿”å›ä¸€ä¸ªfrozensetå¯¹è±¡.</li>
<li>getattr(object, name[, default])<br>å‚æ•°objectä¸ºä¸€ä¸ªå¯¹è±¡,nameä¸ºä¸€ä¸ªstring,ç»“æœè¿”å›objectå¯¹è±¡åä¸ºnameçš„å±æ€§å€¼,<code>getattr(x,&#39;foo&#39;)</code>ç­‰ä»·äº<code>x.foo</code>.</li>
<li>globals()<br>pass</li>
<li>hasattr(object, name)<br>å‚æ•°objectä¸ºä¸€ä¸ªå¯¹è±¡,nameæ˜¯ä¸€ä¸ªstring,å¦‚æœobjectå¯¹è±¡æœ‰åä¸ºnameçš„å±æ€§è¿”å›True,å¦åˆ™è¿”å›False.å®ƒå®é™…ä¸Šæ˜¯é€šè¿‡è°ƒç”¨getattr(object,name)çœ‹æ˜¯å¦ä¼šé€ æˆå¼‚å¸¸æ¥åˆ¤æ–­çš„.</li>
<li><p>hash(object)<br>è¿”å›å¯¹è±¡objectçš„hashå€¼,objectå¯¹è±¡å¿…é¡»æ˜¯ä¸€ä¸ªå¯å“ˆå¸Œçš„ç±»å‹,å¦åˆ™ä¼šæŠ¥é”™.å¹¶ä¸”å€¼ç›¸ç­‰çš„ä¸¤ä¸ªæ•°å­—å‹å¯¹è±¡çš„å“ˆå¸Œå€¼æ˜¯ä¸€æ ·çš„,ä¸ç®¡è¿™ä¸¤ä¸ªæ•°å­—æ˜¯intæˆ–è€…float.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [1]: hash(1)</div><div class="line">Out[1]: 1</div><div class="line"></div><div class="line">In [3]: a = [1]</div><div class="line">In [4]: hash(a)</div><div class="line">---------------------------------------------------------------------------</div><div class="line">TypeError                                 Traceback (most recent call last)</div><div class="line">&lt;ipython-input-4-fe724719d9a1&gt; in &lt;module&gt;()</div><div class="line">----&gt; 1 hash(a)</div><div class="line">TypeError: unhashable type: &apos;list&apos;</div><div class="line"></div><div class="line">In [2]: hash(1) == hash(1.0000)</div><div class="line">Out[2]: True</div></pre></td></tr></table></figure>
</li>
<li><p>help([object])<br>è°ƒç”¨pythonå†…å»ºçš„å¸®åŠ©ç³»ç»Ÿ,ä¾‹å¦‚<code>help(int) / help(str)</code>.</p>
</li>
<li>hex(x) ğŸ­<br>å°†ä¸€ä¸ªæ•´å½¢æ•°å­—å˜ä¸ºä¸€ä¸ªä»¥â€™0xâ€™å¼€å¤´çš„å°å†™16è¿›åˆ¶å­—ç¬¦ä¸².<br>xå¯ä»¥æ˜¯ä¸€ä¸ªintæˆ–è€…longç±»å‹å¯¹è±¡,å¦‚æœä¸æ˜¯çš„è¯è¿™ä¸ªå¯¹è±¡éœ€è¦å®ç°<code>__index__()</code>æ–¹æ³•,å¹¶è¿”å›ä¸€ä¸ªæ•´å½¢æ•°å­—.</li>
<li><p>id(object)<br>è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å”¯ä¸€æ ‡è¯†,åœ¨å®ƒçš„ç”Ÿå‘½å‘¨æœŸå†….</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">In [9]: a</div><div class="line">Out[9]: [1]</div><div class="line"></div><div class="line">In [10]: id(a)</div><div class="line">Out[10]: 4411575760</div></pre></td></tr></table></figure>
</li>
<li><p>input([prompt])<br>pass</p>
</li>
<li>class int(x=0)<br>class int(x, base=10) ğŸ­<br>è¿”å›ä¸€ä¸ªintå¯¹è±¡,xå¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—æˆ–è€…string.å¦‚æœä¸æŒ‡å®šx,è¿”å›0.</li>
<li>isinstance(object, classinfo)<br>å¦‚æœå¯¹è±¡objectæ˜¯ç±»classinfoçš„ä¸€ä¸ªå®ä¾‹æˆ–è€…æ˜¯ç”±classinfoæ´¾ç”Ÿç±»çš„å®ä¾‹ï¼Œè¿”å›Trueå¦åˆ™è¿”å›False.éœ€è¦æ³¨æ„çš„æ˜¯classinfoå¯ä»¥æ˜¯ä¸€ä¸ªç”±å¤šä¸ªç±»æ„æˆçš„å…ƒç»„ï¼Œå¦‚æœobjectæ˜¯è¿™ä¸ªå…ƒç»„ä¸­æŸä¸€ä¸ªç±»çš„å®ä¾‹æˆ–è€…è¿™äº›ç±»ä¸­æ´¾ç”Ÿç±»çš„å®ä¾‹è¿”å›True,å¦åˆ™è¿”å›False.</li>
<li>issubclass(class, classinfo)<br>å¦‚æœç±»classæ˜¯classinfoçš„æ´¾ç”Ÿç±»ï¼Œè¿”å›True,å¦åˆ™è¿”å›False.è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸€ä¸ªç±»å¯ä»¥è¢«å½“ä½œæ˜¯å®ƒè‡ªå·±çš„å­ç±»ã€‚åŒæ ·åœ°ï¼Œclassinfoä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç”±å¤šä¸ªç±»æ„æˆçš„å…ƒç»„ï¼Œå¦‚æœclasæ˜¯è¿™ä¸ªå…ƒç»„ä¸­æŸä¸ªç±»çš„å­ç±»ä¹Ÿä¼šè¿”å›True.</li>
<li><p>iter(o[, sentinel]) ğŸ…ï¸<br>è¿”å›å€¼æ˜¯ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ã€‚<br>ç¬¬äºŒå‚æ•°sentinelæ˜¯å¦å­˜åœ¨å¯¹ç¬¬ä¸€ä¸ªoæœ‰æ¯”è¾ƒå¤§çš„å½±å“ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸å­˜åœ¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°oå¿…é¡»æ˜¯ä¸€ä¸ªé›†åˆå¯¹è±¡(å®ç°äº†<code>__iter__()</code>æ–¹æ³•çš„å¯¹è±¡)æˆ–è€…å®ç°äº†<code>__getitem__()æ–¹æ³•çš„å¯¹è±¡ï¼Œå¹¶ä¸”å–å€¼å‚æ•°å¿…é¡»æ˜¯ä»0å¼€å§‹çš„æ•´å‹</code>,å¦åˆ™åœ¨ä½¿ç”¨iterå‡½æ•°çš„æ—¶å€™ä¼šæœ‰TypeErrorçš„å¼‚å¸¸ã€‚<br>å¦‚æœç¬¬äºŒä¸ªå‚æ•°å­˜åœ¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°oåˆ™å¿…é¡»æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œoè¿™ä¸ªå¯è°ƒç”¨å¯¹è±¡åœ¨è¢«è°ƒç”¨çš„æ—¶å€™ä¼šè¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œæ¯æ¬¡å¯¹oçš„è°ƒç”¨ç›¸å½“äºæ‰§è¡Œoè¿”å›è¿­ä»£å™¨çš„<code>next()</code>æ–¹æ³•ï¼Œå¦‚æœoçš„è¿”å›å€¼å’Œç¬¬äºŒä¸ªå‚æ•°å€¼ç›¸åŒåˆ™ä¼šå¼•å‘StopIterationå¼‚å¸¸ï¼Œå¦åˆ™è¿”å›æ­£å¸¸çš„å€¼ã€‚ä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼Œé€è¡Œè¯»å–mydata.txtï¼Œå½“è¯»åˆ°ç©ºç™½è¡Œçš„æ—¶å€™ç»ˆæ­¢æ“ä½œ:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">with open(&apos;mydata.txt&apos;) as fp:</div><div class="line">for line in iter(fp.readline, &apos;&apos;):</div><div class="line">    process_line(line)</div></pre></td></tr></table></figure>
</li>
<li><p>len(s)<br>è¿”å›ä¸€ä¸ªå¯¹è±¡çš„é•¿åº¦ã€‚å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªåºåˆ—(string,bytes,tuple,listæˆ–è€…range)æˆ–è€…æ˜¯ä¸€ä¸ªé›†åˆ(dict,setæˆ–è€…frozenset).</p>
</li>
<li>class list([iterable]) ğŸ­<br>è¿”å›ä¸€ä¸ªlistå¯¹è±¡ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œæœ€ç»ˆè¿”å›çš„listå¯¹è±¡ä¸­å…ƒç´ é¡ºåºå’Œè¿­ä»£å™¨ä¸­å…ƒç´ çš„é¡ºåºä¿æŒä¸€è‡´ã€‚</li>
<li>locals()<br>pass</li>
<li>class long(x=0) ğŸ­<br>class long(x, base=10)<br>è¿”å›å€¼æ˜¯ä¸€ä¸ªé•¿æ•´å‹æ•°å­—ï¼Œå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°å­—ã€‚</li>
<li><p>map(function, iterable, â€¦) ğŸ…ï¸<br>å°†å‚æ•°å¯è¿­ä»£å¯¹è±¡iterableä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ä¼ å…¥functionå‡½æ•°ä¸­ï¼Œè¿”å›å€¼æ˜¯æ¯ä¸ªå…ƒç´ ç»è¿‡functionå‡½æ•°è°ƒç”¨ä¹‹åçš„è¿”å›å€¼æ„æˆçš„åˆ—è¡¨ã€‚<br>å¦‚æœæœ‰å¤šä¸ªå¯è¿­ä»£å¯¹è±¡ä¼ å…¥ï¼Œfunctionå‡½æ•°ä¹Ÿå¿…é¡»èƒ½å¤ŸåŒæ—¶æ¥å—å¯¹åº”æ•°é‡çš„å‚æ•°ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡é•¿åº¦æ¯”è¾ƒçŸ­ï¼Œåˆ™ä¼šå‘functionå‡½æ•°ä¼ å…¥Noneä½œä¸ºæ›¿ä»£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">In [26]: def map_func(a,b):</div><div class="line">    ...:     return a+b</div><div class="line">    ...:</div><div class="line">In [27]: a = [0,1,2,3,4]</div><div class="line">In [28]: b = [10,11,12,13,14]</div><div class="line">In [29]: map(map_func,a,b)</div><div class="line">Out[29]: [10, 12, 14, 16, 18]</div><div class="line"></div><div class="line">In [32]: a = [0,1,2,3,4,5,6,7]</div><div class="line">In [33]: b = [10,11,12,13,14]</div><div class="line">In [35]: def map_func(a,b):</div><div class="line">    ...:     return b,a</div><div class="line">    ...:</div><div class="line">In [36]: map(map_func,a,b)</div><div class="line">Out[36]: [(10, 0), (11, 1), (12, 2), (13, 3), (14, 4), (None, 5), (None, 6), (None, 7)]</div></pre></td></tr></table></figure>
</li>
<li><p>max(iterable[, key])<br>max(arg1, arg2, *args[, key])<br>è¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­æœ€å¤§çš„å…ƒç´ æˆ–è€…å¤šä¸ªå¯¹è±¡çš„æœ€å¤§ä¸€ä¸ªï¼Œè¿™é‡Œçš„keyæ˜¯ä¸€ä¸ªæ¥å—ä¸€ä¸ªå‚æ•°çš„æ’åºå‡½æ•°ï¼Œç±»ä¼¼äºlist.sort()ä¸­çš„æ’åºå‡½æ•°ã€‚</p>
</li>
<li>memoryview(obj) ğŸ­<br>è¿”å›ä¸€ä¸ªmemoryviewå¯¹è±¡ã€‚</li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">min(iterable[, key])</div><div class="line">   min(arg1, arg2, *args[, key])</div></pre></td></tr></table></figure>
<p>è¿”å›ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ä¸­çš„æœ€å°å€¼æˆ–è€…å‡ ä¸ªå¯¹è±¡ä¸­çš„æœ€å°å€¼ã€‚äºmax()ä½¿ç”¨æ–¹æ³•ç±»ä¼¼ã€‚</p>
</li>
<li>next(iterator[, default]) ğŸ…ï¸<br>å–å‡ºå‚æ•°è¿­ä»£å™¨iteratorçš„ä¸‹ä¸€ä¸ªå€¼ï¼Œç­‰ä»·äº<code>iterator.next()</code>ã€‚å¦‚æœç»™å®šäº†defaultï¼Œåœ¨è¿­ä»£å™¨ä¸­æ²¡æœ‰å‰©ä½™å…ƒç´ çš„æ—¶å€™è¿”å›defaultçš„å€¼ï¼Œå¦åˆ™å¼•å‘StopIterationå¼‚å¸¸ã€‚</li>
<li>class object<br>è¿”å›ä¸€ä¸ªæ™®é€šçš„æ–°å¼ç±»å¯¹è±¡ã€‚objectæ˜¯æ‰€æœ‰æ–°å¼ç±»çš„åŸºç±»ã€‚</li>
<li>oct(x)<br>å°†ä¸€ä¸ªæ•´å‹æ•°å­—è½¬ä¸ºå…«è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</li>
<li>open(name[, mode[, buffering]]) ğŸ…ï¸<br>æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ã€‚å¦‚æœæ–‡ä»¶ä¸èƒ½è¢«æ‰“å¼€ï¼Œä¼šå¼•å‘IOErrorå¼‚å¸¸ã€‚é€šå¸¸æƒ…å†µä¸‹åœ¨æ‰“å¼€æ–‡ä»¶çš„æ—¶å€™éƒ½ä½¿ç”¨open()è€Œé¿å…ç›´æ¥ä½¿ç”¨fileçš„æ„é€ å‡½æ•°ã€‚</li>
<li>ord(c)<br>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º1çš„stringï¼Œè¿”å›ä¸€ä¸ªæ•´å‹ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯chr()çš„é€†æ“ä½œã€‚</li>
<li>pow(x, y[, z])<br>è¿”å›å€¼xçš„yæ¬¡æ–¹ã€‚å¦‚æœç»™å®šäº†zï¼Œå°±ç›¸å½“äºæ˜¯pow(x,y)%zã€‚</li>
<li><code>print(*objects, sep=&#39; &#39;, end=&#39;\n&#39;, file=sys.stdout)</code><br>pass</li>
<li>class property([fget[, fset[, fdel[, doc]]]])<br>pass</li>
<li>range(stop)<br>range(start, stop[, step])<br>rangeèƒ½å¤Ÿååˆ†æ–¹ä¾¿åœ°è¿”å›ä¸€ä¸ªç­‰å·®æ•°åˆ—list,å…¶ä¸­å‚æ•°startç¼ºçœå€¼ä¸º0ï¼Œstepç¼ºçœå€¼æ˜¯1.å¦‚æœstepæ˜¯æ­£å€¼ï¼Œè¿”å›çš„listå°±æ˜¯ä¸€ä¸ªé€’å¢æ•°åˆ—ï¼Œå¦‚æœstepä¸ºè´Ÿå€¼ï¼Œè¿”å›çš„listå°±æ˜¯ä¸€ä¸ªé€’å‡æ•°åˆ—ã€‚</li>
<li><p>raw_input([prompt])<br>å¦‚æœå‚æ•°promptä¸ä¸ºç©ºï¼Œå®ƒä¼šè¢«å†™å…¥æ ‡å‡†è¾“å‡ºå¹¶ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œå¹¶å°†ç”¨æˆ·è¾“å…¥å€¼è½¬ä¸ºstringå¹¶å½“ä½œè¿”å›å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">In [1]: s = raw_input(&apos;input something:&apos;)</div><div class="line">input something:ahhhhhhhhh</div><div class="line">In [2]: s</div><div class="line">Out[2]: &apos;ahhhhhhhhh&apos;</div></pre></td></tr></table></figure>
</li>
<li><p>reduce(function, iterable[, initializer]) ğŸ…ï¸<br>å…³äºreduceçš„è§£é‡Šç›´æ¥ä½¿ç”¨æ–‡æ¡£ä¸­çš„ä»£ç å¥½åƒæ›´èƒ½è§£é‡Šæ¸…æ¥šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">def reduce(function, iterable, initializer=None):</div><div class="line">    it = iter(iterable)</div><div class="line">    if initializer is None:</div><div class="line">        try:</div><div class="line">            initializer = next(it)</div><div class="line">        except StopIteration:</div><div class="line">            raise TypeError(&apos;reduce() of empty sequence with no initial value&apos;)</div><div class="line">    accum_value = initializer</div><div class="line">    for x in it:</div><div class="line">        accum_value = function(accum_value, x)</div><div class="line">    return accum_value</div></pre></td></tr></table></figure>
<p>å®ä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [1]: a = [1]</div><div class="line">In [2]: reduce(lambda x,y:x+y,a)</div><div class="line">Out[2]: 1</div><div class="line">In [3]: reduce(lambda x,y:x+y,a,1)</div><div class="line">Out[3]: 2</div><div class="line"></div><div class="line">In [4]: a = [1,2]</div><div class="line">In [5]: reduce(lambda x,y:x+y,a)</div><div class="line">Out[5]: 3</div></pre></td></tr></table></figure>
</li>
<li><p>reload(module)<br>pass</p>
</li>
<li><p>repr(object)<br>è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²å½¢å¼ã€‚é€šå¸¸è¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥ç”¨è¿‡eval()è¿”å›ä¸€ä¸ªå€¼ç­‰äºobjectçš„å¯¹è±¡ã€‚å¦å¤–ï¼Œé€šè¿‡<code>__repr__()</code>å¯ä»¥è‡ªå®šä¹‰<code>repr()</code>çš„è¿”å›å†…å®¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">In [4]: a = [1,2]</div><div class="line">In [8]: b = repr(a)</div><div class="line"></div><div class="line">In [9]: eval(b) == a</div><div class="line">Out[9]: True</div><div class="line"></div><div class="line">In [10]: eval(b) is a</div><div class="line">Out[10]: False</div></pre></td></tr></table></figure>
</li>
<li><p>reversed(seq)<br>è¿”å›ä¸€ä¸ªé€†åºçš„è¿­ä»£å™¨ã€‚å‚æ•°seqå¿…é¡»æ˜¯ä¸€ä¸ªå®ç°äº†<code>__reversed__()</code>æ–¹æ³•çš„å¯¹è±¡æˆ–è€…å®ç°äº†<code>__len__()</code>æ–¹æ³•å¹¶ä¸”<code>__getitem__()</code>æ–¹æ³•çš„å‚æ•°å¿…é¡»æ˜¯ä»0å¼€å§‹çš„æ•´å‹.</p>
</li>
<li><p>round(number[, ndigits])<br>å‚æ•°numberæ˜¯ä¸€ä¸ªæµ®ç‚¹å‹æ•°å­—ï¼Œndigitsç¼ºçœå€¼æ˜¯0ï¼Œroundçš„ä½œç”¨å°±æ˜¯ä¸€ä¸ªå››èˆäº”å…¥çš„è¿‡ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">In [18]: a = 1.554332</div><div class="line"></div><div class="line">In [19]: round(a)</div><div class="line">Out[19]: 2.0</div><div class="line"></div><div class="line">In [20]: round(a,1)</div><div class="line">Out[20]: 1.6</div><div class="line"></div><div class="line">In [21]: round(a,2)</div><div class="line">Out[21]: 1.55</div><div class="line"></div><div class="line">In [22]: round(a,3)</div><div class="line">Out[22]: 1.554</div></pre></td></tr></table></figure>
</li>
<li><p>class set([iterable]) ğŸ­<br>è¿”å›ä¸€ä¸ªsetå¯¹è±¡ï¼Œå‚æ•°iterableæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ã€‚</p>
</li>
<li>setattr(object, name, value)<br>è¿™ä¸ªæ–¹æ³•å’Œ<code>getattr()</code>æ˜¯ä¸€å¯¹ï¼Œå‚æ•°objectæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œnameæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œvalueå¯ä»¥æ˜¯ä»»æ„å€¼ã€‚nameå¯ä»¥æ˜¯ä¸€ä¸ªæ–°çš„å±æ€§åæˆ–è€…æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å±æ€§åã€‚<code>setattr(x,&#39;name&#39;,value)</code>ç­‰ä»·äº<code>x.name = value</code></li>
<li>class slice(stop)<br>class slice(start, stop[, step])</li>
<li>sorted(iterable[, cmp[, key[, reverse]]]) ğŸ…ï¸<br>pass</li>
<li><p>staticmethod(function)<br>staticmethodæ˜¯ä¸€ä¸ªè£…é¥°å™¨ï¼Œç”¨äºè£…èµ·ç±»ä¸­çš„static methodã€‚å®ƒä¸éœ€è¦ä¸€ä¸ªéšå¼çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">class C(object):</div><div class="line">   @staticmethod</div><div class="line">   def f(arg1, arg2, ...):</div><div class="line">       ...</div></pre></td></tr></table></figure>
<p>åœ¨è°ƒç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥ä½¿ç”¨<code>C.f(*args)</code>æˆ–è€…<code>C().f(*args)</code>.</p>
</li>
<li>class str(object=â€™â€™) ğŸ­<br>è¿”å›ä¸€ä¸ªstringç±»å‹çš„å¯¹è±¡ã€‚å®ƒå’Œrepr(object)æœ‰æ‰€ä¸åŒ,pass</li>
<li>sum(iterable[, start])<br>è¿”å›å¯è¿­ä»£å¯¹è±¡iterableä¸­æ‰€æœ‰å…ƒç´ çš„å’Œå†åŠ ä¸Šstartä¹‹åçš„ç»“æœã€‚startç¼ºçœå€¼æ˜¯0.å¹¶ä¸”é»˜è®¤è¦æ±‚iterableä¸­çš„å…ƒç´ ä¸€èˆ¬éƒ½ä¸ºæ•°å€¼å‹çš„ï¼Œstartä¸èƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚</li>
<li>super(type[, object-or-type])<br>pass</li>
<li>tuple([iterable]) ğŸ­<br>pass</li>
<li>class type(object)<br>class type(name, bases, dict)<br>pass</li>
<li>unichr(i)<br>pass</li>
<li>unicode(object=â€™â€™)<br>unicode(object[, encoding[, errors]])<br>pass</li>
<li>vars([object])<br>pass</li>
<li>xrange(stop)<br>xrange(start, stop[, step])<br>pass</li>
<li>zip([iterable, â€¦])<br>pass</li>
</ol>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> æ ‡å‡†åº“ </tag>
            
            <tag> æ–‡æ¡£ </tag>
            
            <tag> å†…å»ºå‡½æ•° </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[pythonä¸­@classmethodå’Œ@staticmethodçš„ç†è§£]]></title>
      <url>/2017/08/03/%E5%85%B3%E4%BA%8Epython%E7%9A%84@classmethod%E5%92%8C@staticmethod%E7%9A%84%E7%90%86%E8%A7%A3/</url>
      <content type="html"><![CDATA[<p>ä¸€ç›´å¯¹pythonä¸­@classmethodå’Œ@staticmethodçš„ç”¨æ³•å’ŒåŒºåˆ«ä¸æ˜¯å¾ˆç†è§£,ä¸€é¡¿googleä¹‹åå‘ç°è¿˜æ˜¯stackoverflowçœŸçš„æ˜¯ç¨‹åºå‘˜çš„å¥½æœ‹å‹.åœ¨è¿™ä¸ªé—®é¢˜<a href="https://stackoverflow.com/questions/12179271/meaning-of-classmethod-and-staticmethod-for-beginner" target="_blank" rel="external">Meaning of @classmethod and @staticmethod for beginner?</a>ä¸­,å‡ ä¸ªå¤§ç¥çš„å›ç­”è¿˜æ˜¯å¾ˆå¥½çš„.</p>
<a id="more"></a>
<h1 id="Rostyslav-Dzinkoè¿™æ ·è¯´"><a href="#Rostyslav-Dzinkoè¿™æ ·è¯´" class="headerlink" title="@Rostyslav Dzinkoè¿™æ ·è¯´"></a><a href="https://stackoverflow.com/users/789649/rostyslav-dzinko" target="_blank" rel="external">@Rostyslav Dzinko</a>è¿™æ ·è¯´</h1><p>è™½ç„¶classmethodå’Œstaticmethodååˆ†ç›¸ä¼¼,ä½†ä»–ä»¬ä¹‹é—´ç¡®å®å­˜åœ¨ä¸€äº›ç»†å¾®çš„å·®åˆ«:classmethodå¿…é¡»æœ‰ä¸€ä¸ªç±»å¯¹è±¡ä½œä¸ºæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°,ç„¶è€Œstaticmethodå´å¯ä»¥ä¸éœ€è¦å‚æ•°.<br>ä¸‹é¢ğŸ‘‡,ä¸¾ä¸ªä¾‹å­ğŸŒ°:</p>
<h2 id="æ ·æ¿ä»£ç "><a href="#æ ·æ¿ä»£ç " class="headerlink" title="æ ·æ¿ä»£ç "></a>æ ·æ¿ä»£ç </h2><p>å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»æ¥å¤„ç†å’Œæ—¥æœŸç›¸å…³çš„ä¿¡æ¯:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class Date(object):</div><div class="line"></div><div class="line">    def __init__(self, day=0, month=0, year=0):</div><div class="line">        self.day = day</div><div class="line">        self.month = month</div><div class="line">        self.year = year</div></pre></td></tr></table></figure></p>
<p>æ˜¾ç„¶,è¿™ä¸ªç±»èƒ½å¤Ÿå­˜å‚¨ä¸€äº›æ—¥æœŸç›¸å…³çš„ä¿¡æ¯,é€šè¿‡<strong>init</strong>æ–¹æ³•,æˆ‘ä»¬ä¼ å…¥day,monthå’Œyearèƒ½å¤Ÿå®ä¾‹åŒ–ä¸€ä¸ªDateå¯¹è±¡,å…¶ä¸­<strong>init</strong>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°selfå°±ä»£è¡¨æˆ‘ä»¬æ–°å»ºçš„Dateå®ä¾‹.</p>
<h2 id="Class-Method"><a href="#Class-Method" class="headerlink" title="Class Method"></a>Class Method</h2><p>é€šè¿‡@classmethodæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒä¼˜é›…çš„å®Œæˆä¸€äº›ä»»åŠ¡.å¦‚æœä»…ä»…é€šè¿‡<strong>init</strong>æ–¹æ³•æ¥å®ŒæˆDateç±»çš„å®ä¾‹åŒ–,å°±å¿…é¡»è¿™æ ·å®ç°:<code>x = Date(day,month,year)</code>.å¦‚æœç°åœ¨æƒ³è¦å°†ä¸€ä¸ªæ—¥æœŸçš„å­—ç¬¦ä¸²å½¢å¼(â€˜dd-mm-yyâ€™)è½¬ä¸ºDateå¯¹è±¡,æˆ‘ä»¬éœ€è¦å®Œæˆè¿™ä¸¤ä¸ªæ­¥éª¤:</p>
<ol>
<li>å°†å­—ç¬¦ä¸²è½¬ä¸ºday,month,yearä¸‰ä¸ªæ•´å‹å¯¹è±¡æˆ–è€…ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå€¼çš„å…ƒç»„;</li>
<li>é€šè¿‡<strong>init</strong>æ–¹æ³•å®ŒæˆDateå¯¹è±¡çš„å®ä¾‹åŒ–.<br>ä¸Šè¾¹çš„ä¸¤æ­¥å®ç°è¿‡ç¨‹å°±åƒè¿™æ ·:<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">day, month, year = map(int, string_date.split(&apos;-&apos;))</div><div class="line">date1 = Date(day, month, year)</div></pre></td></tr></table></figure>
</li>
</ol>
<p>åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­,ä»¥c++ä¸ºä¾‹,å®ƒå¯ä»¥é‡æ„è‡ªå·±çš„æ„é€ å‡½æ•°æ¥æ¥å—æŸä¸ªæ—¥æœŸçš„å­—ç¬¦ä¸²å½¢å¼æœ€ç»ˆè¿”å›ä¸€ä¸ªDateå®ä¾‹.ä½†æ˜¯pythonæ²¡æœ‰è¿™æ ·çš„ç‰¹æ€§,äºæ˜¯classmethodå°±åœ¨è¿™é‡Œæ´¾ä¸Šäº†ç”¨åœº:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@classmethod</div><div class="line">    def from_string(cls, date_as_string):</div><div class="line">        day, month, year = map(int, date_as_string.split(&apos;-&apos;))</div><div class="line">        date1 = cls(day, month, year)</div><div class="line">        return date1</div><div class="line">date2 = Date.from_string(&apos;11-09-2012&apos;)</div></pre></td></tr></table></figure></p>
<p>ä¸Šè¾¹åˆ©ç”¨classmethodæ¥å®Œæˆå°†å­—ç¬¦ä¸²è½¬ä¸ºDateå®ä¾‹ä¸»è¦æœ‰è¿™äº›ä¼˜åŠ¿:</p>
<ol>
<li>å°†å­—ç¬¦ä¸²è½¬åŒ–çš„è¿‡ç¨‹æ”¾åœ¨ç±»ä¸­,å¹¶ä¸”èƒ½å¤Ÿé‡ç”¨;</li>
<li>å°è£…çš„è¾ƒå¥½,ç¬¦åˆé¢å‘å¯¹è±¡æ€æƒ³;</li>
<li>classmethodä¸­çš„clsä»£è¡¨Date,å®ƒä¸æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹,å°±æ˜¯ç±»å¯¹è±¡æœ¬èº«,å¦‚æœæˆ‘ä»¬æ´¾ç”Ÿäº†å…¶ä»–çš„å­ç±»,å®ƒä»¬ä¹Ÿéƒ½èƒ½ç»§æ‰¿from_stringæ–¹æ³•.</li>
</ol>
<h2 id="Static-Method"><a href="#Static-Method" class="headerlink" title="Static Method"></a>Static Method</h2><p>è¯´å®Œäº†classmethod,æ¥ç€å” ä¸€å” staticmethod.å®ƒå…¶å®å’Œclassmethodååˆ†ç›¸ä¼¼,ä½†æ˜¯å®ƒä¸éœ€è¦åƒç±»æ–¹æ³•æˆ–è€…æ™®é€šçš„å®ä¾‹æ–¹æ³•ä¸€æ ·éœ€è¦å¿…é¡»çš„å‚æ•°(clsæˆ–è€…self).<br>å†ä¸¾ä¸ªä¾‹å­ğŸŒ°:<br>é€šè¿‡classmethodæˆ‘ä»¬å®Œæˆäº†å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬ä¸ºDateå®ä¾‹çš„è¿‡ç¨‹,ç°åœ¨ç»™æˆ‘ä»¬ä¸€ä¸ªå­—ç¬¦ä¸²,åœ¨ä½¿ç”¨Date.from_string(â€˜strâ€™)ç”Ÿæˆå®ä¾‹ä¹‹å‰,åˆ¤æ–­è¿™ä¸ªstræ˜¯å¦æ»¡è¶³è¦æ±‚.<br>å¾ˆæ˜¾ç„¶,è¿™ä¸ªæ–¹æ³•å’Œç±»Dateæœ‰å¯†åˆ‡çš„è”ç³»,ä½†ä»…ä»…åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ»¡è¶³è½¬æ¢çš„è¦æ±‚,å¹¶ä¸éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªDateå¯¹è±¡,è¿™æ—¶å€™staticmethodå°±å¯ä»¥æ´¾ä¸Šç”¨åœº:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@staticmethod</div><div class="line">    def is_date_valid(date_as_string):</div><div class="line">        day, month, year = map(int, date_as_string.split(&apos;-&apos;))</div><div class="line">        return day &lt;= 31 and month &lt;= 12 and year &lt;= 3999</div><div class="line"></div><div class="line"># usage:</div><div class="line">is_date = Date.is_date_valid(&apos;11-09-2012&apos;)</div></pre></td></tr></table></figure></p>
<p>ä¹Ÿå°±æ˜¯è¯´,staticmethodå¯ä»¥åƒä¸€ä¸ªæ™®é€šçš„æ–¹æ³•è¢«è°ƒç”¨,å®ƒä¸è¿™ä¸ªç±»æœ‰æ˜ç¡®çš„ç›¸å…³æ€§,ä½†æ˜¯ä¸éœ€è¦è®¿é—®è¿™ä¸ªç±»å†…éƒ¨çš„å±æ€§æˆ–è€…æ–¹æ³•.</p>
<h1 id="Yaw-Boakyeè¡¥å……è¯´"><a href="#Yaw-Boakyeè¡¥å……è¯´" class="headerlink" title="@Yaw Boakyeè¡¥å……è¯´"></a><a href="https://stackoverflow.com/users/1248059/yaw-boakye" target="_blank" rel="external">@Yaw Boakye</a>è¡¥å……è¯´</h1><p>Rostyslav Dzinkoè¯´çš„éå¸¸å¥½,ä¸è¿‡ä»–(Yaw Boakye)ä»å¦å¤–ä¸€ä¸ªæ–¹é¢å¯¹classmethodå’Œstaticmethodçš„åŒºåˆ«åšäº†è¡¥å……:<br>åœ¨ä¸Šè¾¹çš„ä¾‹å­ä¸­,ä½¿ç”¨@classmethod from_stringä½œä¸ºä¸€ä¸ªç”ŸæˆDateå®ä¾‹çš„å·¥å‚,ç„¶è€Œé€šè¿‡@staticmethodä¹Ÿå¯ä»¥å®Œæˆç±»ä¼¼çš„æ“ä½œ:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">class Date:</div><div class="line">	def __init__(self, month, day, year):</div><div class="line">    	self.month = month</div><div class="line">    	self.day   = day</div><div class="line">    	self.year  = year</div><div class="line"></div><div class="line"></div><div class="line">  	def display(self):</div><div class="line">    	return &quot;&#123;0&#125;-&#123;1&#125;-&#123;2&#125;&quot;.format(self.month, self.day, self.year)</div><div class="line"></div><div class="line"></div><div class="line">  	@staticmethod</div><div class="line">  	def millenium(month, day):</div><div class="line">    	return Date(month, day, 2000)</div><div class="line"></div><div class="line">new_year = Date(1, 1, 2013)               # Creates a new Date object</div><div class="line">millenium_new_year = Date.millenium(1, 1) # also creates a Date object. </div><div class="line"></div><div class="line"># Proof:</div><div class="line">new_year.display()           # &quot;1-1-2013&quot;</div><div class="line">millenium_new_year.display() # &quot;1-1-2000&quot;</div><div class="line"></div><div class="line">isinstance(new_year, Date) # True</div><div class="line">isinstance(millenium_new_year, Date) # True</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡@staticmethod milleniumæˆ‘ä»¬ç°åœ¨ä¹Ÿå¯ä»¥ç”Ÿæˆç±»ä¼¼äºå·¥å‚å‡½æ•°@classmethod from_stringçš„åŠŸèƒ½,ç”ŸæˆDateå®ä¾‹.ä½†æ˜¯è¿™æ ·çš„å®ç°å´æœ‰ç‚¹ç¡¬ç¼–ç çš„å«Œç–‘,å› ä¸º@staticmethod milleniumçš„æœ€ç»ˆè¿”å›ç»“æœæ˜¯é€šè¿‡<code>return Date(month, day, 2000)</code>è¿™å¥ä»£ç å®ç°çš„,ä¹Ÿå°±æ˜¯è¯´å®ƒæ˜ç¡®äº†è¿”å›å¯¹è±¡å°±æ˜¯å°±æ˜¯ä¸€ä¸ªDateçš„å®ä¾‹.<br>ä¸‹é¢æˆ‘ä»¬æ´¾ç”Ÿä¸€ä¸ªDateçš„å­ç±»DateTime:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">class DateTime(Date):</div><div class="line">  def display(self):</div><div class="line">      return &quot;&#123;0&#125;-&#123;1&#125;-&#123;2&#125; - 00:00:00PM&quot;.format(self.month, self.day, self.year)</div><div class="line"></div><div class="line">datetime1 = DateTime(10, 10, 1990)</div><div class="line">datetime2 = DateTime.millenium(10, 10)</div><div class="line"></div><div class="line">datetime1.display() # returns &quot;10-10-1990 - 00:00:00PM&quot;</div><div class="line">datetime2.display() # returns &quot;10-10-2000&quot;</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>datetime1.display()</code>çš„è¿”å›å€¼<code>&quot;10-10-1990 - 00:00:00PM&quot;</code>è€Œ<code>datetime2.display()</code>çš„è¿”å›å€¼æ˜¯<code>returns &quot;10-10-2000&quot;</code>,è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼ŸåŸå› åœ¨äºdatetime1å’Œdatetime2å®ä¾‹åˆ›å»ºçš„æ–¹æ³•æ˜¯ä¸åŒçš„:</p>
<ol>
<li>datetime1é€šè¿‡DateTimeçš„<strong>init</strong>æ–¹æ³•ç”Ÿæˆ <code>isinstance(datetime1, DateTime) # True</code></li>
<li>datetime2é€šè¿‡DateTime.milleniumæ–¹æ³•ç”Ÿæˆ    <code>isinstance(datetime2, DateTime) # False</code></li>
</ol>
<p>è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°@staticmethodå’Œ@classmethodçš„ä¸€äº›ä¸åŒ,å°†milleniumä½¿ç”¨@classmethodé‡å†™:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@classmethod</div><div class="line">def millenium(cls, month, day):</div><div class="line">    return cls(month, day, 2000)</div></pre></td></tr></table></figure></p>
<p>è¿™é‡Œçš„clsæ›¿ä»£äº†ä¹‹å‰çš„Date,å®ƒå¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªæ´¾ç”Ÿå‡ºæ¥çš„å­ç±»,milleniumè¿”å›çš„å®ä¾‹å½“ç„¶ä¹Ÿæ˜¯å¯¹åº”çš„clsçš„å®ä¾‹.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">datetime1 = DateTime(10, 10, 1990)</div><div class="line">datetime2 = DateTime.millenium(10, 10)</div><div class="line"></div><div class="line">isinstance(datetime1, DateTime) # True</div><div class="line">isinstance(datetime2, DateTime) # True</div><div class="line"></div><div class="line"></div><div class="line">datetime1.display() # &quot;10-10-1990 - 00:00:00PM&quot;</div><div class="line">datetime2.display() # &quot;10-10-2000 - 00:00:00PM&quot;</div></pre></td></tr></table></figure></p>
<h2 id="å°å°çš„æ€»ç»“ä¸€ä¸‹"><a href="#å°å°çš„æ€»ç»“ä¸€ä¸‹" class="headerlink" title="å°å°çš„æ€»ç»“ä¸€ä¸‹"></a>å°å°çš„æ€»ç»“ä¸€ä¸‹</h2><p>é€šè¿‡è¿™ä¸¤ä¸ªå¾ˆç²¾å½©çš„è§£é‡Š,ç°åœ¨å¯¹@classmethodå’Œ@staticmethodæœ‰äº†è¿›ä¸€æ­¥çš„ç†è§£:</p>
<ol>
<li>@classmethod,ç”±äºå…¶å¼ºåˆ¶è¦æ±‚æœ‰clså‚æ•°å­˜åœ¨,å¯ä»¥æ›´å¤šçš„ç”¨äºå½“ä½œä¸€ä¸ªç±»å®ä¾‹å·¥å‚ğŸ­,æˆ–è€…å¯ä»¥ä½œä¸ºä¸€ä¸ªå¯ä»¥ç”¨äºæ´¾ç”Ÿç±»ä¸­çš„æ„é€ å‡½æ•°;</li>
<li>@staticmethod,å¦‚æœä¸€ä¸ªæ–¹æ³•ä¸éœ€è¦ä½¿ç”¨ç±»å†…éƒ¨çš„å±æ€§å’Œæ–¹æ³•,ä½†ç¡®å®å’Œç±»æœ‰æ˜ç¡®çš„ç›¸å…³æ€§,å®ƒå°±å¯ä»¥ä½¿ç”¨@staticmethodæ¥ä¿®é¥°.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> oop </tag>
            
            <tag> classmethod </tag>
            
            <tag> staticmethod </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mongodbæœ€è¿‘é¢‘ç¹çœ‹çš„æ–‡æ¡£]]></title>
      <url>/2017/07/25/mongodb%E6%9C%80%E8%BF%91%E9%A2%91%E7%B9%81%E9%9C%80%E8%A6%81%E7%9C%8B%E7%9A%84%E6%96%87%E6%A1%A3/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å¤„ç†çˆ¬åˆ°çš„ç›´æ’­ç½‘ç«™æ•°æ®ï¼Œç”±äºå°†è‡ªå·±éœ€è¦çš„æ•°æ®éƒ½å­˜åœ¨äº†ä¸€ä¸ªcollectioné‡Œè¾¹ï¼Œåœ¨æä¾›apiçš„æ—¶å€™éœ€è¦å„ç§æ“ä½œæ•°æ®ï¼Œç»å¸¸ç”¨åˆ°mongodbçš„aggreationï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªæ–‡æ¡£å°±ç»å¸¸éœ€è¦æ‰“å¼€ï¼Œè¿™é‡Œä¹Ÿåšä¸ªè®°å½•:</p>
<ul>
<li><a href="https://docs.mongodb.com/manual/reference/operator/aggregation/" target="_blank" rel="external">ç®¡é“æ“ä½œç¬¦åˆç®¡é“è¡¨è¾¾å¼</a></li>
<li><a href="https://docs.mongodb.com/manual/core/views/" target="_blank" rel="external">mongodb3.4 read-only view</a></li>
</ul>
]]></content>
      
        <categories>
            
            <category> mongodb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> aggregation </tag>
            
            <tag> read-only View </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[celeryå’Œfabricçš„ä½¿ç”¨]]></title>
      <url>/2017/07/19/celery%E5%92%8Cfabric%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>å¾ˆæ—©å°±å¬è¯´<a href="http://www.celeryproject.org/" target="_blank" rel="external">celery</a>å’Œ<a href="http://www.fabfile.org/" target="_blank" rel="external">fabric</a>è¿™ä¸¤ä¸ªç¥å™¨,æœ€è¿‘åŒæ—¶åœ¨åšä¸¤ä¸ªè‡ªå·±çš„å°é¡¹ç›®ï¼Œæ›´æ–°æ¯”è¾ƒé¢‘ç¹ï¼Œä¸€éä¸€éæ‰‹åŠ¨éƒ¨ç½²å¤ªè¿‡åƒµç¡¬ï¼Œæ‰€ä»¥æ‰çœŸæ­£ç”¨åˆ°äº†è¿™ä¿©å¥½ä¸œè¥¿ã€‚<br><a id="more"></a></p>
<h1 id="celery"><a href="#celery" class="headerlink" title="celery"></a>celery</h1><p>åœ¨ç”¨åˆ°celeryä¹‹å‰ï¼Œå¦‚æœæœ‰å®šæ—¶ä»»åŠ¡è¿™æ ·çš„éœ€æ±‚ï¼Œæˆ‘ä¸€èˆ¬éƒ½æ˜¯ç›´æ¥å†™crontabï¼Œä½†æ˜¯å¦‚æœå•ä¸ªä»»åŠ¡æ—¶é—´æ¶ˆè€—è¾ƒé•¿çš„è¯ï¼Œä½¿ç”¨celeryå°±å¯ä»¥è®©é•¿æ—¶é—´æ¶ˆè€—çš„ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œï¼Œé¿å…ç¨‹åºä¸»çº¿ç¨‹çš„é˜»å¡ã€‚å¦å¤–ä¸€ç‚¹ï¼Œceleryç»“åˆ<a href="http://flower.readthedocs.io/en/latest/" target="_blank" rel="external">flower</a>è¿™ä¸ªceleryç›‘æ§å·¥å…·ï¼Œèƒ½å¤Ÿè®©ä½ çœ‹åˆ°è‡ªå·±çš„ä»»åŠ¡æ‰§è¡ŒçŠ¶å†µã€‚</p>
<p>celeryä½œä¸ºä¸€ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦æ¨¡å—ï¼Œå®ƒæ‹¥æœ‰ç‹¬ç«‹çš„èŒç¨‹ï¼ˆWorkerï¼‰è¿›ç¨‹æŒç»­ç›‘è§†é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰éœ€è¦å¤„ç†çš„æ–°ä»»åŠ¡ï¼Œæ˜¯å¦æœ‰è¦å¤„ç†çš„ä»»åŠ¡åˆ™å–å†³äºä¸­é—´äººï¼ˆBrokerï¼‰åœ¨å®¢æˆ·ç«¯å’ŒèŒç¨‹é—´æ–¡æ—‹ã€‚Brokerä»å®¢æˆ·ç«¯å‘é˜Ÿåˆ—æ·»åŠ æ¶ˆæ¯ï¼Œä¹‹åBrokeræŠŠæ¶ˆæ¯æ´¾é€ç»™Workerã€‚<br>åœ¨çœŸæ­£ä½¿ç”¨çš„æ—¶å€™ï¼Œä¹Ÿä¸ä¼šæœ‰å¤šå°‘éš¾åº¦ã€‚</p>
<ol>
<li><p>å®‰è£…celery</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install celery</div></pre></td></tr></table></figure>
</li>
<li><p>é€‰æ‹©ä¸€ä¸ªä¸­é—´äººï¼Œæˆ‘ç›´æ¥ç”¨redisï¼Œæ¯”è¾ƒæ–¹ä¾¿</p>
</li>
<li><p>æ–°å»ºcelery appï¼Œdouyu_app.pyæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">from celery import Celery</div><div class="line">import celery_douyu_config	# celeryé…ç½®</div><div class="line"></div><div class="line"></div><div class="line">app = Celery(&apos;douyuapp&apos;, include=[&apos;task_douyu&apos;])	# task_douyuä¸ºceleryä»»åŠ¡</div><div class="line">app.config_from_object(&apos;celery_douyu_config&apos;)</div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    app.start()</div></pre></td></tr></table></figure>
</li>
<li><p>æ–°å»ºä»»åŠ¡task_douyu.pyæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from douyu_app import app</div><div class="line">from collector.danmu.CDouyu import Douyu</div><div class="line"></div><div class="line"></div><div class="line">@app.task</div><div class="line">def SAVE_DOUYU_DATA():</div><div class="line">    douyu = Douyu()</div><div class="line">    douyu.getRoomInfos()</div></pre></td></tr></table></figure>
</li>
<li><p>celeryé…ç½®celery_douyu_config.pyæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">from celery.schedules import crontab</div><div class="line"></div><div class="line">BROKER_URL = &apos;redis://127.0.0.1:6379/2&apos;		# ä»»åŠ¡å‘å¸ƒé˜Ÿåˆ—</div><div class="line">CELERY_RESULT_BACKEND = &apos;redis://127.0.0.1:6379/3&apos;		# ä»»åŠ¡æ‰§è¡Œç»“æœå­˜å‚¨</div><div class="line"></div><div class="line">CELERY_TIMEZONE = &apos;Asia/Shanghai&apos; 	# æ—¶åŒºé€‰æ‹©</div><div class="line"></div><div class="line">CELERYBEAT_SCHEDULE = &#123;								</div><div class="line">    &apos;SAVE_DOUYU_ROOMINFO&apos;: &#123; 	# ä»»åŠ¡åç§°</div><div class="line">        &apos;task&apos;: &apos;task_douyu.SAVE_DOUYU_DATA&apos;, 	# å…·ä½“ä»»åŠ¡ task_douyu.SAVE_DOUYU_DATA æ˜¯ä¸€ä¸ªçœŸæ­£è¦æ‰§è¡Œçš„ä»»åŠ¡</div><div class="line">        &apos;schedule&apos;: crontab(minute=[40]), 	# ä»»åŠ¡è®¡åˆ’æ—¶é—´ï¼Œæ¯å°æ—¶40åˆ†çš„æ—¶å€™æ‰§è¡Œ</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>è¿è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">celery -A douyu_app worker -B --loglevel=info</div></pre></td></tr></table></figure>
</li>
</ol>
<p>è¿™é‡Œçš„-Bä¸»è¦ç”¨äºceleryå®šæ—¶ä»»åŠ¡ï¼Œé€šè¿‡heartbeatæ¥é€šçŸ¥Workeræ˜¯å¦æœ‰ä»»åŠ¡éœ€è¦æ‰§è¡Œã€‚</p>
<p>æˆ‘è¿™é‡Œåªæ˜¯ç®€å•çš„ç”¨äº†ä¸€ä¸‹celeryï¼Œå¹¶ä¸”åªç”¨åˆ°äº†å®šæ—¶ä»»åŠ¡ï¼Œceleryä½œä¸ºä¸€æ¬¾åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å·¥å…·ï¼Œè‚¯å®šä¼šæœ‰æ›´å¤šæ›´å‰å®³çš„ç”¨æ³•ï¼Œç•™å¾…ä»¥åç”¨åˆ°çš„æ—¶å€™å†ç ”ç©¶ã€‚</p>
<h1 id="fabric"><a href="#fabric" class="headerlink" title="fabric"></a>fabric</h1><p>ä¹‹æ‰€ä»¥ç”¨åˆ°fabricè¿˜æ˜¯å› ä¸ºè‡ªå·±æ¯”è¾ƒæ‡’ï¼Œå‰è¾¹è¯´åˆ°æœ€è¿‘åœ¨é¢‘ç¹æ›´æ–°ä¸¤ä¸ªå°é¡¹ç›®ï¼Œè¿™ä¸¤ä¸ªé¡¹ç›®éƒ½æœ‰å‘å¤–æä¾›apiæ•°æ®æœåŠ¡çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥æ¯æ¬¡ä¿®æ”¹ä»£ç ï¼Œè¿è¡Œæµ‹è¯•ï¼Œæäº¤ä»£ç ï¼Œsshåˆ°è¿œç¨‹ä¸»æœºpullæœ€æ–°ä»£ç ï¼Œæ€æ­»åŸå…ˆæœåŠ¡è¿›ç¨‹ï¼Œnohupæœ€æ–°æœåŠ¡ã€‚è¿™ä¸ªé“¾è·¯è¿˜æ˜¯æ¯”è¾ƒé•¿çš„ï¼Œå¹¶ä¸”æœ‰ä¸ªé¡¹ç›®é•¿æœŸçš„çˆ¬å–ç½‘ç»œæ•°æ®ï¼Œç„¶åå­˜å‚¨åœ¨mongodbä¸­ï¼Œè‡ªå·±çš„ä½é…äº‘ä¸»æœºç¡¬ç›˜æœ‰é™ï¼Œéœ€è¦ä¸å®šæœŸåœ°å°†æ•°æ®è¿ç§»å‡ºæ¥ï¼Œæ‰€ä»¥æƒ³åˆ°äº†fabricè¿™ä¸ªå¥½ä¸œè¥¿ï¼Œåº”è¯¥å¯ä»¥æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ï¼Œè‡ªåŠ¨åŒ–å®Œæˆä¸Šè¿°æ•´ä¸ªä»»åŠ¡é“¾è·¯ã€‚</p>
<ol>
<li><p>å®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install fabric</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºfabfile.py(é»˜è®¤ä½¿ç”¨è¿™ä¸ªåå­—ï¼Œå¦‚æœæƒ³è¦è‡ªå®šä¹‰ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™fab -f xxx.pyä¹Ÿæ˜¯å¯ä»¥çš„)</p>
</li>
<li><p>é…ç½®è¿œç¨‹ä¸»æœº<br>fabricæ˜¯é€šè¿‡sshçš„æ–¹å¼ç™»å½•åˆ°è¿œç¨‹ä¸»æœºçš„ï¼Œå¯ä»¥é€šè¿‡ç”¨æˆ·å/å¯†ç çš„æ–¹å¼æˆ–è€…æ˜¯é€šè¿‡å¯†é’¥çš„å½¢å¼ï¼Œå› ä¸ºä¹Ÿå°±ä¸‰å°ä¸»æœºï¼Œä¹Ÿéƒ½æ˜¯è‡ªå·±çš„æœºå™¨ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨å¯†é’¥ç™»é™†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># é…ç½®~/.ssh/config</div><div class="line">Host host_name</div><div class="line">	HostName ip or domain</div><div class="line">	User user </div><div class="line">	IdentityFile ~/.ssh/id_rsa</div><div class="line"></div><div class="line"># åœ¨fabfileä¸­å¢åŠ ç›¸å…³é…ç½®</div><div class="line">env.use_ssh_config = True</div><div class="line">env.hosts = [&apos;al&apos;, &apos;al1&apos;]  # è¿™é‡Œçš„åå­—å°±æ˜¯configä¸­çš„host_name</div><div class="line">env.roledefs = &#123;		   # ä¸åŒçš„ä¸»æœºè¦æ˜¯æœ‰ä¸åŒçš„ä»»åŠ¡ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šroleæ¥è¿›è¡ŒåŒºåˆ†</div><div class="line">    &apos;douyu&apos;: [&apos;al&apos;],	   </div><div class="line">    &apos;other&apos;: [&apos;al1&apos;],</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>æ·»åŠ è¿è¡Œæµ‹è¯•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@task</div><div class="line">def run_test():</div><div class="line">    with settings(warn_only=True):</div><div class="line">        result = local(&apos;python tester.py&apos;, capture=True)</div><div class="line">    if result.failed and not confirm(&quot;Tests failed. Continue anyway?&quot;):</div><div class="line">        abort(&quot;Aborting at user request.&quot;)</div></pre></td></tr></table></figure>
</li>
<li><p>æäº¤ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@runs_once</div><div class="line">@task</div><div class="line">def pre_deploy():</div><div class="line">    local(&apos;git add -A &amp;&amp; git commit&apos;)</div><div class="line">    local(&apos;git push origin master &amp;&amp; git push tx master&apos;)</div></pre></td></tr></table></figure>
</li>
<li><p>æ›´æ–°ä»£ç ï¼Œå‘å¸ƒæ–°çš„æœåŠ¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">def deploy_code(cmd):</div><div class="line">    code_dir = &apos;~/git/Hotroom&apos;</div><div class="line">    with settings(warn_only=True):</div><div class="line">        if run(&quot;ls &#123;&#125;&quot;.format(code_dir)).failed:</div><div class="line">            run(&quot;git clone hhttps://github.com/love3forever/Hotroom.git &#123;&#125;&quot;.format(code_dir))</div><div class="line">    with cd(code_dir):</div><div class="line">        run(&quot;git pull&quot;)</div><div class="line">        run(&quot;sudo pip install -r ./requirement.txt&quot;)</div><div class="line">        with cd(&apos;./hotroom&apos;):</div><div class="line">            pids = run(</div><div class="line">                &quot;ps -ef | grep celery | grep -v grep | awk &apos;&#123;print $2&#125;&apos;&quot;)</div><div class="line">            if pids:</div><div class="line">                pid_list = pids.split(&apos;\r\n&apos;)</div><div class="line">                for i in pid_list:</div><div class="line">                    with settings(warn_only=True):</div><div class="line">                        run(&apos;kill -9 %s&apos; % i)</div><div class="line">            run(&apos;pwd&apos;)</div><div class="line">            run(&quot;(nohup celery -A &#123;&#125; worker -B --loglevel=error &gt;&amp; /dev/null &lt; /dev/null &amp;) &amp;&amp; sleep 1&quot;.format(cmd))</div><div class="line">            run(&apos;echo deployed&apos;)</div></pre></td></tr></table></figure>
</li>
<li><p>å¤‡ä»½è¿˜åŸæ•°æ®åº“ï¼Œæ¸…ç©ºæ•°æ®åº“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">def dump(db):</div><div class="line">    stamp = datetime.now().strftime(&apos;%y_%m_%d_%H_%M&apos;)</div><div class="line">    cd_dir = &apos;~/tars/dump/&apos;</div><div class="line">    dump_dir = &apos;~/tars/dump/dump_&#123;&#125;&apos;.format(stamp)</div><div class="line">    dump_tar = &apos;dump_&#123;&#125;.tar.gz&apos;.format(stamp)</div><div class="line">    local_dir = &apos;/Users/eclipse/Downloads/mongo34/dump/&apos;</div><div class="line">    local_tar_dir = &apos;/Users/eclipse/Downloads/mongo34/dump/dump_&#123;&#125;&apos;.format(</div><div class="line">        stamp)</div><div class="line">    local_dump_dir = &apos;/Users/eclipse/Downloads/mongo34/dump/dump_&#123;&#125;.tar.gz&apos;.format(</div><div class="line">        stamp)</div><div class="line">    with settings(warn_only=True):</div><div class="line">        run(&apos;mkdir -p &#123;&#125;&apos;.format(dump_dir))</div><div class="line">        run(&apos;mongodump -d &#123;&#125; -c Roominfo -o &#123;&#125; --gzip&apos;.format(db, dump_dir))</div><div class="line">    with cd(cd_dir):</div><div class="line">        run(&apos;ls&apos;)</div><div class="line">        run(&apos;tar -zcvf &#123;&#125; &#123;&#125;&apos;.format(dump_tar, &apos;dump_&#123;&#125;&apos;.format(stamp)))</div><div class="line">    with settings(warn_only=True):</div><div class="line">        get(&apos;~/tars/dump/&#123;&#125;&apos;.format(dump_tar), local_dir)</div><div class="line">        run(&apos;echo current db:&#123;&#125;&apos;.format(db))</div><div class="line">        run(&apos;mongo&apos;)</div><div class="line">        local(&apos;mkdir -p &#123;&#125;&apos;.format(local_tar_dir))</div><div class="line">        local(&apos;tar -zxvf &#123;&#125; -C &#123;&#125;&apos;.format(local_dump_dir, local_dir))</div><div class="line">        local(&apos;/Users/eclipse/Downloads/mongo34/bin/mongorestore --dir=&#123;&#125; \</div><div class="line">            --gzip&apos;.format(local_tar_dir))</div></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>ç›®å‰éƒ½åªç”¨åˆ°äº†è¿™ä¸¤ä¸ªåº“çš„ä¸€ç‚¹ç‚¹åŠŸèƒ½ï¼Œç›¸ä¿¡åœ¨ä»¥åçš„å·¥ä½œä¸­ä¼šè®©è¿™ä¿©åº“æœ‰æ›´å¤šçš„ä½œç”¨ï¼</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> celery </tag>
            
            <tag> fabric </tag>
            
            <tag> è‡ªåŠ¨åŒ– </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è¿‘æœŸçš„ä¸€äº›æ€»ç»“]]></title>
      <url>/2017/07/09/%E6%9C%80%E8%BF%91%E5%85%B3%E4%BA%8Epython%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>æ˜¨å¤©çœ‹åˆ°è‡ªå·±æ‰‹æœºä¸Šwunderlistä¸Šçš„æç¤ºâ€œç²¾é€špythonâ€ï¼Œä»»åŠ¡æ˜¯å»å¹´åŒä¸€æ—¶é—´å»ºç«‹çš„ã€‚é‚£æ—¶å€™æˆ‘æ‰åˆšåˆšæ¯•ä¸šï¼Œè¿˜æ²¡å»å•ä½æŠ¥é“ï¼Œåœ¨å®¶é‡Œæ‰¾äº†ä¸ªç»ƒæ‰‹é¡¹ç›®ï¼Œé€æ­¥å­¦ä¹ pythonç›¸å…³çš„ä¸œè¥¿ï¼šçˆ¬è™«ã€webæ¡†æ¶ã€æœºå™¨å­¦ä¹ ç­‰å„æ–¹é¢ï¼Œé‚£æ—¶å€™æƒ³ç€è¦æ˜¯ç”¨ä¸€å¹´çš„æ—¶é—´å¥½å¥½æ¥å­¦ï¼Œåº”è¯¥å¯ä»¥è¾¾åˆ°ç²¾é€šçš„ç¨‹åº¦äº†ã€‚<br>ç°åœ¨å›è¿‡å¤´æ¥çœ‹ï¼Œè™½ç„¶æ²¡æœ‰è¾¾åˆ°è‡ªå·±é¢„æƒ³çš„â€œç²¾é€šâ€ï¼Œä½†è¿™ä¸€å¹´è¿˜ç®—å……å®ï¼Œè‡³å°‘ä¸æ˜¯è™šåº¦æ—¶å…‰ï¼Œå•æ˜¯é’ˆå¯¹pythonç›¸å…³çš„ä¸œè¥¿ï¼Œè‡ªå·±ä¹Ÿæ˜¯ä»æ–¹æ–¹é¢é¢ç”¨äº†ä¸å°‘æ—¶é—´æ¥å­¦ä¹ ã€ç»ƒä¹ ã€æ€è€ƒã€‚<br><a id="more"></a></p>
<h1 id="è¯»å¥½ä¹¦"><a href="#è¯»å¥½ä¹¦" class="headerlink" title="è¯»å¥½ä¹¦"></a>è¯»å¥½ä¹¦</h1><p>å¯¹äºæˆ‘æ¥è¯´ï¼Œå¦‚æœæƒ³è¦æ¥è§¦ä¸€é—¨æ–°æŠ€æœ¯ï¼Œæˆ‘ä¼šå…ˆå»å®ƒçš„å®˜ç½‘åšåˆæ­¥çš„äº†è§£ï¼ˆä¸»è¦äº†è§£å®ƒçš„ä¸»è¦ç”¨é€”ã€ç›¸å…³ç”Ÿæ€åœˆçŠ¶å†µï¼‰ï¼Œç„¶ååœ¨ç½‘ä¸Šçœ‹ä¸€äº›å…³äºå®ƒçš„ä¸€äº›æˆåŠŸåº”ç”¨æ¡ˆä¾‹ï¼Œå¦‚æœç¡®å®šè¿™æ˜¯ä¸ªä¸é”™çš„ä¸œè¥¿çš„è¯ï¼Œæˆ‘å°±ä¼šä¹°ä¸Šä¸€ä¸¤æœ¬è¯„ä»·è¾ƒå¥½çš„ä¹¦ï¼ˆä¸€åªæ„Ÿè§‰è¦æƒ³å¿«é€ŸæŒæ¡ä¸€é—¨æ–°æŠ€æœ¯çš„åŸºæœ¬ç”¨æ³•ï¼Œçœ‹ä¹¦æ˜¯æœ€èŠ‚çœæ—¶é—´çš„ï¼‰ï¼Œå½“ç„¶å¦‚æœæ²¡æœ‰ç›¸å…³ä¹¦ç±çš„è¯å®˜æ–¹æ–‡æ¡£æ˜¯æœ€å¥½çš„å‚è€ƒèµ„æ–™ã€‚<br>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œé©¬ä¸Šä¹Ÿå¿«å·¥ä½œä¸€å¹´äº†ï¼Œå„ç±»æŠ€æœ¯ä¹¦ç±ä¹Ÿæ˜¯æ²¡å°‘ä¹°ï¼Œä¸è¿‡ç°é˜¶æ®µè®©æˆ‘å­¦åˆ°æœ€å¤šçš„æ˜¯è¿™ä¸‰æœ¬ä¹¦ï¼š<a href="https://book.douban.com/subject/26852057/" target="_blank" rel="external">Python Webå¼€å‘å®æˆ˜</a>ã€<a href="https://book.douban.com/subject/26381341/" target="_blank" rel="external">Python Cookbook</a>ã€<a href="https://book.douban.com/subject/27028517/" target="_blank" rel="external">æµç•…çš„Python</a>ã€‚ä¹‹æ‰€ä»¥è¯´æ˜¯ç°é˜¶æ®µæ˜¯å› ä¸ºï¼Œæˆ‘è§‰å¾—ä¸ç®¡æ˜¯æŠ€æœ¯ä¹¦ç±ä¹Ÿå¥½è¿˜æ˜¯å…¶ä»–å„ç§ä¸åŒç±»å‹çš„ä¹¦ç±ï¼Œä½ åœ¨ä¸åŒçš„æ—¶é—´å»è¯»éƒ½ä¼šæœ‰ä¸åŒçš„æ„Ÿå—ã€‚<br>åƒæˆ‘è¿™æ ·çš„é€‰æ‰‹ï¼ŒçœŸæ­£ä½¿ç”¨pythonè¿›è¡Œå¼€å‘çš„æ—¶é—´ä¹Ÿå°±ä¸€å¹´å¤šï¼Œç¼ºå°‘å¾ˆå¤šå®é™…å·¥ä½œæ€»çš„ç»éªŒï¼Œæ¥è§¦åˆ°çš„ä¸œè¥¿ä¹Ÿæ¯”è¾ƒå°‘ï¼Œè€Œã€ŠPython Webå¼€å‘å®æˆ˜ã€‹è¿™æœ¬ä¹¦å°±æ°å¥½è§£å†³äº†æˆ‘çš„å¾ˆå¤šç–‘æƒ‘ã€‚è¿™æœ¬ä¹¦ä¸­å…³äºflaskçš„ä¸€äº›ç‰¹æ€§ç›¸å…³çš„ä¸œè¥¿å€’æ˜¯å…¶æ¬¡ï¼Œæˆ‘æ¯”è¾ƒä¹ æƒ¯çš„æ˜¯è¿™æœ¬ä¹¦ä¸­å…³äºå®é™…å¼€å‘ä¸­ä¸€äº›åƒsupervisorã€celeryè¿™æ ·çš„å¥½å·¥å…·ï¼Œä¸€äº›åƒunittestã€flake8è¿™æ ·çš„ä¸€äº›æœ‰å¾ˆå¤§ç”¨å¤„çš„åº“ä»¥åŠä½œè€…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹pythoné¡¹ç›®çš„éƒ¨ç½²ç­‰ç­‰ã€‚<br>ã€Špython cookbookã€‹åˆ™å¯ä»¥ä½œä¸ºä¸€æœ¬å·¥å…·ä¹¦ï¼Œä¹¦ä¸­æ¯ä¸ªå°èŠ‚çš„å†…å®¹åŸºæœ¬ä¸Šéƒ½å¯ä»¥è§£å†³åœ¨å®é™…ç¼–ç¨‹è¿‡ç¨‹ä¸­é‡åˆ°åˆ°å¾ˆå…·ä½“çš„é—®é¢˜ï¼Œå¹¶ä¸”ä¹¦ä¸­ä¸€äº›ç¤ºä¾‹ä»£ç ä¹Ÿä¼šè®©æˆ‘è®¤è¯†åˆ°ä»€ä¹ˆæ ·çš„ä»£ç æ‰æ˜¯æ›´åŠ pythonicçš„ï¼Œä¸ä»…æ˜¯æé«˜å¯è¯»æ€§æ›´å…³é”®çš„æ˜¯æé«˜ä»£ç çš„æ‰§è¡Œæ•ˆç‡ã€‚åœ¨äº†è§£åˆ°ç”Ÿæˆå™¨çš„å¥½å¤„ä¹‹åï¼Œæˆ‘å†ä¹Ÿä¸ç›´æ¥è¿”å›ä¸€ä¸ªå·¨å¤§æ— æ¯”çš„listäº†ã€‚<br>ä¹‹å‰å¯¹ã€Šæµç•…çš„Pythonã€‹è¿™æœ¬ä¹¦ä¹Ÿæ˜¯ç•¥æœ‰è€³é—»ï¼Œåœ¨ä¸­æ–‡ç‰ˆå‡ºæ¥çš„ç¬¬ä¸€æ—¶é—´å°±å…¥æ‰‹äº†ï¼Œè™½ç„¶åˆ°ç°åœ¨ä¸€ç›´ä¹Ÿæ²¡èƒ½è¯»å®Œï¼Œä½†æ˜¯æˆ‘å¾ˆç¡®å®šè¿™æœ¬ä¹¦ç¡®å®ä¸é”™ã€‚å’Œã€Špython cookbookã€‹æœ‰ç‚¹åƒï¼Œè¿™æœ¬ä¹¦çš„ä½œè€…æ›´æ„¿æ„ä»pythonæ ‡å‡†åº“å‡ºå‘ï¼Œå¯¹pythonæ•°æ®ç»“æ„ã€å‡½æ•°ã€é¢å‘å¯¹è±¡ã€å¹¶å‘å’Œå…ƒç¼–ç¨‹ç­‰å„ä¸ªæ–¹é¢æœ‰æ¯”è¾ƒæ·±å…¥çš„å‰–æã€‚ä¹¦ä¸­çš„å¾ˆå¤šå†…å®¹éƒ½ä¼šè®©æˆ‘æœ‰è¿™ç§â€œå±…ç„¶è¿˜æœ‰è¿™ç§æ“ä½œâ€çš„æ„Ÿè§‰ã€‚æ€»ä¹‹ï¼Œè¿™æœ¬ä¹¦èƒ½å¤Ÿè®©è‡ªå·±åœ¨è€ƒè™‘é—®é¢˜çš„æ—¶å€™æ›´å¤šçš„ä½¿ç”¨pythonçš„æ€ç»´æ–¹å¼ï¼Œå¹¶ä¸”åœ¨ä»¥åçš„ä»£ç é£æ ¼ä¸Šä¹Ÿä¼šå°½é‡çš„æŒ‰ç…§ä¹¦ä¸­æ‰€è¯´çš„è¦æ±‚æ‰§è¡Œã€‚</p>
<h1 id="å¤šç»ƒä¹ "><a href="#å¤šç»ƒä¹ " class="headerlink" title="å¤šç»ƒä¹ "></a>å¤šç»ƒä¹ </h1><p>å¿˜è®°æ˜¯ä»å“ªé‡Œçœ‹åˆ°çš„è¿™æ ·çš„ç†è®ºï¼šä½œä¸ºä¸€ä¸ªæŠ€æœ¯äººï¼Œè¦ç†è§£å¥½æŠ€æœ¯äºŒå­—ï¼Œæ‰€è°“æŠ€ï¼Œå¯ä»¥ç†è§£ä¸ºä½ åœ¨å®é™…å·¥ä½œä¸­ä¸€æ¬¡åˆä¸€æ¬¡çš„é‡å¤çš„æ²‰æ·€ï¼Œè€Œæœ¯åˆ™å¯ä»¥ç†è§£ä¸ºè‡ªå·±åœ¨è¿›è¡Œä¸€é¡¹å·¥ä½œçš„æ—¶å€™çš„ç†è®ºæ”¯æ’‘ï¼Œè¿™ä¸¤è€…ä¹Ÿæ˜¯ç›¸è¾…ç›¸æ‰¿ï¼Œè€ŒæŠ€æœ¯äººçš„æŠ€æœ¯æ°´å¹³ä¹Ÿä¼šæ˜¯ä¸€ä¸ªèºæ—‹ä¸Šå‡çš„è¿‡ç¨‹ã€‚<br>åœ¨è¯»äº†å¾ˆå¤šä¹¦ä¹‹åï¼Œ<strong>åˆ»æ„ç»ƒä¹ </strong>æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå¦‚æœå·¥ä½œç¯å¢ƒæ°å¥½éœ€è¦ç”¨åˆ°è¿™é¡¹æŠ€æœ¯åˆ™æœ€å¥½ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„æ¡ä»¶ï¼Œè‡ªå·±åœ¨ç”Ÿæ´»ä¸­å¯ä»¥æ‰¾å¤šå¾ˆå¤šå¥½ç‚¹å­å¯ä»¥é€šè¿‡è‡ªå·±çš„æŠ€æœ¯æ¥å®ç°ã€‚è¿˜æ˜¯ä¸å¾—ä¸è¯´ï¼Œ<a href="https://www.wunderlist.com/zh/" target="_blank" rel="external">å¥‡å¦™æ¸…å•/wunderlist</a>æ˜¯ä¸€æ¬¾å¾ˆä¸é”™çš„åº”ç”¨ï¼Œå¯ä»¥å®ç°å¤šç«¯åŒæ­¥ï¼Œæˆ‘ç»å¸¸ç”¨å®ƒæ¥è®°å½•è‡ªå·±çªç„¶é—ªç°çš„çµå…‰ã€‚åœ¨æœ‰äº†è‡ªè®¤ä¸ºæ¯”è¾ƒå¥½çš„ç‚¹å­ä¹‹åï¼Œå°±å¯ä»¥é€æ­¥ç»†åŒ–å®ç°æ–¹å¼ï¼Œç„¶åå°±å¯ä»¥åŠ¨æ‰‹å¼€å¹²ã€‚</p>
<h1 id="ä¸€äº›æƒ³æ³•"><a href="#ä¸€äº›æƒ³æ³•" class="headerlink" title="ä¸€äº›æƒ³æ³•"></a>ä¸€äº›æƒ³æ³•</h1><p>æˆ‘è‡ªå·±çš„æ¢¦æƒ³æ˜¯æˆä¸ºä¸€ä¸ªçœŸæ­£çš„å…¨æ ˆç¨‹åºå‘˜ï¼Œä»è®¾è®¡ã€å‰ç«¯åˆ°äº¤äº’ã€åç«¯ï¼Œç„¶åå¯ä»¥è‡ªå·±åœ¨å®¶åŠå…¬ï¼Œä¸ç”¨æ‰“å¡ä¸Šä¸‹ç­ã€‚ç°åœ¨çœ‹æ¥å¥½åƒè¿˜å·®çš„æ¯”è¾ƒè¿œï¼Œé‚£å°±å…ˆå®šä¸ªå°ç›®æ ‡å§ï¼šåœ¨å¹´åº•ä¹‹å‰ï¼Œå·©å›ºè‡ªå·±ç°æœ‰çš„æŠ€æœ¯æ ˆï¼švue + python + mongodbï¼Œèƒ½å¤Ÿåœ¨æœ‰æ˜ç¡®éœ€æ±‚çš„æƒ…å†µä¸‹åœ¨æœ€çŸ­çš„æ—¶é—´å†…æ»¡è¶³éœ€æ±‚ã€‚å¦å¤–ï¼Œå¥½çš„å·¥å…·èƒ½å¤Ÿæœ‰æ•ˆæå‡ç”Ÿäº§åŠ›ï¼Œå¥½çš„å·¥ä½œæµç¨‹ä¹Ÿèƒ½å‡å°‘è‡ªå·±åœ¨ä¸å¿…è¦åœ°æ–¹çš„æ—¶é—´å¼€æ”¯ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼éƒ¨ç½²ä¹Ÿæ˜¯ä¸‹åŠå¹´å·¥ä½œçš„ä¸€ä¸ªé‡ç‚¹ã€‚å¦å¤–å°±æ˜¯è¦å…»æˆæ€»ç»“çš„ä¹ æƒ¯ï¼Œæ‰€ä»¥ä»¥åæ¯ä¸ªæœˆè‡³å°‘æ›´æ–°ä¸‰ç¯‡åšå®¢ã€‚</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> è¯»ä¹¦ </tag>
            
            <tag> æ€»ç»“ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[cesium-terrain-builderåœ¨windowsä¸‹çš„ç¼–è¯‘]]></title>
      <url>/2017/06/30/cesium-terrain-builder%E5%9C%A8windows%E4%B8%8B%E7%9A%84%E7%BC%96%E8%AF%91/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ç ”ç©¶cesiumï¼Œå‘ç°cesium ç”¨çš„åœ°å½¢æ•°æ®è·ŸosgEarthçš„è¿˜ä¸å¤ªä¸€æ ·ï¼Œä»–ä»¬é‡‡ç”¨<a href="https://github.com/AnalyticalGraphicsInc/quantized-mesh" target="_blank" rel="external">quantized-mesh</a>è¿™ä¸ªæ•°æ®æ ¼å¼ï¼Œä¹‹å‰åœ¨osgEarthä¸Šç”¨çš„åœ°å½¢ç“¦ç‰‡åœ¨cesiumä¸Šç”¨ä¸äº†ï¼Œè®©äººæ¯”è¾ƒæ¼ç«ã€‚å¥½åœ¨githubä¸Šæœ‰äººå·²ç»å®ç°äº†ä»tifæ ¼å¼çš„demæ•°æ®è½¬åˆ°.terrainæ ¼å¼çš„å·¥å…·:<a href="https://github.com/homme/cesium-terrain-builder" target="_blank" rel="external">cesium-terrain-builder</a>ï¼Œä¸è¿‡è¯¥é¡¹ç›®åœ¨windowsä¸‹ç¼–è¯‘è®©äººæ¯”è¾ƒéš¾å—ï¼Œæ‰€ä»¥çºªå½•ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ã€‚<br><a id="more"></a></p>
<h1 id="æºç å’Œå·¥å…·ä¸‹è½½"><a href="#æºç å’Œå·¥å…·ä¸‹è½½" class="headerlink" title="æºç å’Œå·¥å…·ä¸‹è½½"></a>æºç å’Œå·¥å…·ä¸‹è½½</h1><p>è™½ç„¶ä½œè€…åœ¨githubä¸Šè¯´è¿™ä¸ªé¡¹ç›®åªä¾èµ–gdalï¼Œä¸è¿‡åœ¨windowsä¸Šå‘ç°å®ƒè¿˜ä¾èµ–zlibï¼ˆå¹¶ä¸”å¯¹è¿™ä¸¤ä¸ªåº“çš„ç‰ˆæœ¬ä¹Ÿæœ‰æ‰€è¦æ±‚ï¼‰ï¼Œæ‰€ä»¥è¦æƒ³å®Œæ•´çš„ç¼–è¯‘æ•´ä¸ªé¡¹ç›®éœ€è¦åˆ†åˆ«ä¸‹è½½è¿™äº›æºç ï¼š</p>
<ol>
<li><a href="https://github.com/homme/cesium-terrain-builder" target="_blank" rel="external">cesium-terrain-builder</a></li>
<li><a href="http://download.osgeo.org/gdal/2.0.2/gdal202.zip" target="_blank" rel="external">gdal-2.0.2</a></li>
<li><a href="https://zlib.net/zlib-1.2.11.tar.gz" target="_blank" rel="external">zlib-1.2.11</a></li>
<li><a href="https://cmake.org/files/v3.9/cmake-3.9.0-rc5-win64-x64.msi" target="_blank" rel="external">cmake-3.9.0</a></li>
<li><a href="">vs2017</a>(è¿™ä¸ªå°±çœ‹è‡ªå·±éœ€æ±‚äº†ï¼Œä½¿ç”¨cmakeç”Ÿæˆè‡ªå·±å¯¹åº”çš„vsç‰ˆæœ¬å·¥ç¨‹æ–‡ä»¶å³å¯)</li>
</ol>
<h1 id="zlibç¼–è¯‘ç”Ÿæˆ"><a href="#zlibç¼–è¯‘ç”Ÿæˆ" class="headerlink" title="zlibç¼–è¯‘ç”Ÿæˆ"></a>zlibç¼–è¯‘ç”Ÿæˆ</h1><p>åœ¨å®Œæˆzlibè§£å‹ä¹‹åï¼Œä½¿ç”¨cmakeé…ç½®ï¼Œç”Ÿæˆvså·¥ç¨‹ï¼š</p>
<ol>
<li>zlib cmakeé…ç½®<br><img src="https://o3sw4xojp.qnssl.com/myblogzlib_cmake.png" alt="zlib_cmake_conf"></li>
<li>zlib vså·¥ç¨‹é…ç½®<br><img src="https://o3sw4xojp.qnssl.com/myblogzlib_cmake_conf.png" alt="zlib_vs"></li>
<li>zlib å·¥ç¨‹ç¼–è¯‘<br><img src="https://o3sw4xojp.qnssl.com/myblogzlib_make.png" alt="zlib_build"></li>
<li>ç”Ÿæˆç»“æœ<br>åœ¨å®Œæˆdebugå’Œreleaseä¹‹åï¼Œç”Ÿæˆå†…å®¹å¦‚ä¸‹å¦‚æ‰€ç¤ºï¼š<br><img src="https://o3sw4xojp.qnssl.com/myblogzlib_result.png" alt="zlib_result">ï¼Œå…¶ä¸­includeå’Œlibæ–‡ä»¶å¤¹åœ¨åè¾¹ä¼šæœ‰ç”¨åˆ°ã€‚</li>
</ol>
<h1 id="gdalç¼–è¯‘ç”Ÿæˆ"><a href="#gdalç¼–è¯‘ç”Ÿæˆ" class="headerlink" title="gdalç¼–è¯‘ç”Ÿæˆ"></a>gdalç¼–è¯‘ç”Ÿæˆ</h1><p>gdalé€šè¿‡<a href="">x64 Native Tools Command Prompt for VS 2017</a>å·¥å…·è¿›è¡Œç¼–è¯‘ï¼š<br>æ‰“å¼€è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·ä¹‹åï¼Œcdè¿›å…¥åˆ°gdalæºç ç›®å½•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cd G:\gdal-2.0.2</div><div class="line">g:</div><div class="line">nmake /f makefile.vc MSVC_VER=1910 WIN64=YES</div><div class="line">nmake /f makefile.vc MSVC_VER=1910 WIN64=YES install</div><div class="line">nmake /f makefile.vc MSVC_VER=1910 WIN64=YES devinstall</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­MSVC_VERä»£è¡¨çš„æ˜¯VSçš„ç‰ˆæœ¬<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 1910 = 15.0(2017)</div><div class="line"># 1900 = 14.0(2015)</div><div class="line"># 1800 = 12.0(2013)</div><div class="line"># 1700 = 11.0(2012)</div><div class="line"># 1600 = 10.0(2010)</div><div class="line"># 1500 = 9.0 (2008)</div><div class="line"># 1400 = 8.0 (2005) - specific compilation flags, different from older VC++</div><div class="line"># 1310 = 7.1 (2003) # is it still supported ?</div><div class="line"># 1300 = 7.0 (2002) # is it still supported ?</div></pre></td></tr></table></figure></p>
<p>å®Œæˆä¸Šè¿°æ“ä½œä¹‹åä¼šé»˜è®¤åœ¨Cç›˜ç”Ÿæˆgdalç¼–è¯‘å¥½çš„ç»“æœï¼š<br><img src="https://o3sw4xojp.qnssl.com/mybloggdal_result.png" alt=""></p>
<h1 id="cesium-terrain-builderç¼–è¯‘ç”Ÿæˆ"><a href="#cesium-terrain-builderç¼–è¯‘ç”Ÿæˆ" class="headerlink" title="cesium-terrain-builderç¼–è¯‘ç”Ÿæˆ"></a>cesium-terrain-builderç¼–è¯‘ç”Ÿæˆ</h1><p>é¦–å…ˆæ‰“å¼€cesium-terrain-builderæºç æ–‡ä»¶å¤¹ï¼Œå°†CMakeLists.txtæ‹–å…¥cmakeï¼Œä¸»è¦é…ç½®gdalå’Œzlibçš„è·¯å¾„ï¼š<br><img src="https://o3sw4xojp.qnssl.com/cesium_tool.png" alt=""><br>å®Œæˆé…ç½®ä¹‹åï¼Œç”Ÿæˆvså·¥ç¨‹ï¼Œç›´æ¥ç¼–è¯‘å³å¯ã€‚</p>
<h1 id="ç”Ÿæˆç»“æœ"><a href="#ç”Ÿæˆç»“æœ" class="headerlink" title="ç”Ÿæˆç»“æœ"></a>ç”Ÿæˆç»“æœ</h1><p>ç»è¿‡ä¸Šè¾¹ä¸€ç•ªæŠ˜è…¾ä¹‹åï¼Œæœ€ç»ˆç”Ÿæˆè¿™äº›ä¸œè¥¿ï¼š<br><img src="https://o3sw4xojp.qnssl.com/ctb-tools.png" alt=""><br>ä»–ä»¬çš„å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒè¿™é‡Œï¼š<a href="https://github.com/homme/cesium-terrain-builder" target="_blank" rel="external">ä½¿ç”¨æ–¹æ³•</a>ã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç»è¿‡è¿™æ¬¡æŠ˜è…¾å­¦ä¼šäº†ä½¿ç”¨vsçš„Native Toolsï¼Œä¹ŸçŸ¥é“ä½¿ç”¨cmakeç”Ÿæˆvså·¥ç¨‹å¹¶ä¸æ˜¯ä»€ä¹ˆå¤æ‚çš„äº‹æƒ…ï¼Œè€Œæœ€ç»ˆç›®çš„å°±æ˜¯å‚è€ƒè¿™ä¸ªå¼€æºå·¥å…·çš„æ€è·¯å®ç°è¦pythonçš„åˆ‡ç‰‡å·¥å…·ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> C++ </tag>
            
            <tag> vs2017 </tag>
            
            <tag> gdal </tag>
            
            <tag> zlib </tag>
            
            <tag> cesium </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœ€è¿‘ä¸€æ®µæ—¶é—´çš„æ€»ç»“]]></title>
      <url>/2017/05/31/%E6%9C%80%E8%BF%91%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E7%9A%84%E6%80%BB%E7%BB%93/</url>
      <content type="html"><![CDATA[<p>ä¸Šå‘¨æˆ‘çš„å‡ ä¸ªç ”ç©¶ç”ŸåŒå­¦å®Œæˆäº†æ¯•ä¸šè®ºæ–‡ç­”è¾©ï¼Œçªç„¶æ„è¯†åˆ°å·²ç»æ¯•ä¸šå¿«è¦ä¸€å¹´äº†ã€‚æˆ‘ä»æ²³åŒ—è¾èŒå›åˆ°æ­¦æ±‰ä¹Ÿæœ‰ä¸€ä¸ªåŠæœˆäº†ï¼Œè¶ç€ç°åœ¨æ‰‹ä¸Šçš„æ´»ä¸æ˜¯å¾ˆå¤šï¼Œæ€»ç»“ä¸€ä¸‹æœ€è¿‘å·¥ä½œã€å­¦ä¹ å’Œç”Ÿæ´»ä¸Šçš„å„ç§ã€‚<br><a id="more"></a></p>
<h1 id="new-work"><a href="#new-work" class="headerlink" title="new work"></a>new work</h1><p>ä¹‹æ‰€ä»¥ä»æ²³åŒ—çš„å•ä½è¾èŒï¼Œå¾ˆå¤§ä¸€æ­¥åˆ†åŸå› æ˜¯è‡ªå·±ä¸å–œæ¬¢é‚£æ ·çš„å·¥ä½œçŠ¶æ€ï¼šæ²¡æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œå®½æ³›çš„ç•Œé™ï¼Œæ— æˆé•¿æ€§çš„é‡å¤ã€‚ç°åœ¨çš„è¿™å®¶å…¬å¸ï¼Œåšçš„æ˜¯ä¸“ä¸šç›¸å…³çš„ä¸œè¥¿ï¼Œç›®å‰ä¸»è¦çš„å·¥ä½œèŒƒç•´æ˜¯çˆ¬æ•°æ®ã€æä¾›å€Ÿå£ã€é¡µé¢å±•ç¤ºï¼Œå¯ä»¥ç¨å¾®åƒä¸€ä¸‹è‡ªå·±çš„è€æœ¬ï¼Œæ€»ä½“æ¥è¯´å·¥ä½œå‹åŠ›ä¸å¤§ï¼Œå¯æ”¯é…æ—¶é—´å……è£•ï¼Œæ¯”è¾ƒé€‚åˆæˆ‘ç†æƒ³çš„çŠ¶æ€ï¼ˆå·¥ä½œæ¯•ç«Ÿåªæ˜¯å·¥ä½œï¼Œæœ‰è‡ªå·±çš„æ—¶é—´å»åšå–œæ¬¢çš„äº‹æƒ…æ‰æœ€å¥½ï¼‰ã€‚<br>å”¯ä¸€æ„Ÿåˆ°ä¸å¤ªå¥½çš„å°±æ˜¯æ¥åˆ°è¿™é‡Œä¹‹åæˆé•¿æ²¡æœ‰é¢„æƒ³çš„å¿«ï¼Œä¸»è¦åŸå› æ˜¯åˆšå¼€å§‹åšçš„ä¸œè¥¿å¤§éƒ½æ˜¯è‡ªå·±ä¹‹å‰åšè¿‡çš„ï¼ˆçˆ¬è™«ã€å†™æœåŠ¡ã€jqueryï¼‰ï¼Œæ‰€ä»¥æœ€è¿‘å¼€å‘å·¥ä½œåŸºæœ¬åœä¸‹æ¥ä¹‹åå‡†å¤‡å¼€å§‹æ·±å…¥åº•å±‚ç›¸å…³çš„å†…å®¹å­¦ä¹ ã€‚å¯èƒ½å­¦ä¹ çš„è¿‡ç¨‹ä¼šæœ‰äº›åƒåŠ›ï¼Œä¸è¿‡æœ‰æ›´å¿«çš„æˆé•¿æ€»å½’æ˜¯å¥½çš„ã€‚</p>
<h1 id="learn-something-new"><a href="#learn-something-new" class="headerlink" title="learn something new"></a>learn something new</h1><p>æˆ‘ä¸€ç›´æ˜¯ä¸ªå–œæ¬¢é¼“æ£æ–°æŠ€æœ¯çš„éä¸“ä¸šä¸‰åˆ†é’Ÿçƒ­åº¦é€‰æ‰‹ï¼Œæœ€è¿‘æƒ³è¦å­¦ä¸€ä¸‹ä¸€ç›´æƒ³å­¦ä½†æ˜¯è¢«å„ç§äº‹æƒ…è€½è¯¯çš„unity3dï¼Œä¹°äº†å‡ æœ¬ä¹¦ï¼ˆä¸€ç›´è¿˜æ²¡çœ‹ï¼Œå“ˆå“ˆå“ˆï¼‰ï¼›å¦å¤–å°±æ˜¯æœºå™¨å­¦ä¹ ï¼Œä¹‹å‰çš„å‡ æœ¬ä¹¦éƒ½åªæ˜¯çœ‹äº†ä¸€éƒ¨åˆ†ï¼Œæ„Ÿè§‰é‡Œè¾¹çš„ä¸€äº›ä¸œè¥¿ç†è§£èµ·æ¥ç•¥å¾®åƒåŠ›ï¼Œä¹Ÿæ²¡æœ‰é™ä¸‹å¿ƒæ¥ä»”ç»†å»çœ‹å»ç†è§£ï¼›è¿˜æœ‰å°±æ˜¯å·¥ä½œéœ€è¦çš„ä¸œè¥¿ï¼šosgearthï¼Œè¿˜æ˜¯åº”äº†æˆ‘å¾ˆä¹…ä¹‹å‰è¯´çš„é‚£å¥è¯â€œè¯¥æ¥çš„æ€»å½’è¿˜æ˜¯è¦æ¥çš„â€ã€‚</p>
<h1 id="happy-life"><a href="#happy-life" class="headerlink" title="happy life"></a>happy life</h1><p>æƒ³æƒ³è¿™æ¬¡å·¥ä½œè°ƒæ•´ç»™è‡ªå·±å¸¦æ¥çš„æœ€å¤§çš„æ”¹å˜å°±æ˜¯ç”Ÿæ´»çŠ¶æ€ã€‚æˆªè‡³ç›®å‰ï¼Œæˆ‘çš„ç”Ÿæ´»çŠ¶æ€è¿˜æ˜¯æ¯”è¾ƒå»åˆè‡ªå·±è¿˜åœ¨å­¦æ ¡çš„æ—¶å€™å¯¹æœªæ¥çš„æ†§æ†¬ï¼šä¸€é—´ç‹¬å±…å°å±‹ï¼Œä¸€å°æ€§èƒ½å¼ºåŠ²çš„ç”µè„‘ï¼Œä¸€æ¡Œå­æƒ³è¦è¯»çš„æŠ€æœ¯ä¹¦ç±ï¼Œå¯çˆ±çš„å¥³æœ‹å‹ï¼ˆä¸çŸ¥é“å•¥æ—¶å€™æ‰èƒ½åœ¨ä¸€ä¸ªåŸå¸‚å·¥ä½œï¼‰è¿˜æœ‰ä¸€åªå–µæ˜Ÿäººã€‚</p>
<h1 id="challenges"><a href="#challenges" class="headerlink" title="challenges"></a>challenges</h1><p>æŒ‘æˆ˜ä¸€ç›´éƒ½æœ‰ï¼Œçœ¼å‰ä¸»è¦çš„æŒ‘æˆ˜ä¸»è¦æœ‰è¿™äº›ï¼š</p>
<ul>
<li>å°½å¿«é™ªå¥³æœ‹å‹ä¸€èµ·å®Œæˆä¿ºä»¬ä¿©çš„<a href="https://github.com/love3forever/gogo3" target="_blank" rel="external">vueå°é¡¹ç›®</a></li>
<li>é™ä¸‹å¿ƒå­¦osgearthç›¸å…³å†…å®¹ï¼ˆåŸºæœ¬çš„åœºæ™¯æ¸²æŸ“æ¦‚å¿µã€æµç¨‹ï¼Œåº•å±‚å„ç§æ•°æ®è°ƒåº¦æœºåˆ¶ï¼‰</li>
<li>æŒ¤å‡ºæ—¶é—´æŠŠè‡ªå·±æƒ³è¯»çš„ä¹¦å¥½å¥½è¯»å®Œ</li>
<li>è°ƒæ•´è‡ªå·±çš„ä½œæ¯ã€å¢åŠ é”»ç‚¼æ—¶é—´ï¼ˆå¿…é¡»è¦æ§åˆ¶ä½“é‡å•¦ï¼‰</li>
<li>åšå¥½ä¸€ä¸ªåˆæ ¼çš„é“²å±å®˜</li>
</ul>
]]></content>
      
        <categories>
            
            <category> æ€»ç»“ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ubuntu16.04 nginxé…ç½®http2.0]]></title>
      <url>/2017/05/25/ubuntu%E9%85%8D%E7%BD%AEhttp2.0/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ä¸ºcesiumï¼ˆä¸€ä¸ªå¼€æºä¸‰ç»´çƒï¼‰é…ç½®æœ¬åœ°ç“¦ç‰‡æœåŠ¡ï¼Œæƒ³èµ·è‡ªå·±ä¹‹å‰ç ”ç©¶è¿‡çš„http2.0ä¼šå¯¹ç“¦ç‰‡æ•°æ®è°ƒåº¦æ•ˆç‡æœ‰æ˜æ˜¾æå‡ï¼Œç‰¹æ„ç»™è‡ªå·±çš„å¼€å‘ç¯å¢ƒé…ç½®äº†http2.0çš„ç¯å¢ƒã€‚</p>
<p>googleä¹‹åå‘ç°ä¸¤ä¸ªå¾ˆå¥½çš„æ•™ç¨‹<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-with-http-2-support-on-ubuntu-16-04" target="_blank" rel="external">How To Set Up Nginx with HTTP/2 Support on Ubuntu 16.04</a>ï¼Œ<a href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-16-04" target="_blank" rel="external">How To Secure Nginx with Letâ€™s Encrypt on Ubuntu 16.04</a>ç‰¹æ­¤è®°å½•ï¼</p>
]]></content>
      
        <categories>
            
            <category> nginx </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ubuntu </tag>
            
            <tag> nginx </tag>
            
            <tag> http2.0 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ubuntu mate16.04 aptæº]]></title>
      <url>/2017/05/13/ubuntu_mate_16%20apt%E6%BA%90/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘å‡†å¤‡ä½¿ç”¨ubuntu mate16æ­å»ºä¸€å¥—å¼€å‘ç¯å¢ƒï¼Œè®°å½•ä¸€ä¸‹ä½¿ç”¨åˆ°çš„aptæºï¼Œé˜¿é‡Œäº‘çš„ï¼Œé€Ÿåº¦è¿˜æ˜¯æŒºä¸é”™çš„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse</div><div class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse</div><div class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse</div><div class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiverse</div><div class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</div><div class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse</div><div class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse</div><div class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse</div><div class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiverse</div><div class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</div></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> è®°å½• </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ubuntu </tag>
            
            <tag> apt </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[requestsåº“çš„Failed to establish a new connection]]></title>
      <url>/2017/01/29/requests%E5%BA%93error/</url>
      <content type="html"><![CDATA[<p>ä½¿ç”¨pythonåšçˆ¬è™«çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šåœ¨è¾ƒçŸ­çš„æ—¶é—´å†…æ„å»ºå¤§é‡çš„è¿æ¥å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œé‡åˆ°äº†è¿™æ ·çš„é—®é¢˜ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">requests.exceptions.ConnectionError: HTTPConnectionPool(host=&apos;xxx&apos;, port=80):</div><div class="line">Max retries exceeded with url: /document/record/_search?pretty=true (Caused by NewConnectionError</div><div class="line">(&apos;&lt;requests.packages.urllib3.connection.HTTPConnection object at 0x7f544af9a5d0&gt;: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution&apos;,))</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>æœ€å¼€å§‹çœ‹åˆ°<code>Max retries exceeded with url</code>è¿˜ä»¥ä¸ºæ˜¯è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè‡ªå·±çš„ipåœ°å€è¢«banäº†ï¼Œè€Œååˆé€šè¿‡requestsåº“æ‰‹åŠ¨å‘å‡ºä¸€æ¡è¯·æ±‚ï¼Œå¹¶æ²¡æœ‰ä¸Šè¾¹çš„é”™è¯¯ï¼Œçœ‹æ¥å¹¶ä¸æ˜¯ipè¢«banã€‚<br>åˆçœ‹åˆ°<code>Temporary failure in name resolution</code>ï¼Œä¼šä¸ä¼šæ˜¯åŸŸåè§£æçš„é—®é¢˜ï¼Ÿä¹Ÿä¸ä¼šï¼Œå•ç‹¬ä¸€æ¡è¯·æ±‚æ˜¯å¯ä»¥æ­£å¸¸è¿”å›ç»“æœçš„ï¼Œæ‹¿åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ<br>ç»è¿‡ä¸€ç•ªgoogleï¼Œstackoverflowä¹‹åçœ‹åˆ°äº†è¿™å‡ ä¸ªç­”æ¡ˆï¼š</p>
<ul>
<li><a href="http://xiaorui.cc/2015/12/22/%E5%A4%9A%E8%BF%9B%E7%A8%8B%E4%B8%8B%E7%94%A8requests%E8%AE%BF%E9%97%AEhttp-api%E6%97%B6%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/" target="_blank" rel="external">å¤šè¿›ç¨‹ä¸‹ç”¨requestsè®¿é—®http apiæ—¶é‡åˆ°çš„å‘</a></li>
<li><a href="http://stackoverflow.com/questions/10115126/python-requests-close-http-connection" target="_blank" rel="external">Python-Requests close http connection</a></li>
</ul>
<p>ç»“åˆè‡ªå·±å‡ºç°é—®é¢˜çš„åœºæ™¯ï¼Œåº”è¯¥å°±æ˜¯å› ä¸ºåœ¨çŸ­æ—¶é—´å†…æ‰“å¼€äº†å¤ªå¤šçš„httpè¿æ¥ï¼Œå¹¶ä¸”è¿™äº›è¿æ¥éƒ½æ˜¯é»˜è®¤keep-aliveçš„å½¢å¼ã€‚<br>æ‰€ä»¥åœ¨requestçš„headerä¸­æ·»åŠ äº†<code>&#39;Connection&#39;: close</code>ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªè¯·æ±‚å®Œæˆä¹‹åtime.sleep(0.01)ã€‚</p>
<p>ä¿®æ”¹ä¹‹åï¼Œçˆ¬è™«è·‘äº†ä¸€å¤œæ²¡å†å‡ºé—®é¢˜ï¼Œå¼€å¿ƒã€‚</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[mongodbç”¨æˆ·åå¯†ç ç™»å½•]]></title>
      <url>/2017/01/17/mongodb%E5%B8%A6%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>å†™è¿™ç¯‡åšå®¢æ˜¯ä¸ºäº†çºªå¿µæœ€è¿‘é—¹çš„æ²¸æ²¸æ‰¬æ‰¬çš„å¤§è§„æ¨¡mongodbåº“è¢«é»‘çš„äº‹ä»¶ï¼Œæˆ‘è‡ªå·±ä¹Ÿä¸å¹¸ä¸­æ‹›ï¼Œç´¢æ€§è¢«é»‘çš„æ•°æ®éƒ½æ˜¯è‡ªå·±åšè¯•éªŒçš„ä¸€äº›æ•°æ®ï¼Œå¹¶ä¸æ˜¯å¾ˆé‡è¦ã€‚<br><a id="more"></a><br>å¯èƒ½æ˜¯mongodbä¸ºäº†è®©äººæ›´åŠ å®¹æ˜“ä¸Šæ‰‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ç”¨éªŒè¯å°±å¯ä»¥æ“ä½œæ•°æ®åº“ã€‚ä½†æ˜¯å¦‚æœæƒ³è¦ç¡®ä¿è‡ªå·±mongodbçš„å®‰å…¨ï¼Œå¯ä»¥é€šè¿‡<a href="https://docs.mongodb.com/manual/administration/security-checklist/" target="_blank" rel="external">å¤šç§æ–¹å¼</a>æ¥å®ç°ã€‚<br>å…¶ä¸­æœ€ç®€ä¾¿çš„æ˜¯é€šè¿‡ç”¨æˆ·åå’Œå¯†ç æ¥éªŒè¯ã€‚</p>
<h1 id="æ–°å¢ç”¨æˆ·"><a href="#æ–°å¢ç”¨æˆ·" class="headerlink" title="æ–°å¢ç”¨æˆ·"></a>æ–°å¢ç”¨æˆ·</h1><p>åœ¨å¯¹mongodbå¢åŠ éªŒè¯ä½¿ç”¨ä¹‹å‰ï¼Œéœ€è¦å¢åŠ ä¸€ä¸ªadminç”¨æˆ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">./bin/mongo</div><div class="line">use admin</div><div class="line">db.createUser(</div><div class="line">  &#123;</div><div class="line">    user: &quot;admin&quot;,</div><div class="line">    pwd: &quot;abc@123&quot;,</div><div class="line">    roles: [ &#123; role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; &#125; ]</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>ä¸Šè¾¹è¿™æ®µå‘½ä»¤æŒ‡çš„æ˜¯åœ¨adminåº“ä¸­å¢åŠ ç®¡ç†å‘˜adminç”¨æˆ·ï¼Œä»–çš„å¯†ç æ˜¯abc@123ã€‚æœ‰äº†adminè´¦æˆ·ä¹‹åï¼Œå¯ä»¥å¢åŠ å…¶ä»–çš„ç”¨æˆ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">db.createUser(</div><div class="line">  &#123;</div><div class="line">    user: &quot;eclipse&quot;,</div><div class="line">    pwd: &quot;abc@123&quot;,</div><div class="line">    roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;Douyudata&quot; &#125;,</div><div class="line">             &#123; role: &quot;readWrite&quot;, db: &quot;Pandata&quot; &#125; ]</div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>è€Œä¸Šè¾¹è¿™äº›å‘½ä»¤å°±æ˜¯å¯¹å…·ä½“æ“ä½œæ•°æ®åº“çš„ç”¨æˆ·ï¼šåˆ›å»ºç”¨æˆ·eclipseï¼Œå¯†ç abc@123ï¼Œæ‹¥æœ‰å¯¹åº“Douyudataå’ŒPandataçš„è¯»å†™æƒé™ã€‚<br>æ–°å¢ç”¨æˆ·ä¹‹åï¼Œå¯ä»¥åœ¨mongodbåœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œé€šè¿‡åŠ å…¥â€“authå‚æ•°å³å¯å¯åŠ¨å®‰å…¨éªŒè¯åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼š<code>./bin/mongod --dbpath ./db  --auth</code>ã€‚</p>
<h1 id="shellæ“ä½œ"><a href="#shellæ“ä½œ" class="headerlink" title="shellæ“ä½œ"></a>shellæ“ä½œ</h1><p>åœ¨é€šè¿‡ä¸Šè¾¹çš„å‘½ä»¤è¿è¡Œmongodä¹‹åï¼Œä½¿ç”¨./bin/mongoæ‰“å¼€shellè¿æ¥mongodbã€‚<br>è¿æ¥ä¹‹åçœ‹ä¸‹æ•°æ®åº“åˆ—è¡¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; show dbs</div><div class="line">2017-02-17T11:09:43.539+0800 E QUERY    [main] Error: listDatabases failed:&#123;</div><div class="line">	&quot;ok&quot; : 0,</div><div class="line">	&quot;errmsg&quot; : &quot;not authorized on admin to execute command &#123; listDatabases: 1.0 &#125;&quot;,</div><div class="line">	&quot;code&quot; : 13,</div><div class="line">	&quot;codeName&quot; : &quot;Unauthorized&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å‘ç°å·²ç»å—åˆ°mongodbæƒé™è®¤è¯æœºåˆ¶çš„ä¿æŠ¤ã€‚<br>å…ˆç”¨adminç™»å½•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; use admin</div><div class="line">switched to db admin</div><div class="line">&gt; db.auth(&apos;admin&apos;,&apos;abc@123&apos;)</div><div class="line">1</div><div class="line">&gt; show dbs</div><div class="line">Douyu        0.180GB</div><div class="line">Douyudata    0.001GB</div><div class="line">admin        0.000GB</div><div class="line">lagou        0.000GB</div><div class="line">local        0.000GB</div><div class="line">test         0.000GB</div><div class="line">userManager  0.001GB</div></pre></td></tr></table></figure></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªadminç›®å‰åªæ˜¯ä¸ªç”¨æˆ·ç®¡ç†å‘˜çš„è§’è‰²ï¼Œä»–å¯¹å…·ä½“çš„æ•°æ®åº“æ²¡æœ‰è¯»å†™æƒé™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; use Douyu</div><div class="line">switched to db Douyu</div><div class="line">&gt; show tables</div><div class="line">2017-02-17T11:15:17.279+0800 E QUERY    [main] Error: listCollections failed: &#123;</div><div class="line">	&quot;ok&quot; : 0,</div><div class="line">	&quot;errmsg&quot; : &quot;not authorized on Douyu to execute command &#123; listCollections: 1.0, filter: &#123;&#125; &#125;&quot;,</div><div class="line">	&quot;code&quot; : 13,</div><div class="line">	&quot;codeName&quot; : &quot;Unauthorized&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¦‚æœè¦å‘å¯¹æ•°æ®åº“è¿›è¡Œè¯»å†™ï¼Œéœ€è¦åˆ‡æ¢åˆ°å¯¹åº”çš„ç”¨æˆ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; use admin</div><div class="line">switched to db admin</div><div class="line">&gt; db.auth(&apos;eclipse&apos;,&apos;abc@123&apos;)</div><div class="line">1</div><div class="line">&gt; use Douyudata</div><div class="line">switched to db Douyudata</div><div class="line">&gt; show tables</div><div class="line">Catalog</div><div class="line">Roominfo</div></pre></td></tr></table></figure></p>
<h1 id="pymongoä¸­çš„è®¤è¯æ–¹æ³•"><a href="#pymongoä¸­çš„è®¤è¯æ–¹æ³•" class="headerlink" title="pymongoä¸­çš„è®¤è¯æ–¹æ³•"></a>pymongoä¸­çš„è®¤è¯æ–¹æ³•</h1><p>æˆ‘ä¸€èˆ¬ä½¿ç”¨pymongoæ¥è¿æ¥mongodbï¼Œé€šè¿‡pymongoè¿æ¥çš„æ–¹å¼å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">import os</div><div class="line">from pymongo import MongoClient</div><div class="line">class DB(object):</div><div class="line">    &quot;&quot;&quot;docstring for DB&quot;&quot;&quot;</div><div class="line">    def __init__(self, host=&apos;localhost&apos;, port=27017):</div><div class="line">        self.cli = MongoClient(host=host, port=port)</div><div class="line">    def switch_db(self, database):</div><div class="line">        &apos;&apos;&apos;</div><div class="line">        åˆ‡æ¢åˆ°ç›®æ ‡æ•°æ®åº“ï¼Œå¹¶è¿›è¡Œæƒé™éªŒè¯</div><div class="line">        &apos;&apos;&apos;</div><div class="line">        if database and isinstance(database, str):</div><div class="line">            name = os.getenv(&apos;mongo_name&apos;)</div><div class="line">            pasw = os.getenv(&apos;mongo_pswd&apos;)</div><div class="line">            authdb = self.cli[&apos;admin&apos;]</div><div class="line">            try:</div><div class="line">                authdb.authenticate(name=name, password=pasw)</div><div class="line">            except Exception as e:</div><div class="line">                print(&quot;Erro accured during db authenticate:&#123;&#125;&quot;.format(str(e)))</div><div class="line">            self.db = self.cli[database]</div></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[flask-socketioçš„ä¸€æ¬¡ä½¿ç”¨è®°å½•]]></title>
      <url>/2016/12/28/flask-socketio%E7%9A%84%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8%E7%BB%8F%E5%8E%86/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨åšä¸€ä¸ªå°é¡¹ç›®ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†å³æ—¶é€šä¿¡çš„åŠŸèƒ½æˆ‘æ˜¯é€šè¿‡flask-socketioæ¥å®Œæˆçš„åç«¯ä»£ç ç¼–å†™ã€‚åœ¨å°è¯•è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç‰¹åœ¨æ­¤è®°å½•ï¼Œä»¥å¤‡åç”¨ã€‚<br><a id="more"></a><br>å…·ä½“è¯´æ¥ï¼Œæƒ³è¦å®ç°çš„åŠŸèƒ½æ˜¯è¿™æ ·çš„ï¼šæ¯ä¸¤ä¸ªç”¨æˆ·é€šè¿‡é€šè¿‡ä¸€ä¸ªpairä¿å­˜èµ·æ¥ï¼Œè€Œæ¯ä¸ªpairé€šè¿‡å”¯ä¸€çš„æ ‡è¯†ç¬¦åŠ ä»¥åŒºåˆ†ï¼›åœ¨ç”¨æˆ·è¿æ¥åˆ°åç«¯èŠå¤©æœåŠ¡å™¨ä¹‹åï¼Œåç«¯é€šè¿‡è¯¥ç”¨æˆ·å¯¹åº”çš„pairæ ‡è¯†ç¬¦ç®€å†ä¸€ä¸ªä¸“å±çš„èŠå¤©é¢‘é“(room)ï¼›è¿™ä¸ªèŠå¤©é¢‘é“åªæœ‰è¿™ä¸ªpairä¸­çš„ä¸¤ä¸ªäººèƒ½å¤Ÿè¿›å…¥ï¼ˆç±»ä¼¼äºqqç§èŠï¼‰ã€‚</p>
<h1 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h1><p>ç°åœ¨å…·ä½“æµç¨‹å·²ç»å¾ˆæ¸…æ¥šäº†ï¼Œè¦å®ç°çš„åŠŸèƒ½ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥å…·ä½“å®ç°å¦‚ä¸‹ï¼š<br>é¦–å…ˆï¼Œè¦å»ºç«‹ä¸€ä¸ªsocketioæœåŠ¡å™¨å®ä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from flask_socketio import SocketIO, Namespace</div><div class="line">from flask import Flask</div><div class="line">def createApp():</div><div class="line">    app = Flask(__name__)</div><div class="line">    app.config[&apos;SECRET_KEY&apos;] = &apos;wtf&apos;</div><div class="line">    return app</div><div class="line">app = createApp()</div><div class="line">socketio = SocketIO(app)</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨æœ‰äº†è¿™ä¸ªsocketioï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸ºä»–æ·»åŠ å¯¹åº”çš„äº‹ä»¶ï¼šå‰ç«¯å‘æ¥è¿æ¥è¯·æ±‚å¹¶ä¸”æŠŠè¯¥ç”¨æˆ·æ‰€å±çš„pairæ ‡è¯†ç¬¦ä¸€å¹¶å‘æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ¥å—è¿æ¥è¯·æ±‚å¹¶å»ºç«‹ä¸€ä¸ªroomï¼Œroomå»ºç«‹ä¹‹åï¼Œç”¨æˆ·åŠ å…¥å¯¹åº”çš„roomã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// å‰ç«¯è¯·æ±‚</div><div class="line">var chat = io.connect(&apos;ws://localhost:4000&apos;);	// é€šè¿‡æŒ‡å®šçš„ipå’Œportè¿æ¥åç«¯</div><div class="line">chat.on(&apos;connect&apos;, function(data) &#123;</div><div class="line">    chat.emit(&apos;message&apos;,&#123;msg: &apos;&#123;&#123;roomid&#125;&#125;&apos;&#125;,function()&#123;		//è¿æ¥å»ºç«‹ä¹‹åï¼Œå‘åç«¯å‘é€æ ‡è¯†ç¬¦</div><div class="line">        room = io.connect(&apos;ws://localhost:4000/&#123;&#123;roomid&#125;&#125;&apos;);	//åç«¯ç”Ÿæˆå¯¹åº”çš„roomï¼Œå¹¶æä¾›è¿æ¥</div><div class="line">        room.on(&apos;liaoxian&apos;,function(data)&#123;					//ç›‘å¬åç«¯çš„äº‹ä»¶</div><div class="line">            msgPanel.append(&apos;&lt;p&gt;&apos;+data+&apos;&lt;/p&gt;&lt;br&gt;&apos;)</div><div class="line">        &#125;);</div><div class="line">        &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># åç«¯å¤„ç†</div><div class="line"># ç”±äºåœ¨å®é™…è¿è¡Œä¸­ï¼Œå¯èƒ½ä¼šæœ‰å¤§é‡çš„rooméœ€è¦å»ºç«‹ï¼Œé€šè¿‡classå°†roomæŠ½è±¡å‡ºæ¥ä¼šæ›´æ–¹ä¾¿</div><div class="line">class ChatRoom(Namespace):</div><div class="line">    def on_connect(self):</div><div class="line">        print(&apos;client connected to room&apos;)</div><div class="line"></div><div class="line">    def on_disconnect(self):</div><div class="line">        print(&apos;client disconnected from room&apos;)</div><div class="line">	# è‡ªå®šä¹‰çš„äº‹ä»¶ï¼Œå‰è¾¹éœ€è¦åŠ ä¸Šon_</div><div class="line">    def on_liaoxian(self, msg):</div><div class="line">        print(&apos;running liaoxian&apos;)</div><div class="line">        print(msg)</div><div class="line">        self.send(msg)</div><div class="line">    def on_recv(self, data):</div><div class="line">        self.emit(&apos;liaoxian&apos;, data[&apos;msg&apos;])</div><div class="line">@socketio.on(&apos;message&apos;)</div><div class="line">def getMsg(sss):</div><div class="line">    print(sss)</div><div class="line">    room = sss[&apos;msg&apos;]</div><div class="line">    newRoom = ChatRoom(&apos;/&#123;&#125;&apos;.format(room))	# é€šè¿‡åˆ¶å®šçš„roomç”Ÿæˆå¯¹åº”çš„èŠå¤©é¢‘é“</div><div class="line">    socketio.on_namespace(newRoom)</div></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸Šè¾¹å¾ˆç®€å•çš„ä»£ç å°±å¯ä»¥å®Œæˆä¸€ä¸ªç®€å•çš„ç‚¹åˆ°ç‚¹å³æ—¶é€šä¿¡åº”ç”¨ï¼Œè¯¦ç»†ä»£ç åœ¨æˆ‘çš„<a href="">github</a>ä¸­ã€‚</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Python </tag>
            
            <tag> flask </tag>
            
            <tag> socketio </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[flaskå‡ ç§éƒ¨ç½²æ–¹å¼å®è·µ]]></title>
      <url>/2016/12/12/flask%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F%E5%AE%9E%E8%B7%B5/</url>
      <content type="html"><![CDATA[<p>flaskä½œä¸ºä¸€æ¬¾è½»é‡çº§webæ¡†æ¶ï¼Œå…·æœ‰è¯¸å¤šä¼˜ç‚¹ã€‚æˆ‘å–œæ¬¢å®ƒçš„åŸå› æ˜¯å®ƒå…·æœ‰é«˜åº¦çš„å¯æ‰©å±•æ€§ï¼Œå¹¿æ³›çš„å„ç±»æ’ä»¶ï¼Œä¸°å¯Œçš„å¼€å‘æ–‡æ¡£ã€‚åœ¨å¼€å‘è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šç®€å•çš„ä½¿ç”¨flaskè‡ªå¸¦çš„webæœåŠ¡å™¨ã€‚ä½†æ˜¯åœ¨å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œflaskè‡ªå¸¦çš„webæœåŠ¡å™¨å¾ˆéš¾æ»¡è¶³éœ€æ±‚ã€‚<br><a id="more"></a><br>æ‰€ä»¥ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œéƒ¨ç½²flaskåº”è¯¥ç”¨ä»€ä¹ˆå‘¢ï¼Ÿè¿™é¦–å…ˆå°±ä¸å¾—ä¸è¯´WSGIäº†ã€‚</p>
<h1 id="WSGI"><a href="#WSGI" class="headerlink" title="WSGI"></a>WSGI</h1><p>WSGI(python web server gateway interface)ï¼Œpython webæœåŠ¡å™¨ç½‘å…³æ¥å£ã€‚å®ƒæ˜¯pythonè¯­è¨€å®šä¹‰çš„webæœåŠ¡å™¨å’Œwebåº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸€ç§ç®€å•é€šç”¨çš„æ¥å£ã€‚WSGIå¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªæ˜¯æœåŠ¡å™¨æˆ–è€…è¯´æ˜¯ç½‘å…³ï¼Œå¦ä¸€ä¸ªå¯ä»¥æˆä¸ºwebåº”ç”¨æˆ–è€…è¯´æ˜¯åº”ç”¨æ¡†æ¶ã€‚åœ¨å¤„ç†æ¥è‡ªå‰ç«¯çš„è¯·æ±‚æ˜¯ï¼ŒæœåŠ¡å™¨ä¼šä¸ºåº”ç”¨ç¨‹åºæä¾›ç¯å¢ƒä¸Šä¸‹æ–‡åŠä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚åœ¨åº”ç”¨ç¨‹åºå®Œæˆè¯·æ±‚ä¹‹åï¼Œå°†å…ˆå‰çš„å›è°ƒå‡½æ•°ç»“æœè¿”å›ç»™å‰ç«¯ã€‚å› æ­¤ï¼Œå¯¹äºflaskè€Œè¨€ï¼Œè¿™é‡Œçš„WSGIå¯ä»¥èµ·åˆ°çš„åŠŸèƒ½ï¼š</p>
<ol>
<li>é‡å†™ç¯å¢ƒå˜é‡ï¼Œæ ¹æ®ç›®æ ‡urlå°†è¯·æ±‚æ¶ˆæ¯è·¯ç”±åˆ°å¯¹åº”çš„åº”ç”¨å¯¹è±¡ï¼›</li>
<li>å…è®¸åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è¿è¡Œå¤šä¸ªwebåº”ç”¨ç¨‹åºæˆ–è€…æ¡†æ¶ï¼›</li>
<li>å¯ä»¥èµ·åˆ°è´Ÿè½½å‡è¡¡è¿œç«¯è¯·æ±‚çš„ä½œç”¨ï¼›</li>
<li>å¯¹è¯·æ±‚æˆ–è€…è¿”å›å†…å®¹è¿›è¡Œå¤„ç†ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œåªè¦éµç…§WSGIåè®®çš„webåº”ç”¨éƒ½å¯ä»¥éƒ¨ç½²åœ¨å¯¹åº”çš„webserverä¹‹åã€‚æˆ–è€…è¯´WSGIä¹‹äºpythonï¼Œå°±å¦‚åŒFastcgiä¹‹äºphpã€‚</p>
<h1 id="ç‹¬ç«‹çš„WSGIå®¹å™¨"><a href="#ç‹¬ç«‹çš„WSGIå®¹å™¨" class="headerlink" title="ç‹¬ç«‹çš„WSGIå®¹å™¨"></a>ç‹¬ç«‹çš„WSGIå®¹å™¨</h1><p>å¦‚æœåŒæ—¶æœ‰å¥½å‡ ä¸ªä¸œè¥¿åœ¨é¢å‰ï¼Œèƒ½å¤Ÿå®ç°çš„åŠŸèƒ½ç±»ä¼¼ï¼Œæˆ‘è‚¯å®šä¼šé€‰æ‹©æ›´å®¹æ˜“æ“ä½œçš„ã€‚åœ¨flaskéƒ¨ç½²è¿™ä»¶äº‹æƒ…ä¸Šï¼Œæˆ‘ä¼šé€‰æ‹©ä¸€äº›ç‹¬ç«‹çš„WSGIå®¹å™¨æ¥éƒ¨ç½²flaskã€‚</p>
<h2 id="gunicorn"><a href="#gunicorn" class="headerlink" title="gunicorn"></a>gunicorn</h2><p><a href="http://gunicorn.org/" target="_blank" rel="external">gunicorn</a>æ˜¯ä¸€ä¸ªunixç”¨çš„WSGI HTTPæœåŠ¡å™¨ã€‚å®ƒæ˜¯ä»rubyçš„unicorné¡¹ç›®ä¸­ç§»æ¤è¿‡æ¥çš„ã€‚å®ƒåŸºäºâ€pre-fork workerâ€æ¨¡å‹ï¼Œä¼šé¢„å…ˆå¼€å¯å¤§é‡è¿›ç¨‹ï¼Œç­‰å¾…å¹¶å¤„ç†æ¥æ”¶åˆ°çš„è¯·æ±‚ï¼Œæ¯ä¸ªå•ç‹¬è¿›ç¨‹å¯ä»¥åŒæ—¶å¤„ç†å®ƒä»¬å„è‡ªæ¥åˆ°çš„è¯·æ±‚ï¼Œé¿å…è¿›ç¨‹å¯åŠ¨å’Œé”€æ¯çš„å¼€é”€ã€‚ä½†æ˜¯gunicornæ˜¯åŸºäºé˜»å¡å¼çš„ioï¼Œå¹¶å‘èƒ½åŠ›ç¨å¼±ã€‚å¦‚æœè¦æƒ³ç”¨å®ƒæ¥éƒ¨ç½²flaskåº”ç”¨ç›¸å½“ç®€ä¾¿ã€‚</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼Œè¦é€šè¿‡pipå®‰è£…gunicornï¼Œ<code>pip install gunicorn</code></li>
<li>åœ¨å®‰è£…å®Œæˆä¹‹åï¼Œé€šè¿‡å‘½ä»¤ï¼š<code>gunicorn -w 4 -b 127.0.0.1:4000 run:app</code>å°±å¯ä»¥å°†æ‰€è¦å¯åŠ¨çš„flaskåº”ç”¨ç¨‹åºå¯åŠ¨ã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">â†’ gunicorn -w 4 -b 127.0.0.1:4000 run:app</div><div class="line">[2016-12-12 21:44:16 +0800] [81837] [INFO] Starting gunicorn 19.6.0</div><div class="line">[2016-12-12 21:44:16 +0800] [81837] [INFO] Listening at: http://127.0.0.1:4000 (81837)</div><div class="line">[2016-12-12 21:44:16 +0800] [81837] [INFO] Using worker: sync</div><div class="line">[2016-12-12 21:44:16 +0800] [81840] [INFO] Booting worker with pid: 81840</div><div class="line">[2016-12-12 21:44:16 +0800] [81841] [INFO] Booting worker with pid: 81841</div><div class="line">[2016-12-12 21:44:16 +0800] [81842] [INFO] Booting worker with pid: 81842</div><div class="line">[2016-12-12 21:44:16 +0800] [81843] [INFO] Booting worker with pid: 81843</div></pre></td></tr></table></figure>
</li>
</ul>
<p>å…¶ä¸­-wæŒ‡çš„æ˜¯é¢„å®šä¹‰çš„å·¥ä½œè¿›ç¨‹æ•°ï¼Œ-bæŒ‡çš„æ˜¯è¦ç»‘å®šçš„ipå’Œç«¯å£ï¼Œrunæ˜¯flaskçš„å¯åŠ¨pythonæ–‡ä»¶ï¼Œappåˆ™æ˜¯flaskåº”ç”¨ç¨‹åºå®ä¾‹ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘çš„run.pyæ–‡ä»¶ä¸­æ˜¯è¿™æ ·çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app = Flask(__name__)</div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    app.run(debug=True, host=&apos;0.0.0.0&apos;, port=4000)</div></pre></td></tr></table></figure></p>
<h2 id="Tornado"><a href="#Tornado" class="headerlink" title="Tornado"></a>Tornado</h2><p><a href="http://www.tornadoweb.org/" target="_blank" rel="external">Tornado</a>ï¼Œå®ƒæ˜¯ä¸€æ¬¾å¼€æºçš„å¯ä¼¸ç¼©ã€éé˜»å¡å¼çš„webæœåŠ¡å™¨å’Œå·¥å…·é›†ã€‚åœ¨é«˜å¹¶å‘çš„åº”ç”¨åœºæ™¯ä¸­æœ‰ä¸é”™çš„æ•ˆæœã€‚åŒæ ·ï¼Œè¦æƒ³é€šè¿‡Tornadoæ¥éƒ¨ç½²flaskä¹Ÿæ˜¯å¾ˆç®€ä¾¿çš„ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼Œé€šè¿‡pipå®‰è£…<code>pip install tornado</code></li>
<li>ç¬¬äºŒéƒ¨ï¼Œåœ¨ä½ çš„flaskå¯åŠ¨æ–‡ä»¶å¤¹ä¸­æ–°å»ºpyæ–‡ä»¶ï¼Œç„¶åè¾“å…¥è¿™äº›å†…å®¹ï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™é€šè¿‡è¿™ä¸ªæ–°å»ºçš„æ–‡ä»¶å¯åŠ¨å³å¯:<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">from tornado.wsgi import WSGIContainer</div><div class="line">from tornado.httpserver import HTTPServer</div><div class="line">from tornado.ioloop import IOLoop</div><div class="line">from run import app</div><div class="line">http_server = HTTPServer(WSGIContainer(app))</div><div class="line">http_server.listen(4000)</div><div class="line">IOLoop.instance().start()</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Gevent"><a href="#Gevent" class="headerlink" title="Gevent"></a>Gevent</h2><p><a href="http://www.gevent.org/" target="_blank" rel="external">Gevent</a>æ˜¯ä¸€ä¸ªåŸºäºååŒç¨‹åºçš„pythonåº“ï¼Œä¸tornadoçš„éƒ¨ç½²æ–¹å¼ç±»ä¼¼ï¼Œé€šè¿‡geventéƒ¨ç½²flaskä¹Ÿæ˜¯ååˆ†çš„ä¾¿åˆ©ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">from gevent.wsgi import WSGIServer</div><div class="line">from run import app</div><div class="line">http_server = WSGIServer((&apos;&apos;, 4000), app)</div><div class="line">http_server.serve_forever()</div></pre></td></tr></table></figure></p>
<h1 id="nginx-httpä»£ç†"><a href="#nginx-httpä»£ç†" class="headerlink" title="nginx httpä»£ç†"></a>nginx httpä»£ç†</h1><p>å•çº¯ä¾é ä¸Šè¿°çš„è¿™äº›wsgiå®¹å™¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œå¾€å¾€è¿˜è¦åœ¨è¿™äº›å®¹å™¨å‰è¾¹åœ¨éƒ¨ç½²ä¸€ä¸ªnginxåšhttpè½¬å‘ã€‚nginxå¯ä»¥èµ·åˆ°è´Ÿè½½å‡è¡¡ã€æµé‡æ§åˆ¶ã€æ—¥å¿—ç®¡ç†ç­‰ç­‰æ›´åŠ ç²¾ç»†çš„å·¥ä½œã€‚å¯¹nginxçš„é…ç½®æ–‡ä»¶åšç®€å•çš„ä¿®æ”¹å³å¯å®Œæˆï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line"></div><div class="line">    server_name _;</div><div class="line"></div><div class="line">    access_log  /var/log/nginx/access.log;</div><div class="line">    error_log  /var/log/nginx/error.log;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">        proxy_pass         http://127.0.0.1:4000/;</div><div class="line">        proxy_redirect     off;</div><div class="line"></div><div class="line">        proxy_set_header   Host             $host;</div><div class="line">        proxy_set_header   X-Real-IP        $remote_addr;</div><div class="line">        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="å…¶ä»–çš„éƒ¨ç½²æ–¹å¼"><a href="#å…¶ä»–çš„éƒ¨ç½²æ–¹å¼" class="headerlink" title="å…¶ä»–çš„éƒ¨ç½²æ–¹å¼"></a>å…¶ä»–çš„éƒ¨ç½²æ–¹å¼</h1><p>å½“ç„¶ï¼Œé™¤äº†é€šè¿‡ä¸Šè¿°å‡ ä¸ªwsgiå®¹å™¨æ¥ç®€å•çš„éƒ¨ç½²flaskä»¥å¤–ï¼Œè¿˜æœ‰å…¶ä»–å‡ ç§æ–¹å¼ä¹Ÿå¯ä»¥é€‰æ‹©ï¼š<a href="http://www.pythondoc.com/flask/deploying/mod_wsgi.html" target="_blank" rel="external">mod_wsgi</a>ã€<a href="http://www.pythondoc.com/flask/deploying/uwsgi.html" target="_blank" rel="external">uwsgi</a>ã€<a href="http://www.pythondoc.com/flask/deploying/fastcgi.html" target="_blank" rel="external">fastcgi</a>ã€<a href="http://www.pythondoc.com/flask/deploying/cgi.html" target="_blank" rel="external">cgi</a>ã€‚</p>
<h1 id="è¿›ç¨‹ç®¡ç†å·¥å…·supervisor"><a href="#è¿›ç¨‹ç®¡ç†å·¥å…·supervisor" class="headerlink" title="è¿›ç¨‹ç®¡ç†å·¥å…·supervisor"></a>è¿›ç¨‹ç®¡ç†å·¥å…·supervisor</h1><p>æœ€è¿‘åœ¨æ‰¾flaskç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ç›¸å…³çš„å†…å®¹ï¼Œæ— æ„é—´ç¢°åˆ°ä¸€ä¸ªç¥å™¨ï¼š<a href="http://supervisord.org/" target="_blank" rel="external">supervisord</a>ã€‚<br>å®ƒæ˜¯ä¸€ä¸ªä½¿ç”¨pythonç¼–å†™çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¼€å¯ã€å…³é—­æˆ–è€…é‡å¯è¿›ç¨‹ã€‚å½“ä½ çš„ä¸»æœºä¸å°å¿ƒæŒ‚æ‰çš„æ—¶å€™ï¼Œé€šè¿‡é…åˆ¶å¥½çš„supervisordå¯ä»¥å¾ˆæ–¹ä¾¿çš„é‡å¯æœåŠ¡è€Œä¸ç”¨ä¸€è¡Œä¸€è¡Œæ•²å‘½ä»¤ã€‚è¦æƒ³ä½¿ç”¨supervisordï¼Œåªéœ€è¦è¿™å‡ æ­¥ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼Œå½“ç„¶è¿˜æ˜¯å®‰è£…ï¼š<code>sudo pip install supervisor</code></li>
<li>å®‰è£…å®Œæˆä¹‹åï¼Œä¸»è¦çš„ä»»åŠ¡å°±æ˜¯è¦å®Œæˆé…ç½®æ–‡ä»¶ï¼š<code>echo_supervisord_conf &gt; /path/to/supervisord.conf</code>ï¼Œå…ˆå°†supervisordçš„ç›¸å…³é…ç½®å¯¼å‡ºåˆ°æŒ‡å®šè·¯å¾„ä»¥ä¾›ä¿®æ”¹ï¼›</li>
<li><p>ä¸‹é¢ä¸»è¦ä¿®æ”¹æˆ‘ä»¬æ¯”è¾ƒå…³æ³¨çš„éƒ¨åˆ†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[program:usercenter]</div><div class="line">directory = /home/leon/projects/usercenter ; ç¨‹åºçš„å¯åŠ¨ç›®å½•</div><div class="line">command = gunicorn -c gunicorn.py wsgi:app  ; å¯åŠ¨å‘½ä»¤ï¼Œå¯ä»¥çœ‹å‡ºä¸æ‰‹åŠ¨åœ¨å‘½ä»¤è¡Œå¯åŠ¨çš„å‘½ä»¤æ˜¯ä¸€æ ·çš„</div><div class="line">autostart = true     ; åœ¨ supervisord å¯åŠ¨çš„æ—¶å€™ä¹Ÿè‡ªåŠ¨å¯åŠ¨</div><div class="line">startsecs = 5        ; å¯åŠ¨ 5 ç§’åæ²¡æœ‰å¼‚å¸¸é€€å‡ºï¼Œå°±å½“ä½œå·²ç»æ­£å¸¸å¯åŠ¨äº†</div><div class="line">autorestart = true   ; ç¨‹åºå¼‚å¸¸é€€å‡ºåè‡ªåŠ¨é‡å¯</div><div class="line">startretries = 3     ; å¯åŠ¨å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯ 3</div><div class="line">user = leon          ; ç”¨å“ªä¸ªç”¨æˆ·å¯åŠ¨</div><div class="line">redirect_stderr = true  ; æŠŠ stderr é‡å®šå‘åˆ° stdoutï¼Œé»˜è®¤ false</div><div class="line">stdout_logfile_maxbytes = 20MB  ; stdout æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤ 50MB</div><div class="line">stdout_logfile_backups = 20     ; stdout æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°</div><div class="line">; stdout æ—¥å¿—æ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„å½“æŒ‡å®šç›®å½•ä¸å­˜åœ¨æ—¶æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨åˆ›å»ºç›®å½•ï¼ˆsupervisord ä¼šè‡ªåŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶ï¼‰</div><div class="line">stdout_logfile = /data/logs/usercenter_stdout.log</div></pre></td></tr></table></figure>
</li>
<li><p>æŒ‰ç…§ä¸Šè¾¹çš„å†…å®¹ï¼Œå®Œæˆä¿®æ”¹ä¹‹åï¼Œæ¯”å¦‚è¯´æˆ‘çš„è¿™ä¸ªï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[program:flask]</div><div class="line">command=python ./app/main/run.py</div><div class="line">[program:getmsg]</div><div class="line">command=python ./app/dataCollector/Collector/rocket.py</div></pre></td></tr></table></figure>
</li>
</ul>
<p>è¿›å…¥å¯¹åº”çš„ç›®å½•ï¼Œé”®å…¥<code>supervisord -c manage.conf</code>å°±å¯ä»¥äº†</p>
<ul>
<li>æ¥ä¸‹æ¥é€šè¿‡supervisorctlå°±å¯ä»¥æŸ¥çœ‹å½“å‰è¿›ç¨‹è¿è¡Œçš„çŠ¶æ€ï¼Œå¯åŠ¨æˆ–è€…å…³é—­æŒ‡å®šè¿›ç¨‹äº†ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">â†’ supervisorctl -c  manage.conf</div><div class="line">flask                            RUNNING   pid 79541, uptime 4:43:15</div><div class="line">getmsg                           STOPPED   Dec 12 07:17 PM</div><div class="line">supervisor&gt; stop flask</div><div class="line">flask: stopped</div><div class="line">supervisor&gt; status</div><div class="line">flask                            STOPPED   Dec 12 09:43 PM</div><div class="line">getmsg                           STOPPED   Dec 12 07:17 PM</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="crontabåœ¨pythonè™šæ‹Ÿç¯å¢ƒä¸­çš„ä½¿ç”¨"><a href="#crontabåœ¨pythonè™šæ‹Ÿç¯å¢ƒä¸­çš„ä½¿ç”¨" class="headerlink" title="crontabåœ¨pythonè™šæ‹Ÿç¯å¢ƒä¸­çš„ä½¿ç”¨"></a>crontabåœ¨pythonè™šæ‹Ÿç¯å¢ƒä¸­çš„ä½¿ç”¨</h1><p>ä½¿ç”¨pythonå¼€å‘çš„åŒå­¦å¾€å¾€ä¼šä½¿ç”¨virtualenvæ¥ä½¿è‡ªå·±çš„å¼€å‘ç¯å¢ƒçº¯å‡€ä¸å—å¹²æ‰°ï¼Œæˆ‘åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦å°†ä¸€ä¸ªpythonè„šæœ¬é€šè¿‡crontabå®šæœŸæ‰§è¡Œã€‚åœ¨ç¼–å†™äº†å¯¹åº”çš„crontabé…ç½®æ–‡ä»¶ä¹‹åï¼Œå¹¶æ²¡æœ‰æŒ‰ç…§é¢„æƒ³çš„æ–¹å¼æ¥ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0,15,30,45 * * * * python /home/eclipse/git/env/DouyuFan/app/dataCollector/Collector/allRooms.py</div></pre></td></tr></table></figure></p>
<p>æ„Ÿè§‰æ˜æ˜æ²¡æœ‰é—®é¢˜ï¼Œå¯è„šæœ¬ä¸ºä»€ä¹ˆä¸æ‰§è¡Œå‘¢ï¼Œæ€è€ƒä¸€ä¸‹ï¼Œç”±äºæ˜¯åœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œï¼Œç›´æ¥é€šè¿‡python+è„šæœ¬æ–‡ä»¶çš„æ–¹å¼ï¼Œä½¿ç”¨çš„pythonè§£è¯‘å™¨æ˜¯ç³»ç»Ÿä¸­çš„pythonè€Œä¸æ˜¯è™šæ‹Ÿç¯å¢ƒä¸­çš„é‚£ä¸ªã€‚æ‰€ä»¥ä¸Šè¾¹çš„crontabé…ç½®æ”¹æˆè¿™æ ·å°±å¯ä»¥é¡ºåˆ©è¿è¡Œäº†ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0,15,30,45 * * * * /home/eclipse/git/env/bin/python /home/eclipse/git/env/DouyuFan/app/dataCollector/Collector/allRooms.py</div></pre></td></tr></table></figure></p>
<h1 id="å…³äºpythonå­¦ä¹ ç›¸å…³çš„æƒ³æ³•"><a href="#å…³äºpythonå­¦ä¹ ç›¸å…³çš„æƒ³æ³•" class="headerlink" title="å…³äºpythonå­¦ä¹ ç›¸å…³çš„æƒ³æ³•"></a>å…³äºpythonå­¦ä¹ ç›¸å…³çš„æƒ³æ³•</h1><p>ç”±äºè‡ªå·±ç¼ºä¹åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„å·¥ä½œç»éªŒï¼Œè¿™æ–¹é¢çŸ¥è¯†æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ¬ ç¼ºã€‚åªèƒ½é€šè¿‡è‡ªå·±æ…¢æ…¢æ‘¸ç´¢ã€‚å¦å¤–ï¼Œçœ‹äº†å‰å‡ å¤©åˆšä¹°çš„python cookbookä¹‹åï¼Œæ„Ÿè§‰åƒæ˜¯è¿›å…¥äº†pythonçš„æ–°ä¸–ç•Œï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å’Œå†…å®¹éƒ½æ˜¯ä¹‹å‰æ²¡æœ‰å°è¯•è¿‡çš„ï¼Œæœªæ¥è¦èµ°çš„è·¯è¿˜æœ‰å¾ˆé•¿ï¼ŒåŠ æ²¹ï¼</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[å¦‚ä½•è®©ä½ çš„ä»£ç æ›´åŠ pythonic]]></title>
      <url>/2016/11/28/%E5%A6%82%E4%BD%95%E8%AE%A9%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81%E6%9B%B4%E5%8A%A0pythonic/</url>
      <content type="html"><![CDATA[<p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œä»£ç é£æ ¼æ˜¯ä¸€ä»¶å¾ˆé‡è¦çš„äº‹æƒ…ï¼Œå®ƒå¾€å¾€ä¼šå…³ç³»åˆ°ä½ ä»£ç çš„å¯è¯»æ€§ç”šè‡³æ˜¯æ‰§è¡Œæ•ˆç‡ã€‚å¯¹äºpythonè€Œè¨€ï¼Œç»å¸¸ä¼šåœ¨æ‹›è˜è¦æ±‚ä¸­æœ‰ä¸€æ¡ï¼š<strong>pythonicçš„ä»£ç </strong>ã€‚é‚£ç©¶ç«Ÿä»€ä¹ˆæ˜¯pythonicï¼Œä»€ä¹ˆæ ·çš„ä»£ç æ‰æ˜¯pythonicçš„ä»£ç ï¼Œæˆ‘è‡ªå·±ä¹Ÿä¸€ç›´æœ‰è®©è‡ªå·±çš„ä»£ç æ›´åŠ pythonicï¼Œæ€»ç»“å¹³æ—¶çš„å·¥ä½œå­¦ä¹ å°±æœ‰äº†å¦‚ä¸‹è¿™äº›ã€‚<br><a id="more"></a></p>
<h1 id="ä¸ºä»€ä¹ˆè¦è®©ä»£ç pythonic"><a href="#ä¸ºä»€ä¹ˆè¦è®©ä»£ç pythonic" class="headerlink" title="ä¸ºä»€ä¹ˆè¦è®©ä»£ç pythonic"></a>ä¸ºä»€ä¹ˆè¦è®©ä»£ç pythonic</h1><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€äº›è¿™æ–¹é¢çš„<a href="http://safehammad.com/downloads/python-idioms-2014-01-16.pdf" target="_blank" rel="external">èµ„æ–™</a>ï¼š</p>
<blockquote>
<ul>
<li>Programs must be written for people to read, and only incidentally for machines to execute.</li>
<li>There should be one - and preferably only one - obvious way to do it.</li>
<li>The use of commonly understood syntax or coding constructs can aid readability and clarity.<br>Some idioms can be faster or use less memory than their â€œnon-idiomaticâ€ counterparts.<br>Pythonâ€™s idioms can make your code Pythonic!</li>
</ul>
</blockquote>
<p>å¦‚ä¸Šæ‰€è¯´ï¼Œpythonicçš„ä»£ç ä¼šæ˜æ˜¾å¢åŠ ä»£ç æ•´ä½“çš„å¯è¯»æ€§ã€‚å¹¶ä¸”ï¼Œç»è¿‡å¤§å®¶å¤šå¹´æ¥çš„å®é™…ç»éªŒå·²ç»æ‘¸ç´¢å‡ºä¸€äº›æ¯”è¾ƒæ˜ç¡®çš„è§„åˆ™æ¥è®©ä»£ç pythonicã€‚å¦å¤–ï¼Œpythonicçš„ä»£ç å¾€å¾€é™¤äº†æé«˜å¯è¯»æ€§ä»¥å¤–ä¼šæœ‰æ›´å¿«çš„è¿è¡Œé€Ÿåº¦å’Œæ›´å°‘çš„å†…å­˜å ç”¨ã€‚</p>
<h1 id="pythonicçš„ä¸€äº›å®è·µ"><a href="#pythonicçš„ä¸€äº›å®è·µ" class="headerlink" title="pythonicçš„ä¸€äº›å®è·µ"></a>pythonicçš„ä¸€äº›å®è·µ</h1><h2 id="Make-a-script-both-importable-and-executable"><a href="#Make-a-script-both-importable-and-executable" class="headerlink" title="Make a script both importable and executable"></a>Make a script both importable and executable</h2><p>è¿™é‡Œå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„ç¤ºä¾‹æ¥è¯´æ˜ç™½ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># non-idiomatic</div><div class="line">def main():</div><div class="line">    print(&quot;now we&apos;re in module&quot;, __name__)</div><div class="line">   </div><div class="line">print(&apos;Excuted from the command line&apos;)</div><div class="line">main()</div></pre></td></tr></table></figure></p>
<p>å¯¹äºä¸Šè¾¹è¿™å°æ®µå†…å®¹ï¼Œå¦‚æœå®ƒä»…ä»…æ˜¯å•ä¸ªå­˜åœ¨çš„è¯ï¼Œç›´æ¥æ‰§è¡Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯å½“å®ƒè¢«å½“ä½œmoduleåœ¨åˆ«çš„åœ°æ–¹è¢«importçš„è¯ï¼Œmain()å‡½æ•°ä¼šåœ¨è¢«å¼•å…¥çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œã€‚è€Œé€šè¿‡åœ¨åˆé€‚çš„ä½ç½®æ·»åŠ <code>if __name__ == &#39;__main__&#39;:</code>åˆ¤æ–­ï¼Œåˆ™å¯ä»¥æ›´å¥½çš„ç»„ç»‡è‡ªå·±çš„ä»£ç ã€‚å¯¹äºæˆ‘è‡ªå·±æ¥è¯´ï¼Œæˆ‘å¯èƒ½åœ¨æŸä¸ªmoduleä¸­é¡ºåŠ¿å†™äº†ä¸€äº›æµ‹è¯•æ–¹æ³•ï¼Œåœ¨è¢«åˆ«çš„åœ°æ–¹å¼•å…¥çš„æ—¶å€™ï¼Œè¿™äº›æµ‹è¯•æ–¹æ³•æˆ‘ä¸æƒ³è®©å®ƒæ‰§è¡Œï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨åˆ¤æ–­è¯­å¥ä¹‹åä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">def main():</div><div class="line">    print(&quot;now we&apos;re in module&quot;, __name__)</div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    print(&apos;do some test&apos;)</div><div class="line">    main()</div></pre></td></tr></table></figure></p>
<h2 id="Test-for-â€œtruthyâ€-and-â€œfalsyâ€-values"><a href="#Test-for-â€œtruthyâ€-and-â€œfalsyâ€-values" class="headerlink" title="Test for â€œtruthyâ€ and â€œfalsyâ€ values"></a>Test for â€œtruthyâ€ and â€œfalsyâ€ values</h2><p>pythonä¸­å…³äºçœŸå‡å€¼çš„åˆ¤æ–­ï¼Œå¸¸ç”¨çš„é›†ä¸­ç±»å‹å¯ä»¥å‚è€ƒè¿™ä¸ªè¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>TRUE</th>
<th>FALSE</th>
</tr>
</thead>
<tbody>
<tr>
<td>å­—ç¬¦ä¸²</td>
<td>éç©ºçš„å­—ç¬¦ä¸²</td>
<td>ç©ºå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>æ•°å­—</td>
<td>é0</td>
<td>0</td>
</tr>
<tr>
<td>å®¹å™¨</td>
<td>len(x)!=0</td>
<td>len(x)=0</td>
</tr>
</tbody>
</table>
<p>å¦‚ä½•åˆ¤æ–­çœŸå‡å€¼ï¼Œåˆ™æœ‰ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">name = &apos;Safe&apos;</div><div class="line">pets = [&apos;Dog&apos;, &apos;Cat&apos;, &apos;Hamster&apos;]</div><div class="line">owners = &#123;&apos;Safe&apos;: &apos;Cat&apos;, &apos;George&apos;: &apos;Dog&apos;&#125;</div><div class="line">if name and pets and owners:</div><div class="line">    print(&apos;We have pets!&apos;)</div><div class="line"># non-idiomatic</div><div class="line">if name != &apos;&apos; and len(pets) &gt; 0 and owners != &#123;&#125;:</div><div class="line">    print(&apos;We have pets!&apos;)</div></pre></td></tr></table></figure></p>
<h2 id="Use-in-where-possible"><a href="#Use-in-where-possible" class="headerlink" title="Use in where possible"></a>Use in where possible</h2><p>å°½é‡ä½¿ç”¨inå…³é”®å­—æ¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºä¸€ä¸ªå®¹å™¨ä¸­ï¼Œè¿™ä¸ªå®¹å™¨å¯ä»¥æ˜¯listï¼Œdictï¼Œsetï¼Œstringæˆ–è€…æ˜¯ä½ è‡ªå·±å®ç°äº†<strong>contains</strong>æ–¹æ³•çš„ç±»ã€‚æ¯”å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">name = &apos;Safe Hammad&apos;</div><div class="line">if &apos;H&apos; in name:</div><div class="line">    print(&apos;This name has an H in it!&apos;)</div><div class="line"># non-idiomatic</div><div class="line">name = &apos;Safe Hammad&apos;</div><div class="line">if name.find(&apos;H&apos;) != -1:</div><div class="line">    print(&apos;This name has an H in it!&apos;)</div></pre></td></tr></table></figure></p>
<p>æˆ–è€…ç”¨iné…åˆforæ¥éå†ä¸€ä¸ªåºåˆ—ï¼Œå®ƒå¯ä»¥æ˜¯listï¼Œsetï¼Œdictï¼Œstringæˆ–è€…æ˜¯ä½ è‡ªå·±å®ç°äº†<strong>iter</strong>æ–¹æ³•çš„ç±»ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">pets = [&apos;Dog&apos;, &apos;Cat&apos;, &apos;Hamster&apos;]</div><div class="line">for pet in pets:</div><div class="line">    print(&apos;A&apos;, pet, &apos;can be very cute!&apos;)</div><div class="line"># non-idiomatic</div><div class="line">pets = [&apos;Dog&apos;, &apos;Cat&apos;, &apos;Hamster&apos;] i=0</div><div class="line">while i &lt; len(pets):</div><div class="line">    print(&apos;A&apos;, pets[i], &apos;can be very cute!&apos;)</div><div class="line">    i += 1</div></pre></td></tr></table></figure></p>
<h2 id="Swap-values-without-temp-variable"><a href="#Swap-values-without-temp-variable" class="headerlink" title="Swap values without temp variable"></a>Swap values without temp variable</h2><p>æ„Ÿè§‰è¿™ä¸ªç‰¹æ€§å¾ˆå‰å®³ï¼ˆæˆ‘è‡ªå·±ç”¨çš„å¾ˆå°‘ï¼Œä»¥åè¦å¤šæ³¨æ„ï¼‰ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„è¡¨è¾¾å¼äº¤æ¢ä¸¤ä¸ªå…ƒç´ çš„å€¼ï¼Œå¹¶ä¸”ä¸éœ€è¦ä¸­é—´å˜é‡çš„å‚ä¸ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">a, b = 5, 6</div><div class="line">print(a, b)</div><div class="line">a, b = b, a</div><div class="line">print(a, b)</div><div class="line"># 5, 6 # 6, 5</div><div class="line"># 5, 6</div><div class="line"># non-idiomatic</div><div class="line">a, b = 5, 6</div><div class="line">print(a, b)</div><div class="line">temp = a a = b</div><div class="line">b = temp print(a, b)</div><div class="line"># 6, 5</div></pre></td></tr></table></figure></p>
<h2 id="Build-strings-using-sequence"><a href="#Build-strings-using-sequence" class="headerlink" title="Build strings using sequence"></a>Build strings using sequence</h2><p>åœ¨è¿æ¥å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œé€šè¿‡str.join()æ–¹æ³•è€—ç”¨çš„æ—¶é—´æ˜¯å’Œä¼ é€’ç»™joinæ–¹æ³•çš„å­—ç¬¦ä¸²é•¿åº¦çº¿æ€§ç›¸å…³çš„ï¼›è€Œé‡å¤çš„ä½¿ç”¨â€˜+â€™æ¥æ‹¼æ¥å­—ç¬¦ä¸²è€—ç”¨çš„æ—¶é—´ä¸å­—ç¬¦ä¸²é•¿åº¦å¹³æ–¹å…³ç³»é€’å¢ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">chars = [&apos;S&apos;, &apos;a&apos;, &apos;f&apos;, &apos;e&apos;]</div><div class="line">name = &apos;&apos;.join(chars)</div><div class="line">print(name)           # Safe</div><div class="line"># non-idiomatic</div><div class="line">chars = [&apos;S&apos;, &apos;a&apos;, &apos;f&apos;, &apos;e&apos;]</div><div class="line">name = &apos;&apos;</div><div class="line">for char in chars:</div><div class="line">    name += char</div><div class="line">print(name)           # Safe</div></pre></td></tr></table></figure></p>
<h2 id="è½¬æ¢å€¼ç±»å‹çš„æœ€ä½³å®è·µ"><a href="#è½¬æ¢å€¼ç±»å‹çš„æœ€ä½³å®è·µ" class="headerlink" title="è½¬æ¢å€¼ç±»å‹çš„æœ€ä½³å®è·µ"></a>è½¬æ¢å€¼ç±»å‹çš„æœ€ä½³å®è·µ</h2><p>é€šè¿‡ä¸€ä¸ªå®ä¾‹å¯ä»¥æ›´å¥½çš„è¯´æ˜è¿™æ¡åŸåˆ™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">d = &#123;&apos;x&apos;: &apos;5&apos;&#125;</div><div class="line">try:</div><div class="line">	value = int(d[&apos;x&apos;])</div><div class="line">except (KeyError, TypeError, ValueError):</div><div class="line">	value = None</div><div class="line"># non-idiomatic</div><div class="line">d = &#123;&apos;x&apos;: &apos;5&apos;&#125;</div><div class="line">if &apos;x&apos; in d and \</div><div class="line">   isinstance(d[&apos;x&apos;], str) and \</div><div class="line">   d[&apos;x&apos;].isdigit():</div><div class="line">    value = int(d[&apos;x&apos;])</div><div class="line">else:</div><div class="line">	value = None</div></pre></td></tr></table></figure></p>
<p>åœ¨æˆ‘è‡ªå·±çš„å®é™…ä½¿ç”¨ä¸­ï¼Œä¹Ÿç»å¸¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œé€šè¿‡ç½‘é¡µæŠ“å»åˆ°çš„idå·æˆ–è€…æ˜¯å•†å“çš„ä»·æ ¼å¾€å¾€æ˜¯strç±»å‹çš„ï¼Œæˆ‘æƒ³æŠŠå®ƒå½“ä½œæ•°å­—å­˜åœ¨åº“é‡Œä»…ä»…é€šè¿‡<code>value = int(strValue)</code>æ˜¯å¾ˆä¸å®‰å…¨çš„ã€‚è€Œé€šè¿‡ä¸Šè¿°çš„æ–¹æ³•å¯ä»¥ä»¥æ›´å®‰å…¨çš„æ–¹æ³•å¾—åˆ°è‡ªå·±æƒ³è¦çš„ç»“æœã€‚<br>å¦å¤–ï¼Œåœ¨pythonä¸­æŠ›å‡ºå¼‚å¸¸çš„ä»£ä»·å¯¹æ¯”ä¸javaè¿™ç§è¦å°å¾ˆå¤šã€‚</p>
<h2 id="Enumerate"><a href="#Enumerate" class="headerlink" title="Enumerate"></a>Enumerate</h2><p>Enumerate ä»python2.3å¼•è¿›ï¼Œå®ƒå¤šç”¨äºforå¾ªç¯ä¸­å¾—åˆ°å…ƒç´ åœ¨å®¹å™¨ä¸­æ‰€åœ¨çš„ä½ç½®ï¼Œä½¿ç”¨Enumerateå¯ä»¥æœ‰æ•ˆçš„é¿å…å¤§é‡çš„<code>count += 1</code>è¿™æ ·çš„ä»£ç ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">names = [&apos;Safe&apos;, &apos;George&apos;, &apos;Mildred&apos;]</div><div class="line">for i, name in enumerate(names):</div><div class="line">    print(i, name)   #  0 Safe, 1 George etc.</div><div class="line"># non-idiomatic</div><div class="line">names = [&apos;Safe&apos;, &apos;George&apos;, &apos;Mildred&apos;]</div><div class="line">count = 0</div><div class="line">for name in names:</div><div class="line">    print(i, name)   #  0 Safe, 1 George etc.</div><div class="line">    count += 1</div></pre></td></tr></table></figure></p>
<h2 id="Build-lists-using-list-comprehensions"><a href="#Build-lists-using-list-comprehensions" class="headerlink" title="Build lists using list comprehensions"></a>Build lists using list comprehensions</h2><p>æ›´å¤šçš„ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼æ¥æ„å»ºlistï¼Œåœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ—è¡¨æ¨å¯¼å¼ä¼šæ¯”ä½¿ç”¨container.append(x)æ›´åŠ ç®€æ´ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">data = [7, 20, 3, 15, 11]</div><div class="line">result = [i * 3 for i in data if i &gt; 10]</div><div class="line">print(result)   # [60, 45, 33]</div><div class="line"># non-idiomatic</div><div class="line">data = [7, 20, 3, 15, 11]</div><div class="line">result = []</div><div class="line">for i in data:</div><div class="line">    if i &gt; 10:</div><div class="line">        result.append(i * 3)</div><div class="line">print(result)   # [60, 45, 33]</div></pre></td></tr></table></figure></p>
<h2 id="Create-dict-from-keys-and-values-using-zip"><a href="#Create-dict-from-keys-and-values-using-zip" class="headerlink" title="Create dict from keys and values using zip"></a>Create dict from keys and values using zip</h2><p>å¦‚æœæƒ³è¦å°†ä¸¤ä¸ªç°æœ‰çš„liståˆå¹¶ä¸ºé”®å€¼å¯¹ç»„åˆï¼Œé€šè¿‡zipæ–¹æ³•ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©:<code>d = dict(zip(keys, values))</code><br>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># pythonic</div><div class="line">keys = [&apos;Safe&apos;, &apos;Bob&apos;, &apos;Thomas&apos;]</div><div class="line">values = [&apos;Hammad&apos;, &apos;Builder&apos;, &apos;Engine&apos;]</div><div class="line">d = dict(zip(keys, values))</div><div class="line">print(d)  # &#123;&apos;Bob&apos;: &apos;Builder&apos;,</div><div class="line">          #   &apos;Safe&apos;: &apos;Hammad&apos;,</div><div class="line">          #   &apos;Thomas&apos;: &apos;Engine&apos;&#125;</div><div class="line"># non-idiomatic</div><div class="line">keys = [&apos;Safe&apos;, &apos;Bob&apos;, &apos;Thomas&apos;]</div><div class="line">values = [&apos;Hammad&apos;, &apos;Builder&apos;, &apos;Engine&apos;]</div><div class="line">d = &#123;&#125;</div><div class="line">for i, key in enumerate(keys):</div><div class="line">    d[keys] = values[i]</div><div class="line">print(d)   # &#123;&apos;Bob&apos;: &apos;Builder&apos;,</div><div class="line">           #   &apos;Safe&apos;: &apos;Hammad&apos;,</div><div class="line">           #   &apos;Thomas&apos;: &apos;Engine&apos;&#125;</div></pre></td></tr></table></figure></p>
<h1 id="è·¯æ¼«æ¼«è€Œä¿®è¿œ"><a href="#è·¯æ¼«æ¼«è€Œä¿®è¿œ" class="headerlink" title="è·¯æ¼«æ¼«è€Œä¿®è¿œ"></a>è·¯æ¼«æ¼«è€Œä¿®è¿œ</h1><p>å½“ç„¶ï¼Œä¸Šè¿°çš„è¿™äº›ä»…ä»…æ˜¯å†°å±±ä¸€è§’ï¼Œåœ¨è‡ªå·±å†™ä»£ç çš„è¿‡ç¨‹ä¸­åº”å½“å°½é‡éµå®ˆè¿™äº›å‡†åˆ™ï¼ŒåŠªåŠ›æé«˜è‡ªå·±çš„ä»£ç è´¨é‡ã€‚</p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> è¯»ä¹¦ </tag>
            
            <tag> pythonic </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è¯»Mongodbæƒå¨æŒ‡å—æœ‰æ„Ÿ]]></title>
      <url>/2016/11/25/%E8%AF%BBMongodb%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E6%9C%89%E6%84%9F/</url>
      <content type="html"><![CDATA[<p>ç”±äºä¹‹å‰ä»å›¾ä¹¦é¦†å€Ÿçš„ä¹¦å·²ç»åˆ°æœŸäº†ï¼Œå‰å¤©ä¸‹åˆè¶ç€å¥½å¤©æ°”å»å›¾ä¹¦é¦†äº†ä¸€è¶Ÿï¼Œé¡ºä¾¿å€Ÿå›æ¥ä¸¤æœ¬<a href="https://book.douban.com/subject/25798102/" target="_blank" rel="external">ã€ŠMongodbæƒå¨æŒ‡å—ã€‹</a>å’Œ<a href="https://book.douban.com/subject/25856314/" target="_blank" rel="external">ã€ŠWebæ€§èƒ½æƒå¨æŒ‡å—ã€‹</a>ã€‚æ²¡æƒ³åˆ°ä¸¤å¤©æ—¶é—´å°±æŠŠå‰è¾¹é‚£æœ¬çœ‹å®Œäº†ã€‚æ€»ä½“æ„Ÿè§‰è¿˜ä¸é”™ï¼Œè¿™æœ¬ä¹¦å†™çš„æ¯”è¾ƒç»†è‡´ï¼Œå¾ˆé€‚åˆå…¥é—¨å­¦ä¹ ï¼ŒåŒæ—¶åœ¨çœ‹ä¹¦çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°äº†ä¹‹å‰æ²¡æœ‰ä¸»è¦åˆ°çš„ä¸€äº›çŸ¥è¯†ç‚¹ï¼Œå¹¶ä¸”æ”¹å˜äº†æˆ‘ä¹‹å‰çš„ä¸€äº›é”™è¯¯è®¤è¯†ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾ˆæœ‰å¿…è¦è®°å½•ä¸€ä¸‹çš„ã€‚<br><a id="more"></a></p>
<h1 id="æ²¡æ³¨æ„åˆ°çš„ç‚¹"><a href="#æ²¡æ³¨æ„åˆ°çš„ç‚¹" class="headerlink" title="æ²¡æ³¨æ„åˆ°çš„ç‚¹"></a>æ²¡æ³¨æ„åˆ°çš„ç‚¹</h1><h2 id="TTLç´¢å¼•"><a href="#TTLç´¢å¼•" class="headerlink" title="TTLç´¢å¼•"></a>TTLç´¢å¼•</h2><p>TTL(time-to-live)ç´¢å¼•åœ¨mongodbä¸­ä¸»è¦èµ·åˆ°çš„ä½œç”¨å°±æ˜¯åœ¨æŒ‡å®šæ—¶é—´é‡Œï¼Œå¦‚æœä¸€æ¡è®°å½•éƒ½æ²¡æœ‰å‘ç”Ÿå˜åŒ–å°±ä¼šè¢«è‡ªåŠ¨ç§»é™¤ï¼Œå¯ä»¥èµ·åˆ°ç±»ä¼¼redisä¸­EXPIREå‘½ä»¤çš„ä½œç”¨ã€‚å®ƒçš„ç”¨æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># åœ¨è¡¨colä¸­ä¸ºlastOpå­—æ®µå»ºç«‹TTLç´¢å¼•ï¼Œè¿‡æœŸæ—¶é—´æ˜¯60*60ï¼Œå•ä½ä¸ºç§’</div><div class="line">db.col.ensuerIndex(&#123;&apos;lastOp&apos;:1&#125;,&#123;&apos;expireAfterSecs&apos;:60*60&#125;)</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ol>
<li>TTLç´¢å¼•å¿…é¡»å»ºç«‹åœ¨æ—¥æœŸç±»å‹çš„å­—æ®µä¸Š</li>
<li>TTLç´¢å¼•ä¸èƒ½å¤Ÿæ˜¯å¤åˆç´¢å¼•ï¼Œä½†æ˜¯å¦‚æœå»ºç«‹äº†TTLç´¢å¼•ï¼Œå®ƒå¯ä»¥åœ¨æ’åºå’ŒæŸ¥è¯¢ä¸­å¯¹æ£€ç´¢é€Ÿåº¦æœ‰ä¼˜åŒ–</li>
<li>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœå»ºç«‹äº†è¿™ç§ç´¢å¼•ï¼Œä¸ºé˜²æ­¢åˆ é™¤æ­£åœ¨è¿›è¡Œçš„ä¼šè¯ï¼Œå¯ä»¥åœ¨è¿›è¡Œæ“ä½œçš„è¿‡ç¨‹ä¸­updateè¿™ä¸ªå­—æ®µ</li>
</ol>
<h2 id="explain"><a href="#explain" class="headerlink" title="explain()"></a>explain()</h2><p>æ•°æ®å…¥äº†åº“ï¼Œå¦‚ä½•èƒ½å¤Ÿåœ¨æœ€çŸ­çš„æ—¶é—´å†…æ£€ç´¢å‡ºæ¥æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ã€‚åœ¨mongodbä¸­ï¼Œæœ‰å„å¼å„æ ·çš„ç´¢å¼•ï¼šæœ€ä¸ºæ™®é€šçš„å•å­—æ®µç´¢å¼•ã€å¤šä¸ªå­—æ®µè”åˆèµ·æ¥çš„å¤åˆç´¢å¼•ã€ä¸Šè¾¹åˆšè¯´åˆ°çš„TTLç´¢å¼•è¿˜æœ‰é’ˆå¯¹åœ°ç†ç©ºé—´çš„åœ°ç†ç©ºé—´ç´¢å¼•ã€‚ç´¢å¼•å¾€å¾€ä¼šå¯¹æ£€ç´¢æ•ˆç‡æœ‰è´¨çš„æå‡ï¼Œä½†æ˜¯å¦‚ä½•æ‰èƒ½å¤ŸçŸ¥é“è‡ªå·±å»ºç«‹çš„ç´¢å¼•æœ‰æ²¡æœ‰èµ·ä½œç”¨ï¼Ÿexplain()å’Œhint()è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ç»™ä½ ä¸€ä¸ªç­”å¤ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"># æœªå»ºç«‹ç´¢å¼•</div><div class="line">&gt; db.Position.find(&#123;&apos;company&apos;:&apos;æ‹‰å‹¾ç½‘&apos;&#125;).explain()</div><div class="line">&#123;</div><div class="line">	&quot;queryPlanner&quot; : &#123;</div><div class="line">		&quot;plannerVersion&quot; : 1,</div><div class="line">		&quot;namespace&quot; : &quot;lagou.Position&quot;,</div><div class="line">		&quot;indexFilterSet&quot; : false,</div><div class="line">		&quot;parsedQuery&quot; : &#123;</div><div class="line">			&quot;company&quot; : &#123;</div><div class="line">				&quot;$eq&quot; : &quot;æ‹‰å‹¾ç½‘&quot;</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		&quot;winningPlan&quot; : &#123;</div><div class="line">			&quot;stage&quot; : &quot;COLLSCAN&quot;,</div><div class="line">			&quot;filter&quot; : &#123;</div><div class="line">				&quot;company&quot; : &#123;</div><div class="line">					&quot;$eq&quot; : &quot;æ‹‰å‹¾ç½‘&quot;</div><div class="line">				&#125;</div><div class="line">			&#125;,</div><div class="line">			&quot;direction&quot; : &quot;forward&quot;</div><div class="line">		&#125;,</div><div class="line">		&quot;rejectedPlans&quot; : [ ]</div><div class="line">	&#125;,</div><div class="line">	...</div><div class="line">&#125;</div><div class="line"># ç´¢å¼•ä¹‹å</div><div class="line">&gt; db.Position.find(&#123;&apos;company&apos;:&apos;æ‹‰å‹¾ç½‘&apos;&#125;).explain()</div><div class="line">&#123;</div><div class="line">	&quot;queryPlanner&quot; : &#123;</div><div class="line">		&quot;plannerVersion&quot; : 1,</div><div class="line">		&quot;namespace&quot; : &quot;lagou.Position&quot;,</div><div class="line">		&quot;indexFilterSet&quot; : false,</div><div class="line">		&quot;parsedQuery&quot; : &#123;</div><div class="line">			&quot;company&quot; : &#123;</div><div class="line">				&quot;$eq&quot; : &quot;æ‹‰å‹¾ç½‘&quot;</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		&quot;winningPlan&quot; : &#123;</div><div class="line">			&quot;stage&quot; : &quot;FETCH&quot;,</div><div class="line">			&quot;inputStage&quot; : &#123;</div><div class="line">				&quot;stage&quot; : &quot;IXSCAN&quot;,</div><div class="line">				&quot;keyPattern&quot; : &#123;</div><div class="line">					&quot;company&quot; : 1</div><div class="line">				&#125;,</div><div class="line">				&quot;indexName&quot; : &quot;company_1&quot;,</div><div class="line">				&quot;isMultiKey&quot; : false,</div><div class="line">				&quot;multiKeyPaths&quot; : &#123;</div><div class="line">					&quot;company&quot; : [ ]</div><div class="line">				&#125;,</div><div class="line">				&quot;isUnique&quot; : false,</div><div class="line">				&quot;isSparse&quot; : false,</div><div class="line">				&quot;isPartial&quot; : false,</div><div class="line">				&quot;indexVersion&quot; : 2,</div><div class="line">				&quot;direction&quot; : &quot;forward&quot;,</div><div class="line">				&quot;indexBounds&quot; : &#123;</div><div class="line">					&quot;company&quot; : [</div><div class="line">						&quot;[\&quot;æ‹‰å‹¾ç½‘\&quot;, \&quot;æ‹‰å‹¾ç½‘\&quot;]&quot;</div><div class="line">					]</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		&quot;rejectedPlans&quot; : [ ]</div><div class="line">	&#125;,</div><div class="line">	...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å»ºç«‹ç´¢å¼•å‰åï¼Œexplain()çš„ç»“æœåœ¨â€winningPlanâ€å­—æ®µä¸­æœ‰æ˜æ˜¾ä¸åŒï¼Œæœªå»ºç«‹ç´¢å¼•çš„æ—¶å€™ï¼š<code>&quot;stage&quot; : &quot;COLLSCAN&quot;</code>å»ºç«‹ç´¢å¼•ä¹‹åï¼š<code>&quot;stage&quot; : &quot;IXSCAN&quot;</code>ã€‚å‰è€…çš„COLLSCANè¡¨ç¤ºçš„æ„æ€æ˜¯é€šè¿‡å…¨è¡¨æ‰«æçš„æ–¹å¼æ£€ç´¢ï¼Œåè¾¹çš„åˆ™æ˜¯é€šè¿‡å·²ç»å»ºç«‹çš„ç´¢å¼•è¿›è¡Œæ£€ç´¢ã€‚<br>å†æ¥ä¸€ä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"># æœªå»ºç«‹ç´¢å¼•</div><div class="line">&gt; db.Position.find(&#123;&apos;loc&apos;:&#123;$near:&#123;$geometry:&#123;type:&apos;Point&apos;,coordinates:[113,40]&#125;&#125;&#125;&#125;).explain()</div><div class="line">2016-11-25T14:13:23.421+0800 E QUERY    [main] Error: explain failed: &#123;</div><div class="line">	&quot;ok&quot; : 0,</div><div class="line">	&quot;errmsg&quot; : &quot;error processing query: ns=lagou.PositionTree: GEONEAR  field=loc maxdist=1.79769e+308 isNearSphere=0\nSort: &#123;&#125;\nProj: &#123;&#125;\n planner returned error: unable to find index for $geoNear query&quot;,</div><div class="line">	&quot;code&quot; : 2,</div><div class="line">	&quot;codeName&quot; : &quot;BadValue&quot;</div><div class="line">&#125;</div><div class="line"># å»ºç«‹ç´¢å¼•</div><div class="line">&gt; db.Position.ensureIndex(&#123;loc:&apos;2dsphere&apos;&#125;)</div><div class="line">&#123;</div><div class="line">	&quot;createdCollectionAutomatically&quot; : false,</div><div class="line">	&quot;numIndexesBefore&quot; : 2,</div><div class="line">	&quot;numIndexesAfter&quot; : 3,</div><div class="line">	&quot;ok&quot; : 1</div><div class="line">&#125;</div><div class="line"># ç´¢å¼•ä¹‹å</div><div class="line">&gt; db.Position.find(&#123;&apos;loc&apos;:&#123;$near:&#123;$geometry:&#123;type:&apos;Point&apos;,coordinates:[113,40]&#125;&#125;&#125;&#125;).explain()</div><div class="line">&#123;</div><div class="line">	&quot;queryPlanner&quot; : &#123;</div><div class="line">		...,</div><div class="line">		&quot;winningPlan&quot; : &#123;</div><div class="line">			&quot;stage&quot; : &quot;GEO_NEAR_2DSPHERE&quot;,</div><div class="line">			&quot;keyPattern&quot; : &#123;</div><div class="line">				&quot;loc&quot; : &quot;2dsphere&quot;</div><div class="line">			&#125;,</div><div class="line">			&quot;indexName&quot; : &quot;loc_2dsphere&quot;,</div><div class="line">			&quot;indexVersion&quot; : 2</div><div class="line">		&#125;,</div><div class="line">		&quot;rejectedPlans&quot; : [ ]</div><div class="line">	&#125;,</div><div class="line">	...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç”±äºä¹‹å‰ä¸€ç›´åªæ˜¯åœç•™åœ¨ä¼šç”¨mongodbçš„é˜¶æ®µï¼Œåƒç±»ä¼¼explain()è¿™æ ·çš„æ•°æ®åº“è°ƒä¼˜çš„æ–¹æ³•ä¼šç”¨çš„æ¯”è¾ƒå°‘ã€‚ç°åœ¨çš„è¯æ„Ÿè§‰è¿˜æ˜¯ä»”ç»†ç ”ç©¶å…³äºmongodbçš„å„ä¸ªæ–¹é¢è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ä¸èƒ½åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­åªä¼šæœ‰â€œå•Šï¼å¥½ç‰¹ä¹ˆå¿«å‘€ï¼â€æˆ–è€…æ˜¯â€œæ²ƒè‰¸ï¼Œæ€ä¹ˆè¿™ä¹ˆæ…¢â€çš„æ„Ÿæ€§è®¤è¯†ï¼ŒçŸ¥é“å¦‚ä½•è®©å®ƒå˜å¿«æ‰æ˜¯é‡ç‚¹ã€‚</p>
<h2 id="å¦‚ä½•ç”¨ç´¢å¼•"><a href="#å¦‚ä½•ç”¨ç´¢å¼•" class="headerlink" title="å¦‚ä½•ç”¨ç´¢å¼•"></a>å¦‚ä½•ç”¨ç´¢å¼•</h2><p>è¿˜è®°å¾—å½“åˆæ›¾ç»å»å—é€šå°é—­å¼€å‘ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œç”±äºåœ¨mongodbä¸­ä¸€ä¸ªé›†åˆå­˜çš„æ•°æ®è¿‡å¤šï¼Œé€ æˆåœ¨æ£€ç´¢çš„æ—¶å€™å‡ºç°è¶…æ—¶çš„æƒ…å†µã€‚å¦‚æœæ²¡æœ‰è®°é”™çš„è¯ï¼Œæˆ‘è®°å¾—é€ æˆæ£€ç´¢å¤±è´¥çš„åŸå› æ˜¯ç”±äºé‚£ä¸ªé›†åˆçš„å¤§å°è¶…å‡ºäº†æˆ‘ç¬”è®°æœ¬çš„ç‰©ç†å†…å­˜å¤§å°ï¼Œé€šè¿‡æ™®é€šçš„â€œå…¨è¡¨æ‰«æâ€çš„æ–¹æ³•å·²ç»æ— æ³•å®Œæˆæ­£å¸¸çš„æ£€ç´¢ã€‚åœ¨å»ºç«‹äº†ç´¢å¼•ä¹‹åï¼Œæ•°æ®é‡å¢å¤§10å€æ£€ç´¢é€Ÿåº¦ä¹Ÿæ˜¯æ æ çš„ã€‚<br>æ‰€ä»¥è¯´ï¼Œç´¢å¼•å¯¹äºæ•°æ®åº“æ¥è¯´æ˜¯æå…¶é‡è¦çš„ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªä¸œè¥¿æˆ‘ä¼šåœ¨ä»¥åæ·±å…¥ç ”ç©¶å®ƒçš„åŸç†ã€‚åœ¨å¹³å¸¸çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¯¹äºä¸€ä¸ªé›†åˆï¼Œè¯¥ä¸è¯¥å»ºç«‹ç´¢å¼•ï¼Œå¦‚ä½•å»ºç«‹ç´¢å¼•ï¼Œéƒ½æ˜¯å¾ˆåº”è¯¥è€ƒè™‘çš„äº‹æƒ…ã€‚</p>
<blockquote>
<p>ç´¢å¼•é€šå¸¸é€‚ç”¨çš„æƒ…å†µï¼šåœ¨é›†åˆæ•°æ®é‡è¾ƒå¤§çš„æ—¶å€™ï¼ŒåŒæ—¶ç»å¸¸éœ€è¦æŸ¥è¯¢çš„å­—æ®µç´¢å¼•åŸºæ•°è¾ƒå¤§çš„æƒ…å†µã€‚è¿™é‡Œæ‰€è¯´çš„ç´¢å¼•åŸºæ•°æŒ‡çš„æ˜¯é›†åˆä¸­æŸä¸ªå­—æ®µæ‹¥æœ‰ä¸åŒå€¼çš„æ•°é‡ï¼Œä¸€ä¸ªå­—æ®µçš„ç´¢å¼•åŸºæ•°è¶Šé«˜ï¼Œåœ¨è¿™ä¸ªé”®ä¸Šå»ºç«‹ç´¢å¼•å°±è¶Šæœ‰ç”¨ï¼Œè¿™æ˜¯å› ä¸ºç´¢å¼•èƒ½å¤Ÿå¿«é€Ÿåœ°è®²æœç´¢èŒƒå›´ç¼©å°ã€‚å¦å¤–ï¼Œå¦‚æœä½ éœ€è¦è¿›è¡Œåœ°ç†ç©ºé—´æ–¹é¢çš„æ£€ç´¢ï¼Œ2dsphereæˆ–è€…2dç´¢å¼•æ˜¯å¿…é¡»çš„ã€‚</p>
</blockquote>
<h2 id="mongodbè‡ªå¸¦å·¥å…·"><a href="#mongodbè‡ªå¸¦å·¥å…·" class="headerlink" title="mongodbè‡ªå¸¦å·¥å…·"></a>mongodbè‡ªå¸¦å·¥å…·</h2><p>åœ¨å„ä¸ªç‰ˆæœ¬çš„mongodbå‘è¡Œç‰ˆä¸­ï¼Œbinç›®å½•ä¸‹é™¤äº†mongoå’Œmongodå…¶ä»–å‡ ä¸ªå·¥å…·ä¹Ÿéƒ½å¾ˆå¥½ç”¨ï¼š<br>ä½¿ç”¨mongostatå¯ä»¥å®æ—¶çœ‹åˆ°å½“å‰mongodå®ä¾‹çš„è¿è¡Œå’Œè´Ÿè½½æƒ…å†µï¼Œmongotopåˆ™ç±»ä¼¼linuxç³»ç»Ÿä¸­çš„topå·¥å…·ï¼Œmongofilesåˆ™å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ“ä½œæ•°æ®åº“çš„gridfsã€‚å…¶ä»–çš„å„ä¸ªå·¥å…·ç›¸ä¿¡åœ¨ä»¥åçš„ä½¿ç”¨ä¸­éƒ½ä¼šæœ‰æ¥è§¦ã€‚</p>
<h1 id="é”™è¯¯çš„è®¤è¯†"><a href="#é”™è¯¯çš„è®¤è¯†" class="headerlink" title="é”™è¯¯çš„è®¤è¯†"></a>é”™è¯¯çš„è®¤è¯†</h1><p>ç”±äºä¹‹å‰çš„å®è·µæ¯”è¾ƒå°‘ï¼Œä¹Ÿæ²¡æœ‰è€ç€æ€§å­ä»”ç»†ç³»ç»Ÿçš„å­¦ä¹ mongodbï¼Œç›´åˆ°çœ‹äº†è¿™æœ¬ä¹¦æ‰å‘ç°ä¹‹å‰æœ‰å¾ˆå¤šç†è§£æ˜¯é”™çš„ï¼ˆå¹¶ä¸”æˆ‘åœ¨ç”¨çš„æ—¶å€™è¿˜çœŸçš„æ˜¯è¿™æ ·å¹²çš„ï¼‰ï¼Œè¿™éƒ¨åˆ†é”™è¯¯è®¤è¯†ä¸»è¦é›†ä¸­åœ¨mongodbçš„å‰¯æœ¬é›†åˆåˆ†ç‰‡é‚£éƒ¨åˆ†ã€‚</p>
<h2 id="å…³äºå‰¯æœ¬é›†"><a href="#å…³äºå‰¯æœ¬é›†" class="headerlink" title="å…³äºå‰¯æœ¬é›†"></a>å…³äºå‰¯æœ¬é›†</h2><p>ä¹‹å‰æ€»æ˜¯æƒ³ç€å‰¯æœ¬é›†æ˜¯ç”¨ä»¥ç¼“è§£mongodbè¯»å†™å‹åŠ›ï¼Œè¿›è¡Œè¯»å†™åˆ†ç¦»ç”¨çš„ï¼ŒprimaryèŠ‚ç‚¹è´Ÿè´£æ•°æ®å†™å…¥ï¼Œå„ä¸ªsecondaryèŠ‚ç‚¹åˆ™ä»primaryå®æ—¶è·å–æœ€æ–°æ•°æ®ï¼Œå¹¶æä¾›ç»™åº”ç”¨ç¨‹åºè¯»å–æ•°æ®çš„èƒ½åŠ›ã€‚ä»”ç»†çœ‹äº†è¿™æœ¬ä¹¦ä¹‹åï¼Œæ„Ÿè§‰ä¹‹å‰çœŸæ˜¯å¾ˆå‚»å¾ˆå¤©çœŸï¼Œè€Œä¸”æ·±åˆ‡è§‰å¾—è¿™ç§åˆ†å¸ƒå¼å­˜å‚¨åœ¨å®ç°è¿‡ç¨‹ä¸­è¦è€ƒè™‘çš„ä¸œè¥¿æ˜¯é‚£ä¹ˆå¤šã€‚</p>
<blockquote>
<p>ä½¿ç”¨å‰¯æœ¬é›†å¯ä»¥å°†æ•°æ®ä¿å­˜åˆ°å¤šå°æœåŠ¡å™¨ä¸Šï¼Œå»ºè®®åœ¨æ‰€æœ‰çš„ç”Ÿäº§ç¯å¢ƒä¸­éƒ½è¦ä½¿ç”¨ã€‚ä½¿ç”¨mongodbçš„å‰¯æœ¬é›†ï¼Œå³ä½¿ä¸€å°æˆ–è€…å¤šå°æœåŠ¡å™¨å‡ºé”™ï¼Œä¹Ÿå¯ä»¥ä¿è¯åº”ç”¨ç¨‹åºæ­£å¸¸è¿è¡Œå’Œæ•°æ®å®‰å…¨ã€‚å‰¯æœ¬é›†æ˜¯ä¸€ç»„æœåŠ¡å™¨ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªä¸»æœåŠ¡å™¨primaryï¼Œç”¨äºå¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ˆå½“ç„¶æ˜¯åŒ…æ‹¬è¯»å’Œå†™ï¼‰ï¼Œè¿˜æœ‰å¤šä¸ªå¤‡ä»½æœåŠ¡å™¨secondaryï¼Œç”¨ä»¥ä¿å­˜ä¸»æœåŠ¡å™¨çš„æ•°æ®å‰¯æœ¬ã€‚å¦‚æœä¸»æœåŠ¡å™¨å´©æºƒï¼Œå¤‡ä»½æœåŠ¡å™¨ä¼šé€‰ä¸¾å‡ºä¸€ä¸ªæˆå‘˜å°†å…¶å‡çº§ä¸ºä¸»æœåŠ¡å™¨ã€‚</p>
</blockquote>
<p>å…¶ä¸­æœ€å¤§çš„è¯¯è§£åœ¨ä¸å‰¯æœ¬é›†æˆå‘˜æ•°æ®åŒæ­¥çš„åŸç†ã€‚å¦‚ä¸Šè¾¹æ‰€è¯´ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºä»èŠ‚ç‚¹çš„æ•°æ®éƒ½æ˜¯å®æ—¶ä»ä¸»èŠ‚ç‚¹ä¸Šè¯»å–åˆ°çš„ï¼Œæ‰€ä»¥ä¸»èŠ‚ç‚¹è´Ÿè´£å†™å…¥æ•°æ®ï¼Œåœ¨å†™å…¥çš„åŒæ—¶ä»èŠ‚ç‚¹å¤åˆ¶æ•°æ®ï¼ˆè¿™æ ·ä¼šç»™ä¸»èŠ‚ç‚¹é€ æˆè¾ƒå¤§çš„è´Ÿè½½ï¼‰ï¼Œæ‰€ä»¥ä»èŠ‚ç‚¹å°±æ¥è´Ÿè´£æ•°æ®çš„è¯»å–å§ã€‚æˆ‘å®Œå…¨éƒ½æ²¡æ„è¯†åˆ°æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼ˆå¯¹äºæ•°æ®æ—¶æ•ˆæ€§è¦æ±‚è¾ƒé«˜çš„æƒ…å†µï¼‰è¿˜æœ‰å¦‚æœåœ¨å†™å…¥è´Ÿè½½å¤§çš„æ—¶å€™ï¼Œä»èŠ‚ç‚¹è¿˜ä»ä¸»èŠ‚ç‚¹è¯»å–æ•°æ®ï¼Œä¸»èŠ‚ç‚¹ä¸å°±å´©äº†å—ã€‚<br>è€Œå®é™…ä¸Šå‰¯æœ¬é›†å®ç°æ•°æ®åŒæ­¥æ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>å‰¯æœ¬é›†ç”¨ä»¥åœ¨å¤šå°æœåŠ¡å™¨ä¹‹é—´å¤‡ä»½æ•°æ®ï¼Œmongodbçš„å¤åˆ¶åŠŸèƒ½æ˜¯é€šè¿‡æ“ä½œæ—¥å¿—oplogå®ç°çš„ï¼Œæ“ä½œæ—¥å¿—åŒ…å«äº†ä¸»èŠ‚ç‚¹çš„æ¯ä¸€æ¬¡å†™æ“ä½œã€‚oplogæ˜¯ä¸»èŠ‚ç‚¹çš„localæ•°æ®åº“ä¸­çš„ä¸€ä¸ªå›ºå®šé›†åˆã€‚å¤‡ä»½èŠ‚ç‚¹é€šè¿‡æŸ¥è¯¢è¿™ä¸ªé›†åˆå°±å¯ä»¥çŸ¥é“éœ€è¦è¿›è¡Œå¤åˆ¶çš„æ“ä½œã€‚æ¯ä¸ªä»èŠ‚ç‚¹éƒ½ç»´æŠ¤è‡ªå·±çš„oplogï¼Œè®°å½•æ¯ä¸€æ¬¡ä»ä¸»èŠ‚ç‚¹å¤åˆ¶æ•°æ®çš„æ“ä½œï¼Œå¹¶ä¸”æ¯ä¸ªå‰¯æœ¬é›†æˆå‘˜éƒ½å¯ä»¥ä½œä¸ºåŒæ­¥æºæä¾›ç»™å…¶ä»–æˆå‘˜ã€‚</p>
</blockquote>
<h2 id="å…³äºåˆ†ç‰‡"><a href="#å…³äºåˆ†ç‰‡" class="headerlink" title="å…³äºåˆ†ç‰‡"></a>å…³äºåˆ†ç‰‡</h2><p>ç”±äºä¹‹å‰ç”¨åˆ°çš„æ•°æ®é‡è¿˜æ²¡æœ‰å¤§åˆ°å¿…é¡»ä½¿ç”¨åˆ†ç‰‡çš„ç¨‹åº¦ï¼Œè¿™æ¬¡çœ‹ä¹¦ä¹Ÿæ˜¯å¯¹åˆ†ç‰‡æœ‰äº†é‡æ–°çš„è®¤è¯†ã€‚<br>åˆ†ç‰‡ä¸»è¦ç”¨äºå°†æ•°æ®æ‹†åˆ†ï¼Œå°†æ•°æ®åˆ†æ•£å­˜æ”¾åˆ°ä¸åŒçš„æœºå™¨ä¸Šï¼Œmongodbæ”¯æŒè‡ªåŠ¨åˆ†ç‰‡ï¼Œå¯ä»¥ä½¿æ•°æ®åº“æ¶æ„å¯¹åº”ç”¨ç¨‹åºä¸å¯è§ï¼Œç®€åŒ–ç³»ç»Ÿç®¡ç†ã€‚mongodbçš„åˆ†ç‰‡å…è®¸ä½ åˆ›å»ºä¸€ä¸ªåŒ…å«è®¸å¤šå°æœºå™¨çš„é›†ç¾¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸Šè¾¹æ‰€è¯´çš„å‰¯æœ¬é›†å¯ä»¥ä½œä¸ºåˆ†ç‰‡çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªåˆ†ç‰‡ç”¨äºç»´æŠ¤ä¸€ä¸ªæ•°æ®é›†çš„å­é›†ã€‚<br>åˆ†ç‰‡å¯ä»¥å¸¦æ¥çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>å¢åŠ å¯ç”¨RAM</li>
<li>å¢åŠ å¯ç”¨ç£ç›˜ç©ºé—´</li>
<li>å‡è½»å•å°æœåŠ¡å™¨çš„è´Ÿè½½</li>
<li>æå‡æ•´ä¸ªç³»ç»Ÿçš„ååé‡</li>
</ul>
<h1 id="ä¸€äº›å…¶ä»–çš„æƒ³æ³•"><a href="#ä¸€äº›å…¶ä»–çš„æƒ³æ³•" class="headerlink" title="ä¸€äº›å…¶ä»–çš„æƒ³æ³•"></a>ä¸€äº›å…¶ä»–çš„æƒ³æ³•</h1><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ€æ–°çš„mongodbç‰ˆæœ¬å·²ç»æ¨å‡ºåˆ°3.4ã€‚mongodbçš„å‘å±•ä¸èƒ½è¯´ä¸å¿«ï¼Œè¿™æ¬¾å¯¹å¼€å‘è€…æå…¶å‹å¥½çš„æ•°æ®åº“çœŸçš„å¯ä»¥ä¸‹åŠŸå¤«ä»”ç»†å­¦ä¹ ã€ç ”ç©¶å’Œä½¿ç”¨ã€‚ä¸€äº›å¥½çš„ç‰¹æ€§ï¼šé™¤äº†ç›¸å¯¹é«˜æ•ˆçš„è¯»å†™ä¹‹å¤–ï¼ŒAggregationã€map-reduceéƒ½å¯ä»¥åº”ç”¨åœ¨å¤§æ•°æ®å¤„ç†ä¸Šï¼Œå®˜æ–¹æä¾›çš„ä¸»æµå¼€å‘è¯­è¨€çš„é©±åŠ¨ï¼Œå’Œsparkç»“åˆçš„connectoråœ¨æ•°æ®å®æ—¶åˆ†æä¸Šä¹Ÿä¼šæœ‰ä¸é”™çš„æ•ˆæœã€‚<br>è€Œä¸Šè¾¹è¯´åˆ°çš„è¿™äº›ä¸œè¥¿ï¼Œæˆ‘æƒ³åªæœ‰é€šè¿‡è‡ªå·±ä¸æ–­çš„å®è·µç»ƒä¹ æ‰èƒ½åœ¨å®é™…åº”ç”¨ä¸­æ¸¸åˆƒæœ‰ä½™ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Mongodb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> è¯»ä¹¦ </tag>
            
            <tag> mongodb </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mongodb Aggregation Pipleline]]></title>
      <url>/2016/11/23/mongodb_Aggregation/</url>
      <content type="html"><![CDATA[<p>Mongodbä½œä¸ºç›®å‰æœ€æµè¡Œçš„nosqlæ•°æ®åº“ä¹‹ä¸€ï¼Œå®ƒç»™æˆ‘ä»¬æä¾›äº†æµ·é‡æ•°æ®çš„ç®¡ç†èƒ½åŠ›ã€‚è€Œç°åœ¨æ­£å¤„äºå¤§æ•°æ®æœ€ä¸ºç«çƒ­çš„æ—¶ä»£ï¼Œå¦‚ä½•å°†æµ·é‡çš„æ•°æ®è½¬åŒ–ä¸ºå¯ç”¨çš„ä¿¡æ¯ï¼Œè¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼Œé¢å‘åº”ç”¨è€Œè®¾è®¡çš„mongodbåœ¨åŸºç¡€çš„æ•°æ®åˆ†æä¸Šæä¾›äº†aggregationè¿™ä¸€åŠŸèƒ½ï¼Œè¶³ä»¥æ»¡è¶³å¾ˆå¤šæ—¥å¸¸éœ€æ±‚ã€‚<br><a id="more"></a></p>
<h1 id="ç®¡é“ï¼ˆAggregation-Pipelineï¼‰"><a href="#ç®¡é“ï¼ˆAggregation-Pipelineï¼‰" class="headerlink" title="ç®¡é“ï¼ˆAggregation Pipelineï¼‰"></a>ç®¡é“ï¼ˆAggregation Pipelineï¼‰</h1><p>åœ¨mongodbä¸­ï¼ŒAggregationçš„æ“ä½œæ–¹æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.collection.aggregate( [ &#123; &lt;stage&gt; &#125;, ... ] )</div></pre></td></tr></table></figure></p>
<p>è€Œå…¶ä¸­çš„stageåˆ™æ˜¯æ„æˆç®¡é“çš„æ¯ä¸ªéƒ¨åˆ†ï¼Œå¯ä»¥ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªstageæ¥æ„æˆã€‚ç®¡é“æ˜¯mongodbæ•°æ®èšåˆçš„ä¸€ä¸ªæ–°æ¡†æ¶ï¼Œç±»ä¼¼äºæ•°æ®å¤„ç†çš„ç®¡é“ï¼Œæˆ–è€…è¯´æ˜¯åƒ*nixç³»ç»Ÿä¸­çš„ç®¡é“ã€‚å¯¹äºcollectionï¼Œç”±å¤šä¸ªstageæ„æˆçš„ç®¡é“èƒ½å¤Ÿå®ç°åˆ†ç»„ã€è¿‡æ»¤ç­‰åŠŸèƒ½ï¼Œæ–‡æ¡£æ¯ç»è¿‡ä¸€ä¸ªstageå°±è¿‡è¿›è¡Œå¯¹åº”çš„æ“ä½œå¹¶æŠŠæ“ä½œç»“æœè¾“å‡ºç»™ä¸‹ä¸€ä¸ªstageã€‚å› æ­¤ï¼Œæ„æˆç®¡é“çš„stageåˆ™è‡³å…³é‡è¦ï¼Œå®ƒèƒ½ç›´æ¥å†³å®šæœ€ç»ˆçš„å¤„ç†ç»“æœã€‚<br>æ¯ä¸ªstageç”±<strong>Stage Operators</strong>ï¼ˆç®¡é“æ“ä½œç¬¦ï¼‰å’Œ<strong>Expression Operators</strong>ï¼ˆç®¡é“è¡¨è¾¾å¼ï¼‰æ„æˆã€‚</p>
<h1 id="ç®¡é“æ“ä½œç¬¦"><a href="#ç®¡é“æ“ä½œç¬¦" class="headerlink" title="ç®¡é“æ“ä½œç¬¦"></a>ç®¡é“æ“ä½œç¬¦</h1><p>ç®¡é“æ“ä½œç¬¦ï¼Œå¯ä»¥ç†è§£ä¸ºæ¯ä¸ªstageä½ è¦å¯¹ç›®æ ‡æ•°æ®è¿›è¡Œçš„æ“ä½œï¼Œç›®å‰ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§æ“ä½œç¬¦ï¼š</p>
<h2 id="project"><a href="#project" class="headerlink" title="$project"></a>$project</h2><p>å¯¹äº$projectæ“ä½œç¬¦æ¥è¯´ï¼Œå®˜æ–¹çš„è§£é‡Šæ˜¯è¿™æ ·çš„ï¼š</p>
<blockquote>
<p>Reshapes each document in the stream, such as by adding new fields or removing existing fields. For each input document, outputs one document.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ$projectæ“ä½œç¬¦èƒ½å¤Ÿå®Œæˆå¢åŠ ã€åˆ é™¤ã€é‡å‘½åå­—æ®µï¼Œæ§åˆ¶æµå‘ä¸‹ä¸€ä¸ªstageçš„æ•°æ®ç»„ç»‡å½¢å¼ã€‚<br>ä»¥æˆ‘æŠ“å»çš„æ‹‰å‹¾ç½‘æ‹›è˜æ•°æ®ä¸ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># åŸå§‹æ•°æ®</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;Java&quot;</div><div class="line">&#125;</div><div class="line"># èšåˆæ–¹æ³•</div><div class="line">db.Category.aggregate(&#123;$project:&#123;category:1,é“¾æ¥:&quot;$url&quot;,åˆ†ç±»:&#123;tag:&quot;$tag&quot;,name:&quot;$name&quot;&#125;&#125;&#125;)</div><div class="line"># è¾“å‡ºç»“æœ</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;é“¾æ¥&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;,</div><div class="line">	&quot;åˆ†ç±»&quot; : &#123;</div><div class="line">		&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">		&quot;name&quot; : &quot;Java&quot;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="match"><a href="#match" class="headerlink" title="$match"></a>$match</h2><blockquote>
<p>Filters the document stream to allow only matching documents to pass unmodified into the next pipeline stage. $match uses standard MongoDB queries. For each input document, outputs either one document (a match) or zero documents (no match).</p>
</blockquote>
<p>$matchè¿ç®—ç¬¦ï¼Œç”¨äºç­›é€‰å‡ºç¬¦åˆç›®æ ‡æ¡ä»¶çš„æ•°æ®ä¼ ç»™ä¸‹ä¸€ä¸ªstageã€‚å®ƒçš„ç”¨æ³•å’Œæ™®é€šçš„find()ç±»ä¼¼ï¼Œä»¥ä¸‹ä¾‹æ¥è¯´ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># find()æŸ¥è¯¢</div><div class="line">db.Category.find(&#123;category:&quot;æŠ€æœ¯&quot;&#125;).pretty()</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;Java&quot;</div><div class="line">&#125;</div><div class="line"># èšåˆæ–¹æ³•</div><div class="line">db.Category.aggregate(&#123;$match:&#123;category:&quot;æŠ€æœ¯&quot;&#125;&#125;)</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;Java&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="limit"><a href="#limit" class="headerlink" title="$limit"></a>$limit</h2><blockquote>
<p>Passes the first n documents unmodified to the pipeline where n is the specified limit. For each input document, outputs either one document (for the first n documents) or zero documents (after the first n documents).</p>
</blockquote>
<p>ä¸æ™®é€šæŸ¥è¯¢ç±»ä¼¼ï¼Œlimitç”¨ä»¥é™åˆ¶è¾“å‡ºæ–‡æ¡£æ•°é‡ï¼Œåœ¨aggregtionä¸­çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"># å¸¸è§„æŸ¥è¯¢</div><div class="line">&gt; db.Category.find(&#123;category:&quot;æŠ€æœ¯&quot;&#125;).limit(3).pretty()</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;Java&quot;</div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b4&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Python/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;Python&quot;</div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b5&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/PHP/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;PHP&quot;</div><div class="line">&#125;</div><div class="line"># aggregation</div><div class="line">&gt; db.Category.aggregate(&#123;$limit:3&#125;).pretty()</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;Java&quot;</div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b4&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Python/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;Python&quot;</div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b5&quot;),</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/PHP/&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;name&quot; : &quot;PHP&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="skip"><a href="#skip" class="headerlink" title="$skip"></a>$skip</h2><blockquote>
<p>Skips the first n documents where n is the specified skip number and passes the remaining documents unmodified to the pipeline. For each input document, outputs either zero documents (for the first n documents) or one document (if after the first n documents).</p>
</blockquote>
<p>skipä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„æ“ä½œï¼Œç”¨ä»¥è·³è¿‡è¾“å…¥æ–‡æ¡£å‰nä¸ªæ–‡æ¡£ä¹‹åè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># å¸¸è§„å…¨è¡¨æ‰«æ</div><div class="line">&gt; db.Category.find().skip(1).limit(1)</div><div class="line">&#123; &quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b4&quot;), &quot;category&quot; : &quot;æŠ€æœ¯&quot;, &quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Python/&quot;, &quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;, &quot;name&quot; : &quot;Python&quot; &#125;</div><div class="line">&gt; db.Category.find().limit(1)</div><div class="line">&#123; &quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;), &quot;category&quot; : &quot;æŠ€æœ¯&quot;, &quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;, &quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;, &quot;name&quot; : &quot;Java&quot; &#125;</div><div class="line"># aggregationæ“ä½œ</div><div class="line">&gt; db.Category.aggregate(&#123;$limit:1&#125;)</div><div class="line">&#123; &quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;), &quot;category&quot; : &quot;æŠ€æœ¯&quot;, &quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;, &quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;, &quot;name&quot; : &quot;Java&quot; &#125;</div><div class="line">&gt; db.Category.aggregate(&#123;$skip:1&#125;,&#123;$limit:1&#125;)</div><div class="line">&#123; &quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b4&quot;), &quot;category&quot; : &quot;æŠ€æœ¯&quot;, &quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Python/&quot;, &quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;, &quot;name&quot; : &quot;Python&quot; &#125;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒåŒæ ·æ˜¯limit(1)ï¼Œåœ¨å¢åŠ äº†skipæ“ä½œä¹‹åï¼Œè¿”å›çš„ç»“æœæ˜¯ä¸ç›¸åŒçš„ã€‚</p>
<h2 id="lookup"><a href="#lookup" class="headerlink" title="$lookup"></a>$lookup</h2><blockquote>
<p>Performs a left outer join to another collection in the same database to filter in documents from the â€œjoinedâ€ collection for processing.</p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ$lookupçš„ä½œç”¨å°±æ˜¯è¿›è¡Œä¸€ä¸ªç±»ä¼¼sqlä¸­left joinçš„æ“ä½œï¼Œè€Œæ¯ä¸ªlookupæ“ä½œéœ€è¦æœ‰å››ä¸ªå‚æ•°ä¼ å…¥ï¼š</p>
<ul>
<li>from ç¡®å®šè¦è¿›è¡Œlookupçš„é›†åˆåï¼Œè¯¥é›†åˆå¿…é¡»ä¸å½“å‰è¿›è¡Œaggregateæ“ä½œçš„é›†åˆåœ¨åŒä¸€ä¸ªåº“ä¸­ï¼Œå¹¶ä¸”ä¸èƒ½åˆ†ç‰‡</li>
<li>localField åˆ¶å®šè¦è¿›è¡Œæ“ä½œçš„åˆ—åï¼Œç”¨ä»¥å’Œä¸‹è¾¹é€šè¿‡fromç¡®å®šçš„é›†åˆä¸­foreignFieldæŒ‡å®šçš„åˆ—åè¿›è¡ŒåŒ¹é…</li>
<li>foreignField æŒ‡å®šç”±fromç¡®å®šçš„é›†åˆè¦è¿›è¡Œlookupæ“ä½œçš„åˆ—å</li>
<li>as ä¸¤ä¸ªé›†åˆåŒ¹é…å®Œæˆä¹‹åï¼Œåœ¨å½“å‰ç»“åˆä¸­æ·»åŠ çš„ä¸€åˆ—</li>
</ul>
<p>é€šè¿‡ä¸‹ä¾‹æ¥è¯´ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&gt; db.Position.aggregate(&#123;$lookup:&#123;from:&quot;Category&quot;,localField:&quot;name&quot;,foreignField:&quot;name&quot;,as:&quot;jobInfo&quot;&#125;&#125;,&#123;$skip:1&#125;,&#123;$limit:1&#125;).pretty()</div><div class="line">&#123;</div><div class="line">	&quot;_id&quot; : ObjectId(&quot;582ee2b6b7f3d15abcf7174c&quot;),</div><div class="line">	&quot;positionid&quot; : 2342819,</div><div class="line">	&quot;salary&quot; : &quot;8k-15k&quot;,</div><div class="line">	&quot;name&quot; : &quot;Java&quot;,</div><div class="line">	&quot;detailUR&quot; : &quot;https://www.lagou.com/jobs/2342819.html&quot;,</div><div class="line">	&quot;companyid&quot; : 25439,</div><div class="line">	&quot;company&quot; : &quot;Udeskï¼ä¼ä¸šçº§æ™ºèƒ½å®¢æœå¹³å°&quot;,</div><div class="line">	&quot;experience&quot; : &quot;ç»éªŒ1-3å¹´&quot;,</div><div class="line">	&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">	&quot;address&quot; : &quot;è¥¿ç›´é—¨å—å¤§è¡—2å·æˆé“­å¤§å¦Cåº§16å±‚ï¼ˆè¥¿ç›´é—¨åœ°é“ç«™Cå£ï¼‰&quot;,</div><div class="line">	&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">	&quot;loc&quot; : &#123;</div><div class="line">		&quot;type&quot; : &quot;Point&quot;,</div><div class="line">		&quot;coordinates&quot; : [</div><div class="line">			116.35735297,</div><div class="line">			39.93921106</div><div class="line">		]</div><div class="line">	&#125;,</div><div class="line">	&quot;jobInfo&quot; : [</div><div class="line">		&#123;</div><div class="line">			&quot;_id&quot; : ObjectId(&quot;582ee2a0b7f3d15aaebf35b3&quot;),</div><div class="line">			&quot;category&quot; : &quot;æŠ€æœ¯&quot;,</div><div class="line">			&quot;url&quot; : &quot;https://www.lagou.com/zhaopin/Java/&quot;,</div><div class="line">			&quot;tag&quot; : &quot;åç«¯å¼€å‘&quot;,</div><div class="line">			&quot;name&quot; : &quot;Java&quot;</div><div class="line">		&#125;</div><div class="line">	]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡nameå­—æ®µå°†Categoryå’ŒPositionä¸¤ä¸ªé›†åˆå…³è”èµ·æ¥ï¼Œå¹¶ä¸”Categoryä¸­å¯¹åº”çš„æ•°æ®åœ¨è¾“å‡ºä¸­ä»¥jobInfoè¡¨ç¤ºã€‚</p>
<h2 id="group"><a href="#group" class="headerlink" title="$group"></a>$group</h2><blockquote>
<p>Groups input documents by a specified identifier expression and applies the accumulator expression(s), if specified, to each group. Consumes all input documents and outputs one document per each distinct group. The output documents only contain the identifier field and, if specified, accumulated fields.</p>
</blockquote>
<p>$groupä¹Ÿæ˜¯ä¸€ä¸ªsqlä¸­å¸¸ç”¨çš„æ“ä½œç¬¦ï¼Œå®ƒå¯ä»¥å¾ˆæ–¹ä¾¿çš„æŒ‰ç…§å­—æ®µæ¥è¿›è¡Œä¸€äº›ç»Ÿè®¡å·¥ä½œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; db.Position.aggregate(&#123;$group:&#123;_id:&quot;$name&quot;,count:&#123;$sum:1&#125;&#125;&#125;)</div><div class="line">&#123; &quot;_id&quot; : &quot;æ¸¸æˆåˆ¶ä½œäºº&quot;, &quot;count&quot; : 343 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;äº§å“æ€»ç›‘&quot;, &quot;count&quot; : 90 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;äº§å“éƒ¨ç»ç†&quot;, &quot;count&quot; : 53 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;ç½‘é¡µäº§å“è®¾è®¡å¸ˆ&quot;, &quot;count&quot; : 4 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;äº§å“å®ä¹ ç”Ÿ&quot;, &quot;count&quot; : 13 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;æ¸¸æˆç­–åˆ’&quot;, &quot;count&quot; : 291 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;ç”µå•†äº§å“ç»ç†&quot;, &quot;count&quot; : 301 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;æ•°æ®äº§å“ç»ç†&quot;, &quot;count&quot; : 450 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;äº§å“åŠ©ç†&quot;, &quot;count&quot; : 65 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;ç§»åŠ¨äº§å“ç»ç†&quot;, &quot;count&quot; : 18 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;BIå·¥ç¨‹å¸ˆ&quot;, &quot;count&quot; : 9 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;å”®å‰å·¥ç¨‹å¸ˆ&quot;, &quot;count&quot; : 9 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;ç¡¬ä»¶å¼€å‘å…¶å®ƒ&quot;, &quot;count&quot; : 450 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;å°„é¢‘å·¥ç¨‹å¸ˆ&quot;, &quot;count&quot; : 60 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;çƒ­ä¼ å¯¼&quot;, &quot;count&quot; : 2 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;æ¨¡å…·è®¾è®¡&quot;, &quot;count&quot; : 11 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;DSPå¼€å‘&quot;, &quot;count&quot; : 6 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;ä¼ä¸šè½¯ä»¶å…¶å®ƒ&quot;, &quot;count&quot; : 21 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;ç³»ç»Ÿé›†æˆ&quot;, &quot;count&quot; : 110 &#125;</div><div class="line">&#123; &quot;_id&quot; : &quot;é©±åŠ¨å¼€å‘&quot;, &quot;count&quot; : 129 &#125;</div></pre></td></tr></table></figure></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿›è¡Œ$groupæ“ä½œçš„æ—¶å€™ï¼Œå¿…é¡»è¦æŒ‡å®šä¸€ä¸ª_idçš„å­—æ®µåï¼Œå¹¶ä¸”è¿™ä¸ªæ“ä½œéƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œå¦‚æœæ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™éœ€è¦é¢å¤–çš„å‚æ•°ï¼ˆå°†ä¼šåœ¨ä»¥åçš„æ–‡ç« ä¸­æåˆ°ï¼‰ã€‚</p>
<h2 id="å…¶ä»–çš„æ“ä½œç¬¦"><a href="#å…¶ä»–çš„æ“ä½œç¬¦" class="headerlink" title="å…¶ä»–çš„æ“ä½œç¬¦"></a>å…¶ä»–çš„æ“ä½œç¬¦</h2><p>ä¸Šè¿°å‡ ä¸ªæ˜¯ç”¨çš„æ¯”è¾ƒå¤šçš„å‡ ä¸ªã€‚å…¶ä»–çš„æ“ä½œç¬¦è¿˜æœ‰$unwindã€$sampleã€$sortã€$indexStatsã€$outç­‰ã€‚åœ¨ä»¥åä½¿ç”¨ä¸­å¦‚æœé‡åˆ°çš„è¯åœ¨æ¥è¿™æ›´æ–°ã€‚</p>
<h1 id="ç®¡é“è¡¨è¾¾å¼"><a href="#ç®¡é“è¡¨è¾¾å¼" class="headerlink" title="ç®¡é“è¡¨è¾¾å¼"></a>ç®¡é“è¡¨è¾¾å¼</h1><p>ä¸Šè¾¹çš„å‡ ä¸ªä¾‹å­å·²ç»æœ‰æ‰€ä½“ç°ï¼Œå°±æ˜¯è¯´ï¼Œåœ¨è¿›è¡Œaggreagtionçš„æ—¶å€™ï¼Œæ¯ä¸ªstageéƒ½æ˜¯ç”±ä¸€ä¸ªç®¡é“è¡¨è¾¾å¼ä½œä¸ºåŠ¨è¯ï¼ŒæŒ‰ç…§å¯¹åº”çš„é™åˆ¶è¿›è¡Œæ“ä½œï¼Œè€Œç®¡é“è¡¨è¾¾å¼åˆ™å¯ä»¥æ„æˆä¸°å¯Œçš„æ“ä½œé™åˆ¶ï¼Œä»è€Œå¾—åˆ°æƒ³è¦çš„ç»“æœï¼Œå…¶ä¸­$groupæ“ä½œç¬¦ä¸­çš„$sumåˆ™æ˜¯ä¼—å¤šç®¡é“è¡¨è¾¾å¼ä¸­çš„ä¸€ä¸ªã€‚<br>è€Œè·Ÿå¤šçš„ç®¡é“è¡¨è¾¾å¼å¯ä»¥å‚è€ƒ<a href="https://docs.mongodb.com/v3.2/reference/operator/aggregation/" target="_blank" rel="external">è¿™é‡Œ</a>äº†è§£ã€‚</p>
<h1 id="mongodb-campass"><a href="#mongodb-campass" class="headerlink" title="mongodb campass"></a>mongodb campass</h1><p>é€šè¿‡mongodbè‡ªèº«çš„aggregationæ“ä½œï¼Œåˆç†ä½¿ç”¨ç®¡é“è¡¨è¾¾å¼å’Œç®¡é“æ“ä½œç¬¦å¯ä»¥å®Œæˆå¤§é‡çš„åˆ†æç»Ÿè®¡å·¥ä½œï¼Œè¿™é‡Œä¸å¾—ä¸å¾—è¯´ä¸€ä¸‹mongodbå®˜æ–¹æä¾›çš„æ•°æ®åº“å¯è§†åŒ–å·¥å…·<strong><a href="https://www.mongodb.com/download-center?jmp=docs#compass" target="_blank" rel="external">mongodb compass</a></strong>ã€‚æœ‰äº†è¿™ä¸ªå·¥å…·ï¼ˆæœ‰windowså’Œmacç‰ˆæœ¬ï¼‰ï¼Œæ„Ÿè§‰å…¶ä»–çš„å¯è§†åŒ–å·¥å…·éƒ½å¼±çˆ†äº†ï¼Œå¼ºçƒˆæ¨èï¼</p>
]]></content>
      
        <categories>
            
            <category> mongodb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> mongodb </tag>
            
            <tag> aggregation </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[PythonåŸºç¡€çŸ¥è¯†]]></title>
      <url>/2016/11/16/python%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘å›é¡¾ä¸€ä¸‹pythonç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œä¸»è¦å†…å®¹ä¼šåŒ…æ‹¬ä¸€äº›å¸¸ç”¨åº“æ–‡æ¡£çš„å…³é”®å†…å®¹ï¼ˆé‡æ¸©ä¸€éåŠ æ·±è®°å¿†ï¼‰ï¼Œä¸€äº›é‡è¦çš„å…³é”®å­—ï¼Œpythonicä»£ç é£æ ¼æ³¨æ„çš„å†…å®¹ç­‰ç­‰ã€‚è¿™äº›é‡è¦çš„å†…å®¹ä¼šæŒç»­æ›´æ–°ã€‚<br><a id="more"></a></p>
<h1 id="requestsä¸­æ–‡æ–‡æ¡£"><a href="#requestsä¸­æ–‡æ–‡æ¡£" class="headerlink" title="requestsä¸­æ–‡æ–‡æ¡£"></a>requestsä¸­æ–‡æ–‡æ¡£</h1><ol>
<li>é€šè¿‡<code>import requests</code>å¼•å…¥requestsåŒ…ï¼›</li>
<li>requestsæä¾›äº†å„ç§httpåŠ¨è¯æ“ä½œæ–¹å¼ï¼šåŒ…æ‹¬â€™getâ€™,â€™postâ€™,â€™putâ€™,â€™deleteâ€™,â€™headâ€™å’Œâ€™optionsâ€™ï¼›</li>
<li><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼Œè¦ä¼ é€’ç»™æœåŠ¡å™¨çš„å‚æ•°å¯èƒ½ä¼šé€šè¿‡urlä¸­?ä¹‹åçš„é”®å€¼å¯¹çš„å½¢å¼è¿›è¡Œï¼Œåœ¨requestä¸­ï¼Œå¯ä»¥å°†è¿™äº›é”®å€¼å¯¹ä»¥pythonå­—å…¸çš„å½¢å¼ä¼ é€’</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">params = &#123;&apos;x&apos;:&apos;1&apos;,&apos;y&apos;:&apos;2&apos;&#125;</div><div class="line">requests.get(&apos;https://eclipsesv.com&apos;,params = parmas)</div></pre></td></tr></table></figure>
</li>
<li><p>é€šè¿‡requestsè·å–åˆ°çš„æœåŠ¡å™¨è¿”å›å†…å®¹å¯ä»¥é€šè¿‡è¿™äº›æ–¹å¼æ¥è·å–ï¼š<br><strong>æ­£å¸¸æƒ…å†µä¸‹</strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">response = requests.get(&apos;https://eclipsesv.com&apos;)</div><div class="line">print response.text  #è¿™æ ·å¯ä»¥å¾—åˆ°requestsè‡ªåŠ¨è§£ç åçš„æœåŠ¡å™¨å†…å®¹</div></pre></td></tr></table></figure>
</li>
</ol>
<p>é€šè¿‡<code>response.encoding</code>å¯ä»¥è·å–åˆ°å½“å‰çš„requestsç¼–ç æ–¹å¼ã€‚<br><strong>äºŒè¿›åˆ¶å“åº”å†…å®¹</strong>ï¼š<br>é™¤äº†ä¸Šè¿°çš„textæ–¹æ³•è·å–æœåŠ¡å™¨å†…å®¹ï¼Œé€šè¿‡<code>response.content</code>ä¹Ÿå¯ä»¥è·å–åˆ°äºŒè¿›åˆ¶å½¢å¼çš„æœåŠ¡å™¨å†…å®¹ï¼Œä»¥å›¾ç‰‡ä¸ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">from PIL import Image</div><div class="line">from io import BytesIO</div><div class="line">img = Image.open(BytesIO(response.content))</div></pre></td></tr></table></figure></p>
<p><strong>jsonæ ¼å¼å“åº”å†…å®¹</strong><br>requestsä¸­å†…ç½®æœ‰ä¸€ä¸ªjsonè§£ç å™¨ï¼Œé€šè¿‡ä¸€ä¸‹æ–¹å¼å¯ä»¥è·å–åˆ°æ¥è‡ªæœåŠ¡å™¨çš„jsonå†…å®¹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">response = requests.get(&apos;http://xxxxx&apos;)</div><div class="line">jsonValue = response.json()</div></pre></td></tr></table></figure></p>
<p><strong>åŸå§‹å“åº”å†…å®¹</strong><br>è¿™ç§æ–¹å¼ç›®å‰è¿˜ä¸çŸ¥é“èƒ½å¹²å•¥ï¼Œç”¨äºè·å–æ¥è‡ªæœåŠ¡å™¨çš„åŸå§‹å¥—æ¥å­—å“åº”ï¼Œé€šè¿‡<code>response.raw</code>æ¥è·å–ã€‚</p>
<ol>
<li>è¯·æ±‚å¤´å®šåˆ¶<br>å¦‚æœéœ€è¦å®šåˆ¶è¯·æ±‚çš„headerï¼Œåªéœ€è¦æŒ‰ç…§requestsè§„å®šçš„å½¢å¼ä¼ ä¸€ä¸ªå­—å…¸ç»™headerså³å¯ã€‚ç±»ä¼¼è¿™æ ·å­ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">host = &quot;http://www.douyu.com&quot;</div><div class="line">agent = &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.86 Safari/537.36&apos;</div><div class="line">accept = &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</div><div class="line">connection = &quot;keep-alive&quot;</div><div class="line">CacheControl = &quot;no-cache&quot;</div><div class="line">UpgradeInsecureRequests = 1</div><div class="line">headers = &#123;</div><div class="line">    &apos;User-Agent&apos;: agent,</div><div class="line">    &apos;Host&apos;: HOST,</div><div class="line">    &apos;Accept&apos;: accept,</div><div class="line">    &apos;Cache-Control&apos;: CacheControl,</div><div class="line">    &apos;Connection&apos;: connection,</div><div class="line">    &apos;Upgrade-InsecureRequests&apos;: UpgradeInsecureRequests</div><div class="line">&#125;</div><div class="line">response = requests.get(url,headers=headers)</div></pre></td></tr></table></figure>
</li>
</ol>
<p>è¿™æ ·å°±å¯ä»¥äº†ï¼Œè¿™æ‹›åœ¨çˆ¬å–ç½‘ç«™æ•°æ®çš„æ—¶å€™ä¼šå¾ˆå¸¸ç”¨ã€‚</p>
<ol>
<li>å“åº”çŠ¶æ€ç å’Œè¯·æ±‚å¤´<br>é€šè¿‡<code>response.status_code</code>å³å¯è·å–åˆ°æ¥è‡ªæœåŠ¡å™¨çš„åé¦ˆçŠ¶æ€ç ï¼›<br>é€šè¿‡<code>response.headers</code>å³å¯å¾—åˆ°ç›®å‰è¯·æ±‚çš„è¯·æ±‚å¤´æ˜¯æ€æ ·çš„ã€‚</li>
<li>cookie<br>ä¸è®¾ç½®headersç±»ä¼¼ï¼Œå°†æƒ³è¦ä¼ªé€ çš„cookieæŒ‰ç…§å­—å…¸çš„å½¢å¼åœ¨è¯·æ±‚ä¸­åŠ å…¥å³å¯<code>requests.get(url,cookies=cookies)</code>ã€‚</li>
<li>è¶…æ—¶è®¾ç½®<br>é€šè¿‡è®¾ç½®requestsçš„timeoutåœ¨æŒ‡å®šçš„ç§’æ•°ä¹‹ååœæ­¢ç­‰å¾…æœåŠ¡å™¨<code>requests.get(url,timeout=0.1)</code>ï¼Œè¿™é‡Œæ‰€è¯´çš„ç­‰å¾…æ—¶é—´æ˜¯æŒ‡åœ¨timeoutæ—¶é—´å†…æœåŠ¡å™¨æ²¡æœ‰ä»»ä½•å“åº”åˆ™ä¼šè§¦å‘å¼‚å¸¸ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè¯·æ±‚çš„è€—æ—¶ã€‚</li>
<li>å¦å¤–ä¸€äº›é«˜çº§ç”¨æ³•ï¼ˆä¸»è¦æ˜¯å’Œsessionç›¸å…³çš„å†…å®¹ï¼‰å¯ä»¥å‚è€ƒ<a href="http://docs.python-requests.org/zh_CN/latest/user/advanced.html#advanced" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚</li>
</ol>
<h1 id="bs4-ä¸­æ–‡æ–‡æ¡£"><a href="#bs4-ä¸­æ–‡æ–‡æ¡£" class="headerlink" title="bs4 ä¸­æ–‡æ–‡æ¡£"></a>bs4 ä¸­æ–‡æ–‡æ¡£</h1><p>bs4å¯ä»¥ä»htmlæˆ–æ˜¯xmlä¸­æå–æ•°æ®ï¼Œå¯¹äºbs4è€Œè¨€ï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯å››ç§å¯¹è±¡çš„ç±»å‹ï¼š<strong>Tag , NavigableString , BeautifulSoup , Comment</strong>ã€‚</p>
<h2 id="å››ç§ç±»å‹"><a href="#å››ç§ç±»å‹" class="headerlink" title="å››ç§ç±»å‹"></a>å››ç§ç±»å‹</h2><ol>
<li><strong>Tag</strong>ï¼š<br>è¿™é‡Œçš„tagä¸xmlæˆ–æ˜¯htmlä¸­åŸç”Ÿæ–‡æ¡£çš„tagç›¸åŒï¼Œtagæœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§nameå’Œattributeã€‚æ¯ä¸ªtagéƒ½æœ‰åå­—ï¼Œé€šè¿‡.nameå¯ä»¥è·å–åˆ°tagçš„åå­—<code>tag.name</code>ï¼Œattributeåˆ™æ˜¯tagçš„å±æ€§ï¼Œtagçš„å±æ€§æ“ä½œç±»ä¼¼äºå­—å…¸ï¼š<code>tag[&#39;class&#39;]æˆ–æ˜¯tag[&#39;id&#39;]</code>è¿™æ ·çš„ï¼Œä¹Ÿå¯ç›´æ¥é€šè¿‡tag.attrsè·å–åˆ°ä¸€ä¸ªè£…è½½tagå±æ€§çš„å­—å…¸ã€‚æŸäº›æ—¶å€™ï¼ŒtagæŸä¸ªå±æ€§å¯èƒ½æœ‰å¤šä¸ªå€¼ï¼Œæ¯”å¦‚classã€relç­‰ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œé€šè¿‡â€™tag[â€˜classâ€™]â€™è·å–åˆ°çš„åˆ™æ˜¯ä¸€ä¸ªliståˆ—è¡¨ã€‚</li>
<li><strong>NavigableString</strong><br>è¿™é‡Œçš„NavigableStringå¯ä»¥è®¤ä¸ºæ˜¯tagä¸­çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚<code>&lt;p&gt;hello world&lt;/p&gt;</code>ï¼Œæ­¤å¤„çš„hello worldå³æ˜¯NavigableStringã€‚è¦æƒ³è·å–åˆ°NavigableStringï¼Œå¯ä»¥é€šè¿‡tag.stringæ¥è·å–ï¼Œç›´æ¥è·å–åˆ°çš„å†…å®¹å¯ä»¥é€šè¿‡unicode(tag.string)æ¥è½¬æ¢ä¸ºunicodeã€‚å¦å¤–ï¼ŒNavigableStringä¸å¯ä»¥ç¼–è¾‘ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡replace_with()æ–¹æ³•æ¥æ›¿æ¢ã€‚</li>
<li><strong>BeautifulSoup</strong><br>BeautifulSoupè¡¨ç¤ºçš„æ˜¯æ•´ä¸ªæ–‡æ¡£çš„å…¨éƒ¨å†…å®¹ï¼Œé€šè¿‡BeautifulSoup(response.text)å³å¯ç”ŸæˆBeautifulSoupå¯¹è±¡ã€‚</li>
<li><strong>Comment</strong><br>htmlæˆ–æ˜¯xmlæ–‡æ¡£ä¸­ï¼Œæ³¨é‡Šéƒ¨åˆ†å¾ˆå¸¸è§ï¼Œè€Œåœ¨BeautifulSoupä¸­ï¼Œæ³¨é‡Šåˆ™æ˜¯ä»¥Commentçš„å½¢å¼å­˜åœ¨ã€‚</li>
</ol>
<h2 id="find-amp-select"><a href="#find-amp-select" class="headerlink" title="find&amp;select"></a>find&amp;select</h2><p>å¯¹äºæˆ‘æ¥è¯´ï¼ŒBeautifulSoupæœ€å¸¸ç”¨çš„å°±æ˜¯è§£æhtmlæ–‡ä»¶ï¼Œæ‰€ä»¥è¿™æ¬¡è¿˜æ˜¯æ¡é‡ç‚¹æ¥ï¼Œäº†è§£åˆ°ä¸Šè¿°çš„å‡ ç§ç±»å‹ä¹‹åå°±å¯ä»¥é€šè¿‡findæˆ–è€…æ˜¯selectæ¥æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„é¡µé¢å†…å®¹å¹¶æŠŠå®ƒä»¬ç»“æ„åŒ–å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚</p>
<ol>
<li><strong>è¿‡æ»¤å™¨</strong><br>åœ¨è¿™ä¹‹å‰è¿˜å¾—å¥½å¥½çœ‹çœ‹è¿‡æ»¤å™¨ï¼šè¿‡æ»¤å™¨å¯ä»¥ç”¨åœ¨tagï¼Œnameï¼ŒèŠ‚ç‚¹çš„å±æ€§ï¼Œå­—ç¬¦ä¸²ä»¥åŠå®ƒä»¬çš„æ··åˆä¸­ã€‚<br>å­—ç¬¦ä¸²è¿‡æ»¤å™¨ï¼šæ˜¯æœ€ç®€å•çš„è¿‡æ»¤å™¨ï¼Œåœ¨æœç´¢æ–¹æ³•ä¸­ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œæ¯”å¦‚è¦æœç´¢æ‰€æœ‰çš„<code>&lt;img&gt;</code>æ ‡ç­¾<code>soup.find_all(&#39;img&#39;)</code>ï¼›<br>æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤å™¨ï¼šä¼ å…¥æ­£åˆ™è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ï¼Œé€šè¿‡match()æ¥åŒ¹é…å†…å®¹ï¼Œæ¯”å¦‚æ‰¾å‡ºæ‰€æœ‰ä»¥bå¼€å¤´çš„æ ‡ç­¾<code>soup.find_all(re.compile(&quot;^b&quot;))</code>ï¼›<br>åˆ—è¡¨è¿‡æ»¤å™¨ï¼šå°†åˆ—è¡¨ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¿”å›ä¸åˆ—è¡¨ä¸­åŒ¹é…çš„ä»»ä¸€å…ƒç´ ï¼Œæ¯”å¦‚è¦æ‰¾å¤šæ‰€æœ‰<code>&lt;a&gt;,&lt;b&gt;</code>æ ‡ç­¾ï¼š<code>soup.find_all([&quot;a&quot;,&quot;b&quot;])</code>ï¼›<br>æ–¹æ³•è¿‡æ»¤å™¨ï¼šè¿™ä¸ªå°±å˜æ€äº†ï¼Œå¦‚æœæ²¡æœ‰åˆé€‚çš„è¿‡æ»¤å™¨ï¼Œå¯ä»¥è‡ªå·±æ¥æ”¹é€ ï¼Œå†™ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›trueè¡¨ç¤ºå½“å‰å…ƒç´ æ»¡è¶³æ¡ä»¶ï¼Œå¦‚æœä¸æ»¡è¶³è¿”å›falseï¼Œæ¯”å¦‚å¦‚ä¸‹çš„æ–¹æ³•è¡¨ç¤ºå¦‚æœåŒ…å«classå±æ€§åŒæ—¶ä¸åŒ…å«idå±æ€§ï¼Œåˆ™è¿”å›trueï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">def has_class_not_id(tag):</div><div class="line">	return tag.has_attr(&apos;class&apos;) and not tag.has_attr(&apos;id&apos;)</div></pre></td></tr></table></figure>
</li>
</ol>
<p>ç„¶åå°†è¿™ä¸ªæ–¹æ³•ä¼ ç»™find_all()ï¼Œå°±å¯ä»¥è·å–åˆ°æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„tag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">soup.find_all(has_class_not_id)</div></pre></td></tr></table></figure></p>
<ol>
<li><strong>find_all(name , attrs , recursive , text , **kwargs)</strong><br>åˆšåˆé‡æ–°çœ‹äº†ä¸€éå…³äºfind_all()çš„è¯´æ˜ï¼Œå‘ç°ä¹‹å‰æ²¡æ€ä¹ˆç”¨è¿™ä¸ªæ–¹æ³•çœŸæ˜¯ä¸ªå¤±è¯¯å•Šï¼<br>nameå‚æ•°ï¼šæŸ¥æ‰¾æ‰€æœ‰åå­—ä¸ºnameçš„tagï¼Œæœç´¢nameå‚æ•°çš„å€¼å¯ä»¥ä½¿ç”¨ä»»ä¸€ä¸Šè¿°ç±»å‹çš„è¿‡æ»¤å™¨ï¼›<br>attrså‚æ•°ï¼šå¦‚æœæƒ³è¦é€šè¿‡tagçš„å±æ€§æ¥æŸ¥æ‰¾ï¼Œå¯ä»¥é€šè¿‡è¿™æ ·çš„å½¢å¼ï¼›<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">soup.find_all(id=&apos;link2&apos;)    #ç›´æ¥æŸ¥æ‰¾idä¸ºç›®æ ‡å€¼çš„tag</div><div class="line">soup.find_all(href=re.compile(&quot;elsie&quot;))    #é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾</div><div class="line">soup.find_all(id=True)    #ç”¨trueæŸ¥æ‰¾ï¼Œæ‹¥æœ‰idå±æ€§çš„tag</div><div class="line">soup.find_all(href=re.compile(&quot;elsie&quot;), id=&apos;link1&apos;)    #å¤šä¸ªå±æ€§åŒæ—¶æŸ¥æ‰¾</div><div class="line">data_soup.find_all(attrs=&#123;&quot;data-foo&quot;: &quot;value&quot;&#125;)    #æŸäº›html5å±æ€§ä¸èƒ½ç›´æ¥æŸ¥è¯¢çš„æ—¶å€™å¯ä»¥é€šè¿‡è¿™æ ·çš„å½¢å¼æŸ¥æ‰¾</div></pre></td></tr></table></figure>
</li>
</ol>
<p>textå‚æ•°ï¼šé€šè¿‡textå‚æ•°å¯ä»¥æœç´¢æ–‡æ¡£ä¸­å­—ç¬¦ä¸²å†…å®¹ã€‚åŒæ ·textæ¥å—å„ç§è¿‡æ»¤å™¨ã€‚<br>limitå‚æ•°ï¼šfind_all()æ–¹æ³•ä¼šè¿”å›å…¨éƒ¨çš„æœç´¢å†…å®¹ï¼Œé€šè¿‡limitå¯ä»¥é™åˆ¶è¿”å›æ•°é‡<code>soup.find_all(&quot;a&quot;, limit=2)</code>ï¼›<br>recursiveå‚æ•°ï¼šfind_all()æ–¹æ³•é»˜è®¤ä¼šæ£€ç´¢å½“å‰tagæ‰€æœ‰å­èŠ‚ç‚¹ä»¥åŠå­™èŠ‚ç‚¹ï¼Œå¦‚æœåªæƒ³æœç´¢tagç›´æ¥çš„å­èŠ‚ç‚¹çš„è¯å¯ä»¥é€šè¿‡è®¾ç½®recursiveå€¼æ¥åŠ ä»¥é™åˆ¶<code>soup.html.find_all(&quot;title&quot;, recursive=False)</code>recursive=trueï¼›<br>å¦å¤–ï¼Œå¯ä»¥é€šè¿‡cssæ ·å¼æŸ¥è¯¢<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">soup.find_all(&quot;a&quot;, class_=&quot;sister&quot;)    #ç”±äºclassæ˜¯pythonå…³é”®å­—ï¼Œæ‰€ä»¥classå˜ä¸ºclass_</div><div class="line">soup.find_all(class_=re.compile(&quot;itl&quot;))</div></pre></td></tr></table></figure></p>
<p>æ€»ä¹‹ï¼Œé€šè¿‡classæ¥æŸ¥è¯¢çš„æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„è¿‡æ»¤å™¨ã€‚</p>
<ol>
<li><strong>selectæ–¹æ³•</strong><br>select()ä¸»è¦é€šè¿‡æ–‡æ¡£çš„cssæ ·å¼è¿›è¡Œé€‰æ‹©ï¼š<br>é€šè¿‡tagæ ‡ç­¾é€å±‚æŸ¥æ‰¾ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">soup.select(&quot;title&quot;)</div><div class="line"># [&lt;title&gt;The Dormouse&apos;s story&lt;/title&gt;]</div><div class="line">soup.select(&quot;p nth-of-type(3)&quot;)</div><div class="line"># [&lt;p class=&quot;story&quot;&gt;...&lt;/p&gt;]</div></pre></td></tr></table></figure>
</li>
</ol>
<p>é€šè¿‡æŸä¸ªtagæ ‡ç­¾ä¸‹çš„ç›´æ¥å­æ ‡ç­¾ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">soup.select(&quot;head &gt; title&quot;)</div><div class="line"># [&lt;title&gt;The Dormouse&apos;s story&lt;/title&gt;]</div></pre></td></tr></table></figure></p>
<p>æŸ¥æ‰¾å…„å¼ŸèŠ‚ç‚¹æ ‡ç­¾(è¿™ä¸ªåœ°æ–¹æ²¡çœ‹å¤ªæ‡‚ï¼Œè¿˜éœ€è¦å›å¤´å†çœ‹)ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">soup.select(&quot;#link1 ~ .sister&quot;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;,</div><div class="line">#  &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot;  id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;]</div><div class="line">soup.select(&quot;#link1 + .sister&quot;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;]</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡cssç±»åæŸ¥æ‰¾:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">soup.select(&quot;.sister&quot;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;,</div><div class="line">#  &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;,</div><div class="line">#  &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;]</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡tagçš„idæŸ¥æ‰¾ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">soup.select(&quot;#link1&quot;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;]</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡æ£€ç´¢æ˜¯å¦å­˜åœ¨æŸä¸ªå±æ€§æ¥æŸ¥æ‰¾ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">soup.select(&apos;a[href]&apos;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;,</div><div class="line">#  &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;,</div><div class="line">#  &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;]</div></pre></td></tr></table></figure></p>
<p>é€šè¿‡å±æ€§å€¼æ¥æŸ¥æ‰¾ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">soup.select(&apos;a[href=&quot;http://example.com/elsie&quot;]&apos;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;]</div><div class="line">soup.select(&apos;a[href^=&quot;http://example.com/&quot;]&apos;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;,</div><div class="line">#  &lt;a class=&quot;sister&quot; href=&quot;http://example.com/lacie&quot; id=&quot;link2&quot;&gt;Lacie&lt;/a&gt;,</div><div class="line">#  &lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;]</div><div class="line">soup.select(&apos;a[href$=&quot;tillie&quot;]&apos;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/tillie&quot; id=&quot;link3&quot;&gt;Tillie&lt;/a&gt;]</div><div class="line">soup.select(&apos;a[href*=&quot;.com/el&quot;]&apos;)</div><div class="line"># [&lt;a class=&quot;sister&quot; href=&quot;http://example.com/elsie&quot; id=&quot;link1&quot;&gt;Elsie&lt;/a&gt;]</div></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> requests </tag>
            
            <tag> bs4 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[windowsä¸‹hexo+githubæ­å»ºä¸ªäººåšå®¢]]></title>
      <url>/2016/11/06/hexo+github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<p>ä¹‹å‰è‡ªå·±çš„åšå®¢ä¹Ÿæ˜¯æ‰˜ç®¡åœ¨githubä¸Šï¼Œä½†æ˜¯è®¿é—®é€Ÿåº¦æœ‰æ—¶å€™æ¬ ä½³ï¼Œå¹¶ä¸”ç¼ºå°‘ä¸ªäººå®šåˆ¶çš„æ„Ÿè§‰ï¼Œæ‰€ä»¥å°±æ”¾åœ¨äº†è‡ªå·±çš„äº‘ä¸»æœºä¸Šï¼Œå‘¨æœ«æ°å·§æœ‰ä¸ªæœºä¼šè®©æˆ‘é‡æ–°æ¸©ä¹ ä¸€ä¸‹hexoåœ¨githubä¸Šæ‰˜ç®¡çš„è¿‡ç¨‹ã€‚<br><a id="more"></a></p>
<h1 id="æ‰€éœ€è½¯ä»¶"><a href="#æ‰€éœ€è½¯ä»¶" class="headerlink" title="æ‰€éœ€è½¯ä»¶"></a>æ‰€éœ€è½¯ä»¶</h1><p>è¦å®Œæˆåšå®¢çš„æ­å»ºï¼Œå¤§è‡´éœ€è¦è¿™äº›å†…å®¹ï¼š</p>
<ul>
<li>å·²å®Œæˆé‚®ä»¶æ¿€æ´»çš„githubè´¦å·ï¼ˆå¦‚æœæœªæ¿€æ´»æ— æ³•ä½¿ç”¨githubçš„pagesï¼Œä¹Ÿå°±æ— æ³•è®©githubæ‰˜ç®¡ï¼‰</li>
<li><a href="https://git-scm.com/downloads/" target="_blank" rel="external">gitå®¢æˆ·ç«¯</a></li>
<li><a href="https://nodejs.org/en/" target="_blank" rel="external">nodejs</a>ï¼ˆå› ä¸ºhexoæ˜¯ç”±nodeé©±åŠ¨çš„ï¼‰</li>
<li><a href="http://pad.haroopress.com/" target="_blank" rel="external">Haroopad</a>ï¼Œå„ä¸ªæ“ä½œç³»ç»Ÿéƒ½æœ‰å¯¹åº”çš„ç‰ˆæœ¬</li>
</ul>
<h1 id="æ“ä½œæµç¨‹"><a href="#æ“ä½œæµç¨‹" class="headerlink" title="æ“ä½œæµç¨‹"></a>æ“ä½œæµç¨‹</h1><h2 id="githubçš„ç›¸å…³é…ç½®"><a href="#githubçš„ç›¸å…³é…ç½®" class="headerlink" title="githubçš„ç›¸å…³é…ç½®"></a>githubçš„ç›¸å…³é…ç½®</h2><ol>
<li>ä½ è¦ç”³è¯·ä¸€ä¸ªgithubè´¦å·ï¼Œå¹¶ä¸”ç”¨é‚®ç®±æ¿€æ´»ï¼›</li>
<li>åˆ›å»ºä¸€ä¸ªrepoï¼Œåç§°<strong>å¿…é¡»</strong>æŒ‰ç…§è¿™æ ·çš„æ ¼å¼ï¼šusername.github.ioï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„ç”¨æˆ·åæ˜¯wangerdanï¼Œé‚£åˆ›å»ºçš„é¡¹ç›®åç§°å°±å¿…é¡»æ˜¯wangerdan.github.ioï¼›</li>
<li>æŠŠä½ ç”µè„‘çš„å…¬é’¥ä¸Šä¼ åˆ°githubçš„ssh keyåˆ—è¡¨ä¸­ï¼Œå…·ä½“æ“ä½œå¯å‚è€ƒ<a href="http://blog.csdn.net/houyp520/article/details/9401745" target="_blank" rel="external">è¿™ç¯‡</a>ï¼Œè¿™æ ·åšçš„åŸå› æ˜¯ç­‰ä¸‹hexoæ¨é€éœ€è¦ä½¿ç”¨sshæ¨¡å¼è¿æ¥githubï¼›</li>
</ol>
<h2 id="å…¶ä»–è½¯ä»¶å®‰è£…"><a href="#å…¶ä»–è½¯ä»¶å®‰è£…" class="headerlink" title="å…¶ä»–è½¯ä»¶å®‰è£…"></a>å…¶ä»–è½¯ä»¶å®‰è£…</h2><p>åŒ…æ‹¬gitå®¢æˆ·ç«¯ï¼Œnodejsè¿˜æœ‰Haroopadè¿™ä¸‰ä¸ªï¼Œéƒ½æ˜¯ä¸€è·¯nextå°±å¯ä»¥äº†ã€‚</p>
<h2 id="hexoå®‰è£…å’Œé…ç½®ä»¥åŠæ¨é€"><a href="#hexoå®‰è£…å’Œé…ç½®ä»¥åŠæ¨é€" class="headerlink" title="hexoå®‰è£…å’Œé…ç½®ä»¥åŠæ¨é€"></a>hexoå®‰è£…å’Œé…ç½®ä»¥åŠæ¨é€</h2><ol>
<li><p>hexo-cliï¼šä¹‹å‰å®‰è£…å¥½äº†gitå®¢æˆ·ç«¯ä¹‹åï¼Œåœ¨æ–‡ä»¶å¤¹ä¸­å³é”®ä¼šæœ‰gitBashé€‰é¡¹ï¼Œæ‰¾ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚è¯´æ–‡ä»¶å¤¹å«blogï¼Œè¿›å…¥ä¹‹åï¼Œæ‰“å¼€gitbashï¼Œé”®å…¥ï¼š<code>npm install -g hexo-cli</code>ï¼Œå°±ä¼šè‡ªåŠ¨å®Œæˆå®‰è£…ï¼›</p>
</li>
<li><p>å®‰è£…å®Œæˆhexo-cliä¹‹åï¼Œé”®å…¥<code>hexo init</code>ä¼šå®Œæˆåšå®¢çš„åˆå§‹åŒ–ï¼Œé¡ºä¾¿<code>npm install</code>ï¼Œå®Œæˆå®‰è£…ï¼›</p>
</li>
<li><p>å¯ä»¥å…ˆæµ‹è¯•ä¸€ä¸‹ï¼Œé”®å…¥<code>hexo server</code>ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®localhost:4000çœ‹æ˜¯å¦æœ‰åˆå§‹çš„é¡µé¢ï¼›</p>
</li>
<li><p>å¦‚æœä¸Šè¿°æ­¥éª¤éƒ½æ­£å¸¸å®Œæˆï¼Œç°åœ¨éœ€è¦åšçš„å°±æ˜¯æŠŠåšå®¢å†…å®¹æ¨é€åˆ°githubä¸Šï¼Œé”®å…¥<code>npm install hexo-deployer-git --save</code>ï¼Œå®‰è£…deployç»„ä»¶ï¼›</p>
</li>
<li><p>å®‰è£…å®Œæˆåï¼Œä¿®æ”¹åˆšæ‰blogæ–‡ä»¶å¤¹é‡Œè¾¹çš„_config.ymlæ–‡ä»¶ï¼ŒæŠŠä¸‹è¾¹ä¸€æ®µæ”¹æˆä½ è‡ªå·±çš„å³å¯ï¼›</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Deployment</div><div class="line">## Docs: https://hexo.io/docs/deployment.html</div><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repository: git@github.com:username/username.github.io.git</div><div class="line">  branch: master</div></pre></td></tr></table></figure>
</li>
<li><p>æ¨é€åšå®¢ï¼šå®Œæˆä¸Šè¿°å†…å®¹ä¹‹åï¼Œé€šè¿‡å‘½ä»¤<code>hexo deploy</code>å°±å¯ä»¥æŠŠå½“å‰çš„å†…å®¹æ¨é€åˆ°githubä¸Šï¼Œé€šè¿‡<a href="https://username.github.io/" target="_blank" rel="external">https://username.github.io/</a> è¿™ä¸ªé“¾æ¥å°±å¯ä»¥è®¿é—®äº†ã€‚</p>
</li>
</ol>
<h1 id="å…¶ä»–å†…å®¹"><a href="#å…¶ä»–å†…å®¹" class="headerlink" title="å…¶ä»–å†…å®¹"></a>å…¶ä»–å†…å®¹</h1><p><a href="http://www.tuicool.com/articles/ueI7naV" target="_blank" rel="external">hexoçš„æ“ä½œæ–¹æ³•</a><br><a href="https://git-scm.com/book/zh/v1/%E8%B5%B7%E6%AD%A5" target="_blank" rel="external">gitå­¦ä¹ </a><br><a href="https://segmentfault.com/markdown" target="_blank" rel="external">markdownè¯­æ³•</a></p>
]]></content>
      
        <categories>
            
            <category> hexo </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hexo </tag>
            
            <tag> github </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åæœˆ]]></title>
      <url>/2016/10/31/%E5%8D%81%E6%9C%88/</url>
      <content type="html"><![CDATA[<p>å¯¹æ¯”å»å¹´çš„è¿™ä¸ªæ—¶å€™ï¼Œè‡ªå·±æ¯å¤©ç–²äºå¥”å‘½ï¼Œå‚åŠ å„ç§ç¬”è¯•ã€é¢è¯•ï¼Œç»å†äº†ä¸€æ¬¡æ¬¡å¸Œæœ›ã€å¤±æœ›ã€‚è€Œç°åœ¨çš„æˆ‘ååœ¨æ´’æ»¡é˜³å…‰çš„å±‹å­é‡Œï¼Œå¬ç€é™ˆå¥•è¿…çš„æ­Œï¼ŒçŠ¶æ€ä¹Ÿæ˜¯å¥½åˆ°çˆ†ï¼ˆå½“ç„¶è¿™å¾—ç›Šäº30å·æ™šä¸Šè¡¨ç™½æˆåŠŸï¼Œç°åœ¨æƒ³æƒ³éƒ½æ€€ç–‘æ˜¯ä¸æ˜¯åœ¨åšæ¢¦å‘¢ï¼‰ã€‚<br>ä¸çŸ¥ä¸è§‰å·²ç»å·¥ä½œäº†ä¸‰ä¸ªæœˆï¼Œæƒ³å€Ÿè¿™ç¯‡åšå®¢è®°å½•ä¸€ä¸‹åæœˆä»½çš„ä¸€äº›äº‹æƒ…ã€‚</p>
<p>è®°ä¸œè¥¿ï¼Œä¾æ—§æ˜¯æµæ°´è´¦ï¼Œè¿™æ ·ä»¥åçœ‹èµ·æ¥ä¹Ÿèƒ½æƒ³å¾—æ¸…æ¥šã€‚<br><a id="more"></a></p>
<h1 id="ç¬¬ä¸€å‘¨"><a href="#ç¬¬ä¸€å‘¨" class="headerlink" title="ç¬¬ä¸€å‘¨"></a>ç¬¬ä¸€å‘¨</h1><p>å“ˆå“ˆå“ˆï¼Œç¬¬ä¸€å‘¨å½“ç„¶æ˜¯åä¸€å‡æœŸå•¦ï¼Œå› ä¸ºå¥½ä¹…éƒ½æ²¡å®Œæ•´è¿‡å®Œæ•´æ•´ä¸ƒå¤©çš„åä¸€é•¿å‡ï¼Œå¹¶ä¸”å¥½ä¹…ä¹Ÿæ²¡å†ç§‹å¤©çš„æ—¶å€™å›å®¶ã€‚æ‰€ä»¥ç»è¿‡äº†é•¿è¾¾ä¸¤å‘¨çš„åˆ·ç¥¨ä¹‹åç»ˆäºä¹°åˆ°äº†30å·æ™šä¸Šå›å®¶çš„å§é“ºã€‚å› ä¸ºä¸€ç›´éƒ½æƒ³è‡ªå·±æ”’ä¸€å°ç”µè„‘ï¼Œæ­£å¥½èµ¶ä¸Šè¿™ä¸ªå‡æœŸï¼Œé‚£å°±åœ¨å®¶ææœºå§ã€‚2å·åœ¨äº¬ä¸œä¸Šä¹°çš„æ‰€æœ‰é…ä»¶å°±åˆ°é½äº†ï¼ŒæŒ½èµ·è¢–å­å¼€å¹²ã€‚ç”±äºæ˜¯ç¬¬ä¸€æ¬¡ç»„è£…æœºå™¨ï¼Œåˆ°3å·å‡Œæ™¨æ‰å¼„å¦¥ã€‚<br>å‰©ä¸‹å‡ å¤©å°±æ˜¯å‡ºå»æºœè¾¾ï¼Œæœ€æœ‰æ„æ€çš„è¿˜æ˜¯é™ªå¥½æœ‹å‹ä¸€èµ·å»ä¸ˆé‡æ–°æˆ¿ï¼ˆä»–è¿‡å¹´å°±è¦ç»“å©šäº†ï¼Œæˆ‘ä¹Ÿèƒ½å½“ä¸ªä¼´éƒæ²¾æ²¾å–œæ°”ï¼‰ã€‚æ¯”è¾ƒé—æ†¾çš„å°±æ˜¯åªé™ªçˆ¸å¦ˆä¸€èµ·å‡ºå»é€›äº†ä¸€æ¬¡å…¬å›­ã€‚<br>ä¸ƒå¤©ä¸€æ™ƒå°±è¿‡å»äº†ï¼Œ7å·ä¸‹åˆåè½¦è¿”ç¨‹ï¼Œæ²¡æƒ³åˆ°ç°åœ¨é«˜é“ä¹Ÿæœ‰é‚£ä¹ˆå¤šæ— åº§çš„ç¥¨ï¼Œå¸¦äº†ä¸¤ä¸ªè¡Œæç®±çš„æˆ‘åªå¥½è¢«æŒ¤åœ¨è½¦é—¨å£ã€‚</p>
<h1 id="ç¬¬äºŒå‘¨"><a href="#ç¬¬äºŒå‘¨" class="headerlink" title="ç¬¬äºŒå‘¨"></a>ç¬¬äºŒå‘¨</h1><p>èŠ‚å‰é¢†å¯¼å°±å¸ƒç½®äº†ä»»åŠ¡ï¼Œè®©åšä¸€ä¸ªå…¨æ™¯åœ°å›¾é¡¹ç›®ï¼Œç¬¬äºŒå‘¨ä¸»è¦æ˜¯æŸ¥æ‰¾ç›¸å…³çš„èµ„æ–™å’Œå¯ç”¨çš„è½¯ä»¶ã€‚ç”±äºä¹‹å‰ä¹Ÿæ²¡å¼„è¿‡è¿™ä¸œè¥¿ï¼Œè¿›åº¦ç¨å¾®æœ‰ç‚¹æ…¢ï¼ˆå…¶å®ä¸»è¦è¿˜æ˜¯è‡ªå·±å·æ‡’äº†ï¼‰ã€‚æ‰¾åˆ°ç›®å‰å¤§å®¶åšå…¨æ™¯ç”¨çš„æ¯”è¾ƒå¤šçš„ä¸€æ¬¾è½¯ä»¶<a href="http://krpano.com/" target="_blank" rel="external">Krpano</a>ï¼Œç›¸å…³çš„å›½å†…å‚è€ƒç½‘ç«™<a href="http://www.krpano360.com/" target="_blank" rel="external">Krpanoä¸­æ–‡ç½‘</a>ã€‚ä¸€ä¸ªå¤„ç†å…¨æ™¯ç…§ç‰‡çš„è½¯ä»¶<a href="http://www.ptgui.com/download.html" target="_blank" rel="external">PTGUI</a>ã€‚ç”¨è¿™ä¿©ä¸œè¥¿å’Œå•ä½ç»™çš„ä¸€äº›æ•°æ®åˆæ­¥åšäº†ä¸€äº›å…¨æ™¯åœºæ™¯ï¼Œäº†è§£äº†krpanoçš„è¿è¡Œæœºç†ã€‚å¯¹å…¨æ™¯åœ°å›¾é¡¹ç›®æœ‰äº†åˆæ­¥çš„æŠ€æœ¯è·¯çº¿æ„æƒ³ï¼šæ— éå°±æ˜¯æŠŠå…¨æ™¯åœºæ™¯å’Œåœ°å›¾å…³è”èµ·æ¥ï¼Œè€Œå…¨æ™¯åœºæ™¯ä¹Ÿéƒ½æ˜¯ç”±é™æ€å›¾ç‰‡æ„æˆçš„ï¼Œæ‰€ä»¥å¤„ç†å¥½å…¨æ™¯åœºæ™¯æ§åˆ¶ã€å…¨æ™¯ç…§ç‰‡å­˜å‚¨å’Œè¯»å–å·²ç»ä»–ä»¬å’Œåœ°ç†ä½ç½®çš„å…³è”å°±å¯ä»¥äº†ã€‚<br>å½“ç„¶ä¸èƒ½ä¸æç¬¬äºŒå‘¨æ„‰å¿«çš„å‘¨æœ«æ—¶å…‰ï¼Œä»è¿™å‘¨å¼€å§‹ï¼Œæ¯å‘¨æœ«éƒ½å’Œå°ä¼™ä¼´ä»¬ä¸€èµ·å®ˆæœ›å¼€é»‘ï¼ˆå¼€é»‘å—ï¼Ÿæˆ‘éº¦å…‹é›·è´¼6ï¼‰ã€‚</p>
<h1 id="ç¬¬ä¸‰å‘¨"><a href="#ç¬¬ä¸‰å‘¨" class="headerlink" title="ç¬¬ä¸‰å‘¨"></a>ç¬¬ä¸‰å‘¨</h1><p>æƒ³é€šäº†å¤§è‡´çš„æŠ€æœ¯è·¯çº¿ï¼Œè¿™å‘¨ä¸»è¦æ˜¯å°è¯•æŠŠæ•´ä¸ªæµç¨‹èµ°é€šï¼Œå¹¶ä¸”æœ‰äº†å¦‚ä¸‹è¿™ä¸ªæŠ€æœ¯æµç¨‹å›¾ã€‚<br><img src="https://o3sw4xojp.qnssl.com/%E6%8A%80%E6%9C%AF%E6%B5%81%E7%A8%8B.png?attname=" alt="æŠ€æœ¯æµç¨‹.png"><br>å…¶ä¸­çš„ä¸€äº›ç»†èŠ‚ï¼š</p>
<ul>
<li>å…¨æ™¯ç…§ç‰‡ç»è¿‡åŠ å·¥å¯ä»¥ç”Ÿæˆå¯¹åº”çš„å…¨æ™¯ç“¦ç‰‡ä»¥åŠæ‹æ‘„ç‚¹ä½åæ ‡ä¿¡æ¯</li>
<li>ç“¦ç‰‡æ˜¯æ›´å¤šç…§ç‰‡çš„é›†åˆï¼Œå¤§é‡çš„å…¨æ™¯ç…§ç‰‡ç”Ÿæˆçš„ç“¦ç‰‡ä»…ä»…é€šè¿‡æ–‡ä»¶å¤¹éš¾ä»¥ç®¡ç†ï¼Œç»“åˆç‚¹ä½ä¿¡æ¯å°†ç”Ÿæˆçš„ç“¦ç‰‡ç›´æ¥å¯¼å…¥åˆ°MongoDBä¸­ï¼›</li>
<li>MongoDB+Nginxå¯ä»¥æä¾›ä¸€ä¸ªé«˜æ€§èƒ½çš„ç“¦ç‰‡æœåŠ¡å™¨ï¼Œç‚¹ä½çŸ¢é‡å›¾å¯ä»¥é€šè¿‡é€‚å½“çš„ç¼“å†²åŒºåˆ†æç”Ÿæˆå¯¹åº”çš„å…¨æ™¯è¦†ç›–èŒƒå›´ï¼ˆç‚¹ä½ç¼“å†²çŸ¢é‡å›¾ï¼‰ï¼›</li>
<li>Flaskä½œä¸ºä¸€ä¸ªwebå¼€å‘æ¡†æ¶ï¼Œå¯ä»¥æœ‰æ•ˆå¤„ç†æ¥è‡ªå‰ç«¯çš„æ•°æ®è®¿é—®ï¼›</li>
<li>GeoServerå¯ä»¥å°†ç”Ÿæˆçš„ç‚¹ä½ç¼“å†²åŒºçŸ¢é‡å›¾å‘å¸ƒç”ŸæˆwmsæœåŠ¡æä¾›è°ƒç”¨ï¼›</li>
<li>å¤©åœ°å›¾æä¾›çš„apiä½œä¸ºåœ°å›¾åº•å›¾ï¼ŒKrpano.jsç”¨ä»¥åœ¨æµè§ˆå™¨ä¸­ç”Ÿæˆå…¨æ™¯åœºæ™¯ï¼Œplugin.jsæ˜¯é€šè¿‡è‡ªå·±å¼€å‘åŠ å…¥å…¨æ™¯åœºæ™¯çš„æ’ä»¶ï¼ˆå¯ä»¥æä¾›è¯¸å¦‚é¹°çœ¼ã€é›·è¾¾åŠŸèƒ½ï¼‰ã€‚</li>
</ul>
<h1 id="ç¬¬å››å‘¨"><a href="#ç¬¬å››å‘¨" class="headerlink" title="ç¬¬å››å‘¨"></a>ç¬¬å››å‘¨</h1><p>æœ‰äº†æŠ€æœ¯è·¯çº¿ï¼Œæƒ³æ¸…æ¥šäº†å…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œå¹¶ä¸”ä¸Šå‘¨å·²ç»åˆæ­¥å®Œæˆäº†å„ä¸ªæ¨¡å—ä¹‹é—´çš„ä¸²è”ã€‚è¿™å‘¨ä¸»è¦æ˜¯å†™ä»£ç ï¼Œç”¨ä»£ç æ‰¹é‡å®Œæˆå¤§è§„æ¨¡å…¨æ™¯ç…§ç‰‡çš„åœºæ™¯ç”Ÿæˆï¼Œæå–å…¨æ™¯ç…§ç‰‡çš„ç©ºé—´ä¿¡æ¯ï¼Œå®Œæˆå…¨æ™¯ç“¦ç‰‡çš„å…¥åº“ï¼Œå…¨æ™¯æœåŠ¡å™¨ä»£ç çš„ç¼–å†™ï¼Œkrpanoæ’ä»¶ä»¥åŠå‰ç«¯postæ•°æ®çš„jsã€‚å¦å¤–å°±æ˜¯å¤„ç†çŸ¢é‡æ•°æ®ï¼Œç”¨geoserverå‘åœ°å›¾çƒ­ç‚¹èŒƒå›´wmsã€‚<br>æ•´ä¸ªæµç¨‹åŸºæœ¬ä¸Šç®—æ˜¯ç”¨ä¸Šäº†æˆ‘ç°åœ¨çš„æ•´å¥—æŠ€æœ¯æ ˆï¼Œæ„Ÿè§‰è¿˜ä¸é”™ã€‚</p>
<h1 id="å¦å¤–ä¸€äº›äº‹æƒ…"><a href="#å¦å¤–ä¸€äº›äº‹æƒ…" class="headerlink" title="å¦å¤–ä¸€äº›äº‹æƒ…"></a>å¦å¤–ä¸€äº›äº‹æƒ…</h1><p>ç›®å‰å…¨æ™¯åœ°å›¾æ•´ä¸ªæŠ€æœ¯æµç¨‹å¯ä»¥èµ°é€šï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼šåœºæ™¯åˆå§‹è§’åº¦ã€çƒ­ç‚¹é“¾æ¥ä½ç½®ã€é¹°çœ¼åœ°å›¾ä¸Šè§†çº¿èŒƒå›´ç­‰ç­‰ã€‚<br>æœ€è¿‘åœ¨å­¦ä¹ <a href="http://leafletjs.com/" target="_blank" rel="external">leaflet</a>ï¼Œä¹Ÿæ¥è§¦åˆ°<a href="https://www.mapbox.com" target="_blank" rel="external">Mapbox</a>ï¼Œä¸‰å“¥è¯´æƒ³åšä¸ªåº”ç”¨ï¼Œæˆ‘ä¹Ÿæ˜¯å¥½ä¹…æ²¡å†™è‡ªå·±çš„é¡¹ç›®äº†ï¼Œä¿©äººä¸€èµ·æå¯èƒ½ä¸ä¼šé‚£ä¹ˆboringï¼Œæ‰€ä»¥é‚£å°±å¥½å¥½æå•¦ã€‚<br>å‘¨æ—¥ï¼ŒQQæ¨é€å¥åº·æ¶ˆæ¯ï¼Œçœ‹åˆ°ä¸Šå‘¨æ€»å…±å°±èµ°äº†1Wå¤šæ­¥ï¼Œä»¥åæ¯å¤©ä¸‹åˆä¸‹ç­éƒ½è¦å»é”»ç‚¼æ‰è¡Œå•¦ï¼ˆå¤§å“¥ä½ å¾—å¤šè¿åŠ¨å•Šï¼‰ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> flask </tag>
            
            <tag> mongodb </tag>
            
            <tag> nginx </tag>
            
            <tag> krpano </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[èœé¸Ÿåœ¨springbootä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•]]></title>
      <url>/2016/09/21/%E8%8F%9C%E9%B8%9F%E5%9C%A8springboot%E4%BD%BF%E7%94%A8%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>äººçš„æƒ°æ€§çœŸæ˜¯å¯æ€•å•Šï¼<br>å·®ä¸å¤šä»ä¸­ç§‹ä»¥æ¥ï¼Œéƒ½ä¸€ç›´å¤„äºå·æ‡’çš„çŠ¶æ€ï¼ŒåŸºæœ¬ä¸Šæ²¡å­¦ä¹ ä»€ä¹ˆæ–°ä¸œè¥¿ï¼Œè¿™éƒ½è¦å½’åŠŸäºæš´é›ªå®¶çš„é­”å…½ä¸–ç•Œå’Œå®ˆæœ›å…ˆé”‹äº†ã€‚ç©äº†è¿™ä¹ˆä¹…ï¼Œæ˜¯è¯¥æ€»ç»“ä¸‹è¿™æ®µæ—¶é—´é‡åˆ°çš„é—®é¢˜å’Œå·²ç»æ‰¾åˆ°çš„è§£å†³æ–¹æ³•äº†ï¼Œçœçš„ä»¥åå†é‡åˆ°è¿™äº›é—®é¢˜ã€‚</p>
<a id="more"></a>
<h1 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h1><p>å‰æ®µæ—¶é—´ï¼Œé¢†å¯¼è®©å­¦ä¹ javaå¹¶å°è¯•åšä¸€ä¸ªç”¨æˆ·ç®¡ç†æ¨¡å—ï¼Œä½¿ç”¨casç®¡ç†ç”¨æˆ·ç™»é™†ã€‚ç”±äºä¹‹å‰ä¹Ÿæ˜¯æ²¡åšè¿‡è¿™ç±»ä¸œè¥¿ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸»è¦é‡åˆ°çš„é—®é¢˜æœ‰è¿™äº›ï¼š</p>
<ol>
<li>casæœåŠ¡å™¨çš„é…ç½®ï¼›</li>
<li>é›†æˆcaså®¢æˆ·ç«¯åˆ°springbootä¸­ï¼›</li>
<li>å¦‚ä½•ä½¿ç”¨springbooté»˜è®¤çš„æ¨¡ç‰ˆ<a href="http://www.thymeleaf.org/" target="_blank" rel="external">thymeleaf</a>ï¼›</li>
<li>å‰ç«¯æ•°æ®å¦‚ä½•ä¼ ç»™æœåŠ¡å™¨ç«¯ï¼›</li>
<li>æœåŠ¡å™¨ç«¯åœ¨æ¥å—ä¸åŒç±»å‹æ•°æ®çš„æ—¶å€™ï¼Œå¦‚ä½•åšå‡ºå“åº”çš„å¤„ç†ï¼Œè·å–å‰ç«¯ä¼ é€çš„æ•°æ®ï¼›</li>
<li>åç«¯å‘é€çš„æ•°æ®ä¼ ç»™å‰ç«¯ï¼Œå¦‚ä½•é€šè¿‡æ¨¡ç‰ˆæ¥è¡¨ç°ã€‚</li>
</ol>
<p>å¤§è‡´å½’çº³èµ·æ¥å°±æ˜¯è¿™äº›ï¼Œç”±äºæ˜¯javaæ–°æ‰‹ï¼Œè™½ç„¶ä¹‹å‰æ¥è§¦è¿‡mvcç±»å‹çš„æ¡†æ¶ï¼Œä½†æ˜¯åœ¨é¢å¯¹è¿™äº›é—®é¢˜çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼šå‡ºè¿™æ ·é‚£æ ·çš„é—®é¢˜ã€‚</p>
<h1 id="å¦‚ä½•è§£å†³"><a href="#å¦‚ä½•è§£å†³" class="headerlink" title="å¦‚ä½•è§£å†³"></a>å¦‚ä½•è§£å†³</h1><p>ä¸Šè¾¹çš„è¿™äº›é—®é¢˜ï¼Œæœ‰çš„ç”šè‡³èŠ±è´¹äº†æˆ‘ä¸€å¤©çš„æ—¶é—´ï¼Œè¯¦ç»†çš„è®°å½•è¿™äº›é—®é¢˜å·²ç»è§£å†³æ–¹æ³•å¯¹ä¹‹åçš„å­¦ä¹ è‚¯å®šä¼šæœ‰å¸®åŠ©ã€‚</p>
<h2 id="casæœåŠ¡å™¨çš„é…ç½®æ–¹æ³•"><a href="#casæœåŠ¡å™¨çš„é…ç½®æ–¹æ³•" class="headerlink" title="casæœåŠ¡å™¨çš„é…ç½®æ–¹æ³•"></a>casæœåŠ¡å™¨çš„é…ç½®æ–¹æ³•</h2><p>åœ¨æˆ‘çœ‹æ¥ï¼Œcaså¯ä»¥å½“åšæ˜¯ç±»ä¼¼è­¬å¦‚æ•°æ®åº“ä¸€æ ·æä¾›æœåŠ¡çš„ä¸œè¥¿ï¼Œè€Œå®ƒçš„ä½œç”¨åˆ™æ˜¯ä¸ºç³»ç»Ÿæ¨¡å—æä¾›å•ç‚¹ç™»å½•åŠŸèƒ½ã€‚å„ä¸ªç³»ç»Ÿæ¨¡å—é€šè¿‡é›†æˆcaså®¢æˆ·ç«¯ï¼Œå¹¶å®Œæˆå“åº”çš„é…ç½®å³å¯å®ç°ç”¨æˆ·ç™»å½•ç®¡ç†ã€‚<br>è¦æƒ³æ¨¡å—è·å¾—å•ç‚¹ç™»å½•åŠŸèƒ½ï¼Œç¬¬ä¸€æ­¥è¦å…ˆå®Œæˆè‡ªå·±tomcatå¯¹httpsçš„æ”¯æŒï¼š</p>
<h3 id="1-tomcatçš„httpsé…ç½®æ–¹æ³•"><a href="#1-tomcatçš„httpsé…ç½®æ–¹æ³•" class="headerlink" title="1.tomcatçš„httpsé…ç½®æ–¹æ³•"></a>1.tomcatçš„httpsé…ç½®æ–¹æ³•</h3><p>è¿™ä¸€æ­¥æ“ä½œå¯ä»¥å‚è€ƒç½‘ä¸Šç›¸å…³æ•™ç¨‹ï¼Œæ¯”è¾ƒå¤šï¼Œæˆ‘å‚è€ƒçš„ä¸»è¦æ˜¯<a href="http://www.cnblogs.com/richaaaard/p/5035812.html" target="_blank" rel="external">è¿™ä¸ª</a>ï¼Œç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨é…ç½®ç§˜é’¥çš„æ—¶å€™ï¼Œè¾“å…¥åå­—å’Œå§“æ°ã€ç»„ç»‡å•ä½å’Œç»„ç»‡çš„æ—¶å€™ï¼Œä¸€å®šè¦é…ç½®æˆè‡ªå·±çš„æœåŠ¡å™¨åŸŸåã€‚<br>æ¯”å¦‚æˆ‘åœ¨è‡ªå·±çš„hostsæ–‡ä»¶ä¸­å¢åŠ äº†ä¸€æ¡<code>127.0.0.1 cas.eclipsesv.com</code>ï¼Œæˆ‘åœ¨æœ¬åœ°è¿›è¡Œæµ‹è¯•ï¼Œå°±æŠŠä¸Šè¾¹è¦é…ç½®çš„å†…å®¹å†™æˆcas.eclipsesv.comã€‚<br>å¦å¤–è¦æ³¨æ„çš„å°±æ˜¯åœ¨é…ç½®è¿‡ç¨‹ä¸­ä¸€å®šè¦ç»†å¿ƒï¼Œæ³¨æ„å­—æ¯å¤§å°å†™ï¼Œæ–‡ä»¶è·¯å¾„è¿™äº›ä¸œè¥¿ã€‚</p>
<h3 id="2-è·å–cas-server"><a href="#2-è·å–cas-server" class="headerlink" title="2.è·å–cas server"></a>2.è·å–cas server</h3><p>åœ¨å®Œæˆhttpsé…ç½®ä¹‹åä»caså®˜ç½‘ä¸Šä¸‹è½½å®Œæ•´çš„cas serverï¼Œåœ°å€åœ¨<a href="http://developer.jasig.org/cas/cas-server-4.0.0-release.zip" target="_blank" rel="external">è¿™é‡Œ</a>ï¼›<br>å®Œæˆä¸‹è½½ä¹‹åï¼Œè§£å‹å‹ç¼©åŒ…ï¼Œå°†modulesæ–‡ä»¶å¤¹ä¸­çš„cas-server-webapp-4.0.0.warå¤åˆ¶å‡ºæ¥ï¼Œæ”¾åœ¨é…ç½®å¥½çš„tomcatçš„webappæ–‡ä»¶å¤¹ä¸­ã€‚<br>è¿™ä¸ªæ—¶å€™ï¼Œcaså°±ç®—å·®ä¸å¤šé…ç½®å®Œæˆäº†ã€‚</p>
<h3 id="3-è‡ªå®šä¹‰cas-server"><a href="#3-è‡ªå®šä¹‰cas-server" class="headerlink" title="3.è‡ªå®šä¹‰cas server"></a>3.è‡ªå®šä¹‰cas server</h3><p>é»˜è®¤çš„cas serveråªèƒ½æŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œå¹¶ä¸”ç™»å½•é¡µé¢å’Œç™»å‡ºé¡µé¢éƒ½æ˜¯caså®˜æ–¹æä¾›çš„ï¼Œè‡ªå·±å¦‚æœè¦ç”¨çš„è¯è‚¯å®šæ˜¯è¦æ”¹æ”¹çš„ã€‚</p>
<p>æˆ‘ä»¬å­¦ä¹ è¿‡ç¨‹ä¸­ç”¨çš„æ˜¯oralceæ•°æ®åº“ï¼Œæ‰€ä»¥è¦ç»™cas serveræä¾›è®¿é—®oracleçš„èƒ½åŠ›ï¼Œä»æ•°æ®åº“ä¸­è¯»å–ç”¨æˆ·åå’Œå¯†ç ã€‚<br>å®Œæˆè¿™ä¸€æ­¥éœ€è¦åšä¸¤ä¸ªæ“ä½œï¼Œåœ¨casçš„libæ–‡ä»¶å¤¹ä¸­å¢åŠ commons-pool-1.5.7ã€commons-dbcp-1.4ã€ojdbc6è¿™ä¸‰ä¸ªjaråŒ…ï¼›</p>
<p>å¦å¤–å°±æ˜¯åœ¨tomcat/webapps/cas/æ–‡ä»¶å¤¹ä¸­çš„deployerConfigContext.xmlä¸­å¢åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;bean id=&quot;casDataSource&quot; class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;&gt;</div><div class="line">   &lt;property name=&quot;driverClassName&quot;&gt;</div><div class="line">     &lt;value&gt;oracle.jdbc.driver.OracleDriver&lt;/value&gt;</div><div class="line">   &lt;/property&gt;</div><div class="line">   &lt;property name=&quot;url&quot;&gt;</div><div class="line">     &lt;value&gt;jdbc:oracle:thin:@10.211.55.17:1521:xe&lt;/value&gt;</div><div class="line">   &lt;/property&gt;    </div><div class="line">   &lt;property name=&quot;username&quot;&gt;</div><div class="line">     &lt;value&gt;wangmeng&lt;/value&gt;    </div><div class="line">   &lt;/property&gt;</div><div class="line">   &lt;property name=&quot;password&quot;&gt;</div><div class="line">     &lt;value&gt;abc123&lt;/value&gt;</div><div class="line">   &lt;/property&gt;</div><div class="line">&lt;/bean&gt;</div><div class="line">&lt;bean id=&quot;primaryAuthenticationHandler&quot; </div><div class="line">    class=&quot;org.jasig.cas.adaptors.jdbc.QueryDatabaseAuthenticationHandler&quot;&gt;</div><div class="line">    &lt;property name=&quot;dataSource&quot; ref=&quot;casDataSource&quot; /&gt;</div><div class="line">    &lt;property name=&quot;sql&quot; value=&quot;select PASSWORD from USERS where USER_NAME = ?&quot; /&gt;</div><div class="line">&lt;/bean&gt;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ä¸Šè¾¹çš„beanä¸­æ˜¯å…³äºæ•°æ®åº“çš„è¿æ¥ï¼ŒåŒ…æ‹¬æ•°æ®åº“ipã€ç«¯å£å’Œå®ä¾‹åä»¥åŠç™»å½•ç”¨æˆ·åå’Œå¯†ç ï¼›åè¾¹ä¸€ä¸ªbeanä¸­åˆ™æ˜¯å…³äºæ“ä½œç”¨æˆ·è¡¨çš„å†…å®¹ï¼Œä»¥åŠæŸ¥è¯¢è¯­å¥ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœè¦è‡ªå®šä¹‰cas serveerçš„é»˜è®¤ç™»å½•å’Œç™»å‡ºé¡µé¢ï¼Œå¯ä»¥åœ¨casæ–‡ä»¶å¤¹ä¸­çš„WEB-INF/view/jsp/default/ui/ä¸­å®Œæˆä¿®æ”¹ï¼ŒcasLogoutView.jspæ˜¯ç™»å‡ºé¡µé¢ï¼ŒcasLoginView.jspæ˜¯ç™»å½•é¡µé¢ã€‚</p>
<p>ç»è¿‡ä»¥ä¸Šä¸‰æ­¥æ“ä½œcas serveré…ç½®åŸºæœ¬å°±å¯ä»¥å®Œæˆäº†ã€‚</p>
<h2 id="springbooté›†æˆcas"><a href="#springbooté›†æˆcas" class="headerlink" title="springbooté›†æˆcas"></a>springbooté›†æˆcas</h2><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯Shiroï¼Œå¹¶ä¸»è¦å‚è€ƒäº†è¿™ä¸¤ç¯‡åšå®¢ï¼Œ<a href="http://blog.csdn.net/catoop/article/details/50534006" target="_blank" rel="external">spring booté›†æˆshiroå’Œcas</a>å’Œ<a href="http://howiefh.github.io/2015/05/19/shiro-cas-single-sign-on/" target="_blank" rel="external">Shiro &amp; CAS å®ç°å•ç‚¹ç™»å½•</a>ã€‚æŒ‰ç…§è¿™ä¸¤ç¯‡åšå®¢ä¸­è®²çš„å†…å®¹å°±å¯ä»¥æŠŠcaså®¢æˆ·ç«¯å³æˆåˆ°springbootä¸­äº†ã€‚</p>
<h2 id="thymeleafæ¨¡ç‰ˆçš„ä½¿ç”¨"><a href="#thymeleafæ¨¡ç‰ˆçš„ä½¿ç”¨" class="headerlink" title="thymeleafæ¨¡ç‰ˆçš„ä½¿ç”¨"></a>thymeleafæ¨¡ç‰ˆçš„ä½¿ç”¨</h2><p>thymeleaf æ˜¯springboot é»˜è®¤ä½¿ç”¨çš„æ¨¡ç‰ˆï¼Œåœ¨å®˜ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°æ¯”è¾ƒä¸°å¯Œçš„æ–‡æ¡£ï¼Œè®²çš„è¿˜æ˜¯æ¯”è¾ƒå¥½çš„ã€‚æˆ‘åœ¨ä½¿ç”¨ä¸­ä¸»è¦ç”¨åˆ°äº†åç«¯ä¼ å¯¹è±¡ç»™thymeleafè¿›è¡Œæ¸²æŸ“ï¼Œthymeleafå¾ªç¯ã€åˆ¤æ–­è¿™äº›å¾ˆåŸºæœ¬çš„åŠŸèƒ½ã€‚æ‰“ç®—è¿™å‘¨å‚è€ƒå®˜æ–¹æ–‡æ¡£å†ç³»ç»Ÿçš„è¿‡ä¸€éå®ƒçš„å…¶å®ƒåŠŸèƒ½ã€‚</p>
<h2 id="å‰ç«¯postæ•°æ®ç»™åç«¯"><a href="#å‰ç«¯postæ•°æ®ç»™åç«¯" class="headerlink" title="å‰ç«¯postæ•°æ®ç»™åç«¯"></a>å‰ç«¯postæ•°æ®ç»™åç«¯</h2><p>åœ¨è¿™ä¸ªå°æ¨¡å—çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå‰ç«¯postæ•°æ®æˆ‘ä¸»è¦æ˜¯ç”¨ä¸¤ç§æ–¹å¼ï¼Œformè¡¨å•æäº¤å’Œajaxä¼ è¾“ã€‚</p>
<h3 id="formè¡¨å•ç»“åˆthymeleaf"><a href="#formè¡¨å•ç»“åˆthymeleaf" class="headerlink" title="formè¡¨å•ç»“åˆthymeleaf"></a>formè¡¨å•ç»“åˆthymeleaf</h3><p>ç”±äºä½¿ç”¨äº†thymeleafæ¨¡ç‰ˆï¼Œå› æ­¤è¡¨å•æäº¤çš„æ–¹æ³•å˜å¾—æ›´åŠ ç®€ä¾¿ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;form method=&quot;POST&quot; th:action=&quot;@&#123;&apos;/newDiscussion/&apos;+$&#123;groupid.groupID&#125;&#125;&quot; th:object=&quot;$&#123;newDiscuss&#125;&quot;&gt;</div><div class="line">    &lt;div class=&quot;form-group&quot;&gt; </div><div class="line">        &lt;label for=&quot;groupname&quot;&gt;è®¨è®ºç»„å&lt;/label&gt;</div><div class="line">        &lt;input type=&quot;text&quot; th:field=&quot;*&#123;discussionName&#125;&quot; class=&quot;form-control&quot; id=&quot;groupname&quot;&gt;&lt;/input&gt;</div><div class="line">        &lt;label for=&quot;desc&quot;&gt;æè¿°&lt;/label&gt;</div><div class="line">        &lt;input type=&quot;text&quot; th:field=&quot;*&#123;desc&#125;&quot; class=&quot;form-control&quot; id=&quot;desc&quot;&gt;&lt;/input&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œè¯¥è¡¨å•æ˜¯å¡«å†™ä¿¡ä»¶è®¨è®ºç»„ç›¸å…³çš„å†…å®¹ï¼Œæˆ‘éœ€è¦åšçš„åªæ˜¯åœ¨å¯¹åº”çš„inputä¸­å®ŒæˆnewDiscusså¯¹è±¡discussionNameã€descå±æ€§çš„å¡«å†™å³å¯å®Œæˆã€‚è€ŒnewDiscusså¯¹è±¡æ˜¯æ€ä¹ˆæ¥çš„ï¼Œå°†ä¼šåœ¨åè¾¹æœ‰è¯¦ç»†è§£é‡Šã€‚</p>
<h3 id="ajaxæ•°æ®ä¼ è¾“"><a href="#ajaxæ•°æ®ä¼ è¾“" class="headerlink" title="ajaxæ•°æ®ä¼ è¾“"></a>ajaxæ•°æ®ä¼ è¾“</h3><p>é™¤äº†formè¡¨å•ï¼Œæˆ‘å¯èƒ½éœ€è¦åœ¨ç‚¹å‡»æŸä¸ªæŒ‰é’®ä¹‹åå°†æŸäº›ä¸œè¥¿postç»™åç«¯ï¼Œå¹¶åšå‡ºå“åº”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">function sendData()&#123;</div><div class="line">    var addusers = [];</div><div class="line">    uniqueGroup = $(&quot;h2[name=&apos;uniqueGroup&apos;]&quot;).attr(&quot;id&quot;);</div><div class="line">    addusers.push(uniqueGroup);</div><div class="line">    $(&quot;input[type=&apos;checkbox&apos;]&quot;).each(</div><div class="line">                    function() &#123;</div><div class="line">                        if($(this)[0].checked==true)</div><div class="line">                        &#123;</div><div class="line">                            userid = ($(this).attr(&quot;id&quot;));</div><div class="line">                            addusers.push(userid);</div><div class="line">                        &#125;     </div><div class="line">                    &#125;</div><div class="line">                );</div><div class="line">    $.ajax(&#123;</div><div class="line">        url:&quot;http://cas.eclipsesv.com:9000/group/adduser&quot;,</div><div class="line">        data:JSON.stringify(addusers),</div><div class="line">        type:&quot;post&quot;,</div><div class="line">        contentType: &quot;application/json; charset=utf-8&quot;,</div><div class="line">        dataType:&quot;json&quot;,</div><div class="line">        success:function(responseText)&#123;</div><div class="line">                $(&apos;#myModal&apos;).modal(&apos;hide&apos;);</div><div class="line">                var groupid = responseText.redirect;</div><div class="line">                    var url = &quot;http://cas.eclipsesv.com:9000/group/&quot;+groupid;</div><div class="line">                    window.location.href = url</div><div class="line">                &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç æ˜¯è¦å®Œæˆå°†ä¸€ä¸ªç”±ç”¨æˆ·idç»„æˆçš„æ•°ç»„postç»™åç«¯ï¼Œå¹¶åœ¨æ•°æ®ä¼ è¾“æˆåŠŸä¹‹åå°†é¡µé¢é‡å®šå‘ã€‚</p>
<h2 id="åç«¯å¦‚ä½•è§£ææ¥è‡ªå‰ç«¯çš„æ•°æ®"><a href="#åç«¯å¦‚ä½•è§£ææ¥è‡ªå‰ç«¯çš„æ•°æ®" class="headerlink" title="åç«¯å¦‚ä½•è§£ææ¥è‡ªå‰ç«¯çš„æ•°æ®"></a>åç«¯å¦‚ä½•è§£ææ¥è‡ªå‰ç«¯çš„æ•°æ®</h2><p>å¯¹åº”ä¸Šè¿°å‰ç«¯postæ•°æ®æ–¹æ³•ï¼Œspringbootä¹Ÿæœ‰å¯¹åº”çš„æ•°æ®è§£ææ–¹æ³•ï¼š</p>
<h3 id="è§£æformè¡¨å•æäº¤çš„æ•°æ®"><a href="#è§£æformè¡¨å•æäº¤çš„æ•°æ®" class="headerlink" title="è§£æformè¡¨å•æäº¤çš„æ•°æ®"></a>è§£æformè¡¨å•æäº¤çš„æ•°æ®</h3><p>åˆšæ‰æåˆ°ï¼Œå‰ç«¯åœ¨æäº¤formè¡¨å•çš„æ—¶å€™ï¼Œåªéœ€è¦å®ŒæˆnewDiscusså¯¹åº”å±æ€§çš„å¡«å†™å³å¯ï¼Œè€Œè¿™ä¸ªnewDiscusså¯¹è±¡åˆ™æ˜¯æˆ‘åœ¨formè¡¨å•é¡µé¢ä¸­é€šè¿‡æ¨¡ç‰ˆåµŒå…¥çš„å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@RequestMapping(value = &quot;/group/&#123;groupid&#125;&quot;,method = RequestMethod.GET)</div><div class="line">public String group(@PathVariable String groupid,Model model)&#123;</div><div class="line">    DiscussionGroup discussionGroup = new DiscussionGroup();</div><div class="line">    model.addAttribute(&quot;newDiscuss&quot;, discussionGroup);</div><div class="line">    return &quot;group&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨å‰ç«¯getæ­¤é¡µé¢çš„æ—¶å€™ï¼Œnewä¸€ä¸ªDiscussionGroupå¯¹è±¡ï¼Œåœ¨æ¨¡ç‰ˆä¸­ç”¨newDiscussä»£è¡¨å®ƒï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å‰ç«¯å¡«å†™è¡¨å•çš„æ—¶å€™å®ŒæˆnewDiscusså±æ€§çš„è®¾ç½®ã€‚</p>
<p>åœ¨å®Œæˆå±æ€§å¡«å†™ä¹‹åï¼Œåç«¯è§£ææ•°æ®é€šè¿‡ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">@RequestMapping(value = &quot;/newDiscussion/&#123;groupid&#125;&quot;,method = RequestMethod.POST)</div><div class="line">public String newDiscussion(@PathVariable String groupid,ModelMap model, DiscussionGroup discussionGroup)&#123;</div><div class="line">    if (discussionGroup != null) &#123;</div><div class="line">        System.out.print(groupid);</div><div class="line">    &#125;</div><div class="line">    ControllerHelper helper = new ControllerHelper(userDAOImpl, groupUserDAOImpl, groupDAOImpl,</div><div class="line">            discussionDAOImpl,commentDAOImpl);</div><div class="line">    helper.newDiscussionGroup(discussionGroup,helper.getCurrentUser().getUserId(),groupid);</div><div class="line">    return &quot;redirect:/group/&quot;+groupid;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç›´æ¥åœ¨å‡½æ•°ç­¾åä¸­å¯¹åº”å†™ä¸€ä¸ªDiscussionGroupå¯¹è±¡ï¼Œç”¨ä»¥æ¥å—åˆšåˆšçš„newDiscussï¼Œå°±æ˜¯è¿™æ ·ç®€å•ã€‚éœ€è¦é¢å¤–åšçš„å°±æ˜¯åœ¨DiscussionGroupä¸­å®Œæˆç›¸åº”å±æ€§çš„getterå’Œsetterä»¥åŠé»˜è®¤æ„é€ å‡½æ•°ã€‚</p>
<h3 id="è§£æajaxæäº¤çš„æ•°æ®"><a href="#è§£æajaxæäº¤çš„æ•°æ®" class="headerlink" title="è§£æajaxæäº¤çš„æ•°æ®"></a>è§£æajaxæäº¤çš„æ•°æ®</h3><p>ä¸åŒäºä¸Šè¾¹formè¡¨å•æäº¤é‚£æ ·ï¼Œæ¥å—ajaxä¼ è¾“çš„æ•°æ®éœ€è¦æŒ‰ç…§ä¸‹è¾¹è¿™æ ·æ¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">@RequestMapping(value = &quot;/comments/delete&quot;,method = RequestMethod.POST)</div><div class="line">@ResponseBody</div><div class="line">public Map&lt;String, String&gt;  delComment(@RequestBody String[] userArray)&#123;</div><div class="line">    ControllerHelper helper = new ControllerHelper(userDAOImpl, groupUserDAOImpl, groupDAOImpl,</div><div class="line">            discussionDAOImpl,commentDAOImpl);</div><div class="line">    if (userArray[0] != null) &#123;</div><div class="line">        String groupid = helper.delComment(userArray[0]);</div><div class="line">        System.out.println(userArray[0]+&quot;è¯„è®ºå·²åˆ é™¤&quot;);</div><div class="line">        Map&lt;String, String&gt; result = new HashMap&lt;String, String&gt;();</div><div class="line">        result.put(&quot;redirect&quot;, groupid);</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">        return null;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>éœ€è¦ç”¨åˆ°@ResponseBodyæ³¨è§£ï¼Œå¹¶ä¸”è¿™æ¬¡è¿”å›ç»™å‰ç«¯çš„æ•°æ®ä¹Ÿä¸æ˜¯å…·ä½“çš„æŸä¸ªviewåï¼Œè€Œæ˜¯å®å®åœ¨åœ¨çš„æ•°æ®ï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªé”®å€¼å¯¹ï¼Œè€Œè¿”å›çš„æ•°æ®å¯ä»¥åœ¨ajaxçš„sucessä¸­å¤„ç†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">success:function(responseText)&#123;</div><div class="line">    $(&apos;#myModal&apos;).modal(&apos;hide&apos;);</div><div class="line">    var groupid = responseText.redirect;</div><div class="line">        var url = &quot;http://cas.eclipsesv.com:9000/group/&quot;+groupid;</div><div class="line">        window.location.href = url</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a>æœªå®Œå¾…ç»­</h1><p>ä¸Šè¾¹å†™çš„éƒ½æ˜¯ä½œä¸ºä¸€ä¸ªå…¥é—¨èœé¸Ÿåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œä¸€äº›ç¨šå«©çš„è§£å†³æ–¹æ³•ï¼Œåè¾¹ä¼šé‡åˆ°æ›´å¤æ‚çš„é—®é¢˜ï¼Œæˆ‘ä¹Ÿä¼šä¸€å¦‚å³å¾€çš„è®°å½•è‡ªå·±çš„æˆé•¿è¿‡ç¨‹ã€‚</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æƒ³è¦èµ°å‡ºèˆ’é€‚åŒº]]></title>
      <url>/2016/08/26/%E6%83%B3%E8%A6%81%E8%B5%B0%E5%87%BA%E8%88%92%E9%80%82%E5%8C%BA/</url>
      <content type="html"><![CDATA[<h1 id="å·¥ä½œä¸€ä¸ªæœˆçš„æ„Ÿå—"><a href="#å·¥ä½œä¸€ä¸ªæœˆçš„æ„Ÿå—" class="headerlink" title="å·¥ä½œä¸€ä¸ªæœˆçš„æ„Ÿå—"></a>å·¥ä½œä¸€ä¸ªæœˆçš„æ„Ÿå—</h1><p>åˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œå·²ç»å…¥èŒä¸€ä¸ªæœˆäº†ï¼Œæ²¡æƒ³åˆ°æ—¶é—´è¿‡çš„è¿™ä¹ˆå¿«ï¼Œæƒ³æƒ³è¿™ä¸ªæœˆçš„ç”Ÿæ´»ï¼Œæˆ‘å¥½åƒå·²ç»å¿«è¦é€‚åº”ç°åœ¨çš„ç”Ÿæ´»èŠ‚å¥äº†ã€‚<br><a id="more"></a><br>ç°åœ¨æ˜¯æ™šä¸Š11ç‚¹46åˆ†ï¼Œå’Œå¤§è„¸åˆ€äº†ä¸€æ™šï¼Œå®¤å‹åœ¨çœ‹ç€æ‰‹æœºå‡†å¤‡ç¡è§‰ï¼Œä½†æ˜¯æˆ‘æœ‰ç‚¹ç¡ä¸ç€ï¼Œæˆ‘å¿«è¦é€‚åº”çš„è¿™ç§ç”Ÿæ´»å’Œæˆ‘æƒ³è±¡çš„è¿˜æ˜¯ä¸å¤ªä¸€æ ·ï¼Œç°åœ¨æœ‰ç‚¹å¤ªè¿‡èˆ’é€‚äº†ã€‚ä½åœ¨å•ä½çš„å•èº«å…¬å¯“ï¼ŒåŠå…¬å®¤å’Œä½å®¤å°±åœ¨ä¸€å±‚ï¼Œä¸¤æ­¥å°±åˆ°ã€‚æ—©ä¸Šå…«ç‚¹åŠåˆ°åä¸€ç‚¹åŠï¼Œä¸­é—´ä¼‘æ¯åˆ°ä¸¤ç‚¹åŠï¼Œä¸‹åˆäº”ç‚¹åŠåˆä¸‹ç­äº†ã€‚ä¸ç”¨å¿å—æ‹¥æŒ¤çš„åœ°é“ï¼Œä¸ç”¨ä¸ºä¸Šç­è¿Ÿåˆ°å®³æ€•ï¼Œæ²¡æœ‰è€æ¿åœ¨è¾¹ä¸Šç›‘è§†ä½ çš„ä¸€ä¸¾ä¸€åŠ¨ï¼Œæ²¡æœ‰è®©äººéš¾ä»¥å¿å—çš„å·¥ä½œå‹åŠ›ã€‚<br>ç¬¬ä¸€ä¸ªæœˆï¼Œç”±äºæ²¡æœ‰å…·ä½“çš„å·¥ä½œä»»åŠ¡ï¼Œé¢†å¯¼åªæ˜¯è¯´ç°åœ¨è®©å­¦ä¹ ï¼Œé‚£å°±æš‚ä¸”æ€»ç»“ä¸€ä¸‹è¿™ä¸ªæœˆæˆ‘éƒ½å­¦åˆ°äº†ä»€ä¹ˆã€‚</p>
<h2 id="ç¬¬ä¸€å‘¨"><a href="#ç¬¬ä¸€å‘¨" class="headerlink" title="ç¬¬ä¸€å‘¨"></a>ç¬¬ä¸€å‘¨</h2><p>åˆšæ¥ç¬¬ä¸€å‘¨ï¼Œè¢«å‘é…åˆ°åŠå…¬æ¥¼ï¼Œæ²¡æœ‰ç½‘ç»œï¼Œæ²¡æœ‰å·¥ä½œä»»åŠ¡ã€‚</p>
<ul>
<li>æˆ‘ä¹Ÿæ˜¯åªå¥½ç»§ç»­åšä¹‹å‰çš„pythonå°é¡¹ç›®ï¼Œå®Œå–„äº†æŠ“å–æ–—é±¼ç½‘ç«™æ•°æ®çš„åŠŸèƒ½ã€‚æŠŠå†…å®¹éƒ½æ€»ç»“é“hack on douyu ç³»åˆ—çš„åšå®¢é‡Œè¾¹ã€‚</li>
<li>å¦å¤–å°±æ˜¯å­¦äº†ä¸€ä¸‹arcgiså®˜æ–¹æä¾›çš„pythonåº“ï¼Œæ„Ÿè§‰ä»¥åå·¥ä½œåº”è¯¥ä¼šç”¨åˆ°ã€‚</li>
<li>å¦å¤–å°±æ˜¯åˆé‡æ–°çœ‹äº†ä¸€éredisè®¾è®¡ä¸å®ç°è¿™æœ¬ä¹¦ï¼Œå¯¹redisä½œè€…é«˜è¶…æŠ€è‰ºçš„å´‡æ‹œä¹‹æ„Ÿåˆå¢åŠ äº†ä¸å°‘ã€‚</li>
</ul>
<h2 id="ç¬¬äºŒå‘¨"><a href="#ç¬¬äºŒå‘¨" class="headerlink" title="ç¬¬äºŒå‘¨"></a>ç¬¬äºŒå‘¨</h2><p>è¿™å‘¨å¼€å§‹é€æ¸æš‚åœäº†douyué¡¹ç›®çš„æ›´æ–°ï¼Œæƒ³ç”¨ä¹‹å‰å­¦åˆ°çš„ä¸œè¥¿çœŸæ­£ç”¨èµ·æ¥ï¼Œæƒ³è¦ç”¨flaské‡å†™è‡ªå·±çš„åšå®¢ã€‚</p>
<ul>
<li>å­¦ä¼šäº†ä½¿ç”¨blueprintæ¥çµæ´»æ‰©å±•flask</li>
<li>å­¦ä¼šä½¿ç”¨wtformæ¥å†™é¡µé¢</li>
<li>å¦å¤–oauthç™»å½•æ–¹å¼ä¹Ÿåšäº†ä¸€äº›äº†è§£ï¼Œå¹¶ä½œäº†Githubå’ŒBattlenetçš„oauthç™»å½•</li>
<li>é‡æ–°çœ‹äº†mongodbå®˜æ–¹æ–‡æ¡£ï¼Œå°¤å…¶æ˜¯data aggrigationæ–¹é¢çš„ä¸œè¥¿</li>
</ul>
<p>æœ¬æ‰“ç®—ç”¨battlenetçš„apiæ¥è·å–ä¸€ä¸‹å›½æœçš„æ•°æ®ï¼Œè°çŸ¥é“ç‰¹ä¹ˆçš„ç½‘æ˜“ä¸å¼€å‘å›½æœæ•°æ®ã€‚åˆæ­¥äº†è§£äº†ä¸€ä¸‹githubæä¾›çš„apiåŠŸèƒ½ã€‚<br>å¦å¤–å°±æ˜¯å‡ºå»å‡ºäº†ä¸¤å¤©å·®ï¼Œæ„Ÿå—äº†ä¸‹è¿™è¾¹çš„å·¥ä½œçŠ¶æ€ã€‚</p>
<h2 id="ç¬¬ä¸‰å‘¨"><a href="#ç¬¬ä¸‰å‘¨" class="headerlink" title="ç¬¬ä¸‰å‘¨"></a>ç¬¬ä¸‰å‘¨</h2><p>è¿™å‘¨é¢†å¯¼å›æ¥äº†ï¼Œè¯´è®©å­¦ä¹ javaï¼Œä¹°äº†javaæ ¸å¿ƒæŠ€æœ¯å¤§è‡´çœ‹äº†ä¸€éï¼Œå›é¡¾äº†oopçš„å†…å®¹ï¼Œè¿™å‘¨å…¶å®ä¸»è¦æ˜¯çœ‹ä¹¦ï¼Œå¦å¤–å°±æ˜¯çœ‹springå®˜ç½‘çš„guideï¼Œé…ç½®javaå¼€å‘ç¯å¢ƒã€‚å‘¨æœ«å»æ²³åŒ—çœå›¾ä¹¦é¦†é€›äº†ä¸€è¶Ÿï¼Œå€Ÿäº†ä¸¤æœ¬ä¹¦ã€‚ä»¥åæœ‰æ—¶é—´è¿˜æ˜¯è¦å¤šå»å›¾ä¹¦é¦†ã€‚</p>
<h2 id="ç¬¬å››å‘¨"><a href="#ç¬¬å››å‘¨" class="headerlink" title="ç¬¬å››å‘¨"></a>ç¬¬å››å‘¨</h2><p>å°±æ˜¯è¿™å‘¨äº†ï¼Œjavaæ ¸å¿ƒæŠ€æœ¯çœ‹å®Œä¹‹åï¼Œä¸»è¦æ˜¯åŠ¨æ‰‹æ“ä½œã€‚å­¦ä¼šäº†ä½¿ç”¨mavenåˆ›å»ºjavaé¡¹ç›®ï¼Œåˆ©ç”¨springbootçš„ä¾¿åˆ©ä½œäº†ä¸€ä¸ªåœ¨çº¿èŠå¤©å®¤ã€‚è¿™å‘¨çš„å·¥ä½œä¸»è¦æ˜¯å’Œä¹‹å‰å­¦ä¹ çš„flaskç±»æ¯”ï¼Œäº†è§£äº†springä¸­mvcå„æ–¹é¢å¦‚ä½•æ„å»ºï¼Œå¦‚ä½•èµ°é€šæ•´ä¸ªæµç¨‹ã€‚<br>å¦å¤–å°±æ˜¯åœ¨å‰ç«¯æ–¹é¢åˆä»”ç»†å­¦ä¹ äº†ä¸€ä¸‹ï¼Œä¸»è¦æ˜¯bootstrapã€‚<br>å¦å¤–ä¸å¾—ä¸æçš„æ˜¯ï¼Œå‘¨äºŒå»çœ‹äº†ä¸€ç›´æƒ³çœ‹çš„ã€Šè°å½±é‡é‡5ã€‹ï¼Œç”µå½±ä¸é”™ï¼Œå°±æ˜¯æ™ƒå¾—å¾ˆã€‚ã€‚ã€‚</p>
<h1 id="æ—¥å­æ€ä¹ˆè¿‡"><a href="#æ—¥å­æ€ä¹ˆè¿‡" class="headerlink" title="æ—¥å­æ€ä¹ˆè¿‡"></a>æ—¥å­æ€ä¹ˆè¿‡</h1><p>è¿™å››å‘¨å°±è¿™æ ·è¿‡æ¥äº†ï¼Œæˆ‘æƒ³å¦‚æœæ˜¯è¦åœ¨å…¬å¸çš„è¯ï¼Œè‚¯å®šæ˜¯ä¸ä¼šæœ‰è¿™æ ·å¤šçš„æ—¶é—´ç”¨æ¥å­¦ä¹ ï¼Œä¸è¿‡ä¸€ä¸ªæœˆä¸‹æ¥ä¹‹åï¼Œæ„Ÿå—æœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li>å­¦ä¹ å†…å®¹ä¸å¤Ÿå¤š</li>
<li>å­¦ä¹ åŠ¨åŠ›ä¸è¶³</li>
</ol>
<p>javaç°åœ¨å¯ä»¥è¯´æ˜¯å…¥äº†é—¨ï¼Œä½†æ˜¯æ²¡æœ‰å®é™…é¡¹ç›®æ¥åšï¼Œæ„Ÿè§‰æ¯”è¾ƒè™šï¼Œæˆ‘å¾—æœ‰ä¸ªæƒ³æ³•ï¼Œè‡ªå·±å…ˆæ“ç»ƒèµ·æ¥ã€‚pythonçš„è¯ï¼Œæ„Ÿè§‰åŸºç¡€çŸ¥è¯†æŒæ¡çš„å·®ä¸å¤šï¼Œå¸¦çš„ä¸¤æœ¬ä¹¦è¦å°½å¿«çœ‹å®Œã€‚<br>å¦å¤–ï¼Œä¹‹åçš„å·¥ä½œæ•ˆç‡è¦æœ‰æ‰€æå‡ï¼Œè¦è‡ªå·±åŠ å‹ï¼ŒæŠŠæ—¶é—´æ”¾åœ¨å­¦ä¹ ä¸Šï¼Œåˆ©ç”¨è¿™æ®µå®è´µçš„æ—¶é—´æå‡è‡ªæˆ‘ä»·å€¼ã€‚<br>å¥½äº†ï¼Œç°åœ¨æœ‰ç‚¹å›°äº†ï¼Œç¡äº†ç¡äº†ã€‚<br>å™¢ï¼Œå¯¹äº†ï¼Œç§‹å¤©æ¥äº†ï¼Œæˆ‘æœ€å–œæ¬¢çš„åŒ—æ–¹çš„ç§‹å¤©ã€‚åŠ æ²¹å§ï¼</p>
]]></content>
      
        <categories>
            
            <category> å¿ƒæƒ…æ–‡å­— </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ä½¿ç”¨IDEAå’Œmavenå¿«é€Ÿæ­å»ºSpringBooté¡¹ç›®]]></title>
      <url>/2016/08/25/springboot/</url>
      <content type="html"><![CDATA[<p>ç”±äºå•ä½é¡¹ç›®ä½¿ç”¨javaå¼€å‘ï¼Œæ¡†æ¶ç”¨çš„springï¼Œä¹‹å‰ä¸€ç›´è§‰å¾—javaç‰¹åˆ«éº»çƒ¦ï¼Œæ‰€ä»¥ä¸€ç›´é¿å…å’Œjavaæ¥è§¦ï¼Œè¿™ä¸‹è·‘ä¸æ‰äº†ã€‚æ‰€ä»¥è¿‘ä¸¤å‘¨ä¸€ç›´åœ¨å­¦ä¹ javaã€‚åœ¨æ­¤è®°å½•ä¸€ä¸‹å­¦ä¹ è¿‡ç¨‹ï¼Œå’Œä¸‹ä¸€æ­¥å­¦ä¹ è®¡åˆ’ã€‚<br><a id="more"></a></p>
<h1 id="ä¹¦ç±å’Œæ–‡æ¡£"><a href="#ä¹¦ç±å’Œæ–‡æ¡£" class="headerlink" title="ä¹¦ç±å’Œæ–‡æ¡£"></a>ä¹¦ç±å’Œæ–‡æ¡£</h1><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘å¯¹æŸä¸ªæŠ€æœ¯æ„Ÿå…´è¶£çš„è¯ï¼Œæˆ‘ä¼šå…ˆå»æ‰¾è¿™æ–¹é¢æ¯”è¾ƒç»å…¸çš„ä¹¦ï¼Œæ‰¾äº†ç½‘ä¸Šçš„è¯„ä»·ä¹‹åï¼Œå‘ç°<a href="https://book.douban.com/subject/3146174/" target="_blank" rel="external">Javaæ ¸å¿ƒæŠ€æœ¯</a>è¿™æœ¬ä¹¦æ¯”è¾ƒä¸é”™ï¼Œæœæ–­ä¹°æ¥ã€‚</p>
<p>ç¬¬ä¸€å‘¨è®°æœ¬ä¸Šéƒ½åœ¨çœ‹ä¹¦ï¼Œä¹Ÿæ˜¯åœ¨å†æ¬¡å¯¹OOPæœ‰äº†é‡æ–°çš„è®¤è¯†ã€‚çœ‹è¿‡ä¹¦ä¹‹åï¼Œå‡†å¤‡å†å­¦ä¹ ä¸€ä¸‹springï¼Œç½‘ä¸Šçœ‹äº†å‚è€ƒèµ„æ–™å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œä¸è¿‡æˆ‘çœ‹springå®˜ç½‘ä¸Šçš„<a href="https://spring.io/guides" target="_blank" rel="external">guide</a>å¾ˆä¸é”™ï¼Œå¯ä»¥å‚è€ƒç€æ’¸ä¸€éã€‚å¦å¤–å°±æ˜¯ä¸€ä¸ª<a href="http://websystique.com/spring-4-mvc-tutorial/" target="_blank" rel="external">æ•™ç¨‹</a>ï¼Œå…³äºspring mvcçš„ã€‚</p>
<h1 id="æèµ·"><a href="#æèµ·" class="headerlink" title="æèµ·"></a>æèµ·</h1><p>æœ‰äº†ä¹¦å’Œæ–‡æ¡£çš„å¸®åŠ©ä¹‹åï¼Œè‡ªç„¶è¦å®é™…æ“ä½œèµ·æ¥æ‰è¡Œã€‚åœ¨æ“ä½œä¹‹å‰æˆ‘ä¹Ÿæ˜¯çœ‹äº†ä¸å°‘ç›¸å…³çš„å¸–å­ï¼Œæœ€åé€‰åˆ™IDEAæ¥å¼€å‘ï¼Œè€Œspringbootæ›´æ˜¯æå¤§çš„å‡å°‘äº†javaå¼€å‘çš„å¤æ‚ç¨‹åº¦ï¼Œå‡å°‘äº†å¤§é‡çš„xmlé…ç½®æ–‡ä»¶ã€‚ä¸‹é¢å°±è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨IDEAé…åˆmavenå¿«é€Ÿæ­å»ºä¸€ä¸ªspringbootç¨‹åºå§ã€‚</p>
<h2 id="æ–°å»ºé¡¹ç›®"><a href="#æ–°å»ºé¡¹ç›®" class="headerlink" title="æ–°å»ºé¡¹ç›®"></a>æ–°å»ºé¡¹ç›®</h2><p>ä½¿ç”¨IDEAæ–°å»ºmavené¡¹ç›®ï¼š<br><img src="https://o3sw4xojp.qnssl.com/%E6%96%B0%E5%BB%BAmaven.png" alt="æ–°å»ºmavené¡¹ç›®"><br>é€‰æ‹©mavenï¼Œå‹¾é€‰archetypeï¼Œé€‰æ‹©maven-archetype-webappã€‚ç„¶åå®Œæˆä¸€äº›è®¾ç½®å°±å¯ä»¥è¿›å…¥åˆ°é¡¹ç›®æ–‡ä»¶äº†ã€‚</p>
<h2 id="mavenæºè®¾ç½®"><a href="#mavenæºè®¾ç½®" class="headerlink" title="mavenæºè®¾ç½®"></a>mavenæºè®¾ç½®</h2><p>æœ‰è¿‡ç”¨mavenç®¡ç†é¡¹ç›®ç»éªŒçš„éƒ½çŸ¥é“ï¼Œä½¿ç”¨mavené»˜è®¤çš„æºé€Ÿåº¦ç‰¹åˆ«æ…¢ï¼Œç»å¸¸æ˜¯å†™ä»£ç çš„æ—¶é—´è¿˜æ²¡ç­‰å¾…jaråŒ…ä¸‹è½½çš„æ—¶é—´é•¿ã€‚ç»è¿‡æˆ‘çš„ä¸€ç•ªæœç´¢å‘ç°é˜¿é‡Œäº‘æä¾›çš„mavenæºåœ¨å›½å†…è¿˜æ˜¯æ¯”è¾ƒä¼˜è´¨çš„ã€‚éœ€è¦åšçš„å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨IDEAä¸­ç¨å¾®ä¿®æ”¹ä¸€ä¸‹settingsæ–‡ä»¶å³å¯ã€‚<br>å³é”®pom.xmlæ–‡ä»¶ï¼Œé€‰æ‹©mavené€‰é¡¹ï¼Œç‚¹å‡»æ‰“å¼€settings.xmlï¼Œåœ¨å…¶ä¸­å¢åŠ å¦‚ä¸‹è¿™æ®µé…ç½®æ–‡ä»¶ä¿å­˜å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;mirrors&gt;</div><div class="line">        &lt;mirror&gt;</div><div class="line">            &lt;id&gt;nexus-aliyun&lt;/id&gt;</div><div class="line">            &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</div><div class="line">            &lt;name&gt;Nexus aliyun&lt;/name&gt;</div><div class="line">            &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt;</div><div class="line">        &lt;/mirror&gt;</div><div class="line">&lt;/mirrors&gt;</div></pre></td></tr></table></figure>
<p>æ•ˆæœå°±æ˜¯è¿™æ ·<img src="https://o3sw4xojp.qnssl.com/settings.png" alt="settings.xml">ã€‚</p>
<h2 id="ä¾èµ–é¡¹å¯¼å…¥"><a href="#ä¾èµ–é¡¹å¯¼å…¥" class="headerlink" title="ä¾èµ–é¡¹å¯¼å…¥"></a>ä¾èµ–é¡¹å¯¼å…¥</h2><p>åˆ©ç”¨springbootè¿›è¡Œå¼€å‘webappï¼Œæˆ‘åœ¨ä½¿ç”¨ä¸­éœ€è¦å¯¼å…¥è¿™äº›ä¾èµ–ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;dependency&gt;</div><div class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</div><div class="line">  &lt;version&gt;1.4.0.RELEASE&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-thymeleaf --&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">  &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</div><div class="line">  &lt;version&gt;1.4.0.RELEASE&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="line">  &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</div><div class="line">  &lt;version&gt;1.4.0.RELEASE&lt;/version&gt;</div><div class="line">  &lt;optional&gt;true&lt;/optional&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure>
<p>ç”±äºé…ç½®äº†mavenæºï¼Œè¿™äº›ä¾èµ–é¡¹ä¸‹è½½é€Ÿåº¦è¿˜æ˜¯æŒºå¿«çš„ã€‚</p>
<h2 id="ç ç ç "><a href="#ç ç ç " class="headerlink" title="ç ç ç "></a>ç ç ç </h2><p>é…ç½®å¥½è¿™äº›ä¸œè¥¿ä¹‹åï¼Œå°±å¯ä»¥ç èµ·æ¥äº†ã€‚é¦–å…ˆè¦åœ¨srcæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªç›®å½•ä½œä¸ºSoucres Rootï¼š<br><img src="https://o3sw4xojp.qnssl.com/source.png" alt="Sources Root"><br>åœ¨è¿™é‡Œï¼Œæˆ‘æŠŠjavaä½œä¸ºSoucres Rootï¼Œç”±äºä½¿ç”¨äº†springbootï¼Œåªéœ€è¦ç”¨javaä»£ç å†™å¥½controllerå³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">package com.eclipsesv.HelloController;</div><div class="line"></div><div class="line">import org.springframework.stereotype.Controller;</div><div class="line">import org.springframework.web.bind.annotation.RequestMapping;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by eclipse on 16/8/26.</div><div class="line"> */</div><div class="line">@Controller</div><div class="line">public class Hello &#123;</div><div class="line">    @RequestMapping(&quot;/&quot;)</div><div class="line">    public String index()&#123;</div><div class="line">        return &quot;index&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨@Controllerå’Œ@RequestMappingé…åˆä½¿ç”¨å°±å¯ä»¥å®Œæˆä¸€ä¸ªç®€å•çš„è·¯ç”±æ˜ å°„ï¼Œä¸Šè¾¹çš„è¿™æ®µä»£è¡¨å¦‚æœè®¿é—®urlä¸ºâ€/â€œä¼šè¿”å›åä¸ºâ€indexâ€çš„è§†å›¾ï¼Œè€Œè¿™é‡Œçš„è§†å›¾åªéœ€è¦å†™ä¸€ä¸ªåä¸ºindexçš„html å¹¶æŠŠå®ƒæ”¾åœ¨/resources/templatesä¸­å³å¯ã€‚<br>ç„¶ååªéœ€è¦å†™ä¸€ä¸ªmainå‡½æ•°å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">package com.eclipsesv;</div><div class="line"></div><div class="line">import org.springframework.boot.SpringApplication;</div><div class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</div><div class="line"></div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by eclipse on 16/8/26.</div><div class="line"> */</div><div class="line">@SpringBootApplication</div><div class="line">public class Application &#123;</div><div class="line">    public static void main(String... arg)&#123;</div><div class="line">        SpringApplication.run(Application.class,arg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨@SpringBootApplicationå¯ä»¥å®Œæˆé¡¹ç›®çš„è‡ªåŠ¨é…ç½®ï¼Œå®ƒä¼šåœ¨å¯åŠ¨çš„æ—¶å€™æ‰¾åˆ°é¡¹ç›®ä¸­ç”±@Controlleræ ‡è¯†çš„åŒºåŸŸï¼Œå¹¶è§£æ@RequestMappingå®Œæˆè‡ªåŠ¨è·¯ç”±æ˜ å°„ã€‚<br>ç°åœ¨æ•´ä¸ªé¡¹ç›®ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://o3sw4xojp.qnssl.com/%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png" alt="é¡¹ç›®ç»“æ„"></p>
<h2 id="runèµ·æ¥"><a href="#runèµ·æ¥" class="headerlink" title="runèµ·æ¥"></a>runèµ·æ¥</h2><p>åœ¨å®Œæˆè¿™äº›ä¹‹åï¼Œéœ€è¦åšä¸€ä¸‹é¡¹ç›®çš„å¯åŠ¨é…ç½®ï¼Œå¦‚å›¾ï¼š<br><img src="https://o3sw4xojp.qnssl.com/%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE.png" alt="å¯åŠ¨é…ç½®"><br>ç„¶åç›´æ¥ç‚¹runå°±å¯ä»¥äº†ã€‚</p>
<p><img src="https://o3sw4xojp.qnssl.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-08-26%20%E4%B8%8A%E5%8D%889.18.22.png" alt="è¿è¡Œæ•ˆæœ"></p>
<p>æ•´ä¸ªè¿‡ç¨‹é™¤äº†pox.xmléœ€è¦è‡ªå·±é…ç½®ä»¥å¤–ï¼Œå¹¶ä¸éœ€è¦å¦å¤–çš„é…ç½®é¡¹ï¼Œå¤§å¤§ç®€åŒ–äº†é¡¹ç›®é…ç½®çš„å¤æ‚ç¨‹åº¦ã€‚æ„Ÿè§‰è¿˜æ˜¯ä¸é”™çš„ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Java </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Redisè®¾è®¡ä¸å®ç°ç¬”è®°ï¼ˆå¤åˆ¶ï¼‰]]></title>
      <url>/2016/08/08/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h2 id="å¤åˆ¶"><a href="#å¤åˆ¶" class="headerlink" title="å¤åˆ¶"></a>å¤åˆ¶</h2><p>ä½¿ç”¨å‘½ä»¤slaveof <host> <port> æ¥å®ç°ä¸€ä¸ªredis-serverå¤åˆ¶å¦ä¸€ä¸ªredis-serverï¼Œå…¶ä¸­å‘å‡ºæ­¤å‘½ä»¤çš„serverä¸ºä»æœåŠ¡å™¨å¦ä¸€ä¸ªæˆä¸ºä¸»æœåŠ¡å™¨ã€‚<br>å¦å¤–ï¼Œå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶redis.confæ¥å®ç°ä¸Šè¿°å‘½ä»¤çš„åŠŸèƒ½ï¼š</port></host></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"># slaveof &lt;masterip&gt; &lt;masterport&gt;</div></pre></td></tr></table></figure>
<h2 id=""><a href="#" class="headerlink" title=""></a><a id="more"></a></h2><h2 id="å®ç°æ­¥éª¤"><a href="#å®ç°æ­¥éª¤" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h2><p>åœ¨redisä¸­ï¼Œå¤åˆ¶çš„å®ç°ä¸»è¦é€šè¿‡ä¸¤ä¸ªæ­¥éª¤ï¼šåŒæ­¥å’Œå‘½ä»¤ä¼ æ’­ã€‚</p>
<ol>
<li><p>åŒæ­¥(sync)</p>
<p> åŒæ­¥çš„è¿‡ç¨‹ç»†åˆ†ä¸ºä¸€ä¸‹å‡ ä¸ªè¿‡ç¨‹ï¼š</p>
<ul>
<li>ä»æœåŠ¡å™¨(slave)å‘ä¸»æœåŠ¡å™¨(master)å‘é€SYNCå‘½ä»¤ï¼›</li>
<li>masteræ¥æ”¶åˆ°SYNCå‘½ä»¤ä¹‹åï¼Œæ‰§è¡ŒBGSAVEï¼Œåå°ç”ŸæˆRDBæ–‡ä»¶ï¼›</li>
<li>BGSAVEå®Œæˆåï¼Œmasterå°†RDBæ–‡ä»¶å‘é€ç»™slaveï¼Œslaveæ¥æ”¶åˆ°RDBæ–‡ä»¶ä¹‹åï¼Œå°†è‡ªèº«çŠ¶æ€åŒæ­¥è‡³masteræ‰§è¡ŒBGSAVEæ—¶å€™çš„çŠ¶æ€ï¼›</li>
<li>masterå°†çºªå½•åœ¨ç¼“å­˜åŒºä¸­çš„å‘½ä»¤å‘é€ç»™slaveï¼Œslaveæ‰§è¡Œé‚£äº›å‘½ä»¤ï¼Œå®Œæˆä¸»ä»çŠ¶æ€åŒæ­¥ã€‚</li>
</ul>
</li>
<li><p>å‘½ä»¤ä¼ æ’­(command propagate)</p>
<p> åœ¨åŒæ­¥æ“ä½œå®Œæˆä¹‹åï¼Œä¸»ä»è¾¾åˆ°ä¸€è‡´ï¼Œåç»­é˜¶æ®µä¸»ä»ä¹‹é—´çš„ä¸€è‡´çŠ¶æ€é€šè¿‡å‘½ä»¤ä¼ æ’­æ¥å®Œæˆã€‚</p>
</li>
</ol>
<hr>
<h2 id="å®Œå…¨åŒæ­¥å’Œéƒ¨åˆ†åŒæ­¥"><a href="#å®Œå…¨åŒæ­¥å’Œéƒ¨åˆ†åŒæ­¥" class="headerlink" title="å®Œå…¨åŒæ­¥å’Œéƒ¨åˆ†åŒæ­¥"></a>å®Œå…¨åŒæ­¥å’Œéƒ¨åˆ†åŒæ­¥</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œmasteråœ¨æ‰§è¡ŒBGSAVEå‘½ä»¤ä¹‹åï¼Œä¼šæ¶ˆè€—å¤§é‡çš„æœåŠ¡å™¨èµ„æºç”¨ä»¥ç”ŸæˆRDBæ–‡ä»¶ï¼Œå¦‚æœæœåŠ¡å™¨ä¸­å·²ç»æœ‰è¾ƒå¤šçš„é”®å€¼ï¼Œä¸ä»…å®ŒæˆBGSAVEå‘½ä»¤è€—æ—¶é•¿ï¼Œç”Ÿæˆçš„RDBæ–‡ä»¶ä¹Ÿä¼šç›¸å¯¹è¾ƒå¤§ï¼Œé€šè¿‡ç½‘ç»œå°†RDBæ–‡ä»¶å‘é€ç»™slaveä¹Ÿä¼šå ç”¨å¤§é‡çš„ç½‘ç»œèµ„æºã€‚</p>
<p>å¦‚æœè¯´ä¸€ä¸ªslaveä¹‹å‰æ²¡æœ‰è¿›è¡Œè¿‡å¤åˆ¶æ“ä½œï¼Œå®ƒå®Œå…¨çš„åŒæ­¥masteræ•°æ®è¿˜æƒ…æœ‰å¯åŸï¼Œä½†å¦‚æœä¸€ä¸ªslaveåœ¨å¤åˆ¶è¿‡ç¨‹ä¸­ç”±äºå„ç§åŸå› ä¸­æ–­äº†å’Œmasterçš„è¿æ¥ï¼Œæ˜æ˜å·²ç»å¤åˆ¶äº†å¾ˆå¤šå†…å®¹åœ¨å®Œæˆé‡è¿ä¹‹åè¿˜è¦ä»å¤´å¼€å§‹ï¼Œäºæƒ…äºç†éƒ½è¯´ä¸è¿‡å»ã€‚</p>
<p>äºæ˜¯ï¼Œåœ¨Redis2.8ç‰ˆæœ¬ä¹‹åï¼ŒåŒæ­¥æ“ä½œç”±PSYNCæ›¿ä»£ä¹‹å‰çš„SYNCï¼ŒåŒæ­¥æ“ä½œç»†åˆ†ä¸ºå®Œå…¨åŒæ­¥(full resynchronization)å’Œéƒ¨åˆ†åŒæ­¥(partial resynchronization)ã€‚éƒ¨åˆ†åŒæ­¥çš„å‡ºç°å°±æ˜¯ä¸ºäº†é¿å…é‡å¤åŒæ­¥å¤§é‡slaveå·²ç»åŒæ­¥è¿‡äº†çš„æ•°æ®ã€‚ä¸ºäº†å®ç°éƒ¨åˆ†åŒæ­¥ï¼ŒRedisè®¾è®¡äº†ä¸‰ä¸ªå˜é‡æ¥è¿›è¡Œæ§åˆ¶ï¼š</p>
<ol>
<li>å¤åˆ¶åç§»é‡(replication offset)</li>
</ol>
<pre><code>å¤åˆ¶åç§»é‡æ˜¯masterå’Œslaveéƒ½ä¼šç»´æŠ¤çš„ä¸€ä¸ªé‡ï¼Œå½“masterå‘slaveä¼ æ’­nä¸ªå­—èŠ‚æ•°æ®æ—¶ï¼Œmasterçš„å¤åˆ¶åç§»é‡ä¼šå¢åŠ nï¼Œç›¸åº”çš„ï¼Œslaveåœ¨æ¥åˆ°æ¥è‡ªmasterçš„nä¸ªå­—èŠ‚ä¹‹åï¼Œslaveçš„å¤åˆ¶åç§»é‡ä¹Ÿä¼šå¢åŠ nï¼Œé€šè¿‡å¯¹æ¯”masterå’Œslaveçš„å¤åˆ¶åç§»é‡å¯ä»¥å¾ˆå®¹æ˜“å¾—çŸ¥ä¸»ä»æ˜¯å¦è¾¾åˆ°ä¸€è‡´çŠ¶æ€ï¼›
</code></pre><ol>
<li><p>å¤åˆ¶ç§¯å‹ç¼“å†²åŒº(replication backlog)</p>
<p> å¤åˆ¶ç§¯å‹ç¼“å†²åŒºæ˜¯masterç»´æŠ¤çš„ä¸€ä¸ªå®šé•¿çš„å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼Œé»˜è®¤å¤§å°ä¸º1mbï¼Œå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶ä¸­repl-backlog-sizeæ¥ä¿®æ”¹ã€‚</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># Set the replication backlog size. The backlog is a buffer that accumulates</div><div class="line"># slave data when slaves are disconnected for some time, so that when a slave</div><div class="line"># wants to reconnect again, often a full resync is not needed, but a partial</div><div class="line"># resync is enough, just passing the portion of data the slave missed while</div><div class="line"># disconnected.</div><div class="line">#</div><div class="line"># The bigger the replication backlog, the longer the time the slave can be</div><div class="line"># disconnected and later be able to perform a partial resynchronization.</div><div class="line">#</div><div class="line"># The backlog is only allocated once there is at least a slave connected.</div><div class="line">#</div><div class="line"># repl-backlog-size 1mb</div></pre></td></tr></table></figure>
<p> å¤åˆ¶ç§¯å‹ç¼“å†²åŒºçš„è¿è¡Œæœºç†æ˜¯è¿™æ ·çš„ï¼š</p>
<p> masteråœ¨å°†å‘½ä»¤ä¼ æ’­ç»™slaveçš„æ—¶å€™ï¼Œä¹Ÿä¼šå°†è¿™äº›å‘½ä»¤å†™å…¥åˆ°å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­ï¼Œå¹¶è®°å½•æ¯ä¸ªå­—èŠ‚åœ¨å¤åˆ¶åç§»é‡ï¼Œåœ¨æ–­çº¿é‡è¿çš„slaveå‘masterå‘å‡ºPSYNCè¿›è¡ŒåŒæ­¥çš„æ—¶å€™ï¼Œslaveä¼šå°†è‡ªèº«çš„å¤åˆ¶åç§»é‡offsetä¸€å¹¶å‘å‡ºï¼Œmasteråˆ™å°†slaveçš„offsetåœ¨å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­æŸ¥æ‰¾ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨çš„è¯åˆ™æ‰§è¡Œéƒ¨åˆ†åŒæ­¥ï¼Œå¦åˆ™æ‰§è¡Œå®Œå…¨åŒæ­¥ã€‚</p>
</li>
<li><p>æœåŠ¡å™¨è¿è¡ŒID(run ID)</p>
<p> æ¯ä¸ªRedisæœåŠ¡å™¨ï¼Œæ— è®ºæ˜¯masterè¿˜æ˜¯slaveå®ƒä»¬åœ¨å¯åŠ¨çš„æ—¶å€™éƒ½ä¼šæœ‰ä¸€ä¸ªç”±40ä¸ªéšæœºåå…­è¿›åˆ¶å­—ç¬¦ç»„æˆçš„è¿è¡ŒIDã€‚åœ¨è¿›è¡Œåˆæ¬¡å¤åˆ¶çš„æ—¶å€™ï¼Œmasterä¼šå°†è‡ªèº«çš„run IDå‘é€ç»™slaveï¼Œslaveä¿å­˜æ­¤å€¼ï¼Œåœ¨æ–­çº¿é‡è¿çš„æ—¶å€™ï¼Œé€šè¿‡å¯¹æ¯”å½“å‰masterçš„run IDæ˜¯å¦å’Œä¹‹å‰çš„ç›¸åŒæ¥é€‰æ‹©å°è¯•éƒ¨åˆ†åŒæ­¥è¿˜æ˜¯å®Œå…¨åŒæ­¥ã€‚</p>
</li>
</ol>
<hr>
<h2 id="å®ç°ç»†èŠ‚"><a href="#å®ç°ç»†èŠ‚" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h2><p>ä»¥hoståŒä¸º127.0.0.1ç«¯å£å·åˆ†åˆ«ä¸º6379ã€6380çš„ä¸¤ä¸ªRediså®ä¾‹çš„å¤åˆ¶è¿‡ç¨‹ä¸ºä¾‹ï¼š<br>å…¶ä¸­6379ä¸ºmasterã€6380ä¸ºslaveã€‚</p>
<ol>
<li><p>ä½¿ç”¨redis-cliè¿æ¥slaveï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./redis-cli -p 6380</div></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>åœ¨slaveçš„å®¢æˆ·ç«¯ä¸Šæ‰§è¡Œå‘½ä»¤ï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SLAVEOF 127.0.0.1 6379</div></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>slaveå°†127.0.0.1å’Œ6379åˆ†åˆ«ä¿å­˜åˆ°æœåŠ¡å™¨çŠ¶æ€masterhostå’Œmasterportå±æ€§é‡Œè¾¹ï¼Œmasterå‘slaveçš„å®¢æˆ·ç«¯è¿”å›OKï¼Œè¡¨ç¤ºå¤åˆ¶å‘½ä»¤å·²ç»æ¥æ”¶ï¼ŒçœŸæ­£çš„å¤åˆ¶æ“ä½œå¼€å§‹</p>
</li>
<li><p>å»ºç«‹å¥—æ¥å­—ï¼š</p>
<p> åœ¨SLAVEOF å‘½ä»¤æ‰§è¡Œä¹‹åslaveæ ¹æ®masterhostå’Œmasterportåˆ›å»ºè¿å‘masterçš„å¥—æ¥å­—ï¼Œå®Œæˆå¥—æ¥å­—åˆ›å»ºä¹‹åï¼Œslaveä¸ºè¿™ä¸ªå¥—æ¥å­—å…³è”ä¸€ä¸ªä¸“é—¨ç”¨äºå¤åˆ¶å·¥ä½œçš„æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ï¼Œè´Ÿè´£åç»­çš„å¤åˆ¶å·¥ä½œ(åŒ…æ‹¬æ¥æ”¶RDBæ–‡ä»¶ã€åç»­masterä¼ æ¥çš„å†™å‘½ä»¤ç­‰)ï¼›</p>
<p> åœ¨masterä¸€ç«¯ï¼Œæ¥æ”¶åˆ°slaveçš„å¥—æ¥å­—è¿æ¥ä¹‹åï¼Œmasterè®²å…¶çœ‹ä½œæ˜¯ä¸€ä¸ªè¿æ¥åˆ°ä¸»æœåŠ¡å™¨çš„å®¢æˆ·ç«¯çœ‹å¾…ã€‚</p>
</li>
<li><p>slaveæˆä¸ºmasterä¹‹åï¼Œé¦–å…ˆå‘masterå‘é€PINGå‘½ä»¤ï¼Œç”¨ä»¥æ£€æµ‹slaveå’Œmasterä¹‹é—´çš„å¥—æ¥å­—è¯»å†™çŠ¶æ€æ˜¯å¦æ­£å¸¸ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç›‘æµ‹masterèƒ½å¦æ­£å¸¸å“åº”å‘½ä»¤ã€‚å¦‚æœmasteræ­£å¸¸è¿”å›PONGä½œä¸ºå“åº”ï¼Œåˆ™å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œï¼Œå¦åˆ™slaveå°†ä¼šæ–­å¼€ä¸masterçš„è¿æ¥å¹¶é‡æ–°è¿æ¥ã€‚</p>
</li>
<li><p>èº«ä»½è®¤è¯ï¼šåœ¨slaveæ¥æ”¶åˆ°masterçš„PONGè¿”å›ä¹‹åï¼Œä¸‹ä¸€æ­¥è¦å°½å¿ƒçš„åˆ™æ˜¯å®Œæˆèº«ä»½è®¤è¯ã€‚</p>
<ul>
<li>å¦‚æœmasteræ²¡æœ‰è®¾ç½®requirepassé€‰é¡¹ï¼Œå¹¶ä¸”slaveä¹Ÿæ²¡æœ‰è®¾ç½®masterauthé€‰é¡¹ï¼Œé‚£ä¹ˆmasterè®²ç»§ç»­æ‰§è¡Œslaveå‘é€çš„å‘½ä»¤ï¼Œå¤åˆ¶å·¥ä½œå¯ä»¥æ­£å¸¸è¿›è¡Œ</li>
<li>å¦‚æœä»æœåŠ¡å™¨è®¾ç½®çš„masterauthä¸masterçš„requirepassä¸€è‡´ï¼Œå¤åˆ¶å·¥ä½œå¯ä»¥æ­£å¸¸è¿›è¡Œï¼Œå¦åˆ™ï¼Œmasterä¼šè¿”å›invalid passwordé”™è¯¯</li>
<li>å¦‚æœmasterè®¾ç½®äº†requirepassï¼Œè€Œslaveæœªè®¾ç½®masterauthï¼Œmasterä¼šè¿”å›ä¸€ä¸ªNOAUTHé”™è¯¯ï¼Œåä¹‹ï¼Œmasteræœªè®¾ç½®requirepassè€Œslaveè®¾ç½®äº†masterauthï¼Œmasterä¼šè¿”å›no password is set é”™è¯¯</li>
</ul>
</li>
<li><p>å‘é€ç«¯å£ä¿¡æ¯ï¼šèº«ä»½è®¤è¯é€šè¿‡ä¹‹åï¼Œslaveå°†æ‰§è¡ŒREPLCONF listening-port <port>ï¼Œå‘masterå‘é€ä»æœåŠ¡å™¨çš„ç›‘å¬ç«¯å£å·ï¼Œmasteræ¥åˆ°æ­¤å‘½ä»¤ä¹‹åï¼Œè®¾ç½®slave-listening-portå±æ€§ï¼Œslave-listening-port å¯ä»¥é€šè¿‡åœ¨masterçš„å®¢æˆ·ç«¯ä¸Šæ‰§è¡ŒINFO REPLICATION å‘½ä»¤çœ‹åˆ°ã€‚</port></p>
</li>
<li><p>åŒæ­¥ï¼šslaveå‘masterå‘é€PSYNCå‘½ä»¤ï¼Œè¿›è¡ŒåŒæ­¥æ“ä½œï¼Œå°†è‡ªå·±çš„çŠ¶æ€æ›´æ–°è‡³masterçš„çŠ¶æ€</p>
</li>
<li><p>å‘½ä»¤ä¼ æ’­ï¼šå®ŒæˆåŒæ­¥ä¹‹åï¼Œè¿›å…¥å‘½ä»¤ä¼ æ’­çš„é˜¶æ®µï¼Œè¿™æ—¶å€™masteråœ¨æ‰§è¡Œå†™æ“ä½œä»¥åï¼Œéƒ½ä¼šå°†å…¶ä¼ ç»™slaveï¼Œslaveæ¥æ”¶ä¹‹åæ‰§è¡Œå‘½ä»¤è¾¾åˆ°å’Œmasterä¸€è‡´çš„çŠ¶æ€</p>
</li>
<li><p>å¿ƒè·³æ£€æµ‹ï¼šåœ¨å‘½ä»¤ä¼ æ’­çš„è¿‡ç¨‹ä¸­ï¼Œslaveé»˜è®¤ä¼šæ¯ç§’å‘masterå‘é€å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">REPLCONF ACK &lt;replication offset&gt;</div></pre></td></tr></table></figure>
<p>å‘é€æ­¤å‘½ä»¤æœ‰ä¸‰ä¸ªä½œç”¨ï¼š</p>
<ul>
<li>æ£€æµ‹ä¸»ä»æœåŠ¡å™¨çš„ç½‘ç»œè¿æ¥çŠ¶æ€</li>
<li>è¾…åŠ©å®ç°min-slaveé€‰é¡¹</li>
<li>æ£€æµ‹å‘½ä»¤ä¸¢å¤±</li>
</ul>
</li>
</ol>
]]></content>
      
        <categories>
            
            <category> redis </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[æœ€ç®€ä¾¿çš„çˆ¬è™«æ•ˆç‡æå‡æ–¹æ³•]]></title>
      <url>/2016/08/02/multiprocessing.dummy/</url>
      <content type="html"><![CDATA[<p>æ˜¨æ™šå‘ç°æ”¾åœ¨è…¾è®¯äº‘ä¸»æœºä¸Šé€šè¿‡crontabå®šæ—¶æ‰§è¡Œç”¨ä»¥çˆ¬å»æ–—é±¼åˆ†ç±»é¡µé¢æ•°æ®çš„çˆ¬è™«åœ¨æ‰§è¡Œçš„æ—¶å€™é€Ÿåº¦ç‰¹åˆ«æ…¢ï¼Œäºæ˜¯æƒ³é€šè¿‡å¤šçº¿ç¨‹æ¥æé«˜æ•ˆç‡ã€‚<br>æ‰“å¼€æµè§ˆå™¨ï¼Œé”®å…¥å…³é”®å­—â€œpython å¤šçº¿ç¨‹â€ï¼Œå‘ç°å¤§å¤šæ•°å†…å®¹éƒ½æ˜¯ä½¿ç”¨threadingã€Queueè¿™äº›çœ‹èµ·æ¥å¾ˆç¬¨é‡çš„å®ä¾‹ã€‚ä¸è¿‡ç›´åˆ°multiprocessing.dummyå‡ºç°åœ¨çœ¼å‰ä¹‹åï¼Œä¸€åˆ‡éƒ½å˜å¾—è¾£ä¹ˆç®€å•ã€‚</p>
<a id="more"></a>
<h1 id="multiprocessing-dummy-ä¸å¤šçº¿ç¨‹"><a href="#multiprocessing-dummy-ä¸å¤šçº¿ç¨‹" class="headerlink" title="multiprocessing.dummy ä¸å¤šçº¿ç¨‹"></a>multiprocessing.dummy ä¸å¤šçº¿ç¨‹</h1><p>multiprocessing.dummy æ˜¯multiprocessingçš„ä¸€ä¸ªå­åº“ï¼ŒäºŒè€…çš„ä¸åŒä¹‹å¤„å°±æ˜¯å‰è€…åº”ç”¨äºçº¿ç¨‹åè€…ä¸»è¦åº”ç”¨äºè¿›ç¨‹ï¼Œè€Œå®ƒä»¬å®ç°å¹¶è¡ŒåŒ–æ“ä½œçš„å…³é”®åˆ™æ˜¯map()å‡½æ•°ã€‚<br>ä»¥æˆ‘çš„ä¸¤æ®µä»£ç ä¸ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">def insert_info():</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    é€šè¿‡éå†æ¸¸æˆåˆ†ç±»é¡µé¢è·å–æ‰€æœ‰ç›´æ’­é—´</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    session = requests.session()</div><div class="line">    pagecontent = session.get(Directory_url).text</div><div class="line">    pagesoup = BeautifulSoup(pagecontent)</div><div class="line">    games = pagesoup.select(&apos;a&apos;)</div><div class="line">    col.drop()</div><div class="line">    for game in games:</div><div class="line">        links = game[&quot;href&quot;]</div><div class="line">        Qurystr = &quot;/?page=1&amp;isAjax=1&quot;</div><div class="line">        gameurl = HOST + links + Qurystr</div><div class="line">        gamedata = session.get(gameurl).text</div><div class="line">        flag = get_roominfo(gamedata)</div><div class="line">    aggregateData()</div></pre></td></tr></table></figure>
<p>ä¸Šè¾¹è¿™æ®µæ˜¯ä¹‹å‰è¿è¡Œåœ¨äº‘ä¸»æœºé€Ÿåº¦çœŸçš„è·Ÿçˆ¬ä¼¼çš„ä»£ç ï¼Œé€šè¿‡Directory_urlè¿™ä¸ªåœ°å€ï¼Œè·å–åˆ°é¡µé¢ä¸­æ‰€æœ‰çš„<a></a>æ ‡ç­¾ï¼Œå¹¶è·å–åˆ°å®ƒä»¬çš„â€™hrefâ€™ï¼Œå†é€æ¡è·å–æ¯ä¸ªé“¾æ¥ä¸­çš„å†…å®¹ï¼Œè·å–æƒ³è¦çš„ä¸œè¥¿ï¼Œæœ€ç»ˆå®Œæˆå…¥åº“å·¥ä½œã€‚æ‰€æœ‰çš„ä¸€åˆ‡éƒ½çœ‹ä¼¼æŒ‰éƒ¨å°±ç­å“ˆã€‚åœ¨æˆ‘çš„ç¬”è®°æœ¬ä¸Šåšæµ‹è¯•ï¼Œå®Œæˆæ‰€æœ‰2032æ¡æ•°æ®çš„çˆ¬å–å…±è€—æ—¶<strong>140.5s</strong>(å¥½ç‰¹ä¹ˆæ…¢ï¼ã€‚ï¼)ã€‚</p>
<p>ä½†æ˜¯åœ¨åŠ å…¥multiprocessing.dummyä¹‹åï¼ŒçœŸçš„æ˜¯æœ‰é£ä¸€èˆ¬çš„æ„Ÿè§‰ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">from multiprocessing.dummy import Pool</div><div class="line"></div><div class="line">pool = Pool()</div><div class="line"></div><div class="line">def insert_info():</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    é€šè¿‡éå†æ¸¸æˆåˆ†ç±»é¡µé¢è·å–æ‰€æœ‰ç›´æ’­é—´</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    session = requests.session()</div><div class="line">    pagecontent = session.get(Directory_url).text</div><div class="line">    pagesoup = BeautifulSoup(pagecontent)</div><div class="line">    games = pagesoup.select(&apos;a&apos;)</div><div class="line">    gameurl = [HOST + url[&quot;href&quot;] + &quot;/?page=1&amp;isAjax=1&quot; for url in games]</div><div class="line">    col.drop()</div><div class="line">    g = lambda link: session.get(link).text</div><div class="line">    gamedata = pool.map(g, gameurl)</div><div class="line">    ginfo = lambda data: get_roominfo(data)</div><div class="line">    pool.map(ginfo, gamedata)</div><div class="line">    aggregateData()</div></pre></td></tr></table></figure>
<p>åŒæ ·é€šè¿‡Directory_urlè¿™ä¸€åœ°å€è·å–é¡µé¢ä¸­æ‰€æœ‰æ ‡ç­¾<a></a>ï¼Œç„¶åé€šè¿‡pool.map(g, gameurl)å®Œæˆâ€™hrefâ€™å€¼çš„è·å–ï¼Œæœ€åå†ç”¨ä¸€æ¬¡pool.map(ginfo,gamedata)å®Œæˆæ‰€æœ‰é¡µé¢å†…å®¹çš„æå–å’Œå…¥åº“ã€‚å†ä¸€æ¬¡æµ‹è¯•ï¼Œåªéœ€è¦<strong>33.1s</strong>å³å¯å®Œæˆã€‚</p>
<p>æ›´å¤šè¯¦ç»†ä¿¡æ¯å¯ä»¥å‚è€ƒ<a href="https://docs.python.org/2/library/multiprocessing.html" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Hack On Douyu -- 4]]></title>
      <url>/2016/07/31/HackOnDouyu--4/</url>
      <content type="html"><![CDATA[<p>åŸæœ¬æ‰“ç®—ä½¿ç”¨<a href="http://selenium-python.readthedocs.io/" target="_blank" rel="external">selenium</a>ç»™è¿™ä¸ªå°é¡¹ç›®åšè‡ªåŠ¨åŒ–æµ‹è¯•çš„ï¼Œæ²¡æˆæƒ³seleniumåŠŸèƒ½å¦‚æ­¤å¼ºå¤§ï¼Œé‚£å°±é¡ºåŠ¿åšä¸ªè‡ªåŠ¨æŠ¢é±¼ä¸¸çš„å°å·¥å…·å§ã€‚ğŸ˜Š<br><a id="more"></a></p>
<h1 id="Seleniumæ˜¯ä»€ä¹ˆ"><a href="#Seleniumæ˜¯ä»€ä¹ˆ" class="headerlink" title="Seleniumæ˜¯ä»€ä¹ˆ"></a>Seleniumæ˜¯ä»€ä¹ˆ</h1><p>Seleniumæ˜¯ä¸€æ¬¾ç”±ThoughtWorkså…¬å¸å¼€å‘çš„webè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œå®ƒå¯ä»¥è®©æµ‹è¯•äººå‘˜ç¼–å†™çš„æµ‹è¯•ä»£ç ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œæµ‹è¯•ï¼Œå¹¶ä¸”å®ƒæä¾›äº†å½“å‰ç»å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨çš„é©±åŠ¨ã€‚åŒæ—¶Seleniumä¹Ÿæ‹¥æœ‰å¾ˆå¤šå¼€å‘è¯­è¨€ç‰ˆæœ¬çš„é©±åŠ¨ã€‚æˆ‘ä½¿ç”¨çš„å°±æ˜¯pythonç‰ˆæœ¬çš„é©±åŠ¨ã€‚å…·ä½“å®‰è£…æ­¥éª¤å¯ä»¥å‚è€ƒ<a href="http://selenium-python.readthedocs.io/" target="_blank" rel="external">è¿™é‡Œ</a>ã€‚<br>å…·ä½“æ¥è¯´ï¼ŒSeleniumå¯ä»¥æ¨¡æ‹Ÿå¤§å¤šæ•°çš„é¡µé¢æ“ä½œï¼šå¡«å†™è¡¨å•ã€æ‹–æ‹½é¡µé¢ã€é¡µé¢åˆ‡æ¢ã€è¿”å›ä¸Šä¸€é¡µé¢ã€å‰è¿›åˆ°ä¸‹ä¸€é¡µé¢ç­‰ã€‚<br>å‘Šè¯‰äº†Seleniumç½‘å€ä¹‹åï¼Œå®ƒå¯ä»¥è‡ªåŠ¨æ‰“å¼€æŒ‡å®šçš„æµè§ˆå™¨ï¼Œå¹¶ä¸”å¾…é¡µé¢å®Œå…¨åŠ è½½ä¹‹ååˆ†åˆ«é€šè¿‡é¡µé¢å…ƒç´ çš„idã€nameã€XPathã€Link Textã€tagã€classæˆ–è€…æ˜¯cssé€‰æ‹©å™¨å®Œæˆå…ƒç´ çš„é€‰æ‹©ã€‚<br>é€‰å®šäº†é¡µé¢å…ƒç´ ä¹‹åå¯ä»¥æŒ‰ç…§é¢„æœŸå®Œæˆä¸€äº›åˆ—åŠ¨ä½œã€‚</p>
<h1 id="Talk-is-cheap-Show-you-my-code"><a href="#Talk-is-cheap-Show-you-my-code" class="headerlink" title="Talk is cheap, Show you my code"></a>Talk is cheap, Show you my code</h1><p>æ•´ä¸ªé¡¹ç›®çš„ä»£ç åœ¨<a href="https://github.com/wangmengcn/DouyuFan" target="_blank" rel="external">github</a>ä¸Šæ‰˜ç®¡ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‰å»æµè§ˆã€‚æ•´ä¸ªæŠ¢é±¼ä¸¸ç¤¼ç‰©çš„è¿‡ç¨‹å¯ä»¥ç”±è¿™ä¸ªå›¾æ¥è¯´æ˜ï¼š<br><img src="https://o3sw4xojp.qnssl.com/%E6%96%97%E9%B1%BC%E5%BC%B9%E5%B9%95%E7%9B%91%E5%90%AC.png" alt="è‡ªåŠ¨æŠ¢é±¼ä¸¸æµç¨‹"></p>
<p>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä¸æ–—é±¼å¼¹å¹•æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œç›‘å¬å½“å‰æœ€çƒ­é—¨æˆ¿é—´å¼¹å¹•ï¼Œç”±äºç«ç®­ç¤¼ç‰©æ¶ˆæ¯ä¼šé€šè¿‡å¹¿æ’­å‘æ‰€æœ‰ç›´æ’­é—´å‘é€ï¼Œæ‰€ä»¥åªéœ€è¦æ ¹æ®ç«ç®­æ¶ˆæ¯çš„æ ‡è¯†ç¬¦æ¥åˆ¤å®šç«ç®­æ¶ˆæ¯å³å¯ï¼›</li>
<li>ç«ç®­æ¶ˆæ¯æ¥æ”¶ä¹‹åå¯ä»¥å°†å…¶è½¬å­˜åˆ°redisä¸­ï¼Œåˆ©ç”¨pub/subå®Œæˆç«ç®­æ¶ˆæ¯çš„å¹¿æ’­å’Œè®¢é˜…ï¼›</li>
<li>è®¢é˜…redisç«ç®­æ¶ˆæ¯é¢‘é“ï¼Œè·å–å½“å‰å¯ä»¥æŠ¢é±¼ä¸¸çš„æˆ¿é—´å®Œæ•´urlï¼›</li>
<li>åˆ©ç”¨seleniumæ‰“å¼€æµè§ˆå™¨å¹¶è®¿é—®æŒ‡å®šç›´æ’­é—´ï¼Œè‡ªåŠ¨å‘é€å¼¹å¹•æ¶ˆæ¯ï¼Œå¹¶ä¸”ç‚¹å‡»æŠ¢é±¼ä¸¸çš„æŒ‰é’®ï¼Œæœ€ç»ˆå®Œæˆè‡ªåŠ¨æŠ¢é±¼ä¸¸ç¤¼ç‰©çš„æ•´ä¸ªæµç¨‹ã€‚</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># è·å–å…¨é¢‘é“æ’­æ”¾çš„ç«ç®­ä¿¡æ¯</div><div class="line">def get_rocket(data):</div><div class="line">    try:</div><div class="line">        sender_id = re.search(&apos;\/sn@=(.+?)\/&apos;, data).group(1)</div><div class="line">        recver_id = re.search(&apos;\/dn@=(.+?)\/&apos;, data).group(1)</div><div class="line">        recver_room = re.search(&apos;\/drid@=(.+?)\/&apos;, data).group(1)</div><div class="line">        gift = re.search(&apos;\/gn@=(.+?)\/&apos;, data).group(1)</div><div class="line">        rocketmsg = &#123;&#125;</div><div class="line">        rocketmsg[&quot;sender_id&quot;] = sender_id</div><div class="line">        rocketmsg[&quot;recver_id&quot;] = recver_id</div><div class="line">        rocketmsg[&quot;recver_room&quot;] = recver_room</div><div class="line">        rocketmsg[&quot;gift&quot;] = gift</div><div class="line">        rocketmsg[&quot;date&quot;] = datetime.now()</div><div class="line">        col.insert_one(rocketmsg, bypass_document_validation=False)</div><div class="line">        publishvalue = &#123;&#125;</div><div class="line">        publishvalue[&quot;sender_id&quot;] = sender_id</div><div class="line">        publishvalue[&quot;recver_id&quot;] = recver_id</div><div class="line">        publishvalue[&quot;recver_room&quot;] = recver_room</div><div class="line">        publishvalue[&quot;gift&quot;] = gift</div><div class="line">        castRocket(publishvalue)</div><div class="line">        print sender_id, &quot;é€ç»™æˆ¿é—´å·ä¸º:&quot;, recver_room, &quot;çš„&quot;, recver_id, &quot;ä¸€ä¸ª&quot;,\</div><div class="line">            gift, &quot;&lt;&quot;, datetime.now(), &quot;&gt;&quot;</div><div class="line">        # åœ¨æ­¤å¤„å®Œæˆè‡ªåŠ¨æŠ¢é±¼ä¸¸æµç¨‹</div><div class="line">        getGift(str(recver_room))</div><div class="line">    except Exception, e:</div><div class="line">        print &quot;error occur:&quot;, repr(data)</div><div class="line">    finally:</div><div class="line">        pass</div></pre></td></tr></table></figure>
<p>åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œèµ·åˆ°å…³é”®ä½œç”¨çš„seleniumä¸»è¦æ‰®æ¼”å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è§’è‰²ï¼š</p>
<p><img src="https://o3sw4xojp.qnssl.com/selenium%20driver.png" alt=""></p>
<ol>
<li>è·å–æµè§ˆå™¨cookieï¼Œè¿™æ ·å°±å…å»äº†ç ´è§£æ–—é±¼å¸å·è‡ªåŠ¨ç™»å½•çš„éº»çƒ¦ï¼›</li>
<li>è·å–æŒ‡å®šå…ƒç´ ï¼Œæ¯”å¦‚æ‰¾åˆ°å¼¹å¹•å‘é€çª—å£ï¼Œè¾“å…¥å¼¹å¹•ä¿¡æ¯ï¼Œå‘é€å¼¹å¹•ï¼Œç‚¹å‡»æŠ¢é±¼ä¸¸æŒ‰é’®ï¼›</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">from selenium import webdriver</div><div class="line">from selenium.webdriver.common.action_chains import ActionChains</div><div class="line">import time</div><div class="line"></div><div class="line"></div><div class="line">def getGift(roomid):</div><div class="line">	# è¿™é‡Œæ˜¯æŒ‡å®šfirefoxçš„cookieä½ç½®</div><div class="line">    fp = webdriver.FirefoxProfile(</div><div class="line">        r&apos;/Users/eclipse/Library/Application Support/Firefox/Profiles/tmsbsjpg.default&apos;)</div><div class="line">    browser = webdriver.Firefox(fp)</div><div class="line">    browser.implicitly_wait(15)  # seconds</div><div class="line">    browser.get(&quot;http://www.douyu.com/&quot; + roomid)</div><div class="line">    try:</div><div class="line">    	# æ‰¾åˆ°å¼¹å¹•èŠå¤©çª—å£ï¼Œè¾“å…¥èŠå¤©å†…å®¹</div><div class="line">        indexvideo = browser.find_element_by_class_name(&apos;cs-textarea&apos;)</div><div class="line">        print type(indexvideo)</div><div class="line">        indexvideo.send_keys(&apos;2333333333333&apos;)</div><div class="line">        print indexvideo</div><div class="line">        time.sleep(7)</div><div class="line">        sendbut = browser.find_element_by_class_name(&apos;b-btn&apos;)</div><div class="line">        ActionChains(browser).move_to_element(</div><div class="line">            indexvideo).click(sendbut).perform()</div><div class="line">        gift = browser.find_element_by_class_name(&apos;peck-cdn&apos;)</div><div class="line">    except Exception, e:</div><div class="line">        print str(e)</div><div class="line">        browser.quit()</div><div class="line"></div><div class="line">    times = 0</div><div class="line">    while True:</div><div class="line">        try:</div><div class="line">        	# ç‚¹å‡»æŠ¢é±¼ä¸¸æŒ‰é’®ï¼Œåœ¨å®Œæˆä¹‹åï¼ŒæŒ‰é’®æ¶ˆæ¯ï¼Œç»§ç»­ç‚¹å‡»å‡ºç°å¼‚å¸¸ï¼Œè‡ªåŠ¨å…³é—­æµè§ˆå™¨å³å¯</div><div class="line">            ActionChains(browser).move_to_element(gift).click(gift).perform()</div><div class="line">            time.sleep(2)</div><div class="line">            print times</div><div class="line">            times += 1</div><div class="line">        except Exception, e:</div><div class="line">            print &apos;completed by an error&apos;</div><div class="line">            browser.quit()</div></pre></td></tr></table></figure>
<h1 id="è€æ¿ï¼Œæ¥ä»½é±¼ä¸¸"><a href="#è€æ¿ï¼Œæ¥ä»½é±¼ä¸¸" class="headerlink" title="è€æ¿ï¼Œæ¥ä»½é±¼ä¸¸"></a>è€æ¿ï¼Œæ¥ä»½é±¼ä¸¸</h1><p>æŒ‰ç…§ä¸Šè¿°æ–¹æ³•å®Œæˆç¼–ç ä¹‹åï¼Œæˆ‘ç”¨è‡ªå·±çš„å¸å·æµ‹è¯•äº†ä¸€ä¸‹ï¼Œæ•ˆæœæ˜¯è¿™æ ·çš„ï¼š<br><img src="https://o3sw4xojp.qnssl.com/danmu.gif" alt=""></p>
<p>å‘ç°æ–—é±¼å¯èƒ½æ˜¯åšäº†é™åˆ¶ï¼Œæ¯ä¸ªäººå¤§æ¦‚ä¸€å¤©åªèƒ½æŠ¢åˆ°2000ä¸ªå·¦å³çš„é±¼ä¸¸(æ–—é±¼ï¼šæœ¬æ¥ä¸ºä»£ç å†™æµ‹è¯•çš„ï¼Œè°è®©ä½ æ²¡äº‹å¹²æŠ¢æˆ‘ä»¬é±¼ä¸¸çš„ï¼Ÿï¼ï¼Œæˆ‘ï¼šç”Ÿæ— å¯æ‹.jpg)ï¼Œå¨±ä¹è€Œå·²ï¼Œä¸è¿‡è¯´å¥å¿ƒé‡Œè¯ï¼Œseleniumå¯çœŸçš„æ˜¯ä¸ªå¥½ä¸œè¥¿ã€‚</p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Hack On Douyu -- 3]]></title>
      <url>/2016/07/27/HackOnDouyu--3/</url>
      <content type="html"><![CDATA[<p>åœ¨æ‹¥æœ‰äº†æ•°æ®è·å–å’Œå­˜å‚¨çš„èƒ½åŠ›ä¹‹åï¼Œå¦‚ä½•åˆ©ç”¨å¥½è¿™äº›æ•°æ®æˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚<br>æœ¬æ¥ä¹Ÿä¸€ç›´æ‰“ç®—æŠŠä¹‹å‰å­¦ä¹ çš„flaskæ¡†æ¶ç”¨èµ·æ¥ï¼Œç°åœ¨æœ‰äº†è¿™äº›æ•°æ®ï¼Œæˆ‘æ‰“ç®—åˆ©ç”¨è¿™äº›æ•°æ®åšä¸€ä¸ªå¯¹æ–—é±¼ç½‘ç«™çš„å°å‹ç›‘æ§é¡µé¢ã€‚<br><a id="more"></a></p>
<h1 id="åˆæ­¥æ„æƒ³"><a href="#åˆæ­¥æ„æƒ³" class="headerlink" title="åˆæ­¥æ„æƒ³"></a>åˆæ­¥æ„æƒ³</h1><p>é€šè¿‡å¼¹å¹•å¯ä»¥åŸºæœ¬ä¸Šè·å–åˆ°æ‰€æœ‰çš„æ–—é±¼ç«ç®­ç¤¼ç‰©å‘é€å’Œæ¥æ”¶æƒ…å†µä»¥åŠè¿™äº›ç«ç®­å‘é€çš„æ—¶é—´ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨è¿™äº›æ•°æ®å¾—åˆ°æ¯å¤©æ¯ä¸ªå°æ—¶æ–—é±¼å…¨ç«™ç«ç®­çš„å‘é€æƒ…å†µï¼Œåˆ©ç”¨å‘é€è€…çš„idå’Œæ¥æ”¶è€…çš„idå¯ä»¥ç»Ÿè®¡å‡ºæ¯å¤©çš„ç«ç®­æ’åã€‚æ¯å¤©çš„æ•°æ®åœ¨å‡Œæ™¨å®Œæˆç»Ÿè®¡æ±‡æ€»ï¼Œå¯ä»¥æ„æˆå†å²æ•°æ®ã€‚<br>åœ¨è¿™ä¸ªå°é¡¹ç›®ä¸­ï¼Œæˆ‘ä¸»è¦ç”¨åˆ°ä¸¤ç§æ–¹æ³•å®Œæˆå‰åç«¯æ•°æ®äº¤äº’ï¼šä¸€ç§æ˜¯ç›´æ¥æ ¹æ®è¯·æ±‚urlçŸ¥é“å‰ç«¯éœ€è¦çš„æ•°æ®å…·ä½“æ˜¯ä»€ä¹ˆï¼Œæˆ‘å°±ç›´æ¥åœ¨åç«¯å®Œæˆæ•°æ®çš„è·å–å’Œå¤„ç†ï¼Œé€šè¿‡flaskæ¨¡æ¿å®Œæˆè¦è¿”å›çš„é¡µé¢ï¼›å¦ä¸€ç§æ–¹æ³•åˆ™æ˜¯å®æ—¶æ€§æ¯”è¾ƒå¼ºçš„æˆ–è€…æ˜¯éœ€è¦å’Œå‰ç«¯jsæœ‰äº¤é›†çš„æˆ‘æ‰ç”¨socket.ioå®Œæˆæ•°æ®äº¤äº’ã€‚</p>
<p>é€šè¿‡æŠ“å–æ–—é±¼ç›´æ’­é—´åˆ†ç±»çš„é™æ€é¡µé¢å¯ä»¥æŒ‰ç…§äººæ°”å€¼è¿›è¡Œæ’åï¼Œè·å–åˆ°å½“å‰çš„çƒ­é—¨æˆ¿é—´ï¼Œåˆ©ç”¨è¿™äº›æˆ¿é—´idå¯ä»¥è·å–åˆ°è¯¥ç›´æ’­é—´çš„ç›´æ’­è§†é¢‘æ•°æ®ï¼Œåœ¨flashæ’ä»¶ä¸Šå°±å¯ä»¥ç›´æ¥è½¬æ’­(æœ¬æ¥ä¸€ç›´å¾ˆçº ç»“è§†é¢‘æµå¦‚ä½•è·å–ï¼Œåœ¨å‚è€ƒäº†dotamaxçš„è½¬æ’­æ–¹æ³•ä¹‹åå°±é†’æ‚Ÿäº†)ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨è·å–å®æ—¶èŠå¤©å¼¹å¹•çš„æ—¶å€™å¯ä»¥è·å–åˆ°ç«ç®­å‘é€ä¿¡æ¯ï¼Œå°†è¿™äº›ä¿¡æ¯é€šè¿‡redisè½¬å‘ï¼Œå†ç”±socket.ioæä¾›ç»™å‰ç«¯é¡µé¢ï¼Œå®æ—¶æ¨é€ç«ç®­ç¤¼ç‰©æ¶ˆæ¯ã€‚</p>
<h1 id="ç«ç®­å‘é€æ•°æ®äº¤äº’"><a href="#ç«ç®­å‘é€æ•°æ®äº¤äº’" class="headerlink" title="ç«ç®­å‘é€æ•°æ®äº¤äº’"></a>ç«ç®­å‘é€æ•°æ®äº¤äº’</h1><p>ä¸Šè¾¹è¯´åˆ°ï¼Œç«ç®­å‘é€ä¿¡æ¯é€šè¿‡å¼¹å¹•è·å–ï¼Œåœ¨æ•°æ®åº“ä¸­å­˜å‚¨åŒ…æ‹¬å‘é€è€…idã€æ¥æ”¶è€…idå’Œå‘é€æ—¶é—´ï¼Œè¿™äº›æ•°æ®åŒæ ·å¯ä»¥é€šè¿‡rediså®Œæˆpub/subã€‚<br>å› æ­¤ä¸ºäº†å¾—åˆ°æ¯æ—¥ç«ç®­é€å°æ—¶å‘é€æƒ…å†µï¼Œåœ¨åç«¯å®Œæˆäº†æ•°æ®çš„é¢„å¤„ç†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">def sortbyDay(date):</div><div class="line">    if isinstance(date, datetime):</div><div class="line">        year = date.year</div><div class="line">        m = date.month</div><div class="line">        d = date.day</div><div class="line">        singledate = datetime(year, m, d)</div><div class="line">        print singledate</div><div class="line">        singledata = []</div><div class="line">        count = 0</div><div class="line">        hour = range(0, 24)</div><div class="line">        for h in hour:</div><div class="line">            data = []</div><div class="line">            value = &#123;&#125;</div><div class="line">            start = datetime(year, m, d, h, 0, 0)</div><div class="line">            end = datetime(year, m, d, h, 59, 59)</div><div class="line">            daydata = col.find(</div><div class="line">                &#123;&apos;date&apos;: &#123;&apos;$gt&apos;: start, &apos;$lt&apos;: end&#125;&#125;, &#123;&apos;_id&apos;: 0&#125;)</div><div class="line">            if daydata is not None:</div><div class="line">                for item in daydata:</div><div class="line">                    data.append(item)</div><div class="line">                    count = count + 1</div><div class="line">            else:</div><div class="line">                data = None</div><div class="line">            value[&apos;hour&apos;] = h</div><div class="line">            value[&apos;rockets&apos;] = data</div><div class="line">            singledata.append(value)</div><div class="line">        if count != 0:</div><div class="line">            insertdata = &#123;</div><div class="line">                &apos;date&apos;: singledate,</div><div class="line">                &apos;data&apos;: singledata,</div><div class="line">                &apos;count&apos;: count</div><div class="line">            &#125;</div><div class="line">            return insertdata</div><div class="line">        else:</div><div class="line">            return None</div></pre></td></tr></table></figure>
<p>é€šè¿‡è¾“å…¥æŒ‡å®šçš„æ—¥æœŸdateï¼Œåœ¨æ•°æ®åº“ä¸­æ£€ç´¢è¯¥å¤©å†…rocketè¡¨ä¸­æ‰€æœ‰æ•°æ®ï¼Œè¿”å›å½“å¤©ç«ç®­ç¤¼ç‰©æ€»é‡ã€ä»¥åŠæ¯ä¸ªå°æ—¶ç«ç®­çš„å‘é€é‡ã€‚<br>åœ¨è·å–åˆ°æ¯å¤©æ‰€æœ‰ç«ç®­æ•°æ®ä¹‹åï¼Œç»Ÿè®¡æ¯å¤©å‘é€è€…å’Œæ¥æ”¶è€…æ’åï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">def valuebyHour(date):</div><div class="line">    daydata = sortbyDay(date)</div><div class="line">    count = 0</div><div class="line">    hourvalue = []</div><div class="line">    sendervalue = &#123;&#125;</div><div class="line">    recvervalue = &#123;&#125;</div><div class="line">    if daydata is not None:</div><div class="line">        count = daydata[&apos;count&apos;]</div><div class="line">        hourdata = daydata[&apos;data&apos;]</div><div class="line">        for h in hourdata:</div><div class="line">            hourvalue.append(len(h[&apos;rockets&apos;]))</div><div class="line">            sender = &apos;sender_id&apos;</div><div class="line">            recver = &apos;recver_id&apos;</div><div class="line">            rocket = h[&apos;rockets&apos;]</div><div class="line">            if len(rocket) != 0:</div><div class="line">                sendervalue = sortNames(rocket, sender, sendervalue)</div><div class="line">                recvervalue = sortNames(rocket, recver, recvervalue)</div><div class="line">        return (count, hourvalue, sendervalue, recvervalue)</div><div class="line">    else:</div><div class="line">        return None</div></pre></td></tr></table></figure>
<p>æœ€ç»ˆè¿”å›å½“å¤©ç«ç®­å‘é€æ€»é‡ï¼Œç«ç®­é€å°æ—¶å‘é€æƒ…å†µï¼Œå‘é€è€…å¯¹åº”çš„å‘é€é‡å’Œæ¥æ”¶è€…å¯¹åº”çš„æ¥æ”¶é‡ã€‚</p>
<p>å®Œæˆæ•°æ®é¢„å¤„ç†ä¹‹åï¼Œå°±å¯ä»¥æ ¹æ®å‰ç«¯çš„è¯·æ±‚è¿”å›å¯¹åº”çš„æ•°æ®äº†ã€‚ç”±äºå‰ç«¯è·å–æ•°æ®ä¹‹åå‰ç«¯jsæ ¹æ®æ•°æ®å®Œæˆä¸åŒå›¾è¡¨çš„ç»˜åˆ¶ï¼Œæˆ‘æ˜¯é‡‡ç”¨socket.ioçš„æ–¹å¼å®Œæˆæ•°æ®äº¤äº’ã€‚<br>åœ¨åç«¯ï¼Œæˆ‘æ˜¯ç›´æ¥ä½¿ç”¨flaskçš„ä¸€ä¸ªæ‰©å±•flask_socketioå®Œæˆsocket.ioæœåŠ¡å™¨çš„æ­å»º(å½“ç„¶ï¼Œsocket.ioæ‹¥æœ‰ä¸åŒå¼€å‘è¯­è¨€ç‰ˆæœ¬çš„å®ç°ï¼Œå¯æ ¹æ®å…·ä½“æƒ…å†µæœ‰ä¸åŒé€‰æ‹©)ã€‚åœ¨flaskä¸­å»ºç«‹ä¸€ä¸ªsocket.ioæœåŠ¡å™¨æ˜¯å¾ˆç®€ä¾¿çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from flask_socketio import SocketIO</div><div class="line">from flask_socketio import send, emit</div><div class="line"># flask ä¸»ç¨‹åº</div><div class="line">app = Flask(__name__)</div><div class="line">app.config[&apos;SECRET_KEY&apos;] = &apos;secret&apos;</div><div class="line">socketio = SocketIO(app)</div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    socketio.run(app, host=&apos;0.0.0.0&apos;, port=3000)</div></pre></td></tr></table></figure>
<p>å»ºç«‹socketæœåŠ¡å™¨ä¹‹åï¼Œåªéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µå»ºç«‹ä¸åŒçš„ç›‘å¬äº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"># historyDateäº‹ä»¶ï¼Œæ¥æ”¶æ¥è‡ªå‰ç«¯çš„æ—¥æœŸdateï¼Œå°†å…¶è§£æä¹‹åè°ƒç”¨ä¸Šè¿°æ•°æ®è·å–æ–¹æ³•</div><div class="line">@socketio.on(&apos;historyDate&apos;)</div><div class="line">def sendDate(date):</div><div class="line">    if date:</div><div class="line">        print date</div><div class="line">        time = date.split(&apos;-&apos;)</div><div class="line">        timevalue = [int(item) for item in time]</div><div class="line">        y = timevalue[0]</div><div class="line">        m = timevalue[1]</div><div class="line">        d = timevalue[2]</div><div class="line">        recordDate = datetime(y,m,d)</div><div class="line">        returnValue = valuebyHour(recordDate)</div><div class="line">        if returnValue:</div><div class="line">            (a, b, c, d) = returnValue</div><div class="line">            if b is not None:</div><div class="line">                socketio.emit(&apos;historyRockets&apos;, b)</div><div class="line">        else:</div><div class="line">            socketio.emit(&apos;historyRockets&apos;,None)</div><div class="line"># historyRocketsäº‹ä»¶ï¼Œæ¥æ”¶æ¥è‡ªhistoryDateçš„æ•°æ®å¹¶å°†å…¶è¿”å›ç»™å‰ç«¯           </div><div class="line">@socketio.on(&apos;historyRockets&apos;)</div><div class="line">def sendHistory(data):</div><div class="line">    emit(&apos;historyRockets&apos;,data)</div></pre></td></tr></table></figure>
<p>æœåŠ¡å™¨ç«¯çš„å†…å®¹å¼„å®Œä¹‹åï¼Œå‰ç«¯åªéœ€è¦å»ºç«‹è¿æ¥ï¼Œå¹¶åœ¨æ°å½“çš„æ—¶å€™è§¦å‘å¯¹åº”çš„äº‹ä»¶å³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// è¿æ¥socket.ioæœåŠ¡å™¨</div><div class="line">var socket = io.connect(&apos;http://ip:&apos; + port);</div><div class="line">// è§¦å‘äº‹ä»¶</div><div class="line">socket.emit(&apos;historyDate&apos;,date);</div><div class="line">//æ¥æ”¶æ•°æ®</div><div class="line">socket.on(&apos;historyRockets&apos;, function(msg)&#123;</div><div class="line"> 	dosth();</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<p>æ¯å¤©çš„æ•°æ®åªéœ€è¦å‰ç«¯å‘é€ä¸€ä¸ªæŒ‡å®šçš„dateå°±å¯ä»¥è·å–åˆ°äº†ã€‚</p>
<h1 id="æœ€çƒ­æˆ¿é—´æ•°æ®è·å–"><a href="#æœ€çƒ­æˆ¿é—´æ•°æ®è·å–" class="headerlink" title="æœ€çƒ­æˆ¿é—´æ•°æ®è·å–"></a>æœ€çƒ­æˆ¿é—´æ•°æ®è·å–</h1><p>é€šè¿‡socket.ioå¯ä»¥å®Œæˆæ•°æ®äº¤äº’ï¼Œä½†æ˜¯è¿™äº›æ•°æ®éƒ½éœ€è¦å»ºç«‹é¢å¤–çš„è¿æ¥ã€æ¶ˆè€—é¢å¤–çš„ç½‘ç»œèµ„æºï¼Œä¸€äº›ç›´æ¥å¯ä»¥ä»åç«¯è·å–çš„æ•°æ®åˆ™å¯ç›´æ¥é€šè¿‡flaskæ¨¡æ¿å®Œæˆæ¸²æŸ“ã€‚<br>ä»¥æœ€çƒ­æˆ¿é—´ä¸ºä¾‹ï¼Œç”±äºé€šè¿‡çˆ¬è™«æŠ“å–åˆ°çš„æ•°æ®éƒ½åœ¨æ•°æ®åº“ä¸­ï¼Œé¡µé¢åœ¨åŠ è½½çš„æ—¶å€™ç›´æ¥è°ƒç”¨å³å¯ã€‚</p>
<p>é¦–å…ˆè·å–äººæ°”æ’åå‰21ä½(é¡µé¢æ˜¾ç¤º3*7)ã€‚è·å–è¿™äº›æˆ¿é—´çš„æˆ¿é—´æ ‡é¢˜ã€ä¸»æ’­åã€æˆ¿é—´ç¼–å·å’Œæˆ¿é—´å°é¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># æŒ‰ç…§è§‚ä¼—äººæ•°ï¼Œå‰20åæˆ¿é—´</div><div class="line">def HotRoom():</div><div class="line">    hotroom = roomcol.find(&#123;&#125;, &#123;&quot;_id&quot;: 0, &quot;date&quot;: 0&#125;).sort(</div><div class="line">        &quot;audience&quot;, pymongo.DESCENDING).limit(21)</div><div class="line">    rooms = []</div><div class="line">    if hotroom:</div><div class="line">        for item in hotroom:</div><div class="line">            rooms.append(item)</div><div class="line">    return rooms</div></pre></td></tr></table></figure>
<p>æ•°æ®è·å–ä¹‹åï¼Œåªéœ€è¦åœ¨flaskçš„routerä¸­æ·»åŠ å¯¹åº”è§„åˆ™å¹¶åˆ™æ¨¡æ¿ä¸­å®Œæˆå…ƒç´ æ·»åŠ å³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># æ·»åŠ è·¯ç”±è§„åˆ™</div><div class="line">@app.route(&apos;/chatmsg&apos;)</div><div class="line">def chatmsg():</div><div class="line">    rooms = HotRoom()</div><div class="line">    return render_template(&apos;gift.html&apos;, hotroom=rooms, flag=0)</div></pre></td></tr></table></figure>
<p>å®Œæˆæ¨¡æ¿ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">    &lt;h2 style=&quot;color:rgba(228, 230, 232, 0.53);&quot;&gt;çƒ­é—¨æˆ¿é—´&lt;/h2&gt;</div><div class="line">    &#123;%if hotroom%&#125;</div><div class="line">        &#123;%for room in hotroom%&#125;</div><div class="line">            &#123;%if flag%3==0 %&#125;</div><div class="line">            &lt;div class=&quot;row nopx&quot;&gt;</div><div class="line">            &#123;%endif%&#125;</div><div class="line">            &lt;div class=&quot;col-sm-6 col-md-4 nopx&quot;&gt;</div><div class="line">                &lt;div class=&quot;thumbnail&quot; style=&quot;border:1px solid rgba(135, 144, 160, 0.15);line-height: 0px;</div><div class="line">background-color: rgba(8, 8, 8, 0.72);&quot;&gt;</div><div class="line">                    &lt;img src=&#123;&#123;room[&apos;img&apos;]&#125;&#125; alt=&quot;http://eclipsesv.com:4321/tv/&#123;&#123;room[&apos;roomid&apos;]&#125;&#125;&quot;&gt;</div><div class="line">                    &lt;div class=&quot;caption&quot;&gt;</div><div class="line">                        &lt;h4 style=&quot;color:rgba(228, 230, 232, 0.53);&quot;&gt;&#123;&#123;room[&apos;roomtitle&apos;]&#125;&#125;&lt;/h4&gt;</div><div class="line">                        &lt;p&gt;</div><div class="line">                            &lt;a href=&quot;http://eclipsesv.com:4321/tv/&#123;&#123;room[&apos;roomid&apos;]&#125;&#125;&quot; target=&quot;_blank&quot;&gt;</div><div class="line">                                &#123;&#123;room[&apos;anchor&apos;]&#125;&#125;@&#123;&#123;room[&apos;tag&apos;]&#125;&#125;</div><div class="line">                            &lt;/a&gt;</div><div class="line">                        &lt;/p&gt;</div><div class="line">                    &lt;/div&gt;</div><div class="line">                &lt;/div&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &#123;%set flag=flag+1%&#125;</div><div class="line">            &#123;%if flag%3==0 %&#125;</div><div class="line">            &lt;/div&gt;</div><div class="line">            &#123;%endif%&#125;</div><div class="line">        &#123;%endfor%&#125;</div><div class="line">    &#123;%endif%&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥å•¦ã€‚</p>
<h1 id="è§†é¢‘æµè½¬æ’­"><a href="#è§†é¢‘æµè½¬æ’­" class="headerlink" title="è§†é¢‘æµè½¬æ’­"></a>è§†é¢‘æµè½¬æ’­</h1><p>çƒ­é—¨æˆ¿é—´é¡µé¢å®Œæˆä¹‹åï¼Œæƒ³è¦ç›´æ¥åœ¨é¡µé¢ä¸­è§‚çœ‹è§†é¢‘è€Œä¸æ˜¯è·³è½¬åˆ°æ–—é±¼ï¼Œä¹‹å‰ä¸€ç›´æƒ³å¤æ‚äº†ï¼Œåœ¨çœ‹äº†dotamaxç›´æ’­è§†é¢‘ä¹‹åçœ‹äº†æºç å°±æç„¶å¤§æ‚Ÿäº†ã€‚åŸæ¥åªéœ€è¦ä¸€ä¸ªç›´æ’­é—´idå°±å¯ä»¥äº†ã€‚</p>
<p>åœ¨flaskä¸­æ·»åŠ è·¯ç”±è§„åˆ™ï¼Œé€šè¿‡roomidè¿”å›å¯¹åº”é¡µé¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@app.route(&apos;/tv/&lt;int:roomid&gt;&apos;)</div><div class="line">def tvstream(roomid):</div><div class="line">    if roomid:</div><div class="line">        return render_template(&apos;tv.html&apos;, roomid=roomid)</div></pre></td></tr></table></figure>
<p>å‰ç«¯æ¨¡æ¿åªéœ€è¦è¿™æ ·å³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;%if roomid%&#125;</div><div class="line"> &lt;object type=&quot;application/x-shockwave-flash&quot; data=&quot;http://staticlive.douyutv.com/common/share/play.swf?room_id=&#123;&#123;roomid&#125;&#125;&quot; width=&quot;1200px&quot; height=&quot;750px&quot; allowscriptaccess=&quot;always&quot; allowfullscreen=&quot;true&quot; allowfullscreeninteractive=&quot;true&quot;&gt;&lt;param name=&quot;quality&quot; value=&quot;high&quot;&gt;&lt;param name=&quot;bgcolor&quot; value=&quot;#000000&quot;&gt;&lt;param name=&quot;allowscriptaccess&quot; value=&quot;always&quot;&gt;&lt;param name=&quot;allowfullscreen&quot; value=&quot;true&quot;&gt;&lt;param name=&quot;wmode&quot; value=&quot;transparent&quot;&gt;&lt;param name=&quot;allowFullScreenInteractive&quot; value=&quot;true&quot;&gt;</div><div class="line">			&lt;param name=&quot;quality&quot; value=&quot;high&quot;&gt;</div><div class="line">			&lt;param name=&quot;bgcolor&quot; value=&quot;#000000&quot;&gt;</div><div class="line">			&lt;param name=&quot;allowscriptaccess&quot; value=&quot;always&quot;&gt;</div><div class="line">			&lt;param name=&quot;allowfullscreen&quot; value=&quot;true&quot;&gt;</div><div class="line">			&lt;param name=&quot;wmode&quot; value=&quot;transparent&quot;&gt;</div><div class="line">			&lt;param name=&quot;allowFullScreenInteractive&quot; value=&quot;true&quot;&gt;</div><div class="line"> &lt;/object&gt;</div><div class="line">&#123;%endif%&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥ç›—ç”¨æ–—é±¼çš„è§†é¢‘å•¦ï¼Œå“ˆå“ˆå“ˆã€‚</p>
<h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œç«™ç‚¹åŸºæœ¬ä¸Šå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œç”±äºå‰ç«¯çš„å†…å®¹éƒ½æ˜¯åˆæ­¥æ¥è§¦ï¼Œæ€»ä½“ä¸Šåº”è¯¥è¿˜æœ‰è¾ƒå¤§çš„å¯æ”¹è¿›ä½™åœ°ã€‚æ¥ä¸‹æ¥å‡†å¤‡å®Œæˆçš„ç‚¹ä¸»è¦åŒ…æ‹¬è¿™äº›ï¼š</p>
<ul>
<li>æ•°æ®åº“ç»“æ„ä¼˜åŒ–ï¼Œå……åˆ†è€ƒè™‘åˆ©ç”¨mongodbè‡ªèº«aggregationæ¥å®Œæˆæ•°æ®é¢„å¤„ç†</li>
<li>æä¾›å®Œå–„çš„restful api å®Œæˆæ•°æ®è°ƒç”¨</li>
<li>æä¾›é’ˆå¯¹ç›´æ’­åˆ†ç±»å’Œä¸»æ’­çš„äººæ°”ç›‘æ§</li>
</ul>
<p>æš‚æ—¶å°±å…ˆè¿™äº›ï¼Œç»§ç»­åŠªåŠ›ï¼</p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Hack On Douyu -- 2]]></title>
      <url>/2016/07/23/HackOnDouyu--2/</url>
      <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œä¸»è¦è®²äº†æˆ‘è·å–æ–—é±¼å¼¹å¹•å’ŒæŸäº›é™æ€é¡µé¢çš„æ–¹æ³•ï¼Œåœ¨æ•°æ®è·å–åˆ°ä¹‹åï¼Œå¦‚ä½•æœ‰æ•ˆçš„ç»„ç»‡å’Œå­˜å‚¨æ•°æ®ç›´æ¥å…³ç³»åˆ°åç»­æ•°æ®èƒ½å¦å¯ä»¥èƒŒæœ‰æ•ˆä½¿ç”¨ã€‚<br><a id="more"></a><br>ä¸ºäº†æ›´ç›´è§‚çš„è¯´æ˜è·å–åˆ°çš„è¿™äº›æ•°æ®å¦‚ä½•ç»„ç»‡å’Œä½¿ç”¨ï¼Œæˆ‘å¤§è‡´èŠ±äº†ä¸¤å¼ å›¾æ¥è¯´æ˜ã€‚</p>
<h1 id="æ•°æ®å­˜å‚¨ç»“æ„"><a href="#æ•°æ®å­˜å‚¨ç»“æ„" class="headerlink" title="æ•°æ®å­˜å‚¨ç»“æ„"></a>æ•°æ®å­˜å‚¨ç»“æ„</h1><p>é€šè¿‡çˆ¬è™«æˆ–æ˜¯ç›´æ¥é€šè¿‡tcpé€šè®¯è·å–åˆ°çš„æ–—é±¼é™æ€é¡µé¢æ•°æ®å’Œå¼¹å¹•èŠå¤©å†…å®¹æ•°æ®ç»„ç»‡å½¢å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://o3sw4xojp.qnssl.com/myBlogDouyu_mongo.png" alt="mongodbæ•°æ®ç»„ç»‡ç»“æ„"><br>æˆ‘ä½¿ç”¨mongodbæ¥å­˜å‚¨å’Œç®¡ç†æ•°æ®ï¼ŒæŠŠä¸Šè¿°çš„æ•°æ®å­˜å‚¨åœ¨åä¸ºDouyuçš„æ•°æ®åº“ä¸­ï¼Œå°†æ•°æ®åˆ†åˆ«å­˜äºRoominfoã€chatmsgã€rocketã€rocketbyDayå››ä¸ªè¡¨ä¸­ã€‚</p>
<h2 id="é™æ€é¡µé¢æ•°æ®å­˜å‚¨"><a href="#é™æ€é¡µé¢æ•°æ®å­˜å‚¨" class="headerlink" title="é™æ€é¡µé¢æ•°æ®å­˜å‚¨"></a>é™æ€é¡µé¢æ•°æ®å­˜å‚¨</h2><p>å…¶ä¸­Roominfoåº“ä¸»è¦è®°å½•é€šè¿‡çˆ¬è™«è·å–åˆ°çš„å½“å‰å¼€æ’­æˆ¿é—´ä¿¡æ¯ï¼Œå­—æ®µä¸»è¦åŒ…æ‹¬ç”¨ä»¥çºªå½•æ•°æ®è·å–æ—¶é—´çš„dateã€å¼€æ’­æˆ¿é—´äººæ°”audienceã€æˆ¿é—´æ ‡é¢˜roomtitleã€ä¸»æ’­åanchorã€æˆ¿é—´æ ‡ç­¾tagã€å½“å‰æˆ¿é—´å°é¢å›¾ç‰‡imgã€æˆ¿é—´æ ‡è¯†ç¬¦roomidã€‚<br>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥éš”æ—¶æ‰§è¡Œé™æ€é¡µé¢æ•°æ®è·å–è„šæœ¬ä»è€Œè·å–è¿™äº›æ•°æ®ï¼Œé€šè¿‡å¯¹audienceè¿›è¡Œæ’åºå¯ä»¥è½»æ˜“è·å–åˆ°äººæ°”æœ€é«˜çš„æˆ¿é—´ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†è¿™äº›æˆ¿é—´ä¿¡æ¯ä»¥jsonçš„æ ¼å¼ä¼ è¾“åˆ°éœ€è¦çš„åœ°æ–¹ã€‚è€Œaudienceå’Œtagçš„ç»„åˆä¹Ÿå¯ä»¥è·å–ä¸åŒç±»å‹ç›´æ’­æˆ¿é—´äººæ°”å¯¹æ¯”ç»“æœã€‚<br>æˆ‘åœ¨é¡¹ç›®ä¸­é€šè¿‡æœåŠ¡å™¨ä¸Šçš„crontabæ¯éš”10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡é™æ€é¡µé¢æ•°æ®è·å–ä»»åŠ¡.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">0,10,20,30,40,55 * * *  * python  /path/to/allRooms.py</div></pre></td></tr></table></figure>
<p>ååº”ç»™å‰ç«¯çš„ç»“æœå¯ä»¥é€šè¿‡<a href="http://eclipsesv.com:4321/chatmsg">è¿™ä¸ªé¡µé¢</a>çœ‹åˆ°ã€‚</p>
<h2 id="å¼¹å¹•èŠå¤©å†…å®¹"><a href="#å¼¹å¹•èŠå¤©å†…å®¹" class="headerlink" title="å¼¹å¹•èŠå¤©å†…å®¹"></a>å¼¹å¹•èŠå¤©å†…å®¹</h2><p>ä¸Šä¸€ç¯‡è¯´è¿‡ï¼Œæœ€åˆæ‰“ç®—æ˜¯æƒ³è¦å¯¹å¼¹å¹•èŠå¤©å†…å®¹è¿›è¡Œè‡ªç„¶è¯­è¨€åˆ†æçš„ï¼Œä½†æ˜¯ç”±äºä¸€ç›´æ²¡æ¥å¾—åŠæï¼Œä¹Ÿå°±ææµ…äº†ï¼Œå¯¹ä¸å¼¹å¹•èŠå¤©å†…å®¹ï¼Œåªæ˜¯ç®€è¦çš„çºªå½•äº†åŒ…æ‹¬å‘é€è€…sender_idã€å‘é€æ—¶é—´dateå’Œå¼¹å¹•å†…å®¹contentï¼Œç”±äºæ¯æ¬¡è·å–çš„å¼¹å¹•æ•°æ®éƒ½æ˜¯è·å–å½“æ—¶äººæ°”æœ€é«˜çš„æˆ¿é—´å¼¹å¹•ï¼Œæ‰€ä»¥å¼¹å¹•å†…å®¹å¤§éƒ½æ˜¯ä»€ä¹ˆâ€œç™½é“¶ä¸‰æ°â€ã€â€œæœ€å¼ºç‹è€…â€ä¹‹ç±»çš„ã€‚ã€‚ã€‚</p>
<h2 id="ç«ç®­çºªå½•"><a href="#ç«ç®­çºªå½•" class="headerlink" title="ç«ç®­çºªå½•"></a>ç«ç®­çºªå½•</h2><p>è‡ªç„¶è¯­è¨€åˆ†ææ²¡ææˆï¼Œæ‰€ä»¥ç°åœ¨çš„é‡ç‚¹å·¥ä½œæ˜¯çºªå½•è§‚ä¼—èµ é€ç«ç®­ï¼Œé€šè¿‡è¿™äº›æ•°æ®åšå‡ºä¸€äº›å›¾è¡¨ã€‚<br>å¯¹ç«ç®­ä¿¡æ¯çºªå½•ä½¿ç”¨äº†ä¸¤ä¸ªè¡¨ï¼šrocketå’ŒrocketbyDayã€‚<br>rocketä¸»è¦æ˜¯è·å–å®æ—¶ç«ç®­ä¿¡æ¯ï¼Œé€šè¿‡ä¸æ–—é±¼å¼¹å¹•æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œæ ¹æ®å¼¹å¹•æ¶ˆæ¯ç±»å‹å°†èµ é€ç«ç®­çš„ä¿¡æ¯è·å–åˆ°ï¼Œä¸»è¦åŒ…æ‹¬ï¼šèµ é€è€…sender_idã€æ¥å—è€…recver_idã€èµ é€æ—¶é—´dateå’Œç¤¼ç‰©ç±»å‹giftã€‚<br>rocketbyDayåˆ™æ˜¯é€šè¿‡æ¯å¤©0:05åˆ†ç»Ÿè®¡å‰ä¸€å¤©ç«ç®­éšç€æ—¶é—´çš„åˆ†å¸ƒæƒ…å†µï¼Œä»¥å¤©ä¸ºå•ä½çš„dateã€æ¯å¤©ç«ç®­æ€»æ•°countå’Œå½“å¤©ç«ç®­å…·ä½“æ•°æ®dataã€‚<br>çºªå½•è¿™äº›å†…å®¹ä¸»è¦æ˜¯å¯ä»¥ç»Ÿè®¡å‡ºæ¯æ—¥é€æ—¶ç¤¼ç‰©èµ é€æƒ…å†µã€æ¯å¤©èµ é€ç¤¼ç‰©çš„åœŸè±ªæ’åã€å—åˆ°ç«ç®­ä¸»æ’­æ’åç­‰ã€‚å¤§è‡´ç»“æœå¯ä»¥ç‚¹å‡»<a href="http://eclipsesv.com:4321/">å½“å¤©ç«ç®­ä¿¡æ¯</a>å’Œ<a href="http://eclipsesv.com:4321/history">ç«ç®­å†å²æ•°æ®</a>æŸ¥çœ‹å…·ä½“å†…å®¹ã€‚</p>
<h1 id="æ¶ˆæ¯å®æ—¶è½¬å‘"><a href="#æ¶ˆæ¯å®æ—¶è½¬å‘" class="headerlink" title="æ¶ˆæ¯å®æ—¶è½¬å‘"></a>æ¶ˆæ¯å®æ—¶è½¬å‘</h1><p>ä¸Šè¿°æ•°æ®å¯ä»¥çœ‹ä½œç›´æ’­æ•°æ®ä¸­çš„é•¿æ—¶é—´æ•°æ®ï¼Œè€Œå…¶ä¸­çš„ä¸€äº›éœ€è¦â€œä¿é²œâ€çš„æ•°æ®ä¾‹å¦‚åœ¨æœ‰åœŸè±ªèµ é€ç»™ä¸»æ’­ç«ç®­ä¹‹åï¼Œè§‚ä¼—å¯ä»¥åœ¨ä¸¤åˆ†é’Ÿå†…åˆ°è¯¥æˆ¿é—´æŠ¢é±¼ä¸¸ç¤¼ç‰©ï¼Œå¯¹äºè¿™ç§éœ€è¦â€œä¿é²œâ€çš„æ•°æ®ï¼Œæˆ‘é€šè¿‡redisçš„pubï¼subæ¥æ¥æ”¶å’Œè½¬å‘ï¼Œå¹¶é€šè¿‡socke.ioå®æ—¶å‘é€ç»™å½“å‰æ‰“å¼€é¡µé¢çš„è§‚ä¼—ã€‚å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://o3sw4xojp.qnssl.com/myBlogRedis.png" alt=""></p>
<h1 id="é‡åˆ°çš„é—®é¢˜å’Œä¸‹ä¸€æ­¥è®¡åˆ’"><a href="#é‡åˆ°çš„é—®é¢˜å’Œä¸‹ä¸€æ­¥è®¡åˆ’" class="headerlink" title="é‡åˆ°çš„é—®é¢˜å’Œä¸‹ä¸€æ­¥è®¡åˆ’"></a>é‡åˆ°çš„é—®é¢˜å’Œä¸‹ä¸€æ­¥è®¡åˆ’</h1><p>åœ¨å®é™…é¡¹ç›®è¿è¡Œä¸­ï¼Œæœ‰å¥½å‡ æ¬¡å‡ºç°mongodbè«åå…¶å¦™æŒ‚æ‰çš„ç°è±¡ï¼Œç”±äºé¡¹ç›®è¿è¡Œåœ¨è…¾è®¯1æ ¸å¿ƒ1gbå†…å­˜çš„äº‘ä¸»æœºä¸Šï¼ˆå­¦ç”Ÿä¼˜æƒ ä¸€ä¸ªæœˆåªè¦ä¸€å—é’±ï¼Œ23333333ï¼‰ï¼Œè¿™è®©æˆ‘å¾ˆå¿«æƒ³åˆ°æ˜¯ä¸æ˜¯åœ¨å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œmongodbå ç”¨å†…å­˜è¿‡é«˜å¯¼è‡´æŒ‚æ‰ï¼ˆä¹‹å‰åœ¨å­¦æ ¡åšé¡¹ç›®çš„æ—¶å€™æ›¾ç»è§åˆ°è¿‡mongodbåœ¨å¤§é‡å†™å…¥æ•°æ®çš„æ—¶å€™æ•°æ®åº“æŒ‚æ‰çš„ç°è±¡ï¼‰ã€‚<br>äºæ˜¯ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œè¿æ¥åˆ°äº‘ä¸»æœºä¸Šï¼Œ è¿›å…¥åˆ°mongodbç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">./mongo</div><div class="line">use Douyu</div><div class="line">db.setProfilingLevel(1)</div></pre></td></tr></table></figure>
<p>ç„¶åé™å¾…ä¸‹æ¬¡æ•°æ®åº“æŒ‚æ‰ã€‚æœç„¶åœ¨æŸä¸ªæ•´10åˆ†é’Ÿçš„æ—¶å€™ï¼Œæ•°æ®åˆæ•°ä¸å‡ºæ¥äº†ï¼Œé‡å¯æ•°æ®åº“ï¼Œæ‰“å¼€mongodbå®¢æˆ·ç«¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.system.profile.find().limit(2)</div></pre></td></tr></table></figure>
<p>å‡ºç°çš„å†…å®¹ï¼š<br><img src="https://o3sw4xojp.qnssl.com/myBlog%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-23%20%E4%B8%8B%E5%8D%8811.15.41.png" alt=""></p>
<p>æ­£å¦‚çŒœæƒ³çš„é‚£æ ·ï¼Œæœç„¶æ˜¯ç”±äºå†™å…¥çš„æ—¶å€™é€ æˆäº†æ•°æ®åº“çš„é—®é¢˜ã€‚<br>è¿™æ—¶ï¼Œæœºæ™ºçš„æˆ‘æƒ³åˆ°äº†å¸ˆå¦¹é‚£é‡Œè¿˜æœ‰ä¸ªé—²ç½®çš„äº‘ä¸»æœºï¼Œå¾ç”¨è¿‡æ¥åšä¸ªè¯»å†™åˆ†ç¦»è¯•ä¸‹å§ï¼ˆå½“ç„¶æˆ‘ä¹Ÿæƒ³æä¸ªå‰¯æœ¬é›†ï¼Œå¥½å¤šä¸»ã€å¥½å¤šä»ã€å¥½å¤šåˆ†ç‰‡ã€‚ã€‚ã€‚å…³é”®ä¸æ˜¯æ²¡æ¡ä»¶å˜›ï¼‰ã€‚å‡è½»äº†æœåŠ¡å™¨è´Ÿè½½ä¹‹åï¼Œæ•°æ®åº“æŒ‚æ‰çš„ç°è±¡æ²¡æœ‰å†å‡ºç°å•¦ã€‚</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œé¡¹ç›®åŸºæœ¬ä¸Šå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œåœ¨æ•°æ®æ“ä½œè¿™æ–¹é¢ï¼Œæ‰“ç®—åœ¨å¢åŠ ä¸€äº›å†…å®¹ï¼Œæ¯”å¦‚åˆ†ææŸä¸ªæ¸¸æˆåœ¨æ¯å¤©éšæ—¶é—´è§‚ä¼—äººæ•°å˜åŒ–ã€æŸä¸ªä¸»æ’­ç›´æ’­æ—¶æ®µã€æŸä¸ªæ¸¸æˆäººæ°”å˜åŒ–æƒ…å†µç­‰ç­‰ã€‚<br>ä¸‹ä¸€ç¯‡å†…å®¹ä¸»è¦è®²åç«¯flaskçš„ä¸€äº›æƒ…å†µä»¥åŠå‰åç«¯æ•°æ®ä¼ è¾“æ–¹å¼ç­‰ã€‚</p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Hack On Douyu -- 1]]></title>
      <url>/2016/07/20/HackOnDouyu--1/</url>
      <content type="html"><![CDATA[<p>è·ç¦»ä¸Šæ¬¡æ›´æ–°åˆæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæ¯•ä¸šç­”è¾©ä¹‹åï¼Œç¡®å®å’ŒåŒå­¦ä»¬ä¸€èµ·å‡ºå»å—¨äº†ä¸€æ®µæ—¶é—´ï¼Œç”±äºè¿˜æ²¡å…¥èŒï¼Œåœ¨å®¶æ¸…å‡€çš„ç¯å¢ƒä¸­å¯ä»¥å¥½å¥½å­¦ä¸€ä¸‹ä¸€ç›´æ„Ÿå…´è¶£çš„ä¸œè¥¿å•¦ã€‚</p>
<a id="more"></a>
<p>ä¸€ç›´å¯¹ç½‘ç»œçˆ¬è™«å¾ˆæ„Ÿå…´è¶£ï¼Œæ‰€ä»¥å°±å¼€å§‹å­¦ä¹ å¾ˆæƒ³å­¦çš„pythonï¼Œç”¨äº†ä¹‹åä¹Ÿæ˜¯æ„Ÿè§‰éå¸¸æ£’ã€‚æœŸé—´æŠ“è¿‡åŒ…æ‹¬çŸ¥ä¹ã€è±†ç“£ã€ç…è›‹è¿˜æœ‰ä¸ªå£çº¸ç½‘ç«™çš„æ•°æ®ï¼Œè€ŒæŠ“å»æœ€å¤šçš„è¿˜æ˜¯ç›´æ’­ç½‘ç«™æ–—é±¼ã€‚æ•°æ®æŠ“ä¸‹æ¥ä¹‹åå¦‚ä½•ä½¿ç”¨æ˜¯ä¸ªé—®é¢˜ï¼Œæˆ‘çš„åŠæ³•æ˜¯ç”¨è¿™äº›æ•°æ®é€šè¿‡pythonçš„webæ¡†æ¶flaskæ­å»ºä¸€ä¸ªç½‘ç«™ï¼Œä¹Ÿç®—æ˜¯è¿™æ®µæ—¶é—´çš„å­¦ä¹ æˆæœã€‚ç½‘ç«™çš„æ„å»ºè‡ªç„¶å°‘ä¸äº†å‰ç«¯ï¼Œä¹Ÿæ˜¯ç¡¬ç€å¤´çš®å­¦ä¹ äº†bootstrapï¼Œäº†è§£äº†ä¸€äº›cssã€javascriptçš„çŸ¥è¯†ã€‚è¿™æ®µæ—¶é—´çš„å­¦ä¹ æˆæœä¸»è¦æ˜¯<a href="https://github.com/wangmengcn/LearningFlask" target="_blank" rel="external">LearningFlask</a>ã€<a href="https://github.com/wangmengcn/BeautifulPics" target="_blank" rel="external">BeautifulPics</a>ã€<a href="https://github.com/wangmengcn/Danmu" target="_blank" rel="external">Danmu</a>å’Œ<a href="https://github.com/wangmengcn/DouyuFan" target="_blank" rel="external">DouyuFan</a>è¿™å››ä¸ªé¡¹ç›®ï¼ˆç”±äºä¹Ÿæ˜¯åˆšæ¥è§¦pythonï¼Œä»£ç è´¨é‡å¯èƒ½ä¸æ˜¯å¤ªé«˜ ï¼ã€‚ï¼ï¼‰ã€‚è€Œæœ€åè¿™ä¸ªDouyuFanç®—æ˜¯å¯¹å‰è¾¹å‡ ä¸ªé¡¹ç›®çš„æ€»ç»“ã€‚DouyuFanä¸»è¦æ˜¯é€šè¿‡æ–—é±¼ç½‘ç«™å¼¹å¹•ä¿¡æ¯çš„æŠ“å–ï¼Œè·å–ç›´æ’­ç¤¼ç‰©çš„åˆ†å¸ƒæƒ…å†µï¼Œå†å²æ•°æ®è®°å½•ä»¥åŠå½“å‰æœ€çƒ­é—¨æˆ¿é—´ä¿¡æ¯ã€‚<br>æ¥ä¸‹æ¥æˆ‘å°±ç”¨ä¸‰æ¬¡åˆ†åˆ«ä»‹ç»æˆ‘åœ¨æ•°æ®æŠ“å–ã€åå°æ­å»ºä»¥åŠå‰åç«¯æ•°æ®é€šè®¯ä¸­å­¦åˆ°çš„çŸ¥è¯†å’Œé‡åˆ°çš„é—®é¢˜ã€‚</p>
<h1 id="å¼€æ’­æˆ¿é—´æ•°æ®è·å–"><a href="#å¼€æ’­æˆ¿é—´æ•°æ®è·å–" class="headerlink" title="å¼€æ’­æˆ¿é—´æ•°æ®è·å–"></a>å¼€æ’­æˆ¿é—´æ•°æ®è·å–</h1><p>ä½¿ç”¨pythonæŠ“å–è¿‡æ•°æ®çš„åŒå­¦è‚¯å®šå¯¹<a href="http://docs.python-requests.org/en/master/" target="_blank" rel="external">request</a>å’Œ<a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" target="_blank" rel="external">Beautiful Soup</a>è¿™ä¸¤ä¸ªåº“ä¸é™Œç”Ÿã€‚<br>å·ç§°http for humansçš„requestsç¼ºå¤±ä¸æ˜¯æ²½åé’“èª‰ï¼Œä»–åœ¨é¡µé¢æ•°æ®çš„æŠ“å–ä¸Šç¡®å®ç®€å•æ˜äº†ã€‚<br>é€šå¸¸æƒ…å†µä¸‹ï¼Œrequestså’ŒBeautiful Soupé…åˆä½¿ç”¨ã€‚ä»¥å¯¹æ–—é±¼å½“å‰ç›´æ’­æˆ¿é—´çš„æŠ“å–ä¸ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># -*- coding: utf-8 -*-</div><div class="line">from bs4 import BeautifulSoup  # å¯¼å…¥BeautifulSoupï¼Œæå–ç½‘é¡µä¸­ç›®æ ‡å…ƒç´ </div><div class="line">import re						# re æ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨å¿«é€ŸæŸ¥æ‰¾å’Œè¿‡æ»¤å…ƒç´ ä¸­æœ‰å‡ºè‰²è¡¨ç°</div><div class="line">import requests					# reqeusts ç”¨ä»¥è·å–é¡µé¢æ•°æ®</div><div class="line">from datetime import datetime</div><div class="line">from pymongo import MongoClient</div></pre></td></tr></table></figure>
<p>é¦–å…ˆå¯¼å…¥ä¸Šè¿°è¿™å‡ ä¸ªåº“ï¼Œç„¶åå¯ä»¥ä¼ªé€ httpè¯·æ±‚headerï¼Œè¿™æ ·å¯ä»¥å‡å°‘çˆ¬è™«è¢«æœåŠ¡å™¨banæ‰çš„å¯èƒ½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">HOST = &quot;http://www.douyu.com&quot;</div><div class="line">Directory_url = &quot;http://www.douyu.com/directory?isAjax=1&quot;</div><div class="line">Qurystr = &quot;/?page=1&amp;isAjax=1&quot;</div><div class="line"></div><div class="line">agent = &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.86 Safari/537.36&apos;</div><div class="line">accept = &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</div><div class="line">connection = &quot;keep-alive&quot;</div><div class="line">CacheControl = &quot;no-cache&quot;</div><div class="line">UpgradeInsecureRequests = 1</div><div class="line">headers = &#123;</div><div class="line">    &apos;User-Agent&apos;: agent,</div><div class="line">    &apos;Host&apos;: HOST,</div><div class="line">    &apos;Accept&apos;: accept,</div><div class="line">    &apos;Cache-Control&apos;: CacheControl,</div><div class="line">    &apos;Connection&apos;: connection,</div><div class="line">    &apos;Upgrade-InsecureRequests&apos;: UpgradeInsecureRequests</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯å¼€æ’­æˆ¿é—´æ•°æ®çš„è·å–å’Œå…¥åº“ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">cli = MongoClient(host=&quot;ip&quot;,port=xxx)</div><div class="line">db = cli[&quot;Douyu&quot;]</div><div class="line">col = db[&quot;Roominfo&quot;]</div><div class="line"></div><div class="line"></div><div class="line">def get_roominfo(data):</div><div class="line">    if data:</div><div class="line">        firstpage = BeautifulSoup(data)</div><div class="line">        roomlist = firstpage.select(&apos;li&apos;)</div><div class="line">        print len(roomlist)</div><div class="line">        if roomlist:</div><div class="line">            for room in roomlist:</div><div class="line">                try:</div><div class="line">                    roomid = room[&quot;data-rid&quot;]</div><div class="line">                    roomtitle = room.a[&quot;title&quot;]</div><div class="line">                    roomtitle = roomtitle.encode(&apos;utf-8&apos;)</div><div class="line">                    roomowner = room.select(&quot;p &gt; span&quot;)</div><div class="line">                    roomtag = room.select(&quot;div &gt; span&quot;)</div><div class="line">                    roomimg = room.a</div><div class="line">                    roomtag = roomtag[0].string</div><div class="line">                    date = datetime.now()</div><div class="line">                    # now = datetime.datetime(</div><div class="line">                    # date.year, date.month, date.day, date.hour, date.minute)</div><div class="line">                    if len(roomowner) == 2:</div><div class="line">                        zbname = roomowner[0].string</div><div class="line">                        audience = roomowner[1].get_text()</div><div class="line">                        audience = audience.encode(&apos;utf-8&apos;).decode(&apos;utf-8&apos;)</div><div class="line">                        image = roomimg.span.img[&quot;data-original&quot;]</div><div class="line">                        word = u&quot;ä¸‡&quot;    # åœ¨é¡µé¢ä¸­è·å–çš„æˆ¿é—´äººæ•°ä»¥ä¸‡ä¸ºå•ä½çš„stréœ€è¦è½¬æ¢ä¸ºintå‹ï¼Œä»¥ä¾¿å…¥åº“</div><div class="line">                        if word in audience:</div><div class="line">                            r = re.compile(r&apos;(\d+)(\.?)(\d*)&apos;)</div><div class="line">                            data = r.match(audience).group(0)</div><div class="line">                            audience = int(float(data) * 10000)</div><div class="line">                        else:</div><div class="line">                            audience = int(audience)</div><div class="line">                        roominfo = &#123;</div><div class="line">                            &quot;roomid&quot;: int(roomid),</div><div class="line">                            &quot;roomtitle&quot;: roomtitle,</div><div class="line">                            &quot;anchor&quot;: zbname,</div><div class="line">                            &quot;audience&quot;: audience,</div><div class="line">                            &quot;tag&quot;: roomtag,</div><div class="line">                            &quot;date&quot;: date,</div><div class="line">                            &quot;img&quot; : image</div><div class="line">                        &#125;</div><div class="line">                        col.insert_one(roominfo)</div><div class="line">                    # print roomid,&quot;:&quot;,roomtitle</div><div class="line">                except Exception, e:</div><div class="line">                    pass</div><div class="line"></div><div class="line"></div><div class="line">def insert_info():</div><div class="line">    session = requests.session()</div><div class="line">    pagecontent = session.get(Directory_url).text</div><div class="line">    pagesoup = BeautifulSoup(pagecontent)</div><div class="line">    games = pagesoup.select(&apos;a&apos;)</div><div class="line">    col.drop()</div><div class="line">    for game in games:</div><div class="line">        links = game[&quot;href&quot;]</div><div class="line">        gameurl = HOST + links + Qurystr</div><div class="line">        print gameurl</div><div class="line">        gamedata = session.get(gameurl).text</div><div class="line">        get_roominfo(gamedata)</div></pre></td></tr></table></figure>
<p>æˆ‘å¹³å¸¸ä¹ æƒ¯ä½¿ç”¨mongodbä½œä¸ºæ•°æ®å­˜å‚¨ï¼Œé¦–å…ˆå»ºç«‹ä¸æ•°æ®åº“çš„è¿æ¥ï¼Œç„¶åé€šè¿‡è·å–<a href="http://www.douyu.com/directory?isAjax=1" target="_blank" rel="external">æ–—é±¼å½“å‰æ‰€æœ‰æˆ¿é—´åˆ†ç±»</a>ï¼Œæ¥ç€é€ä¸€è·å–æ¯ä¸ªåˆ†ç±»ä¸­å¼€æ’­çš„æˆ¿é—´æ•°æ®ï¼Œå¹¶è®°å½•æ¯ä¸ªæˆ¿é—´çš„roomidï¼ˆæˆ¿é—´å·ï¼Œæ–—é±¼ç›´æ’­é—´å”¯ä¸€æ ‡è¯†ï¼‰ã€roomtitleï¼ˆæˆ¿é—´æ ‡é¢˜ï¼‰ã€anchorï¼ˆä¸»æ’­idï¼‰ã€audienceï¼ˆè§‚ä¼—äººæ•°ï¼‰ã€tagï¼ˆæˆ¿é—´æ‰€å±åˆ†ç±»ï¼‰ã€dateï¼ˆæ•°æ®è·å–æ—¶é—´ï¼‰ã€imgï¼ˆç›´æ’­é—´å°é¢å›¾ç‰‡ï¼‰ã€‚é€šè¿‡å®šæ—¶æ‰§è¡Œæ­¤è„šæœ¬ï¼Œå¯ä»¥è·å–å½“å‰è§‚ä¼—äººæ•°æœ€å¤šçš„æˆ¿é—´(é€šå¸¸å¤§éƒ½æ˜¯lolçš„ç›´æ’­ ï¼ã€‚ï¼)ï¼Œä¹Ÿå¯ä»¥åœ¨ä¹‹åé€šè¿‡roomidæŸ¥è¯¢åˆ°å…³äºå¯¹åº”ç›´æ’­é—´å¿…è¦çš„ä¿¡æ¯ã€‚</p>
<h1 id="å¼¹å¹•æ•°æ®è·å–"><a href="#å¼¹å¹•æ•°æ®è·å–" class="headerlink" title="å¼¹å¹•æ•°æ®è·å–"></a>å¼¹å¹•æ•°æ®è·å–</h1><p>ç»å¸¸çœ‹æ–—é±¼ç›´æ’­çš„åŒå­¦è‚¯å®šçŸ¥é“â€œå¼¹å¹•å¤§ç¥â€è¿™ä¸ªè¯ï¼Œæˆ‘æœ€åˆæƒ³è¦æŠ“å–å¼¹å¹•çš„ç›®çš„æ˜¯æƒ³é€šè¿‡å¤§é‡çš„è·å–ç›´æ’­é—´å¼¹å¹•æ•°æ®è¿›è¡Œä¸€äº›è‡ªç„¶è¯­è¨€åˆ†æï¼Œç”±äºé‚£äº›ä¸œè¥¿ä¸€ç›´æ²¡å­¦ä¹ ï¼Œä¹Ÿå°±æ²¡å†å¼„ï¼Œä½†æ˜¯ï¼Œé€šè¿‡å¼¹å¹•ï¼Œå¯ä»¥è·å–åˆ°åœ¨å…¨é¢‘é“å¹¿æ’­çš„ç«ç®­ä¿¡æ¯ï¼Œé•¿æ—¶é—´ç›‘æµ‹è¿™äº›æ•°æ®åº”è¯¥ä¹Ÿæ˜¯ä¸€ä»¶æœ‰æ„æ€çš„äº‹æƒ…ã€‚<br>è¯´å¹²å°±å¹²ï¼Œæƒ³è¦è·å–åˆ°ç›´æ’­é—´çš„å¼¹å¹•æ•°æ®ä¸åŒäºä¸Šè¾¹æ‰€è¯´çš„é¡µé¢æ•°æ®æŠ“å–ï¼Œå¥½åœ¨æ–—é±¼å®˜æ–¹ä¹Ÿæä¾›äº†ä¸€ä¸ªè·å–å¼¹å¹•çš„é€”å¾„(æ–—é±¼å¼¹å¹•æœåŠ¡å™¨ç¬¬ä¸‰æ–¹æ¥å…¥åè®®)[<a href="http://dev-bbs.douyutv.com/forum.php?mod=viewthread&amp;tid=109]ï¼Œæ–‡æ¡£ä¸­å¯¹å¦‚ä½•è·å–å¼¹å¹•æ•°æ®ã€ä»¥åŠå¼¹å¹•ä¿¡æ¯ç±»å‹æœ‰å…·ä½“çš„è¯´æ˜ï¼Œè¿™ä¹Ÿå¤§å¤§é™ä½äº†è·å–å¼¹å¹•æ•°æ®çš„éš¾åº¦ã€‚" target="_blank" rel="external">http://dev-bbs.douyutv.com/forum.php?mod=viewthread&amp;tid=109]ï¼Œæ–‡æ¡£ä¸­å¯¹å¦‚ä½•è·å–å¼¹å¹•æ•°æ®ã€ä»¥åŠå¼¹å¹•ä¿¡æ¯ç±»å‹æœ‰å…·ä½“çš„è¯´æ˜ï¼Œè¿™ä¹Ÿå¤§å¤§é™ä½äº†è·å–å¼¹å¹•æ•°æ®çš„éš¾åº¦ã€‚</a><br>çœ‹è¿‡è¿™ä¸ªåè®®ä¹‹åï¼Œé€šè¿‡å»ºç«‹ä¸å¼¹å¹•æœåŠ¡å™¨çš„tcpè¿æ¥ï¼Œå¯ä»¥ä¸æ–­çš„è·å–åˆ°å¼¹å¹•æ•°æ®ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯(socket)[<a href="https://docs.python.org/2/library/socket.html]è¿™ä¸ªåº“ã€‚" target="_blank" rel="external">https://docs.python.org/2/library/socket.html]è¿™ä¸ªåº“ã€‚</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">HOST = &apos;openbarrage.douyutv.com&apos;</div><div class="line">PORT = 8601</div><div class="line">RID = 97376</div><div class="line">LOGIN_INFO = &quot;type@=loginreq/username@=qq_aPSMdfM5&quot; + \</div><div class="line">    &quot;/password@=1234567890123456/roomid@=&quot; + str(RID) + &quot;/&quot;</div><div class="line">JION_GROUP = &quot;type@=joingroup/rid@=&quot; + str(RID) + &quot;/gid@=-9999&quot; + &quot;/&quot;</div><div class="line">ROOM_ID = &quot;type@=qrl/rid@=&quot; + str(RID) + &quot;/&quot;</div><div class="line">KEEP_ALIVE = &quot;type@=keeplive/tick@=&quot; + \</div><div class="line">    str(int(time.time())) + &quot;/vbw@=0/k@=19beba41da8ac2b4c7895a66cab81e23/&quot;</div><div class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œéœ€è¦æ³¨æ„å‡ ä¸ªå˜é‡ï¼š host port roomid gid ã€‚å…¶ä¸­HOSTæ˜¯å¼¹å¹•æœåŠ¡å™¨åœ°å€ï¼Œportæ˜¯å¯¹å¤–å¼€æ”¾çš„ç«¯å£ï¼Œroomidåˆ™æ˜¯ä¸»æ’­é—´å¯¹åº”çš„idï¼Œgidæ˜¯è¦åŠ å…¥çš„å¼¹å¹•é¢‘é“ï¼Œï¼9999é¢‘é“å¯ä»¥è·å–åˆ°æ‰€æœ‰å¼¹å¹•ï¼Œä¹Ÿå°±æ˜¯â€œæµ·é‡å¼¹å¹•â€é¢‘é“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">def get_Hotroom():</div><div class="line">    hotroom = roomcol.find().limit(1).sort(</div><div class="line">        [(&quot;audience&quot;, pymongo.DESCENDING), (&quot;date&quot;, pymongo.DESCENDING)])</div><div class="line">    for item in hotroom:</div><div class="line">        return item[&quot;roomid&quot;]</div><div class="line">        </div><div class="line">def create_Conn():</div><div class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div><div class="line">    s.connect((HOST, PORT))</div><div class="line">    RID = get_Hotroom()</div><div class="line">    print &quot;å½“å‰æœ€çƒ­æˆ¿é—´:&quot;, RID</div><div class="line">    LOGIN_INFO = &quot;type@=loginreq/username@=qq_aPSMdfM5&quot; + \</div><div class="line">        &quot;/password@=1234567890123456/roomid@=&quot; + str(RID) + &quot;/&quot;</div><div class="line">    print LOGIN_INFO</div><div class="line">    JION_GROUP = &quot;type@=joingroup/rid@=&quot; + str(RID) + &quot;/gid@=-9999&quot; + &quot;/&quot;</div><div class="line">    print JION_GROUP</div><div class="line">    s.sendall(tranMsg(LOGIN_INFO))</div><div class="line">    s.sendall(tranMsg(JION_GROUP))</div><div class="line">    return s</div></pre></td></tr></table></figure>
<p>ä¹‹åï¼Œé€šè¿‡get_Hotroom()è·å–åˆ°å½“å‰æœ€çƒ­é—¨æˆ¿é—´ï¼ˆäººæ•°æœ€å¤šçš„æˆ¿é—´ï¼‰ï¼Œé€šè¿‡create_Conn()å»ºç«‹ä¸æœåŠ¡å™¨çš„è¿æ¥ã€‚è¿æ¥å»ºç«‹ä¹‹åå°±å¯ä»¥å¼€å¿ƒçš„è·å–å¹¶ä¿å­˜å¼¹å¹•æ•°æ®äº†:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">def insert_msg(sock):</div><div class="line">    sendtime = 0</div><div class="line">    while True:</div><div class="line">        if sendtime % 20 == 0:</div><div class="line">            print &quot;----------Keep Alive---------&quot;</div><div class="line">            try:</div><div class="line">                sock.sendall(tranMsg(KEEP_ALIVE))</div><div class="line">            except socket.error:</div><div class="line">                print &quot;alive error&quot;</div><div class="line">                sock = create_Conn()</div><div class="line">                insert_msg(sock)</div><div class="line">        sendtime += 1</div><div class="line">        print sendtime</div><div class="line">        try:</div><div class="line">            data = sock.recv(4000)</div><div class="line">            if data:</div><div class="line">                strdata = repr(data)</div><div class="line">                if &quot;type@=spbc&quot; in strdata:</div><div class="line">                    get_rocket(data)</div><div class="line">                if &quot;type@=chatmsg&quot; in strdata:</div><div class="line">                    get_chatmsg(data)</div><div class="line">        except socket.error:</div><div class="line">            print &quot;chat error&quot;</div><div class="line">            sock = create_Conn()</div><div class="line">            insert_msg(sock)</div><div class="line">        time.sleep(1)</div></pre></td></tr></table></figure>
<p>æ¯20ç§’å‘æœåŠ¡å™¨å‘é€ä¸€æ¡KEEP_ALIVEç”¨ä»¥ä½¿è¿æ¥ä¿æ´»ï¼Œé€šè¿‡è·å–åˆ°çš„æ•°æ®ç‰¹ç‚¹ï¼Œå°†æ™®é€šèŠå¤©å¼¹å¹•å’Œç«ç®­å¹¿æ’­å¼¹å¹•åŒºåˆ†å¼€æ¥ï¼Œå¹¶ä¸”ä¿å­˜åœ¨ä¸åŒçš„æ•°æ®åº“ä¸­ä»è€Œä¸ºä¹‹åæä¾›ä¸åŒçš„ç”¨é€”ã€‚<br>å¼¹å¹•æ•°æ®è·å–å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š<br><img src="https://o3sw4xojp.qnssl.com/Douyufandanmu.gif" alt="è·å–å¼¹å¹•"></p>
<h1 id="åç»­å†…å®¹"><a href="#åç»­å†…å®¹" class="headerlink" title="åç»­å†…å®¹"></a>åç»­å†…å®¹</h1><p>è‡³æ­¤ï¼Œæ­¤é¡¹ç›®çš„æ•°æ®è·å–å·¥ä½œå·²ç»å®Œæˆï¼Œåœ¨æ¥ä¸‹æ¥ä¸¤ç¯‡å†…å®¹ä¼šåˆ†åˆ«ä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™äº›æ•°æ®æ„å»ºé¡µé¢ï¼Œä»¥åŠåœ¨æ­¤è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ã€‚</p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[ç¡•å£«è®ºæ–‡è‡´è°¢]]></title>
      <url>/2016/04/22/0422/</url>
      <content type="html"><![CDATA[<p>å¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢ï¼Œä¸»è¦æ˜¯å¿™ç€èµ¶æ¯•ä¸šè®ºæ–‡å•¦ï½ï½ï¼Œä»Šå¤©æ™šä¸Šç»ˆäºå®Œæˆäº†æœ€åçš„è‡´è°¢ï¼Œèµ°å®Œäº†æœ€åä¸€å…¬é‡Œã€‚<br>æ´‹æ´‹æ´’æ´’ä¸‰ä¸‡å­—ï¼Œç»ˆäºåˆ°äº†è‡´è°¢ï¼Œåœ¨è¿™ä¸ªé›·é›¨äº¤åŠ çš„å¤œæ™šï¼Œæˆ‘çš„å¿ƒæƒ…ä¹Ÿæ˜¯æ— æ¯”æ¿€åŠ¨ã€‚<br><a id="more"></a><br>è½¬çœ¼é—´ï¼Œä¸¤å¹´ç¡•å£«ç”Ÿæ´»å°±è¦èµ°åˆ°å°½å¤´ï¼Œå›æƒ³ä¸€è·¯èµ°æ¥ç‚¹ç‚¹æ»´æ»´éƒ½æ˜¯å†å†åœ¨ç›®ã€‚æˆ‘æ¥è‡ªæ²³å—éƒ‘å·ä¸€æ‰€æ²¡æœ‰ä»€ä¹ˆåæ°”çš„æ™®é€šå¤§å­¦ï¼Œè¯»çš„æ˜¯å½“å¹´æ¯”è¾ƒæ–°å…´çš„åœ°ç†ä¿¡æ¯ç³»ç»Ÿä¸“ä¸šã€‚åœ¨å›½å†…ä½œä¸ºåœ°ç†ä¿¡æ¯ç³»ç»Ÿä¸“ä¸šçš„å­¦ç”Ÿè‚¯å®šéƒ½çŸ¥é“æ­¦æ±‰å¤§å­¦æµ‹ç»˜é¥æ„Ÿä¿¡æ¯å·¥ç¨‹å›½å®¶é‡ç‚¹å®éªŒå®¤æ˜¯é¢†åŸŸå†…çš„å¸¦å¤´ç¾Šï¼Œå¤§å­¦å››å¹´è‡ªç„¶æ˜¯ä»°æ…•å·²ä¹…ï¼Œå¿ƒé‡Œä¹Ÿæ—©æ—©è®¸ä¸‹æ„¿æœ›å°†æ¥ä¸€å®šè¦æ¥è¿™é‡Œæ·±é€ ã€‚å›æƒ³èµ·ä¸¤å¹´å‰é—»é¸¡èµ·èˆæŒ‘ç¯å¤œæˆ˜ï¼Œåˆ·è€ƒç ”è‹±è¯­çœŸé¢˜ã€åšé«˜æ•°600é¢˜ã€èƒŒé©¬æ¯›ä¸­ç‰¹ï¼Œä¸ºè‡ªä¹ å®¤åº§ä½æå‰ä¸€ä¸ªå¤šå°æ—¶æ’é˜Ÿâ€¦2014å¹´ï¼Œæ¨±èŠ±ç››å¼€çš„å­£èŠ‚ï¼Œä¹Ÿæ˜¯æ­¦æ±‰å¤§å­¦æœ€ç¾çš„æ—¶å€™ï¼Œæˆ‘å¾ˆè£å¹¸é€šè¿‡äº†ä¸¥æ ¼çš„å¤è¯•ï¼Œæ­£å¼æˆä¸ºå®éªŒå®¤çš„ä¸€åå­¦ç”Ÿã€‚åœ¨æ‹¿åˆ°å½•å–é€šçŸ¥ä¹¦çš„é‚£ä¸€åˆ»ï¼Œæˆ‘å°±çŸ¥é“æœªæ¥çš„ä¸¤å¹´ï¼Œä¸€å®šæ˜¯å¥‹æ–—çš„ä¸¤å¹´ï¼Œä¸€å®šæ˜¯å……å®çš„ä¸¤å¹´ã€‚å¤šäºäº†å½“åˆåŠªåŠ›çš„æˆ‘ç»™äº†è‡ªå·±ç°åœ¨æœ‰å†™ä¸‹è¿™ç¯‡è‡´è°¢çš„æœºä¼šã€‚<br>æ—¢ç„¶æ˜¯è‡´è°¢ï¼Œè‡ªç„¶è¦æ„Ÿè°¢ä¸¤å¹´æ¥ä¸è®ºæ˜¯åœ¨å­¦ä¸šä¸Šã€å·¥ä½œä¸Šè¿˜æ˜¯ç”Ÿæ´»ä¸Šéƒ½ç»™äºˆæˆ‘å¾ˆå¤§å¸®åŠ©çš„æœå¿—å¼ºè€å¸ˆã€‚14å¹´7æœˆä»½ï¼Œè¿˜æœªæ­£å¼å¼€å­¦ï¼Œæœè€å¸ˆå°±æå‰è®©æˆ‘åˆ°å­¦æ ¡åŠ å…¥å°ç»„å·¥ä½œï¼Œå¹¶ç»™æˆ‘ä¸€ä¸ªå½“æ—¶å¾ˆæœ‰æŒ‘æˆ˜æ€§çš„å·¥ä½œâ€”â€”è®©æˆ‘ä¸ºå°ç»„é¡¹ç›®æ­å»ºç³»ç»ŸåŸå‹ã€‚å¤šäºäº†é‚£æ¬¡æœºä¼šè®©æˆ‘æœ‰å¹¸æ¥è§¦åˆ°äº†å¾ˆå¤šæ–°çš„æŠ€æœ¯ã€æ–°çš„æ€æƒ³å’Œæ–°çš„è§£å†³é—®é¢˜æ€è·¯ã€‚ç´§æ¥ç€ï¼Œ14å¹´8æœˆäº‘å—é²ç”¸åœ°éœ‡ï¼Œæœè€å¸ˆä¹Ÿæ˜¯åœ¨ç¬¬ä¸€æ—¶é—´æ´¾å¸ˆå…„å’Œæˆ‘å»æ°‘æ”¿éƒ¨å›½å®¶å‡ç¾ä¸­å¿ƒå‚åŠ åæ–¹æŠ—éœ‡æ•‘ç¾å·¥ä½œï¼Œæœè€å¸ˆè‡ªå·±ä¹Ÿæ˜¯èµ¶èµ´åœ°éœ‡ç°åœºï¼Œå·¥ä½œåœ¨æ•‘ç¾å‡ç¾ç¬¬ä¸€çº¿ã€‚é‚£æ®µæ—¶é—´ï¼Œæ¯å¤©çš„æ•°æ®å¤„ç†ã€ç³»ç»Ÿå±•ç¤ºã€å·¥ä½œæ±‡æŠ¥è®©äººæ—¶åˆ»éƒ½å¤„äºç´§å¼ çŠ¶æ€ï¼Œå¹¶ä¸”ç»å¸¸æ€§çš„åŠ ç­åˆ°å‡Œæ™¨ã€‚æ­£æ˜¯é‚£æ®µç»å†ï¼Œè®©æˆ‘åœ¨æœªæ¥çš„ä¸¤å¹´å†…èƒ½å¤Ÿè½»æ¾åº”å¯¹å­¦ä¹ å’Œå·¥ä½œå‹åŠ›ï¼Œä¹Ÿè®©æˆ‘æ›´åŠ æ¸…æ¥šåœ°è®¤è¯†åˆ°æœè€å¸ˆå¸¸è¯´çš„â€œè¦å®‰æ’å¥½æ—¶é—´â€çš„é‡è¦æ€§ã€‚æœè€å¸ˆä¹Ÿæ˜¯ä¸ªè§†é‡å¼€é˜”ã€è§å¤šè¯†å¹¿çš„å¯¼å¸ˆï¼Œä¸ä»…èƒ½å¤Ÿä¸ºé¡¹ç›®å¼€å‘æä¾›ç‹¬åˆ°çš„è§è§£ï¼Œè€Œä¸”ç»å¸¸èƒ½å¤Ÿç›´å‡»é—®é¢˜ç—›ç‚¹ï¼Œä¸ºæˆ‘åœ¨æŠ€æœ¯ä¸Šçš„æˆé•¿æä¾›äº†è®¸å¤šå¸®åŠ©ã€‚åœ¨è¿™é‡ŒåŒæ—¶ä¹Ÿè¦æ„Ÿè°¢å¼ è€å¸ˆã€æœ±è€å¸ˆï¼Œæ„Ÿè°¢ä»–ä»¬èƒ½å¤Ÿåœ¨ç™¾å¿™ä¹‹ä¸­æŠ½å‡ºæ—¶é—´å‚åŠ æˆ‘çš„å¼€é¢˜æŠ¥å‘Šï¼Œå¹¶ä¸ºæˆ‘çš„ç¡•å£«è®ºæ–‡æä¾›å®è´µæ„è§å’Œå»ºè®®ã€‚<br>è¯»ç ”æœŸé—´åœ¨ä¸€èµ·æ—¶é—´æœ€é•¿çš„å½“ç„¶æ˜¯vgeGroupçš„å°ä¼™ä¼´ä»¬ï¼Œæˆ‘ä»¬å­¦åœ¨ä¸€èµ·ã€ç©åœ¨ä¸€èµ·ï¼Œæ„Ÿè°¢ä½ ä»¬å’Œæˆ‘ä¸€èµ·æˆé•¿ã€‚åœ¨è¿™é‡Œï¼Œå°¤å…¶è¦æ„Ÿè°¢å’Œæˆ‘ä¸€èµ·åŠ å…¥å°ç»„çš„ä¸‰å“¥â€”â€”ç‹ååŒå­¦ï¼Œå¥¹å’Œæˆ‘åŒæ˜¯ä¸“ç¡•ã€‚æ„Ÿè°¢å¥¹é™ªæˆ‘ä¸€èµ·åº¦è¿‡åœ¨äºŒéƒ¨ç ä»£ç çš„æ—¥å­ã€æ„Ÿè°¢å¥¹åœ¨å­¦ä¹ ä¸Šå¯¹æˆ‘æ— ç§çš„å¸®åŠ©ã€æ„Ÿè°¢å¥¹æ•™ä¼šæˆ‘ä¸å°‘wordå’Œpptçš„ä½¿ç”¨æŠ€å·§ï¼Œç¥ä½ ä»Šåçš„æ—¥å­æœ‰ä¹¦æœ‰èŒ¶æœ‰è¿œæ–¹ã€‚æ„Ÿè°¢ç¡•å§â€”â€”åˆ˜ç¡•åŒå­¦åœ¨æŠ€æœ¯ä¸Šå’Œç”Ÿæ´»ä¸Šå¯¹æˆ‘çš„å¸®åŠ©ï¼›æ„Ÿè°¢è€å¤§â€”â€”é¡¾æ·æ™”åŒå­¦é™ªæˆ‘ä¸€èµ·åœ¨åˆ€å¡”ä¸­æ‰¾åˆ°äº†å¿™ç¢Œæ—¥å­ä¸­ç¼ºå¤±çš„æ¿€æƒ…ï¼›æ„Ÿè°¢ç³å§â€”â€”é€¯ç³åŒå­¦èƒ½å¤Ÿåƒä¸€ä¸ªå¤§å§å§ä¸€æ ·ç»™å¤§å®¶æä¾›å„ç§å¸®åŠ©ï¼Œç¥ä½ ä»¬å¤§å®¶èƒ½å¤Ÿæ—©æ—¥æ‹¿åˆ°ç†æƒ³çš„offerã€‚æ„Ÿè°¢ä»‡æ—é¥å¸ˆå…„ï¼Œæ˜¯ä»–è®©æˆ‘æ¥è§¦åˆ°ç¡•å£«æœŸé—´çš„ä¸»è¦ç ”ç©¶å†…å®¹ï¼Œå¹¶ä¸”è€å¿ƒåœ°ç»™æˆ‘è®²è§£å„ä¸ªæŠ€æœ¯å®ç°ç»†èŠ‚ã€æ•™æˆ‘ç”»å‡ºæ¼‚äº®çš„Visioå›¾â€¦å¦å¤–è¿˜è¦æ„Ÿè°¢æˆ‘çš„ä¸€ä¼—å¸ˆå¼Ÿå¸ˆå¦¹ï¼Œæ„Ÿè°¢å¸ˆå¼Ÿæˆ´è¿æ³¢èƒ½å¤Ÿä¸»åŠ¨æ‰¿æ‹…èµ·æˆ‘çš„å¤§é‡é—ç•™å·¥ä½œï¼Œä»»åŠ³ä»»æ€¨ï¼Œå…¢å…¢ä¸šä¸šï¼›æ„Ÿè°¢å¸ˆå¦¹éŸ©é¢–é¢–åœ¨å­¦ä¹ ä¸Šå’Œç”Ÿæ´»ä¸Šç»™æˆ‘æä¾›çš„å¸®åŠ©ï¼›æ„Ÿè°¢å¸ˆå¦¹æé™ï¼Œå¥¹è®©æˆ‘å­¦ä¼šæ›´å¥½çš„å’Œå‹åŠ›ç›¸å¤„ã€æ›´å¥½çš„æ§åˆ¶è‡ªå·±çš„æƒ…ç»ªï¼›æ„Ÿè°¢å¸ˆå¦¹é»„çˆ½ï¼Œå¥¹è®©æˆ‘çœ‹åˆ°äº†åšæŒå¯¹äºä¸€ä¸ªäººçš„é‡è¦æ€§ï¼›æ„Ÿè°¢å¸ˆå¦¹åˆ˜é›…ç‰åˆ†æ‹…äº†æˆ‘çš„ä¸€å¤§éƒ¨åˆ†å·¥ä½œã€‚åœ¨è¿™é‡Œæ„¿ä½ ä»¬èƒ½å¤Ÿçæƒœåœ¨vgeGroupçš„æ—¥å­ï¼ŒæŠŠæ¯å¤©éƒ½è¿‡å¾—ç²¾å½©ï¼Œæ¯ä¸€æ­¥éƒ½èµ°çš„è¸å®ã€‚<br>è¯»ç ”ä¸¤å¹´ï¼Œåœ¨æ ¡æœŸé—´ï¼Œé™¤äº†ä¸Šè¾¹è¯´çš„è¿™äº›äººï¼Œé™ªæˆ‘æœ€å¤šçš„å°±æ˜¯æœºæˆ¿é‚£å°æ¯å¤©è½°è½°ä½œå“çš„æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ç”±å®ƒæˆ‘æ‰å¼€å§‹æ¥è§¦åˆ°ç¥å¥‡çš„Linuxã€‚æœåŠ¡å™¨ä¸Šæœ‰æˆ‘éƒ¨ç½²çš„nginx\php\luajit\mongodb\redis\goaccess\webbench\hexoï¼Œæœ‰æˆ‘è‡ªå·±é…ç½®çš„è·¯ç”±è¡¨ï¼Œæœ‰æˆ‘ç å‡ºæ¥çš„ç“¦ç‰‡è°ƒåº¦é€»è¾‘è„šæœ¬ï¼Œæœ‰è®°å½•æˆ‘å®éªŒç»“æœçš„ç»Ÿè®¡å›¾è¡¨ã€‚å› æ­¤ï¼Œæˆ‘ä¹Ÿå¿…é¡»æ„Ÿè°¢æœºæˆ¿çš„æœåŠ¡å™¨ï¼Œä¸€ä¸ªå¿ å®å¯é çš„ä¼™ä¼´ã€‚ç¥ä½ èƒ½å¤Ÿæ—©æ—¥é‡åˆ°ä¸‹ä¸€ä¸ªæ„¿æ„å’Œä½ ç©è€çš„å°ä¼™ä¼´ã€‚<br>è·ç¦»æ¯•ä¸šçš„æ—¥å­è¶Šæ¥è¶Šè¿‘ï¼Œç§’é’ˆã€åˆ†é’ˆã€æ—¶é’ˆä¸åœåœ¨èµ°ï¼Œå›é¡¾è¿™åŠå¹´ï¼Œç¬¬ä¸€æ¬¡æ„Ÿè§‰åˆ°æ—¶é—´æ˜¯å¦‚æ­¤çè´µã€‚æ—©ä¸Šèµ·åºŠå­¦ä¹ æ–°çŸ¥è¯†ã€çœ‹è®ºæ–‡ã€å†™è®ºæ–‡ï¼Œä¸‹åˆå­¦è½¦ï¼Œæ™šä¸Šçœ‹å„ç§ä»£ç ã€debugã€åšå®éªŒï¼›ç¬¬ä¸€æ¬¡æ„Ÿè§‰ç”Ÿæ´»è¿™ä¹ˆå……å®ï¼Œçœ‹äº†å‡¯æ–‡å‡¯åˆ©çš„ã€Šå¤±æ§ã€‹è®©æˆ‘å¯¹ç°ä»Šè®¡ç®—æœºä¹ƒè‡³æ•´ä¸ªä¸–ç•Œçš„å‘å±•æœ‰äº†ä¸åŒä»¥å¾€çš„çœ‹æ³•ï¼›çœ‹äº†ã€Šå›¾è§£httpã€‹ã€ã€Šwiresharkæ•°æ®åŒ…åˆ†æå®æˆ˜ã€‹è®©æˆ‘å¯¹tcp/ipçš„åŸç†æœ‰äº†æ›´æ·±å…¥çš„ç†è§£ï¼Œå¹¶ä¸”ä¹Ÿå­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨æŠ“åŒ…å·¥å…·æŠ“å–è‡ªå·±éœ€è¦çš„ä¿¡æ¯ï¼›çœ‹äº†ã€Šç¬¨åŠæ³•å­¦pythonã€‹ã€ã€ŠHead first Pythonã€‹è®©æˆ‘å¯¹ä»°æ…•å·²ä¹…çš„pythonæ›´æ˜¯ç€è¿·ï¼Œè‡ªå·±ä¹Ÿå°è¯•å…»äº†å‡ åªçˆ¬è™«ï¼Œå°è¯•ç”¨flaskæ­å»ºç½‘é¡µï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå‰ç«¯è¿™ä¸ªæ–°ä¸–ç•Œçš„å¤§é—¨ä¹Ÿè¢«æˆ‘å¼€å¯ï¼Œçœ‹æ¥æƒ³è¦æˆä¸ºä¸€ä¸ªçœŸæ­£çš„å…¨æ ˆå¼€å‘è€…è¿˜æœ‰å¾ˆé•¿çš„è·¯éœ€è¦èµ°ï¼›åœ¨å¤§ç¥Jerry Quåšå®¢çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä¹Ÿå°†è‡ªå·±çš„åšå®¢å‡çº§åˆ°äº†http2.0ã€‚è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘åªæ˜¯æƒ³è¦æ„Ÿè°¢ä¸€ä¸‹è‡ªå·±ï¼Œæ²¡æœ‰è¾œè´Ÿè‡ªå·±çš„é’æ˜¥ï¼Œæ²¡æœ‰å¿˜è®°è‡ªå·±çš„åˆå¿ƒã€‚<br>åœ¨è¿™æ¿€åŠ¨äººå¿ƒçš„å¤œé‡Œï¼Œè‡´è°¢é‡Œè‡ªç„¶å°‘ä¸äº†è‡ªå·±çš„çˆ¶æ¯ï¼Œæ„Ÿè°¢ä½ ä»¬å«è¾›èŒ¹è‹¦äºŒåä½™è½½ï¼Œæ„Ÿè°¢ä½ ä»¬ä¸€è·¯å¯¹æˆ‘æ‚‰å¿ƒç…§æ–™ï¼Œæ„Ÿè°¢ä½ ä»¬å¯¹æˆ‘åšå®šä¸ç§»çš„æ”¯æŒã€‚æ­£æ˜¯ä½ ä»¬ï¼Œè®©æˆ‘åœ¨é‡åˆ°è‹¦éš¾æ—¶ä¸ä½å¤´ã€ç»å†ç»æœ›æ—¶çœ‹åˆ°å¸Œæœ›ï¼Œä½ ä»¬èº«ä¸Šçš„æ­£èƒ½é‡è®©æˆ‘åˆ‡èº«ä½“ä¼šåˆ°çŸ¥è€»è€Œåå‹‡å¹¶ä¸”æ— æ—¶ä¸åˆ»æ¿€åŠ±ç€æˆ‘åŠªåŠ›è¿‡å¥½æ¯ä¸€å¤©ï¼›æ­£æ˜¯ä½ ä»¬ï¼Œèƒ½å¤ŸçœŸå¿ƒåˆ†äº«æˆ‘æˆåŠŸæ—¶å€™çš„å–œæ‚¦ï¼Œä½ ä»¬çš„é€†è€³å¿ è¨€ã€è°†è°†æ•™è¯²è®©æˆ‘æˆ’éª„æˆ’èºã€å® è¾±ä¸æƒŠã€‚<br>å›æƒ³ä¸¤å¹´å‰ï¼Œä¸€ä½åŒå­¦åœ¨æ¯•ä¸šå­£æ›¾ç»è¯´è¿‡çš„ä¸€å¥è¯â€œå½“çª—å¤–æ ‘å½±å©†å¨‘ï¼Œä¾¿æ˜¯æˆ‘ä»¬ç¦»å¼€çš„æ—¶å€™â€ï¼Œæˆ‘ä»¬éšç€é£˜é›¶çš„æ ‘å½±ç¦»å»ï¼Œè¿½é€è‡ªå·±å¿ƒä¸­çš„æ¢¦æƒ³ï¼Œå»å®ç°è‡ªå·±çš„ä»·å€¼ï¼Œä¸ºæ”¹å˜è¿™ä¸ªä¸–ç•Œåšå‡ºè‡ªå·±çš„è´¡çŒ®ã€‚å½“ç„¶ï¼Œä¸è¦å¿˜äº†ï¼Œæ„Ÿè°¢æ²¿è·¯æ‰€æœ‰é‡åˆ°çš„äººå’Œäº‹ã€‚</p>
<p>2016å¹´4æœˆ22æ—¥å‡Œæ™¨<br>æ­¦æ±‰å¤§å­¦ä¿¡æ¯å­¦éƒ¨</p>
]]></content>
      
        <categories>
            
            <category> å¿ƒæƒ…æ–‡å­— </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Pythonå­¦ä¹ ]]></title>
      <url>/2016/04/06/0406/</url>
      <content type="html"><![CDATA[<p>åˆæ˜¯ä¸€ä¸ªé›·é›¨äº¤åŠ çš„å¤œæ™šï¼Œä¸çŸ¥é“ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹å–œæ¬¢ä¸Šäº†è¿™ç§å¤©æ°”ã€‚<br>å‰æ®µæ—¶é—´ä¸€ç›´åœ¨ç ”ç©¶Pythonçš„ä¸€ä¸ªHTTP2.0å®¢æˆ·ç«¯<a href="https://github.com/Lukasa/hyper" target="_blank" rel="external">Hyper</a>ï¼Œæ²¡æƒ³åˆ°ç«Ÿå–œæ¬¢ä¸Šäº†Pythonã€‚è¿™å‡ å¤©ä¹Ÿæ˜¯æŒ¤æ—¶é—´å­¦ä¹ ï¼Œçœ‹äº†<a href="https://book.douban.com/subject/26264642/" target="_blank" rel="external">ã€Šç¬¨åŠæ³•å­¦Pythonã€‹</a>å’Œ<a href="https://book.douban.com/subject/5310233/" target="_blank" rel="external">ã€ŠHead First Pythonã€‹</a>ä¹‹åï¼Œæƒ³å°±ä»çˆ¬è™«å¼€å§‹å®è·µä¸€æŠŠã€‚<br><a id="more"></a><br>åœ¨å¤šæ¬¡å°è¯•æŠ“å–ç½‘é¡µå†…å®¹ä¹‹åï¼Œå‘ç°éœ€è¦å­¦çš„ä¸œè¥¿è¿˜æŒºå¤šï¼ŒPythonåŸºç¡€çš„åº“urllibã€requestsè¿™äº›ï¼Œå¦å¤–è¿™æ¬¡å®è·µå‘ç°æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯ååˆ†é‡è¦ã€‚éœ€è¦å¤šåŠ åŠªåŠ›æŒæ¡æ‰æ˜¯ã€‚<br>åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œä¸»è¦å­¦ä¼šäº†ä½¿ç”¨æµè§ˆå™¨Cookieã€è®¾ç½®è¯·æ±‚Headerã€éšæœºæ›´æ¢Proxyhostè¿™äº›ä¸œè¥¿æ¥å°†çˆ¬è™«ä¼ªè£…ä¸ºæµè§ˆå™¨ã€‚ä¸‹é¢å°±ç›´æ¥æ”¾ä¸Šé€šç”¨æ€§æ¯”è¾ƒå¼ºç‚¹çš„ä»£ç å§ã€‚</p>
<h2 id="è·å–ä»£ç†IP"><a href="#è·å–ä»£ç†IP" class="headerlink" title="è·å–ä»£ç†IP"></a>è·å–ä»£ç†IP</h2><p>é€šè¿‡<a href="http://www.xicidaili.com" target="_blank" rel="external">http://www.xicidaili.com</a>è¿™ä¸ªç½‘ç«™å¯ä»¥å®æ—¶è·å–åˆ°å¯ç”¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€å’Œç«¯å£ï¼Œå°†å…¶åŠ å…¥åˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™é‡Œæˆ‘æ˜¯ç›´æ¥æŠŠä»–æ”¾åœ¨Redisçš„é˜Ÿåˆ—ä¸­ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">#-*- coding: UTF-8 -*- </div><div class="line">import urllib2</div><div class="line">import redis</div><div class="line">from BeautifulSoup import BeautifulSoup</div><div class="line">class Proxy_queue:</div><div class="line">    def __init__(self, addr, p):</div><div class="line">        print &quot;é“¾æ¥æ•°æ®åº“&quot;</div><div class="line">        self.r = redis.StrictRedis(host=addr,port=int(p),db=0)</div><div class="line">        self.listname=&quot;proxylist&quot;</div><div class="line">    </div><div class="line"></div><div class="line">    def set_proxy(self):</div><div class="line">        for page in range(1,10):</div><div class="line">            print page</div><div class="line">            url = &apos;http://www.xicidaili.com/nn/%s&apos; %page</div><div class="line">            user_agent = &quot;Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.134 Safari/537.36&quot;</div><div class="line">            request = urllib2.Request(url)</div><div class="line">            request.add_header(&quot;User-Agent&quot;, user_agent)</div><div class="line">            content = urllib2.urlopen(request)</div><div class="line">            soup = BeautifulSoup(content)</div><div class="line">            trs = soup.find(&apos;table&apos;, &#123;&quot;id&quot;:&quot;ip_list&quot;&#125;).findAll(&apos;tr&apos;)</div><div class="line">            for tr in trs[1:]:</div><div class="line">                tds = tr.findAll(&apos;td&apos;)</div><div class="line">                ip = tds[2].text.strip()</div><div class="line">                port = tds[3].text.strip()</div><div class="line">                protocol = tds[6].text.strip()</div><div class="line">                if protocol == &apos;HTTP&apos; or protocol == &apos;HTTPS&apos;:</div><div class="line">                    try:</div><div class="line">                        self.r.lpush(self.listname,ip+&quot;:&quot;+port)</div><div class="line">                        print &apos;%s://%s:%s&apos; % (protocol, ip, port)</div><div class="line">                    except Exception, e:</div><div class="line">                        print str(e)</div><div class="line">                    else:</div><div class="line">                        pass</div><div class="line">                    finally:</div><div class="line">                        pass</div><div class="line">    def get_proxy(self):</div><div class="line"></div><div class="line">        if self.r:</div><div class="line">            if self.r.llen(self.listname) == 0:</div><div class="line">                print &quot;å®æ—¶è·å–æœ€æ–°ä»£ç†ï¼Œè¯·ç¨å......&quot;</div><div class="line">                self.set_proxy()</div><div class="line">                print &quot;å®Œæˆæœ€æ–°ä»£ç†çš„çˆ¬å–ï¼&quot;</div><div class="line">            return self.r.rpop(self.listname)</div></pre></td></tr></table></figure></p>
<h2 id="å®æ—¶æ¶ˆè´¹Proxy"><a href="#å®æ—¶æ¶ˆè´¹Proxy" class="headerlink" title="å®æ—¶æ¶ˆè´¹Proxy"></a>å®æ—¶æ¶ˆè´¹Proxy</h2><p>é€šè¿‡ä¸Šè¾¹çš„æ–¹æ³•è·å–åˆ°çš„ä»£ç†æœåŠ¡å™¨ï¼Œæš‚æ—¶å­˜æ”¾åœ¨Redisé˜Ÿåˆ—ä¸­ï¼Œåœ¨ç”¨çš„æ—¶å€™å¯ä»¥é€šè¿‡ä¸‹è¾¹çš„æ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">#encoding=utf8</div><div class="line">import urllib</div><div class="line">import socket</div><div class="line">from proxy_set import Proxy_queue</div><div class="line">import sys</div><div class="line">default_encoding = &apos;utf-8&apos;</div><div class="line">if sys.getdefaultencoding() != default_encoding:</div><div class="line">    reload(sys)</div><div class="line">    sys.setdefaultencoding(default_encoding)</div><div class="line"></div><div class="line"></div><div class="line">socket.setdefaulttimeout(3)</div><div class="line">url = &quot;http://ip.chinaz.com/getip.aspx&quot;</div><div class="line"></div><div class="line">oknum=1</div><div class="line">try:</div><div class="line">    queue = Proxy_queue(&quot;ip&quot;,port)</div><div class="line">except Exception, e:</div><div class="line">    print str(e)</div><div class="line">else:</div><div class="line">    pass</div><div class="line">finally:</div><div class="line">    pass</div><div class="line"></div><div class="line">if queue:</div><div class="line">    while True:</div><div class="line">        try:</div><div class="line">            proxy_host=&quot;http://&quot;+queue.get_proxy()</div><div class="line">            proxy=&#123;&quot;http&quot;:proxy_host&#125;</div><div class="line">            res = urllib.urlopen(url,proxies=proxy).read()</div><div class="line">            print str(oknum)+ res</div><div class="line">            oknum+=1</div><div class="line">        except Exception,e:</div><div class="line">            print proxy</div><div class="line">            print e</div><div class="line">            continue</div></pre></td></tr></table></figure></p>
<h2 id="è±†ç“£APIå®è·µ"><a href="#è±†ç“£APIå®è·µ" class="headerlink" title="è±†ç“£APIå®è·µ"></a>è±†ç“£APIå®è·µ</h2><p>é€šè¿‡<a href="https://developers.douban.com/wiki/?title=api_v2" target="_blank" rel="external">è±†ç“£å®˜æ–¹æä¾›çš„API</a>å¯ä»¥è·å–åˆ°å¾ˆå¤šä¿¡æ¯ï¼Œå¯ä»¥æ»¡è¶³ä¸ªäººå»ºç«™çš„éœ€æ±‚ï¼Œæˆ‘è‡ªå·±ä¹Ÿå°è¯•äº†ä¸€ä¸‹ï¼Œåˆ©ç”¨è¿™äº›APIè·å–ç”µå½±ã€å›¾ä¹¦å’ŒéŸ³ä¹åˆ†ç±»ä¿¡æ¯ï¼Œå¾—åˆ°çš„æ•°æ®éƒ½æ˜¯JSONæ ¼å¼çš„ï¼Œç›´æ¥æ”¾åœ¨MongoDBä¸­å¾ˆæ˜¯æ–¹ä¾¿ã€‚<br>è¿™éƒ¨åˆ†ä»£ç æˆ‘ç›´æ¥æ”¾åœ¨äº†æˆ‘çš„<a href="https://github.com/wangmengcn/DouBan_API_DEV" target="_blank" rel="external">Github</a>ä¸Šã€‚</p>
<h2 id="ä¸‹æ­¥è®¡åˆ’"><a href="#ä¸‹æ­¥è®¡åˆ’" class="headerlink" title="ä¸‹æ­¥è®¡åˆ’"></a>ä¸‹æ­¥è®¡åˆ’</h2><p>ç°åœ¨é€šè¿‡è±†ç“£APIåŸºæœ¬ä¸Šè·å–åˆ°äº†ç”µå½±ã€å›¾ä¹¦å’ŒéŸ³ä¹åˆ†ç±»ä¸»é¡µä¸Šç±»åˆ«çš„æ•°æ®ï¼Œä¸‹ä¸€æ­¥æ‰“ç®—ç ”ç©¶ä¸€ä¸‹Flaskæ¡†æ¶ï¼Œå®Œæˆä¸€ä¸ªå°ç½‘ç«™ï¼ŒæŠŠè¿™äº›æ•°æ®å½“åšåŸºç¡€æ•°æ®ç”¨èµ·æ¥ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Python </category>
            
        </categories>
        
        
        <tags>
            
            <tag> çˆ¬è™« DouBan </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[213]]></title>
      <url>/2016/03/25/0325/</url>
      <content type="html"><![CDATA[<p>å¿™é‡Œå·é—²å’ŒåŒå­¦ä»ç”µå½±é™¢çœ‹å®Œã€Šè™è ä¾ å¤§æˆ˜è¶…äººã€‹ï¼Œè§‚å½±å”¯ä¸€æ„Ÿå—å°±æ˜¯å¸Œæœ›å…­æœˆä»½çš„é‚£éƒ¨æœŸå¾…å·²ä¹…çš„ç”µå½±ä¸è¦åƒè¿™æ ·è®©äººå¤±æœ›ã€‚å›æ¥è·¯ä¸Šçœ‹åˆ°åˆšä»ä¸œè¾¹çˆ¬ä¸Šæ¥çš„ä¸€è½®åœ†æœˆï¼Œè¿˜è¯¯ä»¥ä¸ºæ˜¯è·¯ç¯ã€‚<br><a id="more"></a><br><img src="https://o3sw4xojp.qnssl.com/IMG_3187.JPG" alt="è·¯ç¯ä¸€æ ·çš„æœˆäº®"><br>åˆåˆ°äº†å‘¨äº”ï¼Œæ—¥å­è¿‡å¾—å¯çœŸå¿«ï¼Œæœ€è¿‘ä¸€æ®µæ—¶é—´éƒ½è¿‡å¾—æ¯”è¾ƒè‰°éš¾ï¼Œè®ºæ–‡ã€å·¥ä½œå’Œé©¾ç…§ä¸‰åº§å¤§å±±ä¹Ÿæ˜¯å‹å¾—å–˜ä¸è¿‡æ°”æ¥ã€‚æƒ³èµ·é«˜äºŒä¸‹åŠå­¦æœŸï¼Œç”±äºè¿‡å¹´çš„æ—¶å€™æœŸæœ«è€ƒè¯•æ²¡è€ƒå¥½ï¼Œè€çˆ¸è¿˜ä¸“é—¨ç»™æˆ‘å†™ä¿¡é¼“åŠ±æˆ‘ï¼Œå‘Šè¯‰æˆ‘æ˜¥æš–èŠ±å¼€çš„æ—¶å€™ï¼Œæœ€é€‚åˆæ’­ç§ï¼Œç°åœ¨çš„åŠªåŠ›æ‰èƒ½ä½“éªŒæ”¶è·çš„å–œæ‚¦ã€‚ä¸¤å¹´å‰çš„è¿™ä¸ªæ—¶å€™ï¼Œè‡ªå·±åªèº«æ¥åˆ°æ­¦æ±‰å‚åŠ ç ”ç©¶ç”Ÿå¤è¯•ï¼Œæˆ‘ç›¸ä¿¡é‚£ä¸ªæ—¶å€™çš„æˆ‘çœ¼ä¸­çš„å…‰æ¯”ç°åœ¨çš„äº®ã€‚æ°å¥½æ­¤æ—¶æ­¤åˆ»è±†ç“£FMé‡Œè¾¹ä¹Ÿæ’­ç€å­™ç‡•å§¿çš„ã€Šå°šå¥½çš„é’æ˜¥ã€‹ï¼Œæ˜¯æ—¶å€™åšå‡ºè°ƒæ•´ï¼Œè®©è¿™äº›è‡ªå·±è‚©ä¸Šçš„å‹åŠ›å˜ä¸ºåŠ¨åŠ›ã€‚<br>å’Œæ›´å¤šçš„äººäº¤è°ˆï¼Œçªç ´è‡ªå·±çš„å°åœˆå­ï¼›å’Œæ›´å¤šçš„äººè®¨è®ºï¼Œå¼€é˜”è‡ªå·±çš„æ€è·¯ï¼›å‘ä¼˜ç§€çš„äººå­¦ä¹ ï¼Œæ‰¿è®¤è‡ªå·±çš„ä¸è¶³ï¼Œå¹¶åŠªåŠ›åšåˆ°æ¦œæ ·ä»¬èƒ½å¤Ÿåšåˆ°çš„äº‹æƒ…ã€‚<br>çŸ¥é“è‡ªå·±çš„çŸ¥è¯†é¢ç‹­çª„ï¼Œå°±å»å¹¿æ³›çš„æ¶‰çŒä¸åŒé¢†åŸŸçš„å¤§ä½œï¼›çŸ¥é“ç„¦è™‘å¹¶ä¸èƒ½è§£å†³é—®é¢˜ï¼Œå°±èµ·èº«å¯»æ‰¾è§£å†³é—®é¢˜çš„åŠæ³•ï¼›çŸ¥é“ç¨‹åºæœ‰BUGï¼Œå°±å»æµ‹è¯•ã€ä¿®æ”¹å®Œå–„ç„¶åæäº¤ã€‚<br>ä¸èƒ½ç¡®å®šåšå®Œä¸€ä»¶äº‹æƒ…åæ˜¯å¦ä¼šåæ‚”ï¼Œé‚£å°±åªå»åšä¸€äº›ä¸ä¼šè®©è‡ªå·±åæ‚”çš„äº‹æƒ…ï¼›çŸ¥é“è‡ªå·±è¦åšä»€ä¹ˆäº‹æƒ…ï¼Œé¢å¯¹è´¨ç–‘å£°è¦ç¤¼è²Œçš„å›åº”æˆ–è€…ä¸å›åº”ï¼›åšä¸€ä¸ªè„šè¸å®åœ°çš„è¡ŒåŠ¨æ´¾ï¼Œå‘æ´»åœ¨æ¢¦é‡Œçš„è‡ªå·±è¯´å†è§ï¼</p>
]]></content>
      
        <categories>
            
            <category> å¿ƒæƒ…æ–‡å­— </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[LinuxåŸºç¡€çŸ¥è¯†]]></title>
      <url>/2016/03/17/0327/</url>
      <content type="html"><![CDATA[<p>æ€»ç»“ä¸€ä¸‹å¸¸ç”¨çš„Linuxç³»ç»ŸåŸºç¡€çŸ¥è¯†ç‚¹ã€‚<br><a id="more"></a></p>
<h1 id="Linux-å¯åŠ¨å¤§è‡´è¿‡ç¨‹"><a href="#Linux-å¯åŠ¨å¤§è‡´è¿‡ç¨‹" class="headerlink" title="Linux å¯åŠ¨å¤§è‡´è¿‡ç¨‹"></a>Linux å¯åŠ¨å¤§è‡´è¿‡ç¨‹</h1><ol>
<li>è®¡ç®—æœºé€šç”µä¹‹åï¼Œè¿›å…¥BIOSé˜¶æ®µï¼Œä¹‹åæ“ä½œç³»ç»Ÿæ¥ç®¡ç¡¬ä»¶ï¼Œé¦–å…ˆè¯»å…¥/bootç›®å½•ä¸‹çš„å†…æ ¸æ–‡ä»¶ã€‚</li>
<li>å†…æ ¸æ–‡ä»¶åŠ è½½ä¹‹åï¼Œå¼€å§‹è¿è¡Œç¬¬ä¸€ä¸ªç¨‹åº/sbin/initï¼Œè¿›è¡Œåˆå§‹æ¢ç³»ç»Ÿç¯å¢ƒï¼Œç”±äºinitæ˜¯ç¬¬ä¸€ä¸ªç¨‹åºï¼Œå®ƒçš„è¿›ç¨‹ç¼–å·ä¸º1ï¼Œå…¶ä»–æ‰€æœ‰è¿›ç¨‹éƒ½ä»å®ƒè¡ç”Ÿï¼Œéƒ½æ˜¯å®ƒçš„å­è¿›ç¨‹ã€‚</li>
<li>initæ ¹æ®â€œè¿è¡Œçº§åˆ«â€ç¡®å®šè¦è¿è¡Œå“ªäº›ç¨‹åºï¼ŒLinuxé¢„ç½®å…¶ä¸­è¿è¡Œçº§åˆ«ï¼ˆ0-6ï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ0æ˜¯å…³æœºï¼Œ1æ˜¯å•ç”¨æˆ·æ¨¡å¼ï¼Œ6æ˜¯é‡å¯ï¼Œæ ¹æ®å‘è¡Œç‰ˆä¸åŒ2-5å¯¹åº”çš„è¿è¡Œçº§åˆ«ä¹Ÿæœ‰æ‰€ä¸åŒã€‚initè¿›ç¨‹é¦–å…ˆè¯»å–æ–‡ä»¶/etc/inittabï¼Œå®ƒæ˜¯è¿è¡Œçº§åˆ«çš„è®¾ç½®æ–‡ä»¶ã€‚è€Œæ¯ä¸ªè¿è¡Œçº§åˆ«å¯¹åº”çš„ç¨‹åºåœ¨/etcç›®å½•ä¸‹ï¼ŒæŒ‡å®šè¦åŠ è½½çš„ç¨‹åºã€‚</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">l0:0:wait:/etc/rc.d/rc 0</div><div class="line">l1:1:wait:/etc/rc.d/rc 1</div><div class="line">l2:2:wait:/etc/rc.d/rc 2</div><div class="line">l3:3:wait:/etc/rc.d/rc 3</div><div class="line">l4:4:wait:/etc/rc.d/rc 4</div><div class="line">l5:5:wait:/etc/rc.d/rc 5</div><div class="line">l6:6:wait:/etc/rc.d/rc 6</div></pre></td></tr></table></figure>
<p>ä¾‹å¦‚æ‰“å¼€rc3.dæ–‡ä»¶å¤¹ï¼Œçœ‹çœ‹é‡Œè¾¹éƒ½æœ‰äº›ä»€ä¹ˆ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">lrwxrwxrwx 1 root root 22 Dec  9  2013 K02avahi-daemon -&gt; ../init.d/avahi-daemon</div><div class="line">lrwxrwxrwx 1 root root 24 Dec  9  2013 K02avahi-dnsconfd -&gt; ../init.d/avahi-dnsconfd</div><div class="line">lrwxrwxrwx 1 root root 19 Dec  8 11:25 K05saslauthd -&gt; ../init.d/saslauthd</div><div class="line">lrwxrwxrwx 1 root root 13 Dec  9  2013 K15gpm -&gt; ../init.d/gpm</div><div class="line">lrwxrwxrwx 1 root root 18 Dec  3 11:19 K15svnserve -&gt; ../init.d/svnserve</div><div class="line">......</div><div class="line">lrwxrwxrwx 1 root root 17 Dec  9  2013 S03sysstat -&gt; ../init.d/sysstat</div><div class="line">lrwxrwxrwx 1 root root 17 Dec  9  2013 S10network -&gt; ../init.d/network</div><div class="line">lrwxrwxrwx 1 root root 16 Dec  9  2013 S12syslog -&gt; ../init.d/syslog</div><div class="line">lrwxrwxrwx 1 root root 19 Dec  3 11:19 S26haldaemon -&gt; ../init.d/haldaemon</div><div class="line">......</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œè¾¹éƒ½æ˜¯ä¸€äº›ç¨‹åºçš„è¿æ¥ï¼ŒKå¼€å¤´çš„ä»£è¡¨KILLï¼ˆå…³é—­ï¼‰ï¼ŒSå¼€å¤´ä»£è¡¨Startï¼Œç¬¬ä¸€ä¸ªå­—æ¯ä¹‹åçš„æ•°å­—ä»£è¡¨ç¨‹åºæ‰§è¡Œé¡ºåºï¼Œæ•°å­—è¶Šå°è¡¨ç¤ºæ‰§è¡Œä¼˜å…ˆçº§è¾ƒé«˜ã€‚</p>
<ol>
<li>åŠ è½½å¼€æœºå¯åŠ¨ç¨‹åºï¼Œä¸Šè¾¹rc.dæ–‡ä»¶å¤¹ä¸­çš„é“¾æ¥æ–‡ä»¶æŒ‡å‘å¦å¤–ä¸€ä¸ªç›®å½•/etc/init.dï¼Œè¿™é‡Œè¾¹åˆ™æ˜¯çœŸæ­£å¯åŠ¨çš„è„šæœ¬ï¼Œinitè¿›ç¨‹é€ä¸€åŠ è½½å¼€æœºå¯åŠ¨ç¨‹åºï¼Œå…¶å®å°±æ˜¯è¿è¡Œè¿™ä¸ªç›®å½•ä¸­çš„å¯åŠ¨è„šæœ¬ã€‚</li>
<li>ç”¨æˆ·ç™»å½•ï¼Œå¼€æœºå¯åŠ¨ç¨‹åºåŠ è½½å®Œæˆä¹‹åï¼Œå°±è¦è®©ç”¨æˆ·ç™»å½•äº†ã€‚ä¸€èˆ¬æ¥è¯´ç™»å½•æ–¹å¼æœ‰ä¸‰ç§ï¼šå‘½ä»¤è¡Œç™»å½•ï¼Œsshç™»å½•ï¼Œå›¾å½¢ç•Œé¢ç™»å½•ã€‚</li>
<li>è¿›å…¥login shellï¼Œç”¨æˆ·ç™»å½•æ—¶ä»£å¼€çš„shellå°±å«åšlogin shellã€‚å®ŒæˆLinuxå¯åŠ¨è¿‡ç¨‹ã€‚</li>
</ol>
<h1 id="Linux-ç³»ç»Ÿç»„æˆ"><a href="#Linux-ç³»ç»Ÿç»„æˆ" class="headerlink" title="Linux ç³»ç»Ÿç»„æˆ"></a>Linux ç³»ç»Ÿç»„æˆ</h1><p>Linuxæ“ä½œç³»ç»Ÿç”±Linuxå†…æ ¸å’Œå„ç§å¤–å›´ç¨‹åºç»„æˆã€‚Linuxå†…æ ¸æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è½¯ä»¶ç¨‹åºï¼Œç”¨äºå®ç°CPUå’Œå†…å­˜åˆ†é…ã€è¿›ç¨‹è°ƒèŠ‚ã€è®¾å¤‡é©±åŠ¨ç­‰æ ¸å¿ƒæ“ä½œï¼Œä»¥é¢å‘ç¡¬ä»¶ä¸ºä¸»ã€‚å¤–å›´ç¨‹åºåŒ…æ‹¬ç”¨æˆ·æŒ‡å®šçš„è§£æå™¨ã€ç½‘ç»œæœåŠ¡ç¨‹åºã€å›¾å½¢æ¡Œé¢ç¨‹åºç­‰å„ç§åº”ç”¨å‹è½¯ä»¶ç¨‹åºï¼Œä»¥é¢å‘ç”¨æˆ·ä¸ºä¸»ã€‚<br>Linuxå†…æ ¸æ˜¯æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒï¼Œä¸»è¦åˆ†ä¸ºå‡ éƒ¨åˆ†ç»„æˆï¼šå†…å­˜ç®¡ç†ã€è¿›ç¨‹ç®¡ç†ã€è®¾å¤‡é©±åŠ¨ç¨‹åºã€æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œç®¡ç†ç­‰ã€‚<br>è¿™é‡Œä¸å¾—ä¸æä¸€ä¸‹Linuxç³»ç»Ÿçš„å‘è¡Œç‰ˆæœ¬ï¼Œç”±äºLinuxç³»ç»Ÿå†…æ ¸æ˜¯ä¸ªå¼€æºè½¯ä»¶ï¼Œä»»ä½•å…¬å¸æˆ–è€…ä¸ªäººéƒ½å¯ä»¥å°†Linuxå†…æ ¸å’Œè‡ªç”±è½¯ä»¶æ‰“åŒ…æˆä¸€ä¸ªå®Œæ•´çš„Linuxæ“ä½œç³»ç»Ÿã€‚ä¸»æµçš„Linuxåˆ†æ”¯æœ‰ï¼šRed Hatç³»åˆ—ï¼ˆRed Hatä¼ä¸šç‰ˆã€Fedoraç¤¾åŒºç‰ˆã€CentOSç¤¾åŒºç‰ˆï¼‰ï¼ŒSuseç³»åˆ—ï¼ŒDebianç³»åˆ—ï¼ˆä»¥Ubuntuä¸ºä»£è¡¨ï¼‰</p>
<h1 id="Linux-ç³»ç»Ÿå°çŸ¥è¯†ç‚¹"><a href="#Linux-ç³»ç»Ÿå°çŸ¥è¯†ç‚¹" class="headerlink" title="Linux ç³»ç»Ÿå°çŸ¥è¯†ç‚¹"></a>Linux ç³»ç»Ÿå°çŸ¥è¯†ç‚¹</h1><ul>
<li><p>è½¯ç¡¬é“¾æ¥<br>åœ¨Linuxç³»ç»Ÿä¸­ä½¿ç”¨lnå‘½ä»¤å¯ä»¥å¯¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶å»ºç«‹ä¸€ä¸ªæ–°çš„é“¾æ¥ï¼Œè€Œä¸å¤åˆ¶æ–‡ä»¶çš„å†…å®¹ã€‚é“¾æ¥æœ‰è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¹‹åˆ†ï¼Œè½¯é“¾æ¥åˆå«åšç¬¦å·é“¾æ¥ã€‚ä»–ä»¬çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼šç¡¬é“¾æ¥ï¼Œæ˜¯ç»™æ–‡ä»¶ä¸€ä¸ªå‰¯æœ¬ï¼Œæºæ–‡ä»¶åå’Œé“¾æ¥æ–‡ä»¶åéƒ½æŒ‡å‘ç›¸åŒçš„ç‰©ç†åœ°å€ã€‚ç›®å½•ä¸èƒ½æœ‰ç¡¬é“¾æ¥ï¼Œç¡¬é“¾æ¥ä¸èƒ½å¤Ÿè·¨è¶Šæ–‡ä»¶ç³»ç»Ÿï¼Œä¿®æ”¹åŸæ–‡ä»¶æˆ–è€…ç¡¬é“¾æ¥éƒ½ä¼šå½±å“åˆ°å¯¹æ–¹ï¼Œå¦‚æœåˆ é™¤å…¶ä¸­ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªä¸ä¼šå—åˆ°å½±å“ï¼Œå¯ä»¥é˜²æ­¢ä¸å¿…è¦çš„è¯¯åˆ ï¼›è½¯é“¾æ¥ï¼Œç”¨ln -så‘½ä»¤å»ºç«‹æ–‡ä»¶çš„è½¯é“¾æ¥ï¼Œå®ƒæ˜¯linuxç³»ç»Ÿç‰¹æ®Šæ–‡ä»¶çš„ä¸€ç§ï¼Œä½œä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒçš„æ•°æ®æ˜¯å®ƒæ‰€è¿æ¥æ–‡ä»¶çš„è·¯å¾„åï¼Œç±»ä¼¼äºwindowsä¸­çš„å¿«æ·æ–¹å¼ï¼Œåˆ é™¤è½¯é“¾æ¥æ˜¯ä¸ä¼šå½±å“åˆ°åŸæ–‡ä»¶çš„ã€‚</p>
</li>
<li><p>åƒµå°¸è¿›ç¨‹<br>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹ç»“æŸäº†ï¼Œä½†æ˜¯ä»–çš„çˆ¶è¿›ç¨‹æ²¡æœ‰ç­‰å¾…ï¼ˆè°ƒç”¨wait/waitpidï¼‰ï¼Œé‚£ä¹ˆå®ƒå°†å˜æˆä¸ºä¸€ä¸ªåƒµå°¸è¿›ç¨‹ã€‚é€šè¿‡å‘½ä»¤æ¥æŸ¥çœ‹ç³»ç»Ÿä¸­å­˜åœ¨çš„åƒµå°¸è¿›ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">é€šè¿‡topå¯ä»¥çœ‹å‡ºå½“å‰ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨åƒµå°¸è¿›ç¨‹</div><div class="line">top - 23:12:22 up 28 min,  4 users,  load average: 0.02, 0.07, 0.11</div><div class="line">Tasks: 414 total,   2 running, 412 sleeping,   0 stopped,   0 zombie</div><div class="line">%Cpu(s):  0.0 us,  0.3 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</div><div class="line">KiB Mem :  1003164 total,   256540 free,   568848 used,   177776 buff/cache</div><div class="line">KiB Swap:  2097148 total,  1978136 free,   119012 used.   262808 avail Mem</div><div class="line">å…¶ä¸­zombieå‰çš„æ•°å­—ï¼Œå¦‚æœå¤§äº0åˆ™è¡¨æ˜ç³»ç»Ÿå­˜åœ¨åƒµå°¸è¿›ç¨‹</div><div class="line">//-------åˆ†å‰²çº¿--------\\</div><div class="line">é€šè¿‡pså‘½ä»¤æŠŠåƒµå°¸æªå‡ºæ¥</div><div class="line">ps -ef | grep defunct    æˆ–è€…</div><div class="line">ps -A -ostat,ppid,pid,cmd | grep  -e &apos;^[Zz]â€™</div></pre></td></tr></table></figure>
</li>
</ul>
<p>åœ¨æ‰¾åˆ°åƒµå°¸è¿›ç¨‹ä¹‹åï¼Œé€šè¿‡å…¶pidä½¿ç”¨killå‘½ä»¤å°†å…¶æ€æ­»ï¼Œå¦‚æœæ€ä¸æ­»ï¼Œå¯ä»¥å…ˆå°†å…¶çˆ¶è¿›ç¨‹æ€æ­»ï¼Œçˆ¶è¿›ç¨‹æ­»ååƒµå°¸è¿›ç¨‹å˜ä¸ºâ€œå­¤å„¿è¿›ç¨‹â€ï¼Œè¿‡ç»§ç»™initè¿›ç¨‹ï¼Œinitè´Ÿè´£å¤„ç†åƒµå°¸è¿›ç¨‹ï¼Œå¹¶ä¸”å®ƒäº§ç”Ÿçš„æ‰€æœ‰åƒµå°¸è¿›ç¨‹ä¹Ÿä¼šéšç€æ¶ˆå¤±ã€‚</p>
<ul>
<li>æ–‡ä»¶æƒé™<br>1). åœ¨è¯´é“æ–‡ä»¶æƒé™ä¹‹å‰ï¼Œä¸å¾—ä¸æLinuxä¸­ç”¨æˆ·ä¸ç”¨æˆ·ç»„çš„æ¦‚å¿µã€‚Linuxæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿï¼Œå³ç³»ç»Ÿä¸Šå¯ä»¥å»ºç«‹å¤šä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”å¤šä¸ªç”¨æˆ·å¯ä»¥åœ¨åŒä¸€æ—¶é—´ç™»å½•åŒä¸€ä¸ªç³»ç»Ÿæ‰§è¡Œå„è‡ªä¸åŒçš„ä»»åŠ¡è€Œäº’ä¸å½±å“ã€‚Linuxæ­£æ˜¯é€šè¿‡ç”¨æˆ·å’Œç”¨æˆ·ç»„æƒé™çš„åˆ’åˆ†å’Œç®¡ç†æ¥å®ç°å¤šç”¨æˆ·å¤šä»»åŠ¡çš„è¿è¡Œæœºåˆ¶ã€‚<br>Linuxä¸‹ç”¨æˆ·æ—¶æ ¹æ®è§’è‰²å®šä¹‰çš„ï¼Œå…·ä½“åˆ†ä¸ºä¸‰ç§è§’è‰²ï¼šè¶…çº§ç”¨æˆ·ï¼Œæ‹¥æœ‰å¯¹ç³»ç»Ÿçš„æœ€é«˜ç®¡ç†æƒé™ï¼Œé»˜è®¤rootç”¨æˆ·ï¼›æ™®é€šç”¨æˆ·ï¼Œåªèƒ½å¯¹è‡ªå·±ç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡Œè®¿é—®å’Œä¿®æ”¹ï¼Œå…·æœ‰ç™»å½•ç³»ç»Ÿçš„æƒé™ï¼›è™šæ‹Ÿç”¨æˆ·ï¼šæ­¤ç±»ç”¨æˆ·ç‰¹ç‚¹æ˜¯ä¸èƒ½è¿›è¡Œç³»ç»Ÿç™»å½•ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ç³»ç»Ÿç®¡ç†ï¼Œæ¯”å¦‚nobodyç”¨æˆ·ã€‚<br>ç”¨æˆ·ç»„æ˜¯å…·æœ‰ç›¸åŒç‰¹å¾ç”¨æˆ·çš„é€»è¾‘é›†åˆï¼Œå®ƒèƒ½å¤Ÿå°†éœ€è¦ç›¸åŒæ“ä½œæƒé™çš„ç”¨æˆ·æ”¾åœ¨ä¸€ä¸ªç»„é‡Œï¼Œä»è€Œå¾ˆå¤§ç¨‹åº¦ä¸Šç®€åŒ–ç®¡ç†å·¥ä½œã€‚<br>ç”¨æˆ·å’Œç”¨æˆ·ç»„ä¹‹é—´çš„å…³ç³»å¯èƒ½æ˜¯ï¼šä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šã€å¤šå¯¹ä¸€ã€‚<br>ç”¨æˆ·å’Œç”¨æˆ·ç»„ç›¸å…³é…ç½®æ–‡ä»¶æœ‰è¿™äº›ï¼š/etc/passwdæ–‡ä»¶ï¼Œå®ƒè®°å½•äº†Linuxç³»ç»Ÿä¸­æ¯ä¸ªç”¨æˆ·çš„ä¸€äº›åŸºæœ¬å±æ€§ï¼Œå¹¶ä¸”å¯¹æ‰€æœ‰ç”¨æˆ·å¯è¯»ã€‚å…¶æ ¼å¼æ˜¯è¿™æ ·çš„ï¼šç”¨æˆ·åï¼šå£ä»¤ï¼šç”¨æˆ·æ ‡è¯†å·ï¼šç»„æ ‡è¯†å·ï¼šæ³¨é‡Šè¡Œæè¿°ï¼šä¸»ç›®å½•ï¼šé»˜è®¤shellï¼›/etc/shadowæ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ç”¨æˆ·å¯†ç ï¼Œåªæœ‰rootç”¨æˆ·æœ‰ç”¨è¯»æƒé™ï¼›/etc/groupæ–‡ä»¶ï¼Œç”¨æˆ·ç»„é…ç½®æ–‡ä»¶ï¼Œå­˜æ”¾ç”¨æˆ·ç»„ç›¸å…³ä¿¡æ¯ã€‚<br>ä¸ç”¨æˆ·å’Œç”¨æˆ·ç»„ç›¸å…³æ“ä½œçš„å‘½ä»¤ä¸»è¦æœ‰è¿™äº›ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">åˆ›å»ºç»„</div><div class="line">groupadd test  //å¢åŠ ä¸€ä¸ªtestç»„</div><div class="line">ä¿®æ”¹ç»„</div><div class="line">groupmod -n test1 test //å°†ç»„testæ”¹åä¸ºtest1</div><div class="line">åˆ é™¤ç»„</div><div class="line">groupdel test1	//å°†test1ç»„åˆ é™¤</div><div class="line">//-----------------------------------------//</div><div class="line">å¢åŠ ç”¨æˆ·</div><div class="line">useradd test 	//å¢åŠ ç”¨æˆ·test</div><div class="line">passwd test 	//åœ¨ä½¿ç”¨useraddä¹‹åéœ€è¦å¯¹å¢åŠ çš„ç”¨æˆ·æŒ‡æ˜å…¶ç™»å½•å¯†ç </div><div class="line">ä¿®æ”¹ç”¨æˆ·</div><div class="line">usermod -d /home/test -G test1 test 	//å°†ç”¨æˆ·testçš„ç™»å½•ç›®å½•æ”¹ä¸º/home/testï¼Œå¹¶ä½¿å…¶åŠ å…¥ç”¨æˆ·ç»„test1</div><div class="line">gpasswd -a test test2	//å°†ç”¨æˆ·teståŠ å…¥test2ç»„</div><div class="line">gpasswd -d test test2  	//å°†ç”¨æˆ·testä»test2ç»„ä¸­åˆ é™¤</div><div class="line">åˆ é™¤ç”¨æˆ·</div><div class="line">userdel test 			//åˆ é™¤ç”¨æˆ·test</div></pre></td></tr></table></figure>
</li>
</ul>
<p>2). ä»‹ç»å®Œç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼Œæ¥ä¸‹æ¥è¯´ä¸€ä¸‹Linuxä¸­æ–‡ä»¶æƒé™ã€‚åœ¨Linuxä¸­æ¯ä¸ªæ–‡ä»¶éƒ½å…·æœ‰Userï¼ŒGroupå’ŒOthersä¸‰ç§èº«ä»½çš„åŒºåˆ«ã€‚è¦æƒ³äº†è§£æ–‡ä»¶æƒé™ç›¸å…³çš„å†…å®¹ï¼Œéœ€è¦çŸ¥é“Linuxæ–‡ä»¶å±æ€§ï¼Œé€šè¿‡lså‘½ä»¤å¯ä»¥çœ‹åˆ°æ–‡ä»¶å±æ€§ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">total 88</div><div class="line">drwxr-xr-x  3 root root  4096 Mar 21 09:11 .</div><div class="line">drwxr-xr-x 12 root root  4096 Mar  5 20:56 ..</div><div class="line">-rw-r--r--  1 root root  1077 Dec  3 11:27 fastcgi.conf</div><div class="line">-rw-r--r--  1 root root  1077 Mar 10 00:58 fastcgi.conf.default</div><div class="line">-rw-r--r--  1 root root  1007 Dec  3 11:27 fastcgi_params</div><div class="line">-rw-r--r--  1 root root  1007 Mar 10 00:58 fastcgi_params.default</div><div class="line">-rw-r--r--  1 root root  2837 Mar 10 00:58 koi-utf</div><div class="line">-rw-r--r--  1 root root  2223 Mar 10 00:58 koi-win</div><div class="line">-rw-r--r--  1 root root  3957 Dec  3 11:27 mime.types</div><div class="line">-rw-r--r--  1 root root  3957 Mar 10 00:58 mime.types.default</div><div class="line">-rw-rw-rw-  1 root root  4037 Mar 10 10:44 nginx.conf</div><div class="line">-rw-r--r--  1 root root  3110 Jan 23 15:35 nginx.conf.bak</div><div class="line">-rw-r--r--  1 root root  2656 Mar 10 00:58 nginx.conf.default</div><div class="line">-rw-r--r--  1 root root 12288 Dec  3 21:00 .nginx.conf.swp</div><div class="line">-rw-r--r--  1 root root   636 Dec  3 11:27 scgi_params</div><div class="line">-rw-r--r--  1 root root   636 Mar 10 00:58 scgi_params.default</div><div class="line">drwxr-xr-x  2 root root  4096 Mar  6 13:39 ssl</div><div class="line">-rw-r--r--  1 root root   664 Dec  3 11:27 uwsgi_params</div><div class="line">-rw-r--r--  1 root root   664 Mar 10 00:58 uwsgi_params.default</div><div class="line">-rw-r--r--  1 root root  3610 Mar 10 00:58 win-utf</div><div class="line">[æƒé™] [è¿æ¥] [owner] [group] [size] [ä¿®æ”¹æ—¥æœŸ] [æ–‡ä»¶å]</div></pre></td></tr></table></figure></p>
<p>ç”±lså‘½ä»¤è¿”å›çš„å†…å®¹çœ‹ï¼Œç¬¬ä¸€ç»„ç”±10ä¸ªå­—ç¬¦æ„æˆï¼Œç”¨ä»¥è¡¨ç¤ºå…¶å¯¹åº”æ–‡ä»¶çš„æ–‡ä»¶ç±»å‹å’Œæƒé™ã€‚å…¶ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨è¿™ä¸ªæ–‡ä»¶æ˜¯ç›®å½•ï¼ˆdï¼‰ã€æ–‡ä»¶ï¼ˆ-ï¼‰ã€é“¾æ¥æ–‡ä»¶ï¼ˆlï¼‰ã€å¯ä¾›å­˜å‚¨çš„æ¥å£è®¾å¤‡ï¼ˆbï¼‰ç­‰ã€‚æ¥ä¸‹æ¥çš„9ä¸ªå­—ç¬¦ï¼Œæ¯ä¸‰ä¸ªæ„æˆä¸€ç»„ï¼Œåˆ†åˆ«ä»£è¡¨â€œæ–‡ä»¶æ‹¥æœ‰è€…çš„æƒé™â€ã€â€œåŒç¾¤ç»„çš„æƒé™â€ã€â€œå…¶ä»–éæœ¬ç¾¤ç»„çš„æƒé™â€ã€‚è€Œæ¯ä¸ªç»„ç”±rwxä¸‰ä¸ªå‚æ•°æ¥æ„æˆï¼Œåˆ†åˆ«ä»£è¡¨å¯è¯»ï¼ˆrï¼‰ã€å¯å†™ï¼ˆwï¼‰å’Œå¯æ‰§è¡Œï¼ˆxï¼‰ã€‚å¯¹äºæ–‡ä»¶æ¥è¯´ï¼Œrè¡¨ç¤ºå…·æœ‰è¯»å–æ–‡ä»¶å†…å®¹çš„æƒé™ï¼Œwæƒé™è¡¨ç¤ºå¯å†™å…¥ï¼Œè¡¨ç¤ºå…·æœ‰ç¼–è¾‘ã€æ–°å¢æˆ–æ˜¯ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼ˆä¸åŒ…æ‹¬åˆ é™¤ï¼‰ï¼Œxè¡¨ç¤ºå¯ä»¥æ‰§è¡Œæ­¤æ–‡ä»¶ï¼›å¯¹äºç›®å½•æ¥è¯´ï¼Œrè¡¨ç¤ºå¯ä»¥è¯»å–ç›®å½•ç»“æ„åˆ—è¡¨ï¼ŒæŸ¥è¯¢ç›®å½•ä¸‹çš„æ–‡ä»¶åæ•°æ®ï¼Œé€šè¿‡lsæ˜¾ç¤ºç›®å½•ä¸­çš„å†…å®¹ï¼Œwè¡¨ç¤ºå¯ä»¥æ”¹åŠ¨ç›®å½•ç»“æ„åˆ—è¡¨ï¼ˆå»ºç«‹æ–°çš„æ–‡ä»¶å’Œç›®å½•ï¼Œåˆ é™¤å·²ç»å­˜åœ¨çš„æ–‡ä»¶ä¸ç›®å½•ï¼Œé‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ï¼Œæˆ–è€…ä½¿ç”¨mvè¿›è¡Œæ–‡ä»¶çš„ç§»åŠ¨ï¼‰<br>ç¬¬äºŒç»„è¡¨ç¤ºæœ‰å¤šå°‘æ–‡æ¡£åè¿æ¥åˆ°æ­¤èŠ‚ç‚¹ï¼›<br>ç¬¬ä¸‰ç»„è¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•çš„æ‹¥æœ‰è€…ï¼›<br>ç¬¬å››ç»„è¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶çš„æ‰€å±æ—ç¾¤ï¼›<br>ç¬¬äº”ç»„è¡¨ç¤ºæ–‡ä»¶çš„å¤§å°ï¼Œé»˜è®¤å•ä½æ˜¯bytesï¼›<br>ç¬¬å…­ç»„ä¸ºæ­¤æ–‡ä»¶æˆ–è€…ç›®å½•å»ºæ¡£æ—¥æœŸæˆ–è€…æœ€è¿‘ä¿®æ”¹æ—¥æœŸï¼›<br>ç¬¬ä¸ƒæ ä¸ºæ–‡ä»¶åã€‚<br>3). æ”¹å˜æ–‡ä»¶å±æ€§ä¸æƒé™<br>é€šè¿‡chgrpå‘½ä»¤æ”¹å˜æ–‡ä»¶æ‰€å±ç¾¤ç»„ï¼Œchownå‘½ä»¤æ”¹å˜æ–‡ä»¶æ‹¥æœ‰è€…ï¼Œchmodå‘½ä»¤æ”¹å˜æ–‡ä»¶çš„æƒé™ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chgrp [-R] GROUP FILE	//-Rè¡¨ç¤ºé€’å½’ï¼Œå°†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¿®æ”¹å…¶ç»„åˆ« GROUP è¡¨ç¤ºè¦æ”¹å˜çš„ç›®æ ‡ FILEæ˜¯æ–‡ä»¶æˆ–è€…ç›®å½•</div><div class="line">chown [OPTION] OWNER:GROUP FILE		//æ”¹å˜æ–‡ä»¶æ‰€æœ‰è€…</div></pre></td></tr></table></figure></p>
<p>æ–‡ä»¶æƒé™çš„æ”¹å˜ä½¿ç”¨chmodå‘½ä»¤ï¼Œä½†æ˜¯æƒé™çš„è®¾ç½®æ–¹å¼æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«å¯ä»¥ä½¿ç”¨æ•°å­—æˆ–è€…ç¬¦å·æ¥è¿›è¡Œæƒé™çš„å˜æ›´ã€‚å¯ä»¥ä½¿ç”¨æ•°å­—æ¥ä»£è¡¨å„ä¸ªæƒé™ï¼Œr:4ï¼Œw:2ï¼Œx:1ã€‚æƒé™çš„ä¿®æ”¹æŒ‰ç…§è¿™äº›æ•°å­—å³å¯å®Œæˆï¼Œä¾‹å¦‚è¦æŠŠnginx.confæ–‡ä»¶æƒé™ä¿®æ”¹ä¸º[-rwxrâ€“râ€“]å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å®Œæˆã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod 744 nginx.conf		//rwx==&gt;4+2+1=7 r--==&gt;4 r--==&gt;4</div></pre></td></tr></table></figure></p>
<p>æˆ–è€…æ˜¯<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod u=rwx,go=r nginx.conf		//u==&gt;user go==&gt;group/others</div></pre></td></tr></table></figure></p>
<h1 id="Linux-ä¸­è½¯ä»¶å®‰è£…æ–¹æ³•"><a href="#Linux-ä¸­è½¯ä»¶å®‰è£…æ–¹æ³•" class="headerlink" title="Linux ä¸­è½¯ä»¶å®‰è£…æ–¹æ³•"></a>Linux ä¸­è½¯ä»¶å®‰è£…æ–¹æ³•</h1><ul>
<li><p>YUM</p>
</li>
<li><p>RPM</p>
</li>
<li><p>æºç ç¼–è¯‘ï¼Œç³»ç»Ÿç¯å¢ƒå˜é‡</p>
</li>
</ul>
<h1 id="Linux-è¿ç»´è¿‡ç¨‹ä¸­å¸¸ç”¨å‘½ä»¤åŠå…¶ç”¨æ³•"><a href="#Linux-è¿ç»´è¿‡ç¨‹ä¸­å¸¸ç”¨å‘½ä»¤åŠå…¶ç”¨æ³•" class="headerlink" title="Linux è¿ç»´è¿‡ç¨‹ä¸­å¸¸ç”¨å‘½ä»¤åŠå…¶ç”¨æ³•"></a>Linux è¿ç»´è¿‡ç¨‹ä¸­å¸¸ç”¨å‘½ä»¤åŠå…¶ç”¨æ³•</h1><ul>
<li>ç½‘ç»œç›¸å…³å‘½ä»¤<br>Linuxç³»ç»Ÿä¸­æœ‰ç›¸å…³çš„æ–‡ä»¶ä¸“é—¨é…ç½®ç³»ç»Ÿç½‘ç»œï¼Œä»¥redhatå‘è¡Œç‰ˆä¸ºä¾‹ï¼š<br>ipé…ç½®æ–‡ä»¶ï¼šå¯¹åº”ç½‘å¡çš„ipåœ°å€é…ç½®æ–‡ä»¶åœ¨/etc/sysconfig/network-script/ifcfg-<interface-name>æ–‡ä»¶ä¸­ã€‚ifcfg-eth0ä»£è¡¨ç¬¬ä¸€å—ç½‘å¡ï¼Œifcfg-eth1ä»£è¡¨ç¬¬äºŒå—ç½‘å¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ­¤æ–‡ä»¶ä¸­å¯èƒ½å­˜åœ¨çš„å­—æ®µï¼š</interface-name></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">DEVICE=&#123;name&#125;  						#&#123;name&#125;è¡¨ç¤ºç½‘å¡å¯¹åº”ç‰©ç†è®¾å¤‡çš„åå­—</div><div class="line">TYPE=Ethernet 						#ç½‘ç»œç±»å‹ï¼ŒEthernetä»£è¡¨ä»¥å¤ªç½‘</div><div class="line">ONBOOT=yes/no 						#yes/noä»£è¡¨æ˜¯å¦æ¿€æ´»è¯¥ç½‘ç»œæ¥å£</div><div class="line">BOOTPROTO=none/static/bootp/dhcp    #è®¾ç½®ç½‘å¡è·å–ipçš„æ–¹å¼</div><div class="line">IPADDR=&#123;address&#125;					#å¦‚æœBOOTPROTOè®¾ç½®ä¸ºstatic,&#123;address&#125;ä»£è¡¨èµ‹äºˆç½‘å¡çš„ipåœ°å€</div><div class="line">NETMASK=&#123;mask&#125;						#&#123;mask&#125;ä»£è¡¨ç½‘å¡å¯¹åº”çš„å­ç½‘æ©ç </div><div class="line">GATEWAY=&#123;gateway&#125;					#&#123;gateway&#125;ä»£è¡¨é»˜è®¤ç½‘å…³</div><div class="line">DNS=&#123;dns&#125;							#&#123;dns&#125;ä»£è¡¨DNSæœåŠ¡é…ç½®</div><div class="line">MACADDR=&#123;macaddr&#125;					#&#123;macaddr&#125;è¡¨ç¤ºåˆ¶å®šä¸€ä¸ªmacåœ°å€</div><div class="line">HWADDR=&#123;addr&#125;						#&#123;addr&#125;ä»£è¡¨macåœ°å€</div></pre></td></tr></table></figure>
<p>é€šè¿‡/etc/sysconfig/networkæ–‡ä»¶å¯ä»¥ä¿®æ”¹ä¸»æœºåï¼Œä¹Ÿå¯ä»¥é€šè¿‡hostname {name}æ¥ä¸´æ—¶ä¿®æ”¹ä¸»æœºåï¼›<br>ç½‘å…³çš„é…ç½®æ–‡ä»¶/etc/sysconfig/networkæ–‡ä»¶ï¼Œç½‘å…³çš„ä¿®æ”¹ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šè¿°çš„ipé…ç½®æ–‡ä»¶æ¥ä¿®æ”¹ï¼Œnetworkæ–‡ä»¶ä¸­å¯ä»¥ä¿®æ”¹çš„é…ç½®é¡¹æœ‰è¿™äº›ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">NETWORK=yes #è¡¨ç¤ºç³»ç»Ÿæ˜¯å¦ä½¿ç”¨ç½‘ç»œï¼Œä¸€èˆ¬è®¾ç½®ä¸ºyesï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œåˆ™ä¸èƒ½ä½¿ç”¨ç½‘ç»œï¼Œè€Œä¸”å¾ˆå¤šç³»ç»ŸæœåŠ¡ç¨‹åºå°†æ— æ³•å¯åŠ¨</div><div class="line">RORWARD_IPV4=yes</div><div class="line">HOSTNAME=&#123;hostname&#125;  #&#123;hostname&#125;è¡¨ç¤ºæœåŠ¡å™¨çš„ä¸»æœºåï¼Œè¿™é‡Œçš„ä¸»æœºåè¦å’Œ/etc/hostsä¸­è®¾ç½®çš„ä¸»æœºåå¯¹åº”</div><div class="line">GAREWAY=&#123;address&#125;  #&#123;address&#125;è®¾ç½®æœ¬æœºè¿æ¥çš„ç½‘å…³çš„IPåœ°å€ï¼Œä¾‹å¦‚ï¼Œç½‘å…³10.0.0.2</div><div class="line">GATEWAYDEV=&#123;device&#125;  #&#123;device&#125;è¡¨ç¤ºç½‘å…³çš„è®¾å¤‡åï¼Œå¦‚ï¼šeth0</div><div class="line">NETWORK=yes/noã€€ã€€ã€€ã€€ #ç½‘ç»œæ˜¯å¦è¢«é…ç½®</div><div class="line">FORWARD_IPV4=yes/noã€€ã€€ã€€ã€€ #æ˜¯å¦å¼€å¯IPè½¬å‘åŠŸèƒ½</div></pre></td></tr></table></figure></p>
<p>DNSé…ç½®æ–‡ä»¶ä¸º/etc/resolv.confæ–‡ä»¶ï¼ŒåŒæ ·çš„DNSä¿¡æ¯ä¹Ÿå¯ä»¥åœ¨ipé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼Œé€šè¿‡resolv.confæ–‡ä»¶é…ç½®DNSå®¢æˆ·ç«¯ï¼Œç›®å‰æœ€å¤šæ”¯æŒä¸‰ä¸ªDNSæœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nameserver 8.8.8.8 #googleåŸŸåæœåŠ¡å™¨</div><div class="line">nameserver 8.8.8.4 #googleåŸŸåæœåŠ¡å™¨</div></pre></td></tr></table></figure></p>
<p>åœ¨æ²¡æœ‰é…ç½®åŸŸåæœåŠ¡å™¨çš„æ—¶å€™ï¼Œç³»ç»Ÿä¸Šæ‰€æœ‰çš„ç½‘ç»œç¨‹åºéƒ½é€šè¿‡/etc/hostsæ–‡ä»¶æŸ¥è¯¢ä¸€äº›ä¸»æœºåå¯¹åº”çš„IPåœ°å€ï¼Œä»–ä»¬æ˜¯æŒ‰ç…§é”®å€¼å¯¹çš„æ–¹å¼è¿›è¡Œé…ç½®çš„ï¼Œä¾‹å¦‚:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">eclipsesv.com 121.42.219.216</div><div class="line">localhost 127.0.0.1</div></pre></td></tr></table></figure></p>
<ul>
<li>Shell/Pythonç³»ç»Ÿç®¡ç†è„šæœ¬ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ï¼‰ã€é‚®ä»¶æ”¶å‘è„šæœ¬ã€æ–‡æœ¬å¤„ç†ã€éšæœºç ç”Ÿæˆã€Nginxä½œä¸ºç³»ç»ŸæœåŠ¡çš„è„šæœ¬</li>
<li>sed\akw\grep ä½¿ç”¨ é™„å¸¦å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼</li>
<li>æ•°æ®åº“ MySQLåŸºç¡€å‘½ä»¤ã€Rediså’ŒMongoDBè¦æ·±å…¥ï¼Œä½“ç°ä¼˜åŠ¿</li>
<li>ç›‘æ§å·¥å…· nagios</li>
<li>ç”¨æˆ·å’Œç»„ç®¡ç†</li>
<li>æ–‡ä»¶æ“ä½œæƒé™ä»¥åŠfindå‘½ä»¤</li>
<li>crontabå‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•</li>
<li>ç£ç›˜æŒ‚è½½æ–¹æ³•</li>
</ul>
<h1 id="åˆ†æWebæœåŠ¡å™¨æ—¥å¿—-ï¼ˆåˆ†ææ—¥å¿—ä¸­æ’åé å‰çš„ipã€è®¡æ•°ç»Ÿè®¡ç­‰ï¼‰"><a href="#åˆ†æWebæœåŠ¡å™¨æ—¥å¿—-ï¼ˆåˆ†ææ—¥å¿—ä¸­æ’åé å‰çš„ipã€è®¡æ•°ç»Ÿè®¡ç­‰ï¼‰" class="headerlink" title="åˆ†æWebæœåŠ¡å™¨æ—¥å¿— ï¼ˆåˆ†ææ—¥å¿—ä¸­æ’åé å‰çš„ipã€è®¡æ•°ç»Ÿè®¡ç­‰ï¼‰"></a>åˆ†æWebæœåŠ¡å™¨æ—¥å¿— ï¼ˆåˆ†ææ—¥å¿—ä¸­æ’åé å‰çš„ipã€è®¡æ•°ç»Ÿè®¡ç­‰ï¼‰</h1><ul>
<li>æŸ¥çœ‹æ’åå‰10çš„IPåœ°å€ï¼š awk â€˜{print $1}â€™ access.log | sort | uniq -c | sort -nr | head -n 10</li>
<li>æŸ¥çœ‹æŸä¸€å¤©çš„ipåœ°å€ï¼š cat access.log | grep â€œ01/Nov/2016â€ | awk â€˜{print $1}â€™ | uniq -c | sort -nr | head -n 10</li>
<li>æŸ¥çœ‹è¯·æ±‚æœ€å¤šçš„URLï¼š  awk â€˜{print $11}â€™ access.log | sort | uniq -c | sort -nr | head -n 10<h1 id="å­ç½‘åˆ’åˆ†æ–¹æ³•-ï¼ˆåè¿›åˆ¶äºŒè¿›åˆ¶è½¬æ¢ï¼Œç½‘ç»œåœ°å€ï¼Œä¸»æœºåœ°å€ï¼Œå¹¿æ’­ï¼Œç½‘å…³ç­‰ï¼‰"><a href="#å­ç½‘åˆ’åˆ†æ–¹æ³•-ï¼ˆåè¿›åˆ¶äºŒè¿›åˆ¶è½¬æ¢ï¼Œç½‘ç»œåœ°å€ï¼Œä¸»æœºåœ°å€ï¼Œå¹¿æ’­ï¼Œç½‘å…³ç­‰ï¼‰" class="headerlink" title="å­ç½‘åˆ’åˆ†æ–¹æ³• ï¼ˆåè¿›åˆ¶äºŒè¿›åˆ¶è½¬æ¢ï¼Œç½‘ç»œåœ°å€ï¼Œä¸»æœºåœ°å€ï¼Œå¹¿æ’­ï¼Œç½‘å…³ç­‰ï¼‰"></a>å­ç½‘åˆ’åˆ†æ–¹æ³• ï¼ˆåè¿›åˆ¶äºŒè¿›åˆ¶è½¬æ¢ï¼Œç½‘ç»œåœ°å€ï¼Œä¸»æœºåœ°å€ï¼Œå¹¿æ’­ï¼Œç½‘å…³ç­‰ï¼‰</h1><h1 id="å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼-ï¼ˆipåœ°å€ã€ç”µè¯å·ç ã€ä»¥åŠåŸºç¡€è¯­æ³•ï¼‰"><a href="#å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼-ï¼ˆipåœ°å€ã€ç”µè¯å·ç ã€ä»¥åŠåŸºç¡€è¯­æ³•ï¼‰" class="headerlink" title="å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ ï¼ˆipåœ°å€ã€ç”µè¯å·ç ã€ä»¥åŠåŸºç¡€è¯­æ³•ï¼‰"></a>å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ ï¼ˆipåœ°å€ã€ç”µè¯å·ç ã€ä»¥åŠåŸºç¡€è¯­æ³•ï¼‰</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">æ•°å­—ï¼š^[0-9]*$</div><div class="line">nä½æ•°å­—: ^\d&#123;n&#125;$</div><div class="line">è‡³å°‘nä½æ•°å­—ï¼š ^\d&#123;n,&#125;$</div><div class="line">m-nä½æ•°å­—ï¼š ^\d&#123;m,n&#125;$</div><div class="line">é›¶å’Œéé›¶å¼€å¤´çš„æ•°å­—ï¼š ^(0|[1-9][0-9]*)$</div><div class="line">éé›¶å¼€å¤´æœ€å¤šå¸¦æœ‰ä¸¤ä½å°æ•°çš„æ•°å­—ï¼š ^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</div><div class="line">å¸¦æœ‰1-2ä½å°æ•°çš„æ­£æ•°æˆ–è€…è´Ÿæ•°ï¼š ^(\-)?\d+(\.\d&#123;1,2&#125;)?$</div><div class="line">æ­£æ•°ã€è´Ÿæ•°å’Œå°æ•°ï¼š ^(\-|\+)?\d+(\.\d+)?$</div><div class="line">Emailåœ°å€ï¼š ^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</div><div class="line">åŸŸåï¼š[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</div><div class="line">InternetURLï¼š[a-zA-z]+://[^\s]* æˆ– ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$</div><div class="line">æ‰‹æœºå·ç ï¼š^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$</div><div class="line">èº«ä»½è¯å·(15ä½ã€18ä½æ•°å­—)ï¼š^\d&#123;15&#125;|\d&#123;18&#125;$</div><div class="line">ipåœ°å€ï¼š ((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="TCPåè®®ç»†èŠ‚ï¼ˆåˆ†ç»„ã€é‡ä¼ ã€æ»‘åŠ¨çª—å£ã€æ¡æ‰‹åˆ†æ‰‹ã€å„é˜¶æ®µè¿æ¥çŠ¶æ€ï¼‰"><a href="#TCPåè®®ç»†èŠ‚ï¼ˆåˆ†ç»„ã€é‡ä¼ ã€æ»‘åŠ¨çª—å£ã€æ¡æ‰‹åˆ†æ‰‹ã€å„é˜¶æ®µè¿æ¥çŠ¶æ€ï¼‰" class="headerlink" title="TCPåè®®ç»†èŠ‚ï¼ˆåˆ†ç»„ã€é‡ä¼ ã€æ»‘åŠ¨çª—å£ã€æ¡æ‰‹åˆ†æ‰‹ã€å„é˜¶æ®µè¿æ¥çŠ¶æ€ï¼‰"></a>TCPåè®®ç»†èŠ‚ï¼ˆåˆ†ç»„ã€é‡ä¼ ã€æ»‘åŠ¨çª—å£ã€æ¡æ‰‹åˆ†æ‰‹ã€å„é˜¶æ®µè¿æ¥çŠ¶æ€ï¼‰</h1><h1 id="HTTPåè®®ç»†èŠ‚ï¼ˆè¯·æ±‚-å“åº”æŠ¥æ–‡ï¼ŒçŠ¶æ€ç ï¼ŒHTTP2-0ç‰¹æ€§"><a href="#HTTPåè®®ç»†èŠ‚ï¼ˆè¯·æ±‚-å“åº”æŠ¥æ–‡ï¼ŒçŠ¶æ€ç ï¼ŒHTTP2-0ç‰¹æ€§" class="headerlink" title="HTTPåè®®ç»†èŠ‚ï¼ˆè¯·æ±‚/å“åº”æŠ¥æ–‡ï¼ŒçŠ¶æ€ç ï¼ŒHTTP2.0ç‰¹æ€§)"></a>HTTPåè®®ç»†èŠ‚ï¼ˆè¯·æ±‚/å“åº”æŠ¥æ–‡ï¼ŒçŠ¶æ€ç ï¼ŒHTTP2.0ç‰¹æ€§)</h1><h1 id="SMTP-POP3åè®®ç»†èŠ‚-ï¼ˆbase64ç¼–ç åŸç†ï¼‰"><a href="#SMTP-POP3åè®®ç»†èŠ‚-ï¼ˆbase64ç¼–ç åŸç†ï¼‰" class="headerlink" title="SMTP/POP3åè®®ç»†èŠ‚ ï¼ˆbase64ç¼–ç åŸç†ï¼‰"></a>SMTP/POP3åè®®ç»†èŠ‚ ï¼ˆbase64ç¼–ç åŸç†ï¼‰</h1>]]></content>
      
        <categories>
            
            <category> æ“ä½œç³»ç»Ÿ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hyper Interface(1)]]></title>
      <url>/2016/03/16/Hyper%20Interface1/</url>
      <content type="html"><![CDATA[<p>åœ¨æ¥ä¸‹æ¥çš„ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä¼šåœ¨å­¦ä¹ Hyperçš„è¿‡ç¨‹ä¸­ï¼Œç¿»è¯‘å®˜æ–¹æ¥å£æ–‡æ¡£ï¼Œç›®æ ‡æ˜¯åœ¨ä»”ç»†é˜…è¯»æ–‡æ¡£çš„åŒæ—¶æé«˜PythonæŠ€è‰ºï¼ŒåŒæ—¶ä¼šåšä¸€äº›å®éªŒæµ‹è¯•HTTP2åœ¨æ€§èƒ½ä¸Šçš„æå‡åˆ°åº•æœ‰å¤šå°‘ã€‚ç”±äºæ˜¯ç¬¬ä¸€æ¬¡è¿›è¡Œè¿™æ ·çš„ç¿»è¯‘ï¼Œæœ‰å¾ˆå¤šé”™è¯¯æˆ–è€…çº°æ¼ï¼Œæˆ‘ä¼šåœ¨ä»¥åä¸æ–­çš„æ›´æ–°ã€‚<br><a id="more"></a></p>
<h1 id="HTTPåŸºç¡€ç±»"><a href="#HTTPåŸºç¡€ç±»" class="headerlink" title="HTTPåŸºç¡€ç±»"></a>HTTPåŸºç¡€ç±»</h1><h2 id="HTTPConnection"><a href="#HTTPConnection" class="headerlink" title="HTTPConnection"></a>HTTPConnection</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">class hyper.HTTPConnection(host,port=None,secure=Node,window_manager=Node,</div><div class="line">	enable_push=False,ssl_content=None,proxy_port=Node,**kwargs)</div></pre></td></tr></table></figure>
<p>HTTPConnectionä½œä¸ºä¸€ä¸ªè¿æ¥åˆ°æœåŠ¡å™¨çš„å¯¹è±¡ç±»ä¼¼äºPythonæ ‡å‡†åº“ä¸­HTTPConnectionçš„ä½œç”¨ï¼Œåªä¸è¿‡æœ‰ä¸€äº›å…³é”®çš„ä¸åŒä¹‹å¤„ã€‚<br>Hyperå¹¶ä¸æ”¯æŒå¤§å¤šæ•°çš„æ ‡å‡†åº“ä¸­HTTPConnectionç±»æ„é€ å‡½æ•°çš„å‚æ•°ã€‚å¤§å¤šæ•°hyper.Connectionç±»ä¸­çš„å¯é€‰å‚æ•°åŒæ—¶æ”¯æŒHTTP/1.1å’ŒHTTP/2ã€‚</p>
<blockquote>
<p>å‚æ•°</p>
<ul>
<li>host-å³æ‰€è¦è¿æ¥çš„æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ä¸€ä¸ªIPåœ°å€æˆ–è€…æ˜¯ä¸€ä¸ªåŸŸåï¼Œå¹¶ä¸”å¯ä»¥åŒ…å«ä¸€ä¸ªç«¯å£å·ï¼Œæ¯”å¦‚è¯´ï¼šâ€™eclipsesv.comâ€™,â€™eclipsesv.com:443â€™æˆ–è€…â€™121.42.219.216:44444â€™ã€‚</li>
<li>port(å¯é€‰å‚æ•°)-å³æ‰€è¦è¿æ¥çš„ç«¯å£å·ï¼Œå¦‚æœåœ¨hostä¸­å·²ç»è¯´æ˜ï¼Œportå‚æ•°å¯ä»¥ç¼ºçœï¼Œè¿™é‡Œæœ‰ä¸ªç–‘é—®ï¼Œã€‚Hyperå®˜ç½‘ä¸Šè¯´çš„æ˜¯å¦‚æœhostä¸­ä¸æŒ‡åè¦è®¿é—®çš„portï¼Œå¹¶ä¸”portå‚æ•°ä¹Ÿä¸è®¾ç½®çš„è¯ï¼Œç¼ºçœæ˜¯è®¿é—®443ç«¯å£ï¼Œä½†æ˜¯æˆ‘è‡ªå·±åœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­å‘ç°å¥½åƒå¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚<br>é»˜è®¤çŠ¶æ€ä¸‹ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">from hyper import HTTPConnection</div><div class="line">con = HTTPConnection(&apos;eclipsesv.com&apos;)</div><div class="line">Streamid = con.request(&apos;GET&apos;,&apos;/&apos;)</div><div class="line">print Streamid</div><div class="line">resp = con.get_response()</div><div class="line">print resp</div><div class="line">&apos;&apos;&apos;è¾“å‡ºç»“æœ&apos;&apos;&apos;</div><div class="line">None</div><div class="line">&lt;hyper.http11.response.HTTP11Response object at 0x0000000002C722B0&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<p>æŒ‡æ˜ä½¿ç”¨443ç«¯å£ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">from hyper import HTTPConnection</div><div class="line">con = HTTPConnection(&apos;eclipsesv.com&apos;,443)</div><div class="line">Streamid = con.request(&apos;GET&apos;,&apos;/&apos;)</div><div class="line">print Streamid</div><div class="line">resp = con.get_response()</div><div class="line">print resp</div><div class="line">&apos;&apos;&apos;è¿”å›ç»“æœ&apos;&apos;&apos;</div><div class="line">1</div><div class="line">&lt;hyper.http20.response.HTTP20Response object at 0x0000000002C5CDD8&gt;</div></pre></td></tr></table></figure></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒStreamidä¸ºNone,æŒ‡æ˜ç«¯å£443ä¹‹åï¼ŒStreamidè¿”å›1ï¼Œè¿™æ ·çš„ç»“æœè¯´æ˜ï¼Œç¼ºçœæƒ…å†µä¸‹è®¿é—®çš„æ˜¯80ç«¯å£ï¼Œå¹¶ä¸æ˜¯443ã€‚<br>åœ¨Hyperæºç common/connection.pyä¸­ï¼ŒHTTPConnectionç±»ä¸­<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">def __init__(self,</div><div class="line">                 host,</div><div class="line">                 port=None,</div><div class="line">                 secure=None,</div><div class="line">                 window_manager=None,</div><div class="line">                 enable_push=False,</div><div class="line">                 ssl_context=None,</div><div class="line">                 proxy_host=None,</div><div class="line">                 proxy_port=None,</div><div class="line">                 **kwargs):</div><div class="line">        self._host = host</div><div class="line">        self._port = port</div><div class="line">        self._h1_kwargs = &#123;</div><div class="line">            &apos;secure&apos;: secure, &apos;ssl_context&apos;: ssl_context, </div><div class="line">            &apos;proxy_host&apos;: proxy_host, &apos;proxy_port&apos;: proxy_port </div><div class="line">        &#125;</div><div class="line">        self._h2_kwargs = &#123;</div><div class="line">            &apos;window_manager&apos;: window_manager, &apos;enable_push&apos;: enable_push,</div><div class="line">            &apos;secure&apos;: secure, &apos;ssl_context&apos;: ssl_context, </div><div class="line">            &apos;proxy_host&apos;: proxy_host, &apos;proxy_port&apos;: proxy_port</div><div class="line">        &#125;</div><div class="line">        # Add any unexpected kwargs to both dictionaries.</div><div class="line">        self._h1_kwargs.update(kwargs)</div><div class="line">        self._h2_kwargs.update(kwargs)</div><div class="line">        &apos;&apos;&apos;å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯HTTP11Connectionï¼Œè¿™é‡Œåº”è¯¥æ˜¯æ–‡æ¡£ä¸­çš„ç¢§æ²¹é¸¡&apos;&apos;&apos;</div><div class="line">        self._conn = HTTP11Connection(</div><div class="line">            self._host, self._port, **self._h1_kwargs</div><div class="line">        )</div></pre></td></tr></table></figure></p>
<ul>
<li>secure(å¯é€‰å‚æ•°)-ç”¨ä»¥æŒ‡æ˜è¯·æ±‚æ˜¯å¦åŸºäºTLSè¿æ¥ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ç¼ºçœå€¼ä¸ºFalseï¼Œå¦‚æœè®¿é—®æœåŠ¡å™¨443ç«¯å£ç¼ºçœåˆ™å˜ä¸ºTrueã€‚</li>
<li>window_manager(å¯é€‰å‚æ•°)-è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªBaseFlowControlManagerçš„å­ç±»ï¼Œç¼ºçœæƒ…å†µä¸‹ä½¿ç”¨FlowControlManagerã€‚ç”¨ä»¥æ§åˆ¶<a href="https://www.zhihu.com/question/32255109" target="_blank" rel="external">æ»‘åŠ¨çª—å£</a>ã€‚</li>
<li>enable_push(å¯é€‰å‚æ•°)-ç¡®å®šæœåŠ¡å™¨æ˜¯å¦ä½¿ç”¨æœåŠ¡å™¨æ¨é€ï¼ˆä¸»åŠ¨æ¨é€èµ„æºç»™å®¢æˆ·ç«¯ï¼‰ã€‚</li>
<li>ssl_context(å¯é€‰å‚æ•°)-ç”¨ä»¥è®¾ç½®è¯ä¹¦è®¤è¯çš„é€‰é¡¹ï¼Œç¼ºçœæƒ…å†µä¸‹ä½¿ç”¨SSLContextæ›¿ä»£ã€‚</li>
<li>proxy_host(å¯é€‰å‚æ•°)-ä»£ç†æœåŠ¡å™¨ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªIPåœ°å€æˆ–è€…åŸŸåï¼Œå¯ä»¥å¸¦æœ‰ç«¯å£å·ã€‚</li>
<li>proxy_portï¼ˆå¯é€‰å‚æ•°ï¼‰-ä»£ç†æœåŠ¡å™¨ç«¯å£ï¼Œå®ƒå’Œproxy_hostçš„è®¾ç½®æ–¹æ³•å’Œhostä¸portå‚æ•°ä¸€è‡´ã€‚<blockquote>
<p>æ–¹æ³•</p>
</blockquote>
</li>
<li>request(method,url,body=Node,headers={})-ä½¿ç”¨methodæŒ‡å®šçš„æ–¹æ³•ï¼Œå¦‚â€™GETâ€™æˆ–è€…â€™POSTâ€™å’Œåˆ¶å®šçš„URLæ¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚<br>å‚æ•°â€“methodï¼ŒæŒ‡æ˜è¯·æ±‚çš„æ–¹æ³•ï¼Œå¦‚â€™GETâ€™ã€â€™POSTâ€™ç­‰ï¼›urlï¼ŒæŒ‡æ˜è¦è®¿é—®çš„è·¯å¾„ï¼Œæ ¼å¼åƒè¿™æ ·ï¼šâ€™/path/to/segementâ€™ï¼›bodyï¼ˆå¯é€‰å‚æ•°ï¼‰ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªfile-likeå¯¹è±¡ï¼ˆPythonå†…ç½®å‡½æ•°open()è¿”å›çš„æœ‰ä¸ªread()æ–¹æ³•çš„å¯¹è±¡ï¼Œé™¤äº†fileä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ˜¯å†…å­˜çš„å­—èŠ‚æµã€ç½‘ç»œæµã€è‡ªå®šä¹‰æµç­‰ï¼‰æˆ–è€…bytestringï¼›headers(å¯é€‰å‚æ•°)-ç”¨ä»¥å‘é€è¯·æ±‚çš„headersã€‚<br>è¿”å›å€¼â€“è¿”å›ä¸€ä¸ªStreamIDï¼Œå¦‚æœè¯¥æ¡è¯·æ±‚åŸºäºHTTP/1.1è¿”å›Nodeã€‚</li>
<li>get_response(<em>args,*</em>kwargs)-ç”¨ä»¥è¿”å›ä¸€ä¸ªè¯·æ±‚å¯¹è±¡ã€‚</li>
</ul>
<h1 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP/2"></a>HTTP/2</h1><h2 id="HTTP20Connection"><a href="#HTTP20Connection" class="headerlink" title="HTTP20Connection"></a>HTTP20Connection</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">class hyper.HTTP20Connection(host,port=None,secure=None,window_manager=None,</div><div class="line">	enable_push=False,ssl_context=None,proxy_host=None,proxy_port=None,**kwargs)</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªç±»è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå‘æœåŠ¡å™¨å‘èµ·çš„HTTP2è¿æ¥ï¼Œå®ƒçš„å‚æ•°ä¸HTTPConnectionä¸€è‡´ï¼Œå‚æ•°çš„è®¾ç½®ä¹Ÿç±»ä¼¼ï¼Œè¿™é‡Œä¸å†å¤šè¯´ã€‚</p>
<blockquote>
<p>æ–¹æ³•</p>
<ul>
<li>close(error_code=None)ï¼Œç”¨ä»¥å…³é—­ä¸æœåŠ¡å™¨çš„è¿æ¥ã€‚å¯é€‰å‚æ•°error_codeç”¨ä»¥é‡ç½®è¿æ¥ï¼Œæ­¤æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ã€‚</li>
<li>connect()ï¼Œå½“ç±»HTTP20Connectionåˆ›å»ºå¥½ä¹‹åï¼Œç”¨ä»¥è¿æ¥åˆ¶å®šçš„æœåŠ¡å™¨ï¼Œä½†æ˜¯å¦‚æœè¿æ¥å·²ç»å»ºç«‹çš„è¯ï¼Œæ­¤æ–¹æ³•åˆ™å˜æˆç©ºæ“ä½œ(no-op)ï¼Œæ­¤æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ã€‚</li>
<li>endheaders(message_body=None,final=False,stream_id=None)ï¼Œå‘é€é¢„å…ˆå‡†å¤‡å¥½çš„è¯·æ±‚å¤´ç»™æœåŠ¡å™¨ã€‚å¦‚æœå‚æ•°message_bodyä¸ä¸ºç©ºï¼Œå®ƒä¹Ÿä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ï¼Œå½“åšè¯·æ±‚ä½“ï¼Œå¹¶ä¸”è¿™ä¸ªæµä¼šç«‹å³å…³é—­ã€‚å¦‚æœå‚æ•°finalè®¾ç½®ä¸ºTrueï¼Œè¯·æ±‚æµä¹Ÿä¼šç«‹å³åœæ­¢ï¼Œéšåè°ƒç”¨send()æ–¹æ³•ä»¥å…³é—­è¯¥è¯·æ±‚æµã€‚æ­¤æ–¹æ³•æ— è¿”å›å€¼ã€‚</li>
<li>get_pushes(stream_id=None,capture_all=False)ï¼Œä»æœåŠ¡å™¨è¿”å›ä¸€ä¸ªpromiseçš„ç”Ÿæˆå™¨ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•ä¸æ˜¯å¹‚ç­‰çš„ï¼Œpromisesåœ¨æ­¤æ–¹æ³•ä¸€æ¬¡è°ƒç”¨ä¹‹åï¼Œå¯èƒ½ä¸ä¼šæŒ‰ç…§è¯·æ±‚é¡ºåºè¿”å›ã€‚å¤šä¸ªè°ƒç”¨çš„è¿”å›å€¼å¯èƒ½ä¼šå¼•å‘æœªå®šä¹‰çš„è¡Œä¸ºã€‚å‚æ•°ï¼šstream_id(å¯é€‰å‚æ•°)-æƒ³è¦è·å–æœåŠ¡å™¨æ¨é€çš„æµIDï¼›capture_all(å¯é€‰å‚æ•°)ï¼Œå¦‚æœè®¾ç½®ä¸ºFalseï¼ŒæœåŠ¡å™¨æ¨é€çš„promiseä¼šä»¥éé˜»å¡çš„å½¢å¼è¿”å›ï¼Œè€ŒTrueåˆ™åä¹‹ã€‚æ­¤æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæœåŠ¡å™¨æ¨é€çš„HTTP20Pushå¯¹è±¡ã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">def get_pushes(self,stream_id=None,capture_all=False):</div><div class="line">	stream = self._get_stream(stream_id)</div><div class="line">    for promised_stream_id, headers in stream.get_pushes(capture_all):</div><div class="line">        yield HTTP20Push(</div><div class="line">            HTTPHeaderMap(headers), self.streams[promised_stream_id]</div><div class="line">        )</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<ul>
<li>get_response(stream_id=None)ï¼Œæ­¤æ–¹æ³•åœ¨ä½¿ç”¨requestä¹‹åä½¿ç”¨ï¼Œrequestæ–¹æ³•çš„è¿”å›å€¼stream_idä½œä¸ºæ­¤æ–¹æ³•çš„å‚æ•°ã€‚æ­¤æ–¹æ³•è¿”å›å€¼ä¸ºä¸€ä¸ªHTTP20Responseå¯¹è±¡ã€‚</li>
<li>network_buffer_sizeï¼Œè¿™æ˜¯HTTP20Connectionç±»é»˜è®¤çš„ä¸€ä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå†…å­˜ç¼“å†²åŒºç”¨ä»¥å­˜å‚¨ä»ç½‘ç»œä¸­è·å–çš„æ•°æ®ã€‚å¯ä»¥ç”¨æ¥è¿›è¡Œè°ƒä¼˜ã€‚</li>
<li>putheader(header,argument,stream_id=None)ï¼Œå°†ä¸€ä¸ªHTTPçš„è¯·æ±‚å¤´å‘é€åˆ°æœåŠ¡å™¨ï¼Œä¸httplibåº“ä¸­æ­¤æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œè°ƒç”¨æ­¤æ–¹æ³•å®é™…ä¸Šå¹¶ä¸ä¼šå‘é€æ•°æ®åˆ°æœåŠ¡å™¨ï¼Œå®ƒä»…ä»…æ˜¯ä¸ºendheaders()æ–¹æ³•çš„headersè¿›è¡Œæ’åºï¼Œå®ƒä¼šç¡®ä¿å‘é€åˆ°æœåŠ¡å™¨çš„è¯·æ±‚å¤´ç¬¦åˆHTTP/2çš„æ ‡å‡†ï¼Œå¹¶ä¸”å®ƒä¼šå‰”é™¤ä¸€äº›HTTP/2ä¸­æ— ç”¨çš„å‚æ•°ã€‚</li>
<li>putrequest(method,selector,**kwargs)ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„ç¬¬ä¸€æ­¥ï¼Œè¿”å›ä¸€ä¸ªstreamidã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&apos;å®ƒåœ¨requestæ–¹æ³•ä¸­çš„ä½¿ç”¨&apos;</div><div class="line">def request(self, method, url, body=None, headers=&#123;&#125;):</div><div class="line">	stream_id = self.putrequest(method, url)</div><div class="line"></div><div class="line">    for name, value in headers.items():</div><div class="line">        self.putheader(name, value, stream_id)</div><div class="line"></div><div class="line">    # Convert the body to bytes if needed.</div><div class="line">    if isinstance(body, str):</div><div class="line">        body = body.encode(&apos;utf-8&apos;)</div><div class="line"></div><div class="line">    self.endheaders(message_body=body, final=True, stream_id****=stream_id)</div><div class="line">    return stream_id</div></pre></td></tr></table></figure>
<ul>
<li>receive_frame(frame)ï¼Œç”¨ä»¥æ¥æ”¶æ„æˆstreamçš„å¸§ã€‚</li>
<li>request(method,url,body=None,headers={})ï¼Œä½¿ç”¨putrequestæ–¹æ³•æ¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</li>
<li>send(data,final=Flase,stream_id=None)ï¼Œå‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¼šç«‹å³å‘é€åˆ°æœåŠ¡å™¨ï¼Œå¦‚æœè¿™äº›æ•°æ®æ˜¯æœ€åè¦å‘é€çš„éƒ¨åˆ†ï¼Œå‚æ•°finalåº”è¯¥è®¾ç½®ä¸ºTrueï¼Œè¿™æ ·è¯·æ±‚æµå°±ä¼šå…³é—­ã€‚</li>
</ul>
<h2 id="HTTP20Response"><a href="#HTTP20Response" class="headerlink" title="HTTP20Response"></a>HTTP20Response</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class hyper.HTTP20Response(headers,stream)</div></pre></td></tr></table></figure>
<p>HTTP20Responseç”¨ä»¥ä»£è¡¨ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„HTTP2å“åº”ï¼Œå®ƒæä¾›äº†è·å–å“åº”å¤´å’Œå“åº”å®ä½“çš„æ–¹æ³•ã€‚å“åº”æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ä¹Ÿå¯ç”¨äºå£°æ˜å¯¹è±¡ã€‚</p>
<blockquote>
<p>æ–¹æ³•</p>
<ul>
<li>close()ï¼Œå…³é—­å“åº”ï¼Œå®é™…ä¸Šæ˜¯å…³é—­äº†åç»­çš„é¢HTTP2æ•°æ®æµã€‚æ–¹æ³•æ— è¿”å›å€¼ã€‚</li>
<li>fileno()ï¼Œè¿”å›åŸºç¡€å¥—æ¥å­—çš„æ–‡ä»¶æè¿°è¯ï¼Œæ­¤æ–¹æ³•å½“å‰ä¸å¯ç”¨ã€‚</li>
<li>read(amt=None,decode_content=True)ï¼Œè·å–å“åº”å®ä½“ã€‚å‚æ•°ï¼šamt(å¯é€‰å‚æ•°)ï¼Œè®¾ç½®è¦è¯»å–çš„æ•°æ®é‡ï¼Œç¼ºçœæƒ…å†µä¸‹ä¼šè¿”å›æ‰€æœ‰çš„å“åº”å®ä½“ï¼›decode_content(å¯é€‰å‚æ•°)ï¼Œç¼ºçœä¸ºTrue,å°†è¿”å›çš„æ•°æ®è§£ç ã€‚</li>
<li>read_chunked(decode_content=True),è¿”å›ç»è¿‡ç¼–ç çš„æ•°æ®å—ã€‚æ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›ä¸€å¸§çš„æ•°æ®ã€‚</li>
<li>reason=None,è¿”å›æœåŠ¡å™¨å“åº”çš„åŸå› çŸ­è¯­ã€‚</li>
<li>status=None,è¿”å›æœåŠ¡å™¨å“åº”çš„çŠ¶æ€ç ã€‚</li>
</ul>
</blockquote>
<h2 id="HTTP20Push"><a href="#HTTP20Push" class="headerlink" title="HTTP20Push"></a>HTTP20Push</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class hyper.HTTP20Push(request_headers,stream)</div></pre></td></tr></table></figure>
<p>HTTP20Pushä»£è¡¨é€šè¿‡æœåŠ¡å™¨æ¨é€æœºåˆ¶è¢«å‘é€å‡ºæ¥çš„ä¸€ä¸ªè¯·æ±‚/å“åº”ã€‚</p>
<blockquote>
<p>æ–¹æ³•</p>
<ul>
<li>cancel()å–æ¶ˆå·²ç»æ¨é€çš„æ•°æ®å¹¶ä¸”å…³é—­è¯¥æ•°æ®æµã€‚æ­¤æ–¹æ³•æ— è¿”å›å€¼ã€‚</li>
<li>get_response()è·å–æœåŠ¡å™¨æ¨é€çš„æ•°æ®ã€‚è¿”å›ä¸€ä¸ªHTTP20Responseå¯¹è±¡ã€‚</li>
</ul>
</blockquote>
<h1 id="To-be-continued"><a href="#To-be-continued" class="headerlink" title="To be continued"></a>To be continued</h1><ul>
<li>HTTP/1.1</li>
<li>Headers</li>
<li>SSLContext</li>
<li>Requests Transport Adapter</li>
<li>Flow Control</li>
<li>Exceptions</li>
</ul>
<h1 id="æ›´æ–°è®°å½•"><a href="#æ›´æ–°è®°å½•" class="headerlink" title="æ›´æ–°è®°å½•"></a>æ›´æ–°è®°å½•</h1><ul>
<li>2016/3/21æ›´æ–°äº†HTTP/2</li>
</ul>
]]></content>
      
        
        <tags>
            
            <tag> HTTP2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[é‚®ä»¶ä¼ è¾“åè®®ç¬”è®°]]></title>
      <url>/2016/03/15/0326/</url>
      <content type="html"><![CDATA[<p>ç½‘æ˜“æ˜¥æ‹›ï¼ŒæŠ•äº†é‚®ä»¶äº‹ä¸šéƒ¨çš„è¿ç»´å·¥ç¨‹å¸ˆå²—ä½ï¼Œä»¥å‰æ²¡æ€ä¹ˆæ¥è§¦è¿‡é‚®ä»¶è¿™å—å†…å®¹ï¼Œç‰¹æ­¤è®°å½•å­¦ä¹ å†…å®¹ã€‚<br><a id="more"></a></p>
<h1 id="å‡ ä¸ªå®šä¹‰"><a href="#å‡ ä¸ªå®šä¹‰" class="headerlink" title="å‡ ä¸ªå®šä¹‰"></a>å‡ ä¸ªå®šä¹‰</h1><h2 id="é‚®ä»¶"><a href="#é‚®ä»¶" class="headerlink" title="é‚®ä»¶"></a>é‚®ä»¶</h2><p>é‚®ä»¶æ˜¯ä¸€ç§æ¶ˆæ¯çš„æ ¼å¼ï¼Œç”±ä¿¡å°ã€é¦–éƒ¨å’Œæ­£æ–‡ç»„æˆã€‚ä¿¡å°ä¸Šæœ€é‡è¦çš„æ˜¯æ”¶ä»¶äººçš„åœ°å€ï¼Œé‚®ä»¶æœåŠ¡å™¨ä½¿ç”¨è¿™ä¸ªåœ°å€å°†é‚®ä»¶å‘é€åˆ°å—ä¿¡äººæ‰€åœ¨çš„é‚®ä»¶æœåŠ¡å™¨ä¸Šï¼›é¦–éƒ¨æ˜¯æœ‰ç”¨æˆ·ä»£ç†æˆ–é‚®ç®±æœåŠ¡å™¨æ·»åŠ çš„ä¸€äº›ä¿¡æ¯ï¼›æ­£æ–‡åˆ™æ˜¯å‘é€ç”¨æˆ·å‘é€ç»™æ¥æ”¶ç”¨æˆ·æŠ¥æ–‡çš„å†…å®¹ã€‚</p>
<h2 id="ç”¨æˆ·ä»£ç†"><a href="#ç”¨æˆ·ä»£ç†" class="headerlink" title="ç”¨æˆ·ä»£ç†"></a>ç”¨æˆ·ä»£ç†</h2><p>ç”¨æˆ·ä»£ç†æ˜¯ç”¨æˆ·ä¸ç”µå­é‚®ä»¶ç³»ç»Ÿçš„äº¤äº’æ¥å£ï¼Œä¸€èˆ¬æ¥è¯´ä»–å°±æ˜¯æˆ‘ä»¬PCä¸Šçš„ä¸€ä¸ªç¨‹åºï¼Œæ¯”å¦‚è¯´Foxmailå’ŒOutlookç­‰ã€‚</p>
<h2 id="é‚®ä»¶æœåŠ¡å™¨"><a href="#é‚®ä»¶æœåŠ¡å™¨" class="headerlink" title="é‚®ä»¶æœåŠ¡å™¨"></a>é‚®ä»¶æœåŠ¡å™¨</h2><p>é‚®ä»¶æœåŠ¡å™¨æ˜¯ç”µå­é‚®ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œå®ƒç”¨æ¥å‘é€å’Œæ¥æ”¶é‚®ä»¶ï¼Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™ä¸ºç”¨æˆ·æä¾›æœåŠ¡ã€‚æ¯”å¦‚è¯´smtp.163.comã€‚</p>
<h1 id="SMTPåè®®"><a href="#SMTPåè®®" class="headerlink" title="SMTPåè®®"></a>SMTPåè®®</h1><p>SMTPï¼Œç®€å•é‚®ä»¶ä¼ é€åè®®ï¼Œå’Œhttpç­‰å¤šæ•°åº”ç”¨å±‚åè®®ä¸€æ ·ï¼Œå®ƒé€šè¿‡TCPè¿æ¥å®ç°é‚®ä»¶åœ¨ç½‘ç»œä¸­çš„ä¼ é€ã€‚SMTPç”¨æ¥å°†å®¢æˆ·æœºä¸Šçš„é‚®ä»¶ä¼ é€åˆ°æœåŠ¡å™¨ä¸Šæˆ–è€…æ˜¯ä»ä¸€ä¸ªé‚®ä»¶æœåŠ¡å™¨è½¬å‘åˆ°å¦å¤–ä¸€ä¸ªé‚®ä»¶æœåŠ¡å™¨ã€‚</p>
<h2 id="é€šä¿¡è¿‡ç¨‹"><a href="#é€šä¿¡è¿‡ç¨‹" class="headerlink" title="é€šä¿¡è¿‡ç¨‹"></a>é€šä¿¡è¿‡ç¨‹</h2><p>ä¸€ä¸ªSMTPé€šä¿¡è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>å‘é€ç«¯é‚®ä»¶æœåŠ¡å™¨ä¸æ¥æ”¶ç«¯é‚®ä»¶æœåŠ¡å™¨25ç«¯å£å»ºç«‹TCPè¿æ¥</li>
<li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€å„ç§å‘½ä»¤ï¼Œè¯·æ±‚å„ç§æœåŠ¡ï¼Œä¾‹å¦‚è®¤è¯ã€æŒ‡å®šå‘é€äººå’Œæ¥æ”¶äºº</li>
<li>æœåŠ¡å™¨è§£æç”¨æˆ·å‘½ä»¤ï¼Œåšå‡ºç›¸åº”æ“ä½œè¿”å›ç›¸åº”ç»™å®¢æˆ·ç«¯</li>
<li>é‡å¤ç¬¬äºŒç¬¬ä¸‰æ­¥ï¼Œç›´è‡³é‚®ä»¶å‘é€å®Œæˆæˆ–è€…è¿æ¥ä¸­æ–­ã€‚<h2 id="Telnetæµ‹è¯•SMTP"><a href="#Telnetæµ‹è¯•SMTP" class="headerlink" title="Telnetæµ‹è¯•SMTP"></a>Telnetæµ‹è¯•SMTP</h2>ä½¿ç”¨Telnetå·¥å…·ï¼Œä½¿ç”¨SMTPæ¨¡æ‹Ÿå‘é€é‚®ä»¶è¿‡ç¨‹ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">$ telnet smtp.163.com 25    //é”®å…¥é‚®ä»¶æœåŠ¡å™¨åä»¥åŠç«¯å£å·25 å»ºç«‹è¿æ¥</div><div class="line">Trying 220.181.12.16...</div><div class="line">Connected to smtp.163.com.  //è¿æ¥å»ºç«‹æˆåŠŸ</div><div class="line">Escape character is &apos;^]&apos;.</div><div class="line">220 163.com Anti-spam GT for Coremail System (163com[20141201])</div><div class="line">HELO smtp.163.com          //HELO ç”¨ä»¥å’ŒæœåŠ¡å™¨å®Œæˆæ¡æ‰‹</div><div class="line">250 OK</div><div class="line">AUTH LOGIN				   //AUTH LOGIN å¼€å§‹è®¤è¯ç™»å½•</div><div class="line">334 dXNlcm5hbWU6</div><div class="line">ZWMZNsaXBzZV9zdg==		   //ä»¥Base64åŠ å¯†çš„é‚®ç®±ç”¨æˆ·å</div><div class="line">334 UGFzc3dvcmQ6</div><div class="line">d456xNjg5MTM=			   //ä»¥Base64åŠ å¯†çš„é‚®ç®±å¯†ç </div><div class="line">235 Authentication successful   //è®¤è¯æˆåŠŸ</div><div class="line">MAIL FROM:&lt;xxxx@163.com&gt;  //é‚®ä»¶å‘é€æ–¹</div><div class="line">250 Mail OK</div><div class="line">RCPT TO:&lt;xxxx@qq.com&gt;		//é‚®ä»¶æ¥æ”¶æ–¹</div><div class="line">250 Mail OK</div><div class="line">DATA Just a try for smtp</div><div class="line">500 Error: bad syntax</div><div class="line">DATA							//å¼€å§‹å†™å…¥é‚®ä»¶å†…å®¹</div><div class="line">354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</div><div class="line">TO: xxxxx@qq.com			//æ¥æ”¶æ–¹</div><div class="line">FROM: xxxxx@163.com			//å‘é€æ–¹</div><div class="line">SUBJECT: Just a try for SMTP  //é‚®ä»¶ä¸»é¢˜</div><div class="line">							  //éš”ç©ºä¸€è¡Œ</div><div class="line">This is a test,not for real.  //é‚®ä»¶å†…å®¹</div><div class="line">.							  //é‚®ä»¶ä»¥.åŠ å›è½¦é”®ç»“å°¾</div><div class="line">250 Mail OK queued as smtp12,EMCowEAJp0UnlvZWz6MLAA--.4874S2 1459001194</div><div class="line">QUIT						  //ç»“æŸé€šä¿¡</div><div class="line">221 Bye</div><div class="line">Connection closed by foreign host.</div></pre></td></tr></table></figure>
<h1 id="POP3åè®®"><a href="#POP3åè®®" class="headerlink" title="POP3åè®®"></a>POP3åè®®</h1><p>POP3ï¼Œé‚®å±€åè®®ç¬¬ä¸‰ç‰ˆã€‚å®ƒè¢«ç”¨æˆ·ä»£ç†ç”¨æ¥ä»é‚®ä»¶æœåŠ¡å™¨å»çš„é‚®ä»¶ã€‚ä¸SMTPä¸€æ ·å®ƒä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®®ï¼Œç«¯å£110ã€‚POP3åè®®æœ‰ä¸‰ç§çŠ¶æ€ï¼Œè®¤è¯çŠ¶æ€ã€å¤„ç†çŠ¶æ€å’Œæ›´æ–°çŠ¶æ€ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åˆšå»ºç«‹è¿æ¥æ—¶å¤„äºè®¤è¯çŠ¶æ€ï¼›è®¤è¯æˆåŠŸåè¿›å…¥å¤„ç†çŠ¶æ€ï¼›å®Œæˆç”¨æˆ·å‘½ä»¤åœ¨ç”¨æˆ·ä½¿ç”¨QUITå‘½ä»¤ä¹‹åè¿›å…¥æ›´æ–°çŠ¶æ€ã€‚</p>
<h2 id="é€šä¿¡è¿‡ç¨‹-1"><a href="#é€šä¿¡è¿‡ç¨‹-1" class="headerlink" title="é€šä¿¡è¿‡ç¨‹"></a>é€šä¿¡è¿‡ç¨‹</h2><p>ç”¨æˆ·ä»£ç†ä»é‚®ä»¶æœåŠ¡å™¨ä¸Šæ¥æ”¶é‚®ä»¶çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”¨æˆ·è¿è¡Œç”¨æˆ·ä»£ç†</li>
<li>ç”¨æˆ·ä»£ç†ä¸é‚®ä»¶æœåŠ¡å™¨110ç«¯å£å»ºç«‹TCPè¿æ¥</li>
<li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€å„ç§å‘½ä»¤ï¼Œè¯·æ±‚æœåŠ¡ï¼Œä¾‹å¦‚æŸ¥è¯¢é‚®ç®±ä¿¡æ¯ã€ä¸‹è½½é‚®ä»¶ç­‰</li>
<li>æœåŠ¡å™¨è§£æç”¨æˆ·å‘½ä»¤ï¼Œåšå‡ºç›¸åº”å“åº”</li>
<li>é‡å¤3ã€4æ­¥éª¤</li>
<li>ç”¨æˆ·ä»£ç†å°†è·å–åˆ°çš„æ•°æ®å‘ˆç°ç»™ç”¨æˆ·</li>
</ul>
<h2 id="Telnetæµ‹è¯•POP3"><a href="#Telnetæµ‹è¯•POP3" class="headerlink" title="Telnetæµ‹è¯•POP3"></a>Telnetæµ‹è¯•POP3</h2><p>ä½¿ç”¨Telnetå·¥å…·ï¼Œæµ‹è¯•POP3ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">telnet pop.163.com 110 #telnetç™»å½•110ç«¯å£</div><div class="line">Trying 202.108.5.104...</div><div class="line">Connected to pop.163.com.</div><div class="line">Escape character is &apos;^]&apos;.</div><div class="line">+OK Welcome to coremail Mail Pop3 Server (163com[20050206])</div><div class="line">USER xxxx # ç”¨æˆ·å</div><div class="line">+OK core mail</div><div class="line">PASS xxxxx # ç™»å½•å¯†ç </div><div class="line">+OK 254 message(s) [27676669 byte(s)]</div><div class="line">STAT # æŸ¥çœ‹é‚®ç®±çŠ¶æ€</div><div class="line">+OK 254 27676669</div><div class="line">LIST # é‚®ä»¶åˆ—è¡¨</div><div class="line">+OK 354 27676669</div><div class="line">1 2468</div><div class="line">2 21945</div><div class="line">3 33136</div><div class="line">4 2071</div><div class="line">5 3364</div><div class="line">6 18906</div><div class="line">7 3136</div><div class="line">8 24764</div><div class="line">.................</div><div class="line"></div><div class="line">TOP 254 0 # æŸ¥çœ‹æŒ‡å®šé‚®ä»¶çš„é‚®ä»¶å¤´ï¼Œ0è¡¨ç¤ºæŸ¥çœ‹æ•´ä¸ªé‚®ä»¶å¤´ï¼Œå…¶å®ƒæ­£æ•´æ•°è¡¨ç¤ºé™åˆ¶è¿”å›å¤šå°‘è¡Œã€‚</div><div class="line">+OK core mail</div><div class="line">Received: from smtp.63.com (unknown [58.252.70.158])</div><div class="line">by smtp5 (Coremail) with SMTP id wKjREDrA9gIfFqlEjCnRAg==.29062S4;</div><div class="line">Mon, 03 Jul 2006 21:07:18 +0800 (CST)</div><div class="line">TO: crazywill@163.com</div><div class="line">FROM : cccc@163.com # è¿™é‡Œå³å‰é¢å‘ä¿¡æ—¶ä¼ªé€ çš„ä¸€ä¸ªå‡å‘é€äººä¿¡æ¯ï¼Œå¹³æ—¶æ­£å¸¸æ“ä½œåªæ˜¾ç¤ºè¿™ä¸ªã€‚</div><div class="line">SUBJECT: test by telnet/smtp # é‚®ä»¶ä¸»é¢˜</div><div class="line">Message-Id: &lt;44A91687.0E6F6C.07562&gt;</div><div class="line">Date: Mon, 3 Jul 2006 21:07:19 +0800 (CST)</div><div class="line">Sender: crazywill@163.com # è¿™é‡Œæ˜¯çœŸæ­£çš„å‘é€äººï¼Œä¸å¯ä¼ªé€ ã€‚</div><div class="line"></div><div class="line"></div><div class="line">.</div><div class="line">RETR 254 # è·å–æŒ‡å®šé‚®ä»¶</div><div class="line">+OK 354 octets</div><div class="line">Received: from smtp.63.com (unknown [58.252.70.158])</div><div class="line">by smtp5 (Coremail) with SMTP id wKjREDrA9gIfFqlEjCnRAg==.29062S4;</div><div class="line">Mon, 03 Jul 2006 21:07:18 +0800 (CST)</div><div class="line">TO: crazywill@163.com</div><div class="line">FROM : cccc@163.com</div><div class="line">SUBJECT: test by telnet/smtp</div><div class="line">Message-Id: &lt;44A91687.0E6F6C.07562&gt;</div><div class="line">Date: Mon, 3 Jul 2006 21:07:19 +0800 (CST)</div><div class="line">Sender: crazywill@163.com</div><div class="line"></div><div class="line">test, just a test.</div><div class="line">.</div><div class="line"></div><div class="line">DELE 254 # åˆ é™¤ç¬¬254å°é‚®ä»¶</div><div class="line">+OK core mail</div><div class="line">STAT # æŸ¥çœ‹é‚®ç®±çŠ¶æ€</div><div class="line">+OK 253 27676315</div><div class="line">QUIT # é€€å‡º</div><div class="line">+OK core mail</div><div class="line">Connection closed by foreign host.</div></pre></td></tr></table></figure></p>
<h1 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h1><p><a href="http://363918.blog.51cto.com/353918/739650" target="_blank" rel="external">ä½¿ç”¨telnetæµ‹è¯•smtpå’Œpop3åè®®</a><br><a href="http://blog.csdn.net/bripengandre/article/details/2191048" target="_blank" rel="external">SMTPåè®®åˆ†æ</a><br><a href="http://blog.csdn.net/bripengandre/article/details/2192111" target="_blank" rel="external">POP3åè®®åˆ†æ</a></p>
]]></content>
      
        <categories>
            
            <category> è®¡ç®—æœºç½‘ç»œ </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[Learning Hyper]]></title>
      <url>/2016/03/14/Learning%20Hyper/</url>
      <content type="html"><![CDATA[<p>16å¹´3æœˆ12æ—¥æ—©æ™¨ä¹ç‚¹åŠï¼Œç¦»å¼€åŒ—äº¬ï¼Œç»“æŸäº†è¯»ç ”ç”Ÿæ¶¯çš„å‡ºå·®ä¹‹è·¯ã€‚åœ¨æœªæ¥ä¸¤ä¸ªæœˆå°†æŠŠç²¾åŠ›é›†ä¸­æ”¾åœ¨æ¯•ä¸šè®ºæ–‡ä¸Šã€‚ç”±äºæ¯•è®¾å¤§é‡å†…å®¹ä¸HTTP2.0ç›¸å…³ï¼ˆè¿™ä¸ï¼Œç°åœ¨åšå®¢å·²ç»åœ¨Nginxçš„æ”¯æŒä¸‹è½¬ä¸ºHTTP2.0äº†ï¼Œç»¿è‰²çš„å°é”çœ‹èµ·æ¥å¾ˆé¡ºçœ¼å‘¢ï¼‰ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿåœ¨å­¦ä¹ Pythonï¼Œç‰¹æ­¤è®°å½•å­¦ä¹ è¿‡ç¨‹ã€‚<br><a id="more"></a></p>
<h1 id="æ¯•è®¾å†…å®¹"><a href="#æ¯•è®¾å†…å®¹" class="headerlink" title="æ¯•è®¾å†…å®¹"></a>æ¯•è®¾å†…å®¹</h1><p>è¯»ç ”æœŸé—´ï¼Œåšçš„å†…å®¹ä¸»è¦æ˜¯å…³äºå®æ—¶å¯è§†åŒ–ä¸­æ‰€ç”¨åˆ°çš„æµ·é‡ç“¦ç‰‡æ•°æ®ï¼ŒåŒ…æ‹¬ç“¦ç‰‡æ•°æ®åˆ‡åˆ†ã€ç“¦ç‰‡æ•°æ®åº“æ„å»ºã€ç“¦ç‰‡æœåŠ¡å™¨ç«¯é«˜é€Ÿç¼“å­˜ç­‰ç­‰å†…å®¹ã€‚ç°åœ¨å›å¤´çœ‹çœ‹ä»¥å‰è€—è´¹äº†å¤§é‡æ—¶é—´ç²¾åŠ›åšå‡ºæ¥çš„ä¸œè¥¿å¯èƒ½ä»…ä»…å°±æ˜¯ä¸ªç©å…·ï¼Œåœ¨å®é™…åº”ç”¨ä¸­å¾ˆå¯èƒ½ä¼šå´©å´©å´©ï¼Œä½†æ˜¯æˆ‘è¿™ä¸ªäººå°±æ˜¯å–œæ¬¢é¼“æ£äº›æ–°é²œçš„ä¸œè¥¿ã€‚å»å¹´æ•²å®šçš„HTTP2.0åè®®ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸€ç›´å…³æ³¨äº†å¾ˆä¹…ï¼Œ<a href="https://imququ.com/" target="_blank" rel="external">å±ˆå¤§ç¥çš„åšå®¢</a>ç›¸å…³èµ„æ–™ä¹ŸæŒºå¤šï¼Œå…¶ä¸­æ¨èçš„å‡ æœ¬ä¹¦ä¹Ÿéƒ½ååˆ†ä¸é”™ã€‚æˆ‘è§‰å¾—HTTP2.0çš„æ–°ç‰¹æ€§å¤´éƒ¨å‹ç¼©ã€å¤šè·¯å¤ç”¨ä»¥åŠæœåŠ¡å™¨æ¨é€éƒ½å¯ä»¥åœ¨æµ·é‡å°æ•°æ®ä¼ è¾“ä¸­å‘æŒ¥å¾ˆå¥½çš„æ•ˆæœã€‚</p>
<blockquote>
<p>##å¤´éƒ¨å‹ç¼©###<br>é€šè¿‡å¤´éƒ¨å‹ç¼©ï¼Œå¯ä»¥æœ‰æ•ˆçš„é™ä½æµ·é‡ç“¦ç‰‡æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ç›¸ä¼¼è¯·æ±‚å¤´éƒ¨æ‰€æ¶ˆè€—ä¸å¿…è¦çš„æµé‡ï¼Œé€šè¿‡å‡å°‘æ€»ä½“æ•°æ®æµé‡æ¥æé«˜æ•°æ®ä¼ è¾“æ•ˆç‡æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ³•ã€‚</p>
<p>##å¤šè·¯å¤ç”¨##<br>é€šè¿‡å®¢æˆ·ç«¯å‘ç“¦ç‰‡æœåŠ¡å™¨ç®€å†çš„ä¸€æ¡HTTP2è¿æ¥ï¼Œå¯ä»¥è·å–å¤šä¸ªç“¦ç‰‡æ•°æ®ï¼Œæœ‰æ•ˆé™ä½ç”±äºTCPå»ºç«‹è¿æ¥æ¡æ‰‹åˆ†æ‰‹æ‰€å çš„æ—¶é—´æ¶ˆè€—ï¼Œç“¦ç‰‡æœåŠ¡å™¨ä¹Ÿå¯ä»¥æŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºä¼ é€ç“¦ç‰‡æ•°æ®åˆ°å®¢æˆ·ç«¯ã€‚</p>
<p>##æœåŠ¡å™¨æ¨é€##<br>è¿™ä¸ªæ˜¯æˆ‘è®¤ä¸ºå¯¹ç“¦ç‰‡æ•°æ®ä¼ è¾“æ•ˆç‡æå‡æœ€å¤§çš„åœ°æ–¹ï¼Œä»¥å¾€çš„æ•°æ®ä¼ è¾“ï¼Œå³ä½¿æœåŠ¡å™¨çŸ¥é“ä¸‹ä¸€æ­¥å®¢æˆ·ç«¯å°†è¦è¯·æ±‚çš„æ•°æ®ï¼Œå®ƒä¹Ÿæ²¡æ³•ä¸»åŠ¨å°†æ•°æ®æ¨é€ç»™å®¢æˆ·ç«¯ï¼Œä½†æ˜¯HTTP2.0å¯ä»¥å®ç°è¿™ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯é€šè¿‡è§£æå½“å‰æ•°æ®è¯·æ±‚çš„ç‰¹ç‚¹æ¨æµ‹ä¸‹ä¸€æ­¥å¯èƒ½è¦è¢«è¯·æ±‚çš„æ•°æ®ï¼Œæå‰å°†æ•°æ®æ¨é€ç»™å®¢æˆ·ç«¯ï¼Œæœ‰æ•ˆçš„æå‡å¯è§†åŒ–æ•ˆæœã€‚</p>
</blockquote>
<h1 id="Hyper"><a href="#Hyper" class="headerlink" title="Hyper"></a>Hyper</h1><p><a href="https://hyper.readthedocs.org/en/latest/" target="_blank" rel="external">Hyper</a>æ˜¯Pythonç‰ˆæœ¬çš„HTTP2.0å®¢æˆ·ç«¯ï¼Œå…¶ä»–çš„å¼€å‘è¯­è¯¸å¦‚Javascriptã€Goã€Javaç­‰éƒ½æœ‰å¯¹åº”çš„åè®®å®ç°ï¼Œå¯ä»¥åœ¨<a href="https://github.com/search?utf8=%E2%9C%93&amp;q=http2" target="_blank" rel="external">è¿™é‡Œ</a>æ‰¾åˆ°ä½ æƒ³è¦çš„å®¢æˆ·ç«¯ã€‚<br>Hyperæ˜¯ä¸€ä¸ªä½¿ç”¨çº¯ç²¹Pythonç¼–å†™çš„åº“ï¼Œå®ƒå¯ä»¥åœ¨Python3.4æˆ–è€…Python2.7.9æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬ä¸Šè¿è¡Œï¼Œé™¤äº†HTTP2.0å®ƒä¹Ÿå®Œæˆäº†HTTP1.1çš„å®ç°ã€‚</p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æƒ³è¦ä½¿ç”¨Hyperä¹‹å‰ï¼Œå½“ç„¶è¦æŠŠå®ƒå®‰è£…åœ¨ä½ çš„å¼€å‘ç¯å¢ƒã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install hyper</div></pre></td></tr></table></figure></p>
<p>ç®€å•ä¸€å¥è¯å³å¯æå®šã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒHTTP2.0éœ€è¦å»ºç«‹åœ¨TLSï¼ˆå®‰å…¨ä¼ è¾“å±‚åè®®ï¼‰ä¹‹ä¸Šã€‚å¦‚æœä½¿ç”¨çš„æ˜¯Python3.4æˆ–è€…æ›´é«˜çš„ç‰ˆæœ¬å°±ä¸éœ€è¦æ‹…å¿ƒè¿™äº›ï¼Œå¦‚æœæ˜¯è¾ƒæ—©çš„ç‰ˆæœ¬åˆ™éœ€è¦ä½¿ç”¨PyOpenSSLæ¥æä¾›TLSçš„æ”¯æŒã€‚</p>
<h2 id="èµ°èµ·"><a href="#èµ°èµ·" class="headerlink" title="èµ°èµ·"></a>èµ°èµ·</h2><p>åœ¨å®‰è£…äº†Hyperä¹‹åï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢ç®€å•çš„ä»£ç è¿›è¡ŒHTTPè¯·æ±‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from hyper import HTTPConnection</div><div class="line">con = HTTPConnection(&apos;eclipsesv.com&apos;)</div><div class="line">con.request(&apos;GET&apos;,&apos;/&apos;)</div><div class="line">resp = con.get_response()</div><div class="line">print resp.headers</div><div class="line"></div><div class="line">&apos;&apos;&apos;è¾“å‡ºå†…å®¹&apos;&apos;&apos;</div><div class="line">HTTPHeaderMap([(&apos;Server&apos;, &apos;nginx/1.9.7&apos;), (&apos;Date&apos;, &apos;Mon, 14 Mar 2016 14:41:08 GMT&apos;), (&apos;Content-Type&apos;, &apos;text/html&apos;), (&apos;Content-Length&apos;, &apos;184&apos;), (&apos;Connection&apos;, &apos;keep-alive&apos;), (&apos;Location&apos;, &apos;https://eclipsesv.com/&apos;)])</div></pre></td></tr></table></figure></p>
<h1 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a>æœªå®Œå¾…ç»­</h1><p>ä»Šå¤©å°±å…ˆåˆ°è¿™é‡Œï¼Œæ¥ä¸‹æ¥çš„å‡ ç¯‡å†…å®¹ä¼šæŒ‰ç…§Hyperå®˜ç½‘æä¾›çš„APIè¿›è¡Œä¸€äº›ç®€å•çš„è¯•éªŒï¼Œä¸ºè®ºæ–‡è¯•éªŒåšå¥½å‡†å¤‡ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> HTTP2 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åŠåŠå­éä¸“ä¸šç¨‹åºå‘˜çš„æˆé•¿å†ç¨‹]]></title>
      <url>/2015/12/10/1210/</url>
      <content type="html"><![CDATA[<p>äººå¹´é¾„ä¸€å¤§ï¼Œå°±å–œæ¬¢å›å¿†ä»å‰çš„è¿‡å¾€ã€‚<br>æƒ³æƒ³è‡ªå·±è¿™ä¸ªåŠåŠå­éä¸“ä¸šç¨‹åºå‘˜ï¼Œä¸€è·¯èµ°æ¥çš„ç‚¹ç‚¹æ»´æ»´ï¼Œç¡®å®å€¼å¾—è®°å½•ä¸€ä¸‹ã€‚<br><a id="more"></a></p>
<h1 id="å°éœ¸ç‹è®©æˆ‘çŸ¥é“äº†ç¼–ç¨‹"><a href="#å°éœ¸ç‹è®©æˆ‘çŸ¥é“äº†ç¼–ç¨‹" class="headerlink" title="å°éœ¸ç‹è®©æˆ‘çŸ¥é“äº†ç¼–ç¨‹"></a>å°éœ¸ç‹è®©æˆ‘çŸ¥é“äº†ç¼–ç¨‹</h1><p>å¤§çº¦åœ¨æˆ‘å°å­¦ä¸‰å››å¹´çºªçš„æ—¶å€™ï¼Œåœ¨å¤–è¯»ä¹¦çš„èˆ…èˆ…ç»™æˆ‘å’Œå¼Ÿå¼Ÿä¹°äº†ä¸ªå°éœ¸ç‹å­¦ä¹ æœºï¼ˆå¤§äººå½“ç„¶éƒ½æ˜¯æœ¬ç€è®©å°å­©å¥½å¥½å­¦ä¹ çš„ç›®çš„ï¼‰ï¼Œé‡Œè¾¹é¡ºä¾¿å¸¦äº†å¼ æ¸¸æˆå¡ï¼Œæˆ‘è®°å¾—é‡Œè¾¹æœ‰åŒæˆªé¾™ã€æ‹³çš‡ã€‚æ’ä¸Šç”µè§†ï¼Œæˆ‘å’Œè€å¼Ÿä¸€äººä¸€ä¸ªæ‰‹æŸ„ï¼Œæ‰“å¾—é£èµ·ã€‚å‡æœŸæ‰“åˆ°æ‰‹ç–¼ï¼Œå¹³æ—¶ä¸Šå­¦å·ç€ç©ã€‚å¥½æ™¯ä¸é•¿ï¼Œé‚£å¼ å¡æ‰“äº†æœ‰åŠå¹´å…‰æ™¯å°±åäº†ï¼Œæ‰¾äº†ä¸€ä¸ªå­¦æ ¡é«˜å¹´çº§çš„é—®ä¸ºä»€ä¹ˆåäº†ï¼Œä»–å‘Šè¯‰æˆ‘é‚£ä¸ªå¡å¸¦ä¸Šé»‘è‰²çš„ä¸€å¨ä¸œè¥¿åäº†ã€‚èˆ…èˆ…ä»å­¦æ ¡å›æ¥åï¼Œé—®ä»–èƒ½ä¸èƒ½ä¿®å¾—å¥½ï¼Œä»–è¯´ä¸è¡Œï¼Œé‚£ä¸ªé»‘è‰²çš„ä¸€å¨å«åšç»‘å®šå°è£…ï¼Œæ˜¯æŠŠèŠ¯ç‰‡é€šè¿‡æç»†çš„å¯¼çº¿äºç”µè·¯æ¿è¿æ¥åï¼Œæ»´ä¸€æ»´é»‘è‰²çš„èƒ¶åœ¨ä¸Šé¢ï¼Œè¾¾åˆ°é˜»éš”å…‰çº¿ç­‰å¤–ç•Œå½±å“çš„æ•ˆæœï¼Œåäº†æ²¡æ³•ä¿®ã€‚æˆ‘ç»§ç»­é—®ï¼Œé‚£é‡Œè¾¹çš„æ¸¸æˆæ˜¯æ€ä¹ˆåšçš„ï¼Œä»–å½“æ—¶è¯´äº†ä¸€ä¸ªç‰¹åˆ«é«˜å¤§ä¸Šçš„è¯â€œç¼–ç¨‹â€ã€‚</p>
<h1 id="ä»å°å°±æœ‰æˆä¸ºå¤§ç¥çš„æ¢¦æƒ³"><a href="#ä»å°å°±æœ‰æˆä¸ºå¤§ç¥çš„æ¢¦æƒ³" class="headerlink" title="ä»å°å°±æœ‰æˆä¸ºå¤§ç¥çš„æ¢¦æƒ³"></a>ä»å°å°±æœ‰æˆä¸ºå¤§ç¥çš„æ¢¦æƒ³</h1><p>æ‰“é‚£ä¹‹åï¼Œåœ¨ç”µè§†ä¸Šï¼Œä¹¦ä¸Šå¤šå¤šå°‘å°‘éƒ½ä¼šçœ‹åˆ°ä¸€äº›å…³äºâ€œç¼–ç¨‹â€çš„ä¸œè¥¿ï¼Œæ¯”å¦‚è­¦å¯Ÿç ´æ¡ˆï¼Œé»‘çª—å£ä¸Šé—ªå¾—é£å¿«çš„å‘½ä»¤è¡Œï¼›æ¯”å¦‚å½“æ—¶çš„ä¸–ç•Œé¦–å¯Œæ¯”å°”ç›–èŒ¨ä»¥å‰ä¹Ÿæ˜¯ç¼–ç¨‹é«˜æ‰‹ã€‚è‡ªå·±å°±åœ¨å¿ƒé‡Œæƒ³ç€ï¼Œä»¥åå¥½å¥½å­¦ä¹ ï¼Œä¹Ÿå»å­¦ä¹ ç¼–ç¨‹ï¼Œæˆä¸ºå¤§ç¥ã€‚</p>
<h1 id="é˜´å·®é˜³é”™çš„Cäº•"><a href="#é˜´å·®é˜³é”™çš„Cäº•" class="headerlink" title="é˜´å·®é˜³é”™çš„Cäº•"></a>é˜´å·®é˜³é”™çš„Cäº•</h1><p>æ—¶é—´è·‘çš„é£å¿«ï¼Œç´§å¼ çš„é«˜ä¸­ä¸‰å¹´ï¼Œæ¯å¤©æ²‰æµ¸åœ¨è¯­æ•°å¤–ç†åŒ–ç”Ÿä¸­ï¼Œé«˜è€ƒä¹‹åï¼Œåœ¨ä¸€ä¸ªé—²é€‚çš„åˆåï¼Œæˆ‘çˆ¸å¦ˆå‘Šè¯‰æˆ‘ï¼Œæˆ‘è¢«ååŒ—æ°´é™¢å½•å–äº†ï¼Œåœ°ç†ä¿¡æ¯ç³»ç»Ÿä¸“ä¸šã€‚æˆ‘å¯»æ€è¿™æ˜¯å•¥ä¸“ä¸šå•Šï¼Œéƒ½æ²¡å¬è¿‡ï¼Œä¸è¿‡åº”è¯¥æ˜¯è·Ÿåœ°ç†æœ‰å…³çš„ï¼Œå¥½åœ¨æˆ‘åœ°ç†è¿˜ç®—æ¯”è¾ƒå¥½çš„ï¼Œåº”è¯¥è¿˜å¯ä»¥å§ã€‚<br>åˆ°å­¦æ ¡åï¼Œå¬å­¦é•¿è¯´æˆ‘ä»¬ä¸“ä¸šéœ€è¦â€œç¼–ç¨‹â€ï¼Œæˆ‘ä»¿ä½›åˆæƒ³èµ·äº†å°æ—¶å€™çš„æ¢¦æƒ³ï¼Œâ€œé‚£æˆ‘è¯¥æ€ä¹ˆå…¥é—¨å‘¢ï¼Ÿâ€,æˆ‘å¼±å¼±çš„é—®ã€‚â€œCSharpä½ å¯ä»¥å…ˆå­¦ï¼Œå­¦ä¼šäº†å…¶ä»–çš„ç¼–ç¨‹è¯­è¨€ä¹Ÿå°±å¥½å­¦äº†ã€‚â€<br>ç¼–ç¨‹è¯­è¨€ï¼Œæœ‰ä¸€ä¸ªé«˜å¤§ä¸Šçš„åè¯ã€‚æŒ‰ç…§å¸ˆå…„è¯´çš„CSharpï¼Œæˆ‘å»åˆ°å›¾ä¹¦é¦†ä¸€ä¸ªä¸€ä¸ªçš„æ‰¾ï¼Œæœ‰Cã€C++ã€Cäº•ã€JAVAâ€¦å¯å°±æ˜¯æ²¡æ‰¾åˆ°ä»–è¯´çš„CSharpï¼Œæˆ‘å°±é—®å›¾ä¹¦ç®¡ç†å‘˜ï¼Œå’±ä»¬è¿™è¾¹CSharpçš„ä¹¦éƒ½æ”¾åœ¨å“ªé‡Œï¼Œä»–ç¥äº†æˆ‘ä¸€çœ¼ï¼Œâ€œä½ çœ‹ï¼Œä¸å°±åœ¨ä½ èƒŒåå˜›ã€‚â€æˆ‘å›è¿‡èº«ï¼Œâ€œè¿™ä¸æ˜¯Cäº•å—?â€å¿ƒé‡Œæƒ³ï¼Œè¿™äººå±…ç„¶è¿˜è’™éª—å¤§ä¸€æ–°ç”Ÿã€‚â€œåŒå­¦ï¼Œä½ ä¸€å¹´çº§å§ï¼Œè¿™ä¸ªä¸è¯»Cäº•ï¼Œè¿™å°±æ˜¯CSharpã€‚â€è¿™ä¸‹ç³—å¤§äº†â€¦</p>
<h1 id="ç¬¬ä¸€ä¸ªè¹©è„šå°ç¨‹åº"><a href="#ç¬¬ä¸€ä¸ªè¹©è„šå°ç¨‹åº" class="headerlink" title="ç¬¬ä¸€ä¸ªè¹©è„šå°ç¨‹åº"></a>ç¬¬ä¸€ä¸ªè¹©è„šå°ç¨‹åº</h1><p>æ—¶é—´ä¸€ç›´æŒç»­åˆ°å¤§äºŒæš‘å‡å‰ï¼Œä¸“ä¸šè¯¾è€å¸ˆæ‰å¼€å§‹ç»™æˆ‘ä»¬è®²ä¸€äº›ç¼–ç¨‹æ–¹é¢çš„ä¸œè¥¿ï¼Œä¹Ÿæ­£æ˜¯è¿™ä¸ªè€å¸ˆæ­£å¼å¼€å¯äº†æˆ‘åæ¥çš„ç¼–ç¨‹ä¹‹è·¯ã€‚åæ¥åˆé™†é™†ç»­ç»­å­¦ä¹ äº†è®¡ç®—æœºç½‘ç»œã€æ•°æ®ç»“æ„è¿™äº›è¯¾ç¨‹ã€‚åœ¨è¿™ä¸ªè€å¸ˆçš„å¸¦é¢†ä¸‹ï¼Œç¬¬ä¸€æ¬¡é…ç½®SQL Serverï¼Œç¬¬ä¸€æ¬¡å®Œæˆäº†ä¸€ä¸ªè¹©è„šçš„ä¿¡æ¯ç®¡ç†ç³»ç»Ÿï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åœ¨è¯¾å ‚ä¸Šè¢«å¤¸å¥–ï¼ˆå…¶å®å¤§å­¦é˜¶æ®µï¼Œæˆ‘åœ¨å®¿èˆå’Œå›¾ä¹¦é¦†çš„æ—¶é—´è¦æ¯”å»ä¸Šè¯¾çš„æ—¶é—´å¤šå¾—ä¸è¦å¤ªå¤šï¼Œä»¥è‡³äºæ¯•ä¸šçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸“ä¸šçš„äººæˆ‘éƒ½è®¤ä¸å…¨ï¼‰ã€‚é¡ºä¾¿è´´ä¸Šå½“å¹´çš„ç¬¬ä¸€ä¸ªå°ç¨‹åº<br><img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipsesv_jpgç¬¬ä¸€ä¸ªè¹©è„šç¨‹åº.jpg" alt="">.</p>
<h1 id="è€ƒç ”æœŸé—´çš„ç–¯ç‹‚æ¶‰çŒ"><a href="#è€ƒç ”æœŸé—´çš„ç–¯ç‹‚æ¶‰çŒ" class="headerlink" title="è€ƒç ”æœŸé—´çš„ç–¯ç‹‚æ¶‰çŒ"></a>è€ƒç ”æœŸé—´çš„ç–¯ç‹‚æ¶‰çŒ</h1><p>æˆ‘è¿™ä¸ªäººï¼Œå°±æ˜¯é‚£ç§åçŸ¥åè§‰ï¼Œæ¯”è¾ƒå‘†å‚»çš„é‚£ç§ï¼Œåˆ«äººçœ‹ç€æ˜¯å¤§æ™ºè‹¥æ„šï¼Œæˆ‘å¯æ˜¯è´§çœŸä»·å®çš„å‚»ã€‚åˆ«äººç–¯ç‹‚è‡ªä¹ å‡†å¤‡è€ƒç ”çš„æ—¶å€™ï¼Œæˆ‘åœ¨æ‰“æ¸¸æˆï¼Œåˆ«äººå»è€ƒç ”çš„æ—¶å€™ï¼Œæˆ‘è¿˜åœ¨æ‰“æ¸¸æˆã€‚ç›´åˆ°å¤§å››ä¸‹å­¦æœŸï¼Œåœ¨å®¶è¿‡äº†å¹´ï¼Œå†åŠ ä¸Šä¸€äº›ç‰¹æ®Šçš„åŸå› ï¼Œæˆ‘å†³å®šï¼Œæˆ‘å¾—å»è€ƒç ”æ‰è¡Œï¼ˆå› ä¸ºåœ¨å¤§å­¦æœŸé—´å­¦åˆ°çš„ä¸œè¥¿ç¡®å®å¤ªå°‘äº†ï¼Œæ€ªæˆ‘è‡ªå·±ï¼Œæˆ‘å¤ªè´ªç©ï¼‰ã€‚é€‚é€¢ä»å°ç©åˆ°å¤§çš„å¥½å“¥ä»¬ä¹Ÿåœ¨è€ƒç ”ï¼Œæˆ‘ä¾¿æ¬å»å’Œä»–ä¸€èµ·å¹¶è‚©ä½œæˆ˜ã€‚åœ¨æ²³å—ç†å·¥å¤ä¹ è€ƒç ”ï¼Œæ¯å¤©éƒ½åœ¨å›¾ä¹¦é¦†è‡ªä¹ å®¤çœ‹ä¹¦ã€‚å¶å°”ä¼šæƒ³ï¼Œå¦‚æœè€ƒä¸Šäº†ï¼Œè‡ªå·±è¿™ä¹ˆæ°´æ€ä¹ˆè¡Œï¼Œå¬è¯´é‚£è¾¹äººç¼–ç¨‹éƒ½å¾ˆå‰å®³ï¼Œæˆ‘ä¹Ÿå¾—å‰å®³ç‚¹æ‰è¡Œã€‚äºæ˜¯ï¼Œæ²³å—ç†å·¥å›¾ä¹¦é¦†è®¡ç®—æœºç›¸å…³çš„ä¹¦ç±è¢«æˆ‘æ‰¿åŒ…äº†ï¼ŒPHPã€JavaScriptã€C++ã€Pythonã€åšé­”å…½ä¸–ç•Œæ’ä»¶çš„Luaï¼Œæœ‰çš„æ²¡çš„æˆ‘éƒ½çœ‹è¿‡ï¼ˆå½“ç„¶ï¼Œé‚£å¤§åŠå¹´æ—¶é—´ï¼Œæ²¡å°‘çœ‹ä¹¦ç¦å°”æ‘©æ–¯æ¢æ¡ˆã€å†°ä¸ç«ä¹‹æ­Œã€ç”µå½±è°å½±é‡é‡çš„åŸè‘—ä¼¯æ©ç³»åˆ—ç­‰ç­‰ç­‰ç­‰ï¼‰ã€‚å°±è¿™æ ·ï¼Œ2014å¹´1æœˆ3å·æˆ‘è®°å¾—ï¼Œé¡¶ç€å¿«è¦ä¸‹å±±çš„æœˆäº®ï¼Œåœ¨å¥½å‹çš„é™ªåŒä¸‹åä¸Šäº†å›å®¶è€ƒè¯•çš„è½¦ã€‚è€ƒå®Œä¹‹åï¼Œå°±æ²¡æƒ³è€ƒä¸ä¸Šçš„äº‹æƒ…ï¼Œè¿™è¦æ˜¯å†è€ƒä¸ä¸Šï¼Œå°±æ²¡äººèƒ½è€ƒå¾—ä¸Šäº†ï¼ˆå°±æ˜¯è¿™ä¹ˆè‡ªä¿¡ï¼‰ã€‚</p>
<h1 id="è¯»ç ”æœŸé—´å…¨æ–°çš„ç¯‡ç« "><a href="#è¯»ç ”æœŸé—´å…¨æ–°çš„ç¯‡ç« " class="headerlink" title="è¯»ç ”æœŸé—´å…¨æ–°çš„ç¯‡ç« "></a>è¯»ç ”æœŸé—´å…¨æ–°çš„ç¯‡ç« </h1><p>æœ¬ç€å­¦å¥½æŠ€æœ¯çš„ç›®çš„ï¼Œ14å¹´7æœˆ12å·ï¼Œæˆ‘æ¥åˆ°æ­¦å¤§ï¼Œ14å¹´ä¸‹åŠå¹´ï¼Œæˆ‘åˆ†åˆ«æ¥è§¦äº†WPFã€Redisã€MongoDBï¼ŒGithubä¹Ÿæ˜¯æ‰“é‚£æ—¶å€™æ‰å¼€å§‹ç”¨çš„ã€‚å¼€æºè½¯ä»¶çš„è“¬å‹ƒå‘å±•ï¼Œç¡®å®è®©æˆ‘æ„Ÿåˆ°éœ‡æƒŠï¼Œä¹Ÿæš—æš—ä¸‹å®šå†³å¿ƒï¼Œæˆ‘ä»¥åä¹Ÿè¦æˆä¸ºèƒ½æœ‰ä¸Šåƒä¸ªStarçš„é€‰æ‰‹ï¼ˆè™½ç„¶è‡³ä»Šéƒ½æ²¡æœ‰ä¸€ä¸ªStar,=.=)ã€‚15å¹´ä¸ŠåŠå¹´ï¼Œè‡ªæˆ‘æ„Ÿè§‰æ˜¯æˆé•¿æœ€å¤§çš„ä¸€æ®µæ—¶é—´ï¼Œä»WebæœåŠ¡å™¨ï¼ŒTCP/IPåè®®ï¼Œå„ç±»ä¸»æµNoSQLæ•°æ®åº“ï¼Œå†…å­˜æ•°æ®åº“é›†ç¾¤ï¼ŒæœåŠ¡å™¨ç«¯è„šæœ¬ç­‰ç­‰ï¼Œä»¥å‰ä»ä¹¦ä¸Šçœ‹åˆ°çš„ä¸œè¥¿ï¼Œä»æˆ‘çš„ä¸€ä¸ªä¸€ä¸ªVISIOå›¾è½åœ°å®ç°ã€‚<br>15å¹´9æœˆä»½åˆ°11æœˆï¼Œä»å¦å¤–ä¸€ä¸ªè§’åº¦è®©æˆ‘æˆé•¿ï¼Œä¸€ä¸ªåˆä¸€ä¸ªé¢è¯•å¤±è´¥ï¼Œè®©æˆ‘å‘ç°ï¼Œè‡ªå·±åšçš„ä¸œè¥¿éƒ½åªæ˜¯ç©å…·ï¼Œè·ŸçœŸæ­£è¾¾åˆ°é«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„çŠ¶æ€ç›¸å»ç”šè¿œã€‚åŒæ—¶ï¼Œæé™ç¼–ç¨‹ã€æ•æ·å¼€å‘ã€TDDç­‰ç­‰ä»¥å‰ä¹Ÿåªæ˜¯åœ¨ä¹¦ä¸Šçœ‹åˆ°çš„ä¸œè¥¿ï¼Œæˆä¸ºäº†é¢è¯•å®˜è¯„åˆ¤å®åŠ›çš„æ ‡å‡†ã€‚</p>
<h1 id="è„šè¸å®åœ°"><a href="#è„šè¸å®åœ°" class="headerlink" title="è„šè¸å®åœ°"></a>è„šè¸å®åœ°</h1><p>ä½œä¸ºä¸€ä¸ªè¹©è„šçš„åŠåŠå­éä¸“ä¸šé€‰æ‰‹ï¼Œæœªæ¥çš„è·¯è¿˜å¾ˆé•¿ï¼Œæˆ‘æ‰“ç®—ä»ä»¥ä¸‹å‡ ç‚¹æå‡è‡ªå·±çš„æ°´å¹³ï¼š</p>
<ul>
<li>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ï¼ˆMySQL PostGreSQLï¼‰</li>
<li>è®¾è®¡æ¨¡å¼</li>
<li>æ•°æ®ç»“æ„</li>
<li>æ·±å…¥å­¦ä¹ å…¨æ ˆJavaScriptå¼€å‘</li>
<li>Linuxæ—¥å¸¸æ“ä½œï¼ˆå¬æ–°æµªçš„é¢è¯•å®˜å¤§å”è¯´ç†Ÿç»ƒæ“ä½œé¸Ÿå“¥ç§æˆ¿èœå°±å¯ä»¥å•¦ï¼‰</li>
</ul>
<h1 id="ä»°æœ›æ˜Ÿç©º"><a href="#ä»°æœ›æ˜Ÿç©º" class="headerlink" title="ä»°æœ›æ˜Ÿç©º"></a>ä»°æœ›æ˜Ÿç©º</h1><p>å’Œä¸‰å“¥ä¸€èµ·åœ¨ççˆå±±ä¸Šèµ°åœˆï¼ŒæŠ¬å¤´çœ‹åˆ°æ»¡å¤©ç¹æ˜Ÿï¼Œæˆ‘ä»€ä¹ˆæ—¶å€™æ‰èƒ½æœ‰é‚£ä¹ˆå¤šçš„Starã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> å¿ƒæƒ…æ–‡å­— </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[C#ä¸­çš„virtualã€abstractå’Œinterface]]></title>
      <url>/2015/10/28/C-%E4%B8%AD%E7%9A%84virtual%E5%92%8Cabstract/</url>
      <content type="html"><![CDATA[<p><small><a href="http://www.cnblogs.com/blsong/archive/2010/08/12/1798064.html" target="_blank" rel="external">æœ¬æ–‡è½¬è‡ª</a></small></p>
<hr>
<p>åœ¨C#çš„å­¦ä¹ ä¸­ï¼Œå®¹æ˜“æ··æ·†virtualæ–¹æ³•å’Œabstractæ–¹æ³•çš„ä½¿ç”¨ï¼Œç°åœ¨æ¥è®¨è®ºä¸€ä¸‹äºŒè€…çš„åŒºåˆ«ã€‚äºŒè€…éƒ½ç‰µæ¶‰åˆ°åœ¨æ´¾ç”Ÿç±»ä¸­ä¸overrideçš„é…åˆä½¿ç”¨ã€‚<br><a id="more"></a></p>
<h1 id="Virtualæ–¹æ³•ï¼ˆè™šæ–¹æ³•ï¼‰"><a href="#Virtualæ–¹æ³•ï¼ˆè™šæ–¹æ³•ï¼‰" class="headerlink" title="Virtualæ–¹æ³•ï¼ˆè™šæ–¹æ³•ï¼‰"></a>Virtualæ–¹æ³•ï¼ˆè™šæ–¹æ³•ï¼‰</h1><p>virtual å…³é”®å­—ç”¨äºåœ¨åŸºç±»ä¸­ä¿®é¥°æ–¹æ³•ã€‚virtualçš„ä½¿ç”¨ä¼šæœ‰ä¸¤ç§æƒ…å†µï¼š<br>æƒ…å†µ1ï¼šåœ¨åŸºç±»ä¸­å®šä¹‰äº†virtualæ–¹æ³•ï¼Œä½†åœ¨æ´¾ç”Ÿç±»ä¸­æ²¡æœ‰é‡å†™è¯¥è™šæ–¹æ³•ã€‚é‚£ä¹ˆåœ¨å¯¹æ´¾ç”Ÿç±»å®ä¾‹çš„è°ƒç”¨ä¸­ï¼Œè¯¥è™šæ–¹æ³•ä½¿ç”¨çš„æ˜¯åŸºç±»å®šä¹‰çš„æ–¹æ³•ã€‚<br>æƒ…å†µ2ï¼šåœ¨åŸºç±»ä¸­å®šä¹‰äº†virtualæ–¹æ³•ï¼Œç„¶ååœ¨æ´¾ç”Ÿç±»ä¸­ä½¿ç”¨overrideé‡å†™è¯¥æ–¹æ³•ã€‚é‚£ä¹ˆåœ¨å¯¹æ´¾ç”Ÿç±»å®ä¾‹çš„è°ƒç”¨ä¸­ï¼Œè¯¥è™šæ–¹æ³•ä½¿ç”¨çš„æ˜¯æ´¾ç”Ÿé‡å†™çš„æ–¹æ³•ã€‚</p>
<h1 id="Abstractæ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰"><a href="#Abstractæ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰" class="headerlink" title="Abstractæ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰"></a>Abstractæ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰</h1><p>abstractå…³é”®å­—åªèƒ½ç”¨åœ¨æŠ½è±¡ç±»ä¸­ä¿®é¥°æ–¹æ³•ï¼Œå¹¶ä¸”æ²¡æœ‰å…·ä½“çš„å®ç°ã€‚æŠ½è±¡æ–¹æ³•çš„å®ç°å¿…é¡»åœ¨æ´¾ç”Ÿç±»ä¸­ä½¿ç”¨overrideå…³é”®å­—æ¥å®ç°ã€‚</p>
<h1 id="æ¥å£å’ŒæŠ½è±¡ç±»"><a href="#æ¥å£å’ŒæŠ½è±¡ç±»" class="headerlink" title="æ¥å£å’ŒæŠ½è±¡ç±»"></a>æ¥å£å’ŒæŠ½è±¡ç±»</h1><p>æœ€æœ¬è´¨çš„åŒºåˆ«ï¼šæŠ½è±¡ç±»æ˜¯ä¸€ä¸ªä¸å®Œå…¨çš„ç±»ï¼Œæ˜¯å¯¹å¯¹è±¡çš„æŠ½è±¡ï¼Œè€Œæ¥å£æ˜¯ä¸€ç§è¡Œä¸ºè§„èŒƒã€‚<br>C# æ˜¯é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡è¯­è¨€ï¼Œæ¯ä¸€ä¸ªå‡½æ•°éƒ½å±äºä¸€ä¸ªç±»ã€‚<br>Staticï¼šå½“ä¸€ä¸ªæ–¹æ³•è¢«å£°æ˜ä¸ºStaticæ—¶ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶ä¿ç•™è¿™ä¸ªæ–¹æ³•çš„å®ç°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å±äºç±»ï¼Œä½†æ˜¯ä¸å±äºä»»ä½•æˆå‘˜ï¼Œä¸ç®¡è¿™ä¸ªç±»çš„å®ä¾‹æ˜¯å¦å­˜åœ¨ï¼Œå®ƒä»¬éƒ½ä¼šå­˜åœ¨ã€‚å°±åƒå…¥å£å‡½æ•°Static void Mainï¼Œå› ä¸ºå®ƒæ˜¯é™æ€å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¢«è°ƒç”¨ã€‚<br>Virtualï¼šå½“ä¸€ä¸ªæ–¹æ³•è¢«å£°æ˜ä¸ºVirtualæ—¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–¹æ³•ï¼Œç›´åˆ°ä½ ä½¿ç”¨ClassName variable = new ClassName();å£°æ˜ä¸€ä¸ªç±»çš„å®ä¾‹ä¹‹å‰ï¼Œå®ƒéƒ½ä¸å­˜åœ¨äºçœŸå®çš„å†…å­˜ç©ºé—´ä¸­ã€‚è¿™ä¸ªå…³é”®å­—åœ¨ç±»çš„ç»§æ‰¿ä¸­éå¸¸å¸¸ç”¨ï¼Œç”¨æ¥æä¾›ç±»æ–¹æ³•çš„å¤šæ€æ€§æ”¯æŒã€‚<br>abstractï¼šæŠ½è±¡æ–¹æ³•å£°æ˜ä½¿ç”¨ï¼Œæ˜¯å¿…é¡»è¢«æ´¾ç”Ÿç±»è¦†å†™çš„æ–¹æ³•ï¼ŒæŠ½è±¡ç±»å°±æ˜¯ç”¨æ¥è¢«ç»§æ‰¿çš„ï¼›å¯ä»¥çœ‹æˆæ˜¯æ²¡æœ‰å®ç°ä½“çš„è™šæ–¹æ³•ï¼›å¦‚æœç±»ä¸­åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆç±»å°±å¿…é¡»å®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œä¸è®ºæ˜¯å¦è¿˜åŒ…å«å…¶ä»–ä¸€èˆ¬æ–¹æ³•ï¼›æŠ½è±¡ç±»ä¸èƒ½æœ‰å®ä½“çš„ã€‚</p>
<h1 id="Talk-is-cheap-Letâ€™s-code"><a href="#Talk-is-cheap-Letâ€™s-code" class="headerlink" title="Talk is cheap,Letâ€™s code"></a>Talk is cheap,Letâ€™s code</h1><p>interface:ç”¨æ¥å£°æ˜æ¥å£<br>1.åªæä¾›ä¸€äº›æ–¹æ³•è§„çº¦ï¼Œä¸æä¾›æ–¹æ³•ä¸»ä½“. å¦‚:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public interface IPerson</div><div class="line">&#123;</div><div class="line">	void getName();//ä¸åŒ…å«æ–¹æ³•ä¸»ä½“</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2.æ–¹æ³•ä¸èƒ½ç”¨public abstractç­‰ä¿®é¥°,æ— å­—æ®µå˜é‡ï¼Œæ— æ„é€ å‡½æ•°ã€‚<br>3.æ–¹æ³•å¯åŒ…å«å‚æ•°ã€‚ å¦‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public interface IPerson</div><div class="line">&#123;</div><div class="line">	void getAge(string s);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ä¸€ä¸ªä¾‹å­(ä¾‹1)ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">public interface IPerson</div><div class="line">&#123;</div><div class="line">    IPerson(); //é”™è¯¯</div><div class="line">    string name; //é”™è¯¯</div><div class="line">    public void getIDcard();//é”™è¯¯</div><div class="line">    void getName(); //right</div><div class="line">    void getAge(string s); //right</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å®ç°interfaceçš„ç±»<br>1.ä¸ç»§æ‰¿ç±»çš„æ ¼å¼ä¸€è‡´ï¼Œå¦‚ public class Chinese:IPerson{}<br>2.å¿…é¡»å®ç° interface ä¸­çš„å„ä¸ªæ–¹æ³•<br>ä¾‹2ï¼Œç»§æ‰¿ä¾‹1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public class Chinese:IPerson</div><div class="line">&#123;</div><div class="line">    public Chinese()&#123;&#125; //æ·»åŠ æ„é€ </div><div class="line">    public void getName()&#123;&#125; //å®ç°getName()</div><div class="line">    public void getAge(string s)&#123;&#125; //å®ç°getAge()</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>abstract:å£°æ˜æŠ½è±¡ç±»ã€æŠ½è±¡æ–¹æ³•<br>1.æŠ½è±¡æ–¹æ³•æ‰€åœ¨ç±»å¿…é¡»ä¸ºæŠ½è±¡ç±»<br>2.æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œå¿…é¡»ç”±å…¶æ´¾ç”Ÿç±»å®ç°ã€‚<br>3.æŠ½è±¡æ–¹æ³•ä¸åŒ…å«æ–¹æ³•ä¸»ä½“ï¼Œå¿…é¡»ç”±æ´¾ç”Ÿç±»ä»¥overrideæ–¹å¼å®ç°æ­¤æ–¹æ³•,è¿™ç‚¹è·Ÿinterfaceä¸­çš„æ–¹æ³•ç±»ä¼¼<br>å¦‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">public abstract class Book</div><div class="line">&#123;</div><div class="line">    public Book()</div><div class="line">    &#123;</div><div class="line">    &#125;</div><div class="line">    public abstract void getPrice(); //æŠ½è±¡æ–¹æ³•ï¼Œä¸å«ä¸»ä½“</div><div class="line">    public virtual void getName() //è™šæ–¹æ³•ï¼Œå¯è¦†ç›–</div><div class="line">    &#123;</div><div class="line">    	Console.WriteLine(&quot;this is a test:virtual getName()&quot;);</div><div class="line">    &#125;</div><div class="line">    public virtual void getContent() //è™šæ–¹æ³•ï¼Œå¯è¦†ç›–</div><div class="line">    &#123;</div><div class="line">    	Console.WriteLine(&quot;this is a test:virtual getContent()&quot;);</div><div class="line">    &#125;</div><div class="line">    public void getDate() //ä¸€èˆ¬æ–¹æ³•ï¼Œè‹¥åœ¨æ´¾ç”Ÿç±»ä¸­é‡å†™ï¼Œé¡»ä½¿ç”¨newå…³é”®å­—</div><div class="line">    &#123;</div><div class="line">    	Console.WriteLine(&quot;this is a test: void getDate()&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">public class JavaBook:Book</div><div class="line">&#123;</div><div class="line">    public override void getPrice() //å®ç°æŠ½è±¡æ–¹æ³•ï¼Œå¿…é¡»å®ç°</div><div class="line">    &#123;</div><div class="line">    	Console.WriteLine(&quot;this is a test:JavaBook override abstract getPrice()&quot;);</div><div class="line">    &#125;</div><div class="line">    public override void getName() //è¦†ç›–åŸæ–¹æ³•ï¼Œä¸æ˜¯å¿…é¡»çš„</div><div class="line">    &#123;</div><div class="line">    	Console.WriteLine(&quot;this is a test:JavaBook override virtual getName()&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æµ‹è¯•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public class test</div><div class="line">&#123;</div><div class="line">    public test()</div><div class="line">    &#123;</div><div class="line">        JavaBook jbook=new JavaBook();</div><div class="line">        jbook.getPrice(); //å°†è°ƒç”¨JavaBookä¸­getPrice()</div><div class="line">        jbook.getName(); //å°†è°ƒç”¨JavaBookä¸­getName()</div><div class="line">        jbook.getContent(); //å°†è°ƒç”¨Bookä¸­getContent()</div><div class="line">        jbook.getDate(); //å°†è°ƒç”¨Bookä¸­getDate()</div><div class="line">    &#125;</div><div class="line">    public static void Main()</div><div class="line">    &#123;</div><div class="line">    	test t=new test();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>virtual:æ ‡è®°æ–¹æ³•ä¸ºè™šæ–¹æ³•<br>1.å¯åœ¨æ´¾ç”Ÿç±»ä¸­ä»¥overrideè¦†ç›–æ­¤æ–¹æ³•<br>2.ä¸è¦†ç›–ä¹Ÿå¯ç”±å¯¹è±¡è°ƒç”¨<br>3.æ— æ­¤æ ‡è®°çš„æ–¹æ³•(ä¹Ÿæ— å…¶ä»–æ ‡è®°)ï¼Œé‡å†™æ—¶éœ€ç”¨newéšè—åŸæ–¹æ³•<br>abstract ä¸virtual : æ–¹æ³•é‡å†™æ—¶éƒ½ä½¿ç”¨ override å…³é”®å­—æ¥å£å®šä¹‰ä»¥å¤§å†™å­—æ¯Iå¼€å¤´ã€‚æ–¹æ³•åªå®šä¹‰å…¶åç§°,åœ¨C#ä¸­ï¼Œæ–¹æ³•é»˜è®¤æ˜¯å…¬æœ‰æ–¹æ³•ï¼›ç”¨publicä¿®é¥°æ–¹æ³•æ˜¯ä¸å…è®¸çš„,å¦åˆ™ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼›æ¥å£å¯ä»¥ä»åˆ«çš„æ¥å£ç»§æ‰¿ï¼Œå¦‚æœæ˜¯ç»§æ‰¿å¤šä¸ªæ¥å£ï¼Œåˆ™çˆ¶æ¥å£åˆ—è¡¨ç”¨é€—å·é—´éš”ã€‚<br>æ¥å£å¯ä»¥é€šè¿‡ç±»æ¥å®ç°ï¼Œå½“ç±»çš„åŸºåˆ—è¡¨åŒæ—¶åŒ…å«åŸºç±»å’Œæ¥å£æ—¶ï¼Œåˆ—è¡¨ä¸­é¦–å…ˆå‡ºç°çš„æ˜¯åŸºç±»ï¼›ç±»å¿…é¡»è¦å®ç°å…¶æŠ½è±¡æ–¹æ³•ï¼›<br>æ¥å£ä½¿ç”¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">namespace Dage.Interface</div><div class="line">&#123;</div><div class="line">    //æ‰“å°æœºæ¥å£</div><div class="line">    public interface IPrint</div><div class="line">    &#123;</div><div class="line">    	string returnPrintName();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">//--------------------------------------------</div><div class="line">using System;</div><div class="line">using Dage.Interface;</div><div class="line">namespace Dage.Print</div><div class="line">&#123;</div><div class="line">    //HPç‰Œæ‰“å°æœºç±»</div><div class="line">    public class HP: IPrint</div><div class="line">    &#123;</div><div class="line">        public string returnPrintName()</div><div class="line">        &#123;</div><div class="line">        	return &quot;è¿™æ˜¯HPç‰Œæ‰“å°æœº&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">//--------------------------------------------</div><div class="line">using System;</div><div class="line">namespace Dage.Print</div><div class="line">&#123;</div><div class="line">    //Epsç‰Œæ‰“å°æœºç±»</div><div class="line">    public class Eps: IPrint</div><div class="line">    &#123;</div><div class="line">        public string returnPrintName()</div><div class="line">        &#123;</div><div class="line">        	return &quot;è¿™æ˜¯Epsç‰Œæ‰“å°æœº&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">//--------------------------------------------</div><div class="line">using System;</div><div class="line">using Dage.Interface;</div><div class="line">namespace Dage</div><div class="line">&#123;</div><div class="line">    //æ‰“å°ç±»</div><div class="line">    public class Printer</div><div class="line">    &#123;</div><div class="line">        public Printer()</div><div class="line">        &#123;&#125;</div><div class="line">        public string PrintName(IPrint iPrint)</div><div class="line">        &#123;</div><div class="line">        	return iPrint.returnPrintName();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">//--------------------------------------------</div></pre></td></tr></table></figure></p>
<p>â€“WinFromä¸­è°ƒç”¨ä»£ç :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">private void button1_Click(object sender, System.EventArgs e)</div><div class="line">&#123;</div><div class="line">    Printer p= new Printer();</div><div class="line">    switch (this.comboBox1.Text)</div><div class="line">    &#123;</div><div class="line">        case &quot;HP&quot;:</div><div class="line">        MessageBox.Show(p.PrintName(new HP()));</div><div class="line">        break;</div><div class="line">        case &quot;Eps&quot;:</div><div class="line">        MessageBox.Show(p.PrintName(new Eps()));</div><div class="line">        break;</div><div class="line">        default:</div><div class="line">        MessageBox.Show(&quot;æ²¡æœ‰å‘ç°è¿™ä¸ªå“ç‰Œï¼&quot;);</div><div class="line">        break;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
]]></content>
      
        
        <tags>
            
            <tag> C# </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[15å¹´çš„9æœˆå’Œ10æœˆ]]></title>
      <url>/2015/10/20/15%E5%B9%B4%E7%9A%849%E6%9C%88%E5%92%8C10%E6%9C%88/</url>
      <content type="html"><![CDATA[<p>ä»…ä»¥æ­¤æ–‡ï¼Œä»Šå¹´æ‰¾å·¥ä½œçš„è¿™ä¸¤ä¸ªæœˆï¼Œè™½ç„¶ä»ç„¶æ²¡æœ‰æ‹¿åˆ°offer,ä½†æ˜¯éœ€è¦é™ä¸‹å¿ƒæ¥ä»”ç»†æ€ç´¢ä¸€ä¸‹äº†ã€‚<br><a id="more"></a><br>9æœˆ22å·ï¼Œæ¥åˆ°äº†æ¥è‡ªç½‘æ˜“æ¸¸æˆçš„é¢è¯•é€šçŸ¥çŸ­ä¿¡ï¼Œå¿ƒé‡Œå¾ˆæ˜¯å¼€å¿ƒï¼Œæ²¡æƒ³åˆ°é‚£ä¹ˆéš¾çš„ç¬”è¯•ä¹Ÿå¯ä»¥é€šè¿‡ã€‚<br>9æœˆ25å·ï¼Œä¸€å¤§æ—©å°±èµ·åºŠï¼Œåè½¦æ¥åˆ°å…‰è°·ï¼Œ8ç‚¹åŠä¸åˆ°å°±åˆ°äº†é…’åº—ï¼Œæˆ‘æ˜¯9ç‚¹15é¢è¯•çš„ï¼Œç­‰ç€é¢è¯•çš„é‚£ä¼šï¼Œå¿ƒé‡Œå¿å¿‘ä¸å·²ï¼Œæ¯•ç«Ÿè‡ªå·±éè®¡ç®—æœºç§‘ç­å‡ºèº«ï¼Œå†åŠ ä¸Šç½‘æ˜“æ¸¸æˆæ˜¯å‡ºäº†åçš„éš¾è¿›ï¼Œåœ¨é‚£é‡Œç­‰å¾…é¢è¯•ä¹ŸçœŸæ˜¯å¦‚åé’ˆæ¯¡ã€‚æœä¸å…¶ç„¶ï¼Œç»ˆäºè½®åˆ°æˆ‘äº†ï¼Œä¸¤ä¸ªé¢è¯•å®˜å¾ˆå’Œè”¼çš„å¼€é—¨ï¼Œç„¶ååä¸‹æ‹¿ç€æˆ‘çš„ç®€å†çœ‹äº†ä¸€éï¼Œé—®äº†ä¸€äº›å¾ˆåŸºç¡€çš„é—®é¢˜ï¼šè§£é‡Šä¸€ä¸‹åƒµå°¸è¿›ç¨‹ï¼›è¯¦ç»†æè¿°ä¸€ä¸‹TCPè¿æ¥ä¸­ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹ï¼›ç»™å‡ºä¸€ä¸ªåœºæ™¯ï¼Œå†™å‡ºSQLè¯­å¥â€¦â€¦è™½ç„¶é—®çš„é—®é¢˜éƒ½å¾ˆåŸºç¡€ï¼Œä½†æ˜¯è‡ªå·±å¹³æ—¶ä¹Ÿæ˜¯çŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæ¯ä¸ªé—®é¢˜éƒ½èƒ½è¯´ä¸Šä¸€ç‚¹ï¼Œä½†æ˜¯éƒ½ä¸æ·±å…¥ã€‚æœç„¶ï¼Œ40åˆ†é’Ÿä¸åˆ°ï¼Œä¸¤ä½é¢è¯•å®˜éƒ½è¯´è‡ªå·±æ²¡ä»€ä¹ˆé—®äº†ï¼Œä»Šå¤©çš„é¢è¯•å°±åˆ°æ­¤ä¸ºæ­¢äº†ã€‚ç°æºœæºœçš„èµ°å‡ºé…’åº—ï¼Œè‡ªçŸ¥å¸Œæœ›æ¸ºèŒ«ï¼Œæœç„¶ï¼Œä¸€é¢ä¹‹åå†æ— éŸ³è®¯ã€‚å°±è¿™æ ·ï¼Œé”™å¤±äº†è‡ªå·±æœ€æƒ³è¦è¿›çš„å…¬å¸ã€‚<br>é”™è¿‡ç½‘æ˜“æ¸¸æˆä¹‹åï¼Œå°±å¼€å§‹æµ·æŠ•ï¼Œå„ç§å…¬å¸ã€‚<br>10æœˆ14å·ï¼Œå€¼å¾—çºªå¿µçš„ä¸€å¤©ã€‚æ—©èµ·ï¼Œå‡†å¤‡ä¸Šåˆ11ç‚¹åŠåœ¨æ­¦æ±‰ç†å·¥çš„æ·±ä¿¡æœé¢è¯•ï¼Œèƒ½å¤Ÿèµ°åˆ°é¢è¯•ï¼Œä¹Ÿå®å±ä¸æ˜“ã€‚å¯¹äºä»¥å‰åªæ˜¯å¬è¿‡VPNçš„æˆ‘æ¥è¯´ï¼Œéœ€è¦è¡¥å……çš„çŸ¥è¯†å¤ªå¤šï¼Œåœ¨é¢è¯•ä¹‹å‰ï¼Œä¹Ÿæ˜¯å¹¿æ³›çš„æœé›†ç›¸å…³çš„ä¸œè¥¿æ¶è¡¥ã€‚ä¸åˆ°åç‚¹ï¼Œæ‰“å°å¥½ç®€å†ä¾¿å‡ºå‘äº†ï¼Œä¸€ç›´åœ¨ç­‰ç€ï¼Œ11ç‚¹40å·¦å³ï¼Œé¢è¯•å®˜å–Šäº†6ä¸ªäººä¸€èµ·è¿›å»é¢è¯•ï¼Œæˆ‘æ‰åˆšåˆšçŸ¥é“å±…ç„¶æ˜¯ç¾¤é¢ï¼Œè¿™å¯¹äºä»æ¥ä¸å–œæ¬¢åœ¨ä¼—äººé¢å‰è¯´è¯çš„æˆ‘æ¥è¯´ï¼ŒçœŸçš„æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚é¢è¯•ç»“æœä¹Ÿæ˜¯å¯æƒ³è€ŒçŸ¥ï¼Œç›¸æ¯”äºèº«ç»ç™¾æˆ˜çš„é¢éœ¸ä»¬ï¼Œæˆ‘è‡ªç„¶æ˜¯ç›¸å½¢è§ç»Œã€‚<br>ä¸­åˆå›åˆ°å­¦æ ¡å·²ç»æ˜¯1ç‚¹åŠï¼Œåªèƒ½å»ä¹°äº›æ³¡é¢ï¼Œç«è…¿æ¥åƒã€‚ä¸‹åˆä¸¤ç‚¹åŠï¼Œå»å‚åŠ ThoughtWorksï¼ˆåç§°TWï¼‰çš„å®£è®²ä¼šï¼ŒåŒæ ·çš„ï¼Œè¿™å®¶å…¬å¸æˆ‘ä¹Ÿæ˜¯ä»°æ…•è®¸ä¹…ï¼Œæˆ‘å¾ˆæ¬£èµä»–ä»¬å¯¹äºç¼–ç¨‹çš„æ€åº¦ï¼Œå¯¹äºè½¯ä»¶å·¥ç¨‹çš„çœ‹æ³•ï¼Œæˆ‘ä¹Ÿå¾ˆå¸Œæœ›èƒ½å¤Ÿå’Œä»–ä»¬é‚£æ ·çš„äººå·¥ä½œåœ¨ä¸€èµ·ã€‚å®£è®²ä¹‹åï¼Œä¾¿å¼€å§‹äº†ç¬”è¯•ï¼Œä½œä¸ºä¸€å®¶ä¸ä¼—ä¸åŒçš„å…¬å¸ï¼Œä»–ä»¬çš„ç¬”è¯•ä¹Ÿæ˜¯ç‹¬å‡ºå¿ƒè£ï¼Œåšç€ä»–ä»¬çš„ç¬”è¯•é¢˜ï¼Œè‡ªå·±ä»¿ä½›æ­£å¦‚TWçš„HRæ‰€è¯´ï¼Œå˜èº«æˆä¸ºä¸€å°è®¡ç®—æœºï¼ŒæŒ‰ç…§ä¸€æ¡æ¡æŒ‡ä»¤è¿è¡Œå¾—å‡ºæœ€ç»ˆç»“æœã€‚å¾ˆå¿«ï¼Œä¸€ä¸ªåŠå°æ—¶è¿‡å»ï¼Œäº¤ä¸Šç­”å·ã€‚<br>æ¯•ç«Ÿå·²ç»æ˜¯10æœˆä»½ï¼Œè¿›å…¥ç§‹å¤©ï¼Œå¤©é»‘çš„æœç„¶æ—©äº†è®¸å¤šï¼Œ5ç‚¹åŠå›åˆ°å®¿èˆï¼Œæ¥åˆ°æ–°æµªçš„é¢è¯•é€šçŸ¥ï¼Œæ™šä¸Š7ç‚¹ã€‚å¿ƒæƒ³ç€ç‰¹ä¹ˆçš„ï¼Œæˆ‘ç¬”è¯•å¤§é¢˜éƒ½æ²¡åšï¼Œè¿™è®©æˆ‘å»é¢è¯•ï¼Œä¸èƒ½åˆ°äº†æ‰“æˆ‘ä¸€é¡¿å§ï¼Ÿä½†æ˜¯ï¼Œåœ¨å®¿èˆé—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œä¸å¦‚å»ç¢°ç¢°è¿æ°”å§ã€‚ä¸€ä¸ªäººï¼Œå–ç€ä¸€ç“¶é…¸å¥¶ï¼Œ6ç‚¹åŠåˆ°äº†é¢è¯•åœ°ç‚¹ï¼Œå‘ç°äººè¿˜å¾ˆå¤šã€‚7ç‚¹å‡†æ—¶ï¼Œé¢è¯•å®˜å–Šæˆ‘è¿‡å»ã€‚è¿™æ¬¡é¢è¯•æ˜¯æˆ‘ç»å†æ‰€æœ‰é¢è¯•æ„Ÿè§‰æœ€å¥½çš„ä¸€æ¬¡äº†ï¼Œå€’ä¸æ˜¯è¯´è‡ªå·±è¡¨ç°å¾ˆå¥½ï¼Œè€Œæ˜¯è§‰å¾—æ–°æµªçš„é¢è¯•å®˜äººéƒ½è¶…çº§å¥½ã€‚æˆ‘æŠ•çš„æ•°æ®åº“æ–¹å‘çš„å²—ä½ï¼Œé¢è¯•å®˜æ‹¿ç€æˆ‘çš„ç®€å†å’Œç¬”è¯•å·å­çœ‹äº†ä¸€ä¸‹è¯´ï¼Œä½ ç¬”è¯•å¤§é¢˜éƒ½æ²¡åšå•Šã€‚æˆ‘ä¹Ÿåªå¥½è¯´è‡ªå·±æ•°æ®ç»“æ„å’Œç®—æ³•ç›¸å…³çš„åŸºç¡€æ¯”è¾ƒè–„å¼±ã€‚é¢è¯•å®˜ä¹Ÿå¹¶æ²¡æœ‰ä¸ºéš¾ï¼Œç»§ç»­æ¥ç€é—®ä¸€äº›é¡¹ç›®ä¸Šçš„é—®é¢˜å’Œæ•°æ®åº“ç›¸å…³çš„å†…å®¹ï¼Œè·Ÿä»–ä¸€äº¤æµï¼Œå‘ç°è‡ªå·±åšçš„ä¸œè¥¿çœŸçš„æ˜¯å¤ªæ¸£äº†ï¼ŒèŠäº†åŠä¸ªå°æ—¶ï¼Œä»–è¯´æ²¡ä»€ä¹ˆé—®çš„äº†ï¼Œä½ å…ˆå‡ºå»ç¨ç­‰ä¸‹äºŒé¢ã€‚äºŒé¢çš„é¢è¯•å®˜ä¹Ÿå¾ˆå’Œè”¼ï¼Œçœ‹ç€ç®€å†å’Œä¸€é¢é¢è¯•å®˜çš„é¢è¯•ä¿¡æ¯ï¼Œä¸Šæ¥å°±è®©æˆ‘ç”¨Shellåˆ©ç”¨STMPåè®®è‡ªåŠ¨å‘é€ç³»ç»Ÿè­¦æŠ¥é‚®ä»¶ã€‚è¿™ç©æ„ï¼Œå¾ˆæ—©ä»¥å‰åšè¿‡ï¼Œç°åœ¨ä¹Ÿæ—©å·²ç»å¿˜è®°äº†ï¼›ç„¶ååˆé—®ï¼Œå¦‚ä½•åœ¨Linuxç³»ç»Ÿä¸­æŒ‚è½½ç£ç›˜ï¼Œæˆ‘åªçŸ¥é“mountå‘½ä»¤ï¼Œå¦‚ä½•ä¸€æ­¥æ­¥åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿã€æŒ‚è½½ç£ç›˜å¹³æ—¥é‡Œä¹Ÿæ²¡ç”¨è¿‡â€¦ç„¶ååˆé—®äº†ä¸€äº›æ›´åŠ ç»†èŠ‚çš„é—®é¢˜ï¼Œè¿™ä¸‹è‚¯å®šæ›´æ‹›æ¶ä¸ä½ã€‚ä»–è¯´ï¼Œä½ è¿™æœ¬ç§‘å­¦çš„åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼Œè¯»ç ”åˆæ˜¯æµ‹ç»˜å·¥ç¨‹ï¼Œç°åœ¨æ¥æ‰¾è®¡ç®—æœºçš„å·¥ä½œï¼Œè¿™çœŸæ˜¯ä¸å®¹æ˜“ã€‚æˆ‘ç¬‘ç¬‘é—®ä»–ï¼Œåƒæˆ‘è¿™æ ·çš„ï¼Œæ€æ ·æ‰èƒ½æ¯”è¾ƒå¿«é€Ÿçš„æé«˜è‡ªå·±çš„æŠ€æœ¯æ°´å¹³ã€‚ä»–æ€è€ƒäº†ä¸¤ç§’ï¼Œè¯´é“ï¼Œé¦–å…ˆä½ è¦æœ‰ä¸ªäººç»™ä½ å¼•è·¯ï¼Œè¿™æ ·æ‰çŸ¥é“åœ¨é¢å¯¹é—®é¢˜çš„æ—¶å€™ï¼Œä»€ä¹ˆé—®é¢˜éœ€è¦ä¼˜å…ˆè§£å†³ã€é—®é¢˜å¦‚ä½•è§£å†³ã€ä»€ä¹ˆé—®é¢˜ä¸éœ€è¦è€ƒè™‘â€¦è€Œä¸”ï¼Œå¦‚æœæƒ³è¦å¯¹æŸç§æŠ€æœ¯æœ‰æ·±å…¥ç ”ç©¶ï¼Œä½ å¿…é¡»æ‰“ä¸‹ä¸€ä¸ªç¨³å›ºçš„åŸºç¡€â€¦æ˜¯å•Šï¼Œè‡ªå·±åœ¨å¹³æ—¶ä¹Ÿæ˜¯åªèƒ½æ‘¸ç€çŸ³å¤´è¿‡æ²³ï¼Œä¹Ÿæ²¡æœ‰ç³»ç»ŸåŒ–çš„å­¦ä¹ è¿‡è®¡ç®—æœºç›¸å…³çš„å†…å®¹ï¼Œä¹Ÿåªèƒ½æ€ªå¹³æ—¶å¤ªè´ªç©ï¼Œå¤ªæ‡’ï¼Œåˆ°çœŸæ­£é«˜æŠ€æœ¯çš„äººé¢å‰ï¼ŒçœŸçš„æ˜¯åŸå½¢æ¯•éœ²ã€‚ä¸è¿‡æˆ‘ä¹Ÿå¾ˆå¼€å¿ƒäº†ï¼Œæ¯•ç«Ÿåœ¨è¿™æ¬¡é¢è¯•ä¸­å­¦ä¹ åˆ°äº†ä¸å°‘ä¸œè¥¿ï¼Œè€Œä¸”æŒ‰ç…§é¢è¯•å®˜çš„æ¨èï¼Œæƒ³è¦ç”¨å¥½Linuxï¼Œå‘½ä»¤å¿…é¡»ç†Ÿç»ƒï¼Œå½“å¤©æ™šä¸Šå›åˆ°å®¿èˆï¼Œç«‹å³åœ¨ç½‘ä¸Šä¹°äº†é¸Ÿå“¥ç§æˆ¿èœã€‚ææŠ€æœ¯çš„ï¼ŒçœŸçš„æ˜¯è¦æ‰æ‰å®å®ï¼Œè¸è¸å®å®ã€‚<img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipse_svlinux.jpg" alt="é¸Ÿå“¥ç§æˆ¿èœ"><br>å¾ˆå¿«ï¼ŒTWé€šçŸ¥ç¬”è¯•é€šè¿‡ï¼Œ10æœˆ16å·ï¼Œè®¤è®¤çœŸçœŸåšäº†å¤§åŠå¤©ä»£ç ä½œä¸šï¼Œä¸‹åˆæäº¤äº†ï¼Œå¾ˆå¿«ï¼Œå½“å¤©æ™šä¸Šå°±æ”¶åˆ°äº†åé¦ˆï¼Œé€šçŸ¥17å·ä¸‹åˆ4ç‚¹å»é¢è¯•ã€‚å¿ƒé‡Œæ—¢å…´å¥‹åˆç´§å¼ ï¼Œå¿ƒæƒ³è¿™æ¬¡ä¸€å®šè¦æˆåŠŸã€‚4ç‚¹çš„é¢è¯•ï¼Œæˆ‘3ç‚¹å°±åˆ°äº†å…‰è°·ï¼Œåœ¨ä¼‘æ¯å®¤å€™ç€ï¼Œç›¸æ¯”ç½‘æ˜“æ¸¸æˆçš„é‚£æ¬¡é¢è¯•ï¼Œè¿™æ¬¡å°±è½»æ¾äº†è®¸å¤šã€‚å¤§æ¦‚4ç‚¹ä¸€åˆ»ï¼Œå–Šæˆ‘è¿‡å»é¢è¯•ï¼Œä¸€é¢æ˜¯HRé¢ï¼ŒHRå¾ˆniceï¼Œåœ¨æ ¡æ‹›çš„æ—¶å€™æˆ‘ä¹Ÿè§è¿‡ï¼Œåšäº†ç®€çŸ­çš„è‡ªæˆ‘ä»‹ç»ï¼ŒHRä¹Ÿæ ¹æ®ä¸€ç³»åˆ—çš„é—®ç­”ï¼Œè§‚å¯Ÿä¸€äº›ç»†èŠ‚ï¼Œè®°å½•æˆ‘çš„è¡¨ç°ï¼Œè‡ªå·±æ„Ÿè§‰æœ€ç³Ÿç³•çš„å°±æ˜¯ä¸€æ®µè‹±è¯­çš„å¯¹è¯ï¼Œäº‹å…ˆæ²¡æœ‰å‡†å¤‡å……åˆ†ï¼Œæå¾—æ¯”è¾ƒç´§å¼ ï¼›HRé¢è¿‡ä¹‹åï¼Œè®©æˆ‘åœ¨å¤§å…é‡Œç­‰ç€æŠ€æœ¯é¢ï¼Œå¤§æ¦‚20åˆ†é’Ÿå·¦å³ï¼ŒæŠ€æœ¯é¢å¼€å§‹äº†ï¼ŒTWçš„å‘˜å·¥éƒ½æŒºå¹´è½»ã€‚ä¸Šæ¥å…ˆæ˜¯è¿‡äº†ä¸€éæˆ‘çš„ä»£ç ä½œä¸šï¼ŒæŒ‡å‡ºäº†ä¸€äº›ä¸è¶³ï¼Œå’Œæ”¹è¿›æ„è§ï¼Œç„¶åå°±æ˜¯å¦ä¸€ä¸ºå¤§å“¥çœ‹ç€ç®€å†æ¥é—®é—®é¢˜ã€‚TWæ¯•ç«Ÿæ˜¯ä¸€å®¶ä¸ä¼—ä¸åŒçš„å…¬å¸ï¼ŒæŠ€æœ¯é¢ä¹Ÿå¹¶æ²¡æœ‰é—®è¯¸å¦‚è®¡ç®—æœºç½‘ç»œã€ç®—æ³•ã€æ•°æ®ç»“æ„ä¹‹ç±»çš„é—®é¢˜ï¼Œå€’æ˜¯å¯¹æˆ‘çš„ä¸ªäººåšå®¢æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œä¹‹ååˆè®©æˆ‘ä»‹ç»äº†ä¸€ä¸‹è‡ªå·±åšçš„é¡¹ç›®ï¼ŒæŠ€æœ¯é¢æ•´ä½“æ¥è®²ä¹Ÿæ¯”è¾ƒè½»æ¾ï¼Œæœ€åé—®æˆ‘æœ‰ä»€ä¹ˆé—®çš„ä¸ï¼Œæˆ‘å°±å¼±å¼±çš„è¯´ï¼Œç°åœ¨è‡ªå·±çš„æŠ€æœ¯æ ˆæ¯”è¾ƒæ‚ï¼Œå„ç§æŠ€èƒ½éƒ½ç‚¹äº†å¤©èµ‹ç‚¹ï¼Œå°±æ˜¯æ·±åº¦ä¸å¤Ÿï¼Œå¦‚ä½•æœ‰æ•ˆçš„æé«˜å¯¹æŠ€æœ¯æ·±åº¦ã€‚è·Ÿæˆ‘è¿‡ä»£ç ä½œä¸šé‚£ä½å¤§å“¥ï¼ˆåæ¥å¬è¯´æ˜¯ä»–ä»¬è¿™è¾¹çš„ä¸€ä¸ªç»ç†ï¼‰è¯´é“ï¼Œä½ åœ¨é—®ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œè¦å…ˆæƒ³æƒ³é—®çš„åˆ°åº•ç®—ä¸ç®—æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä½ ç°åœ¨æ‹…å¿ƒä½ çš„æŠ€æœ¯æ·±åº¦ä¸å¤Ÿæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿™å°±å¦‚åŒæç§‘å­¦ç ”ç©¶ï¼Œä¸€ç¾¤å­¦ç”Ÿå’Œä¸€ä¸ªæ•™æˆï¼Œå¯èƒ½æ•™æˆçš„ç ”ç©¶æ·±åº¦ä¼šæ·±ä¸€äº›ï¼Œä½†æ˜¯ä»–ä¹Ÿä¸æ•¢è¯´è‡ªå·±çš„æ·±åº¦å·²ç»å¤Ÿäº†â€¦.åæ¥åˆè®²åˆ°ç¼–ç¨‹è¯­è¨€çš„å½¢æ€ï¼Œç”šè‡³æ˜¯â€œäººç±»çš„å­¦ä¹ è¿‡ç¨‹æœ¬èº«å°±æ˜¯ä¸€ä¸ªèºæ—‹ä¸Šå‡çš„è¿‡ç¨‹â€¦.â€ã€‚ä¸”ä¸è¯´è¿™æ ·è¯´æœ‰æ²¡æœ‰é“ç†ï¼Œä½†æ˜¯è¿™ä½å¤§å“¥çš„è§è§£æˆ‘å·²ç»å¾ˆä½©æœäº†ã€‚æœ€åï¼Œå¦å¤–ä¸€ä½å¤§å“¥è¯´ï¼Œæ°¸è¿œä¸è¦å»æ‹…å¿ƒä¸€ä¸ªæ°¸è¿œä¸ä¼šå‘ç”Ÿçš„é—®é¢˜ã€‚å…¶å®ä¹Ÿæ˜¯ï¼Œä¸å…¶ä¸åœçš„æ‹…å¿ƒé—®é¢˜å‡ºç°ï¼ŒçœŸçš„ä¸å¦‚å»ç›´é¢é—®é¢˜ï¼Œè§£å†³é—®é¢˜ã€‚è¿™ä¹Ÿè®©æˆ‘æƒ³åˆ°äº†å½“å¹´è€ƒç ”çš„æ—¶å€™é‚£ç§å¿ƒæƒ…ã€‚10æœˆ19å·ï¼Œä¸Šåˆ9ç‚¹40ï¼ŒTWæœ€åä¸€è½®é¢è¯•ï¼Œä¸‰åˆ†é’Ÿè‡ªæœ‰æ¼”è®²ï¼Œå¤–åŠ æ— é¢†å¯¼å°ç»„è®¨è®ºï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸€ä¸ªå¤šå°æ—¶ï¼Œè¿™ä¹Ÿéƒ½æ˜¯æˆ‘æœ€ä¸æ“…é•¿çš„ä¸œè¥¿å•¦ã€‚ç¦»å¼€æ—¶è¯´æ˜¯ä»Šå¤©ä¼šç»™ç­”å¤ã€‚<br>10æœˆ20å·ï¼Œä»Šå¤©ç­‰äº†ä¸€å¤©ï¼Œçœ‹åˆ°ä¸€ä¸ªå°ç»„çš„åŒå­¦æ‹¿åˆ°offerï¼Œæ—¶é—´ä¹Ÿåˆ°äº†è¿™ä¸ªæ—¶å€™ï¼Œè‡ªçŸ¥æ˜¯æ— ç¼˜TWäº†ã€‚<br>è¢«è¿ç€é„™è§†äº†ä¸¤ä¸ªæœˆï¼Œä¹Ÿæ·±çŸ¥æ‰¾å·¥ä½œä¸æ˜“ï¼Œæƒ³è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚è‡ªå·±çš„ï¼ŒçœŸçš„åƒæ˜¯æ‰¾å¯¹è±¡ï¼Œé™¤äº†è®©è‡ªå·±æ›´åŠ ä¼˜ç§€ï¼Œä¸‰å“¥è¯´çš„â€œå‘½ä¸­æœ‰æ—¶ç»ˆé¡»æœ‰ï¼Œå‘½ä¸­æ— æ—¶è«å¼ºæ±‚â€ä¹Ÿæ˜¯æœ‰å‡ åˆ†é“ç†ã€‚<br><img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipse_svå¤©ç©º.jpg" alt="äº‘æ·¡é£è½»"></p>
]]></content>
      
        
        <tags>
            
            <tag> å¿ƒæƒ…æ–‡å­— </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OSIä¸ƒå±‚æ¨¡å‹ç¬”è®°]]></title>
      <url>/2015/10/12/OSI%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B/</url>
      <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å‡†å¤‡æ‰¾å·¥ä½œçš„è¿‡ç¨‹ä¸­ï¼Œå¤ä¹ ä»¥å‰å­¦ä¹ çš„è®¡ç®—æœºç½‘ç»œï¼Œç”±äºä»¥å‰å­¦ä¹ çš„æ—¶å€™ä¹Ÿæ˜¯èµ°é©¬è§‚èŠ±ï¼Œæ‰€ä»¥ç°åœ¨å¾ˆæœ‰å¿…è¦åšä¸ªç¬”è®°ã€‚</p>
<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>OSI(Open System Interconnect)ï¼Œå¼€æ”¾ç³»ç»Ÿäº’è¿å‚è€ƒæ¨¡å‹ï¼Œæ˜¯å›½é™…æ ‡å‡†åŒ–ç»„ç»‡(ISO)å’Œå›½é™…ç”µæŠ¥ç”µè¯å’¨è¯¢å§”å‘˜ä¼š(CCITT)è”åˆåˆ¶å®šçš„å¼€æ”¾ç³»ç»Ÿäº’è¿å‚è€ƒæ¨¡å‹ï¼Œä¸ºå¼€æ”¾å¼äº’è¿ä¿¡æ¯ç³»ç»Ÿæä¾›äº†ä¸€ç§åŠŸèƒ½ç»“æ„çš„æ¡†æ¶ã€‚ä»ä½åˆ°é«˜åˆ†ä¸º7å±‚ï¼Œä¾æ¬¡æ˜¯ï¼šç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚ã€‚<br><a id="more"></a></p>
<h2 id="ç‰©ç†å±‚"><a href="#ç‰©ç†å±‚" class="headerlink" title="ç‰©ç†å±‚"></a>ç‰©ç†å±‚</h2><p>ç‰©ç†å±‚ä½œä¸ºOSIä¸­çš„ç¬¬ä¸€å±‚ï¼Œäº§ç”Ÿå¹¶æ£€æµ‹ç”µå‹ï¼Œä»¥ä¾¿å‘é€å’Œæ¥æ”¶æºå¸¦æ•°æ®çš„ä¿¡å·ï¼Œæä¾›ä¸ºå»ºç«‹ã€ç»´æŠ¤å’Œæ‹†é™¤ç‰©ç†é“¾è·¯æ‰€éœ€è¦çš„æœºæ¢°çš„ã€ç”µæ°”çš„ã€åŠŸèƒ½çš„å’Œè§„ç¨‹çš„ç‰¹æ€§ï¼›æœ‰å…³çš„ç‰©ç†é“¾è·¯ä¸Šä¼ è¾“éç»“æ„çš„ä½æµä»¥åŠæ•…éšœæ£€æµ‹æŒ‡ç¤ºã€‚ç‰©ç†å±‚çš„åª’ä½“ä¸»è¦åŒ…æ‹¬ï¼šé’ˆè„šã€ç”µå‹ã€çº¿ç¼†è§„èŒƒã€é›†çº¿å™¨ã€ä¸­ç»§å™¨ã€ç½‘å¡ã€ä¸»æœºé€‚é…å™¨ç­‰ã€‚åœ¨è¿™ä¸€å±‚ï¼Œæ•°æ®è¿˜æ²¡æœ‰è¢«ç»„ç»‡ï¼Œä»…ä½œä¸ºåŸå§‹çš„ä½æµæˆ–ç”µæ°”ç”µå‹å¤„ç†ï¼Œå•ä½æ˜¯bitæ¯”ç‰¹ã€‚</p>
<h2 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a>æ•°æ®é“¾è·¯å±‚</h2><p>æ•°æ®é“¾è·¯å±‚æ˜¯OSIæ¨¡å‹ç¬¬äºŒå±‚ï¼Œæ§åˆ¶ç‰©ç†å±‚å’Œç½‘ç»œå±‚ä¹‹é—´çš„é€šè®¯ã€‚å®ƒå¯ä»¥åœ¨ä¸å¯é çš„ç‰©ç†çº¿è·¯ä¸Šè¿›è¡Œæ•°æ®çš„å¯é ä¼ é€’ï¼Œå®ƒå¯ä»¥å°†ä»ç½‘ç»œå±‚æ¥æ”¶åˆ°çš„æ•°æ®åˆ†å‰²æˆå¯è¢«ç‰©ç†å±‚ä¼ è¾“çš„å¸§ï¼ˆ<em>å¸§æ˜¯ç”¨æ¥ç§»åŠ¨æ•°æ®çš„ç»“æ„åŒ…ï¼Œå®ƒä¸ä»…åŒ…æ‹¬åŸå§‹æ•°æ®ï¼Œè¿˜åŒ…æ‹¬å‘é€æ–¹å’Œæ¥æ”¶æ–¹çš„ç‰©ç†åœ°å€ä»¥åŠæ£€é”™å’Œæ§åˆ¶ä¿¡æ¯ã€‚å…¶ä¸­çš„åœ°å€ç¡®å®šäº†å¸§å°†å‘é€åˆ°ä½•å¤„ï¼Œè€Œçº é”™å’Œæ§åˆ¶ä¿¡æ¯åˆ™ç¡®ä¿å¸§æ— å·®é”™åˆ°è¾¾ã€‚ å¦‚æœåœ¨ä¼ é€æ•°æ®æ—¶ï¼Œæ¥æ”¶ç‚¹æ£€æµ‹åˆ°æ‰€ä¼ æ•°æ®ä¸­æœ‰å·®é”™ï¼Œå°±è¦é€šçŸ¥å‘é€æ–¹é‡å‘è¿™ä¸€å¸§</em>ï¼‰ã€‚æ•°æ®é“¾è·¯å±‚ä¸­è¿è¡Œçš„è®¾å¤‡æ˜¯äº¤æ¢æœºã€‚æ•°æ®é“¾è·¯å±‚çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼šç‰©ç†åœ°å€å¯»å€ã€æ•°æ®çš„æˆå¸§ã€æµé‡æ§åˆ¶ã€æ•°æ®çš„æ£€é”™ã€é‡å‘ç­‰ã€‚è¿™ä¸€å±‚çš„åè®®ä¸»è¦åŒ…æ‹¬ï¼šSDLCã€HDLCã€PPPã€STPã€å¸§ä¸­ç»§ç­‰ã€‚æ•°æ®åœ¨è¿™ä¸€å±‚çš„å­˜åœ¨å½¢å¼æ˜¯Frameæ•°æ®å¸§ã€‚</p>
<h2 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h2><p>OSIæ¨¡å‹çš„ç¬¬ä¸‰å±‚ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†ç½‘ç»œåœ°å€è½¬åŒ–ä¸ºå¯¹åº”çš„ç‰©ç†åœ°å€ï¼Œå¹¶ä¸”å†³å®šå¦‚ä½•å°†æ•°æ®ä»å‘é€æ–¹ä¼ åˆ°æ¥æ”¶æ–¹ã€‚ç½‘ç»œå±‚é€šè¿‡ç»¼åˆè€ƒè™‘å‘é€ä¼˜å…ˆæƒã€ç½‘ç»œæ‹¥å¡ç¨‹åº¦ã€æœåŠ¡è´¨é‡ä»¥åŠå¯é€‰è·¯ç”±çš„èŠ±è´¹æ¥å†³å®šä»ä¸€ä¸ªç½‘ç»œä¸­èŠ‚ç‚¹A åˆ°å¦ä¸€ä¸ªç½‘ç»œä¸­èŠ‚ç‚¹B çš„æœ€ä½³è·¯å¾„ã€‚è·¯ç”±å™¨è¿è¡Œåœ¨ç½‘ç»œå±‚ã€‚è¿™ä¸€å±‚çš„åè®®ä¸»è¦åŒ…æ‹¬ï¼šIPã€IPXã€ARPã€RARPå’ŒICMPã€‚æ•°æ®åœ¨è¿™ä¸€å±‚å­˜åœ¨çš„å½¢å¼æ˜¯Packetæ•°æ®åŒ…å’ŒDatagramæŠ¥æ–‡ã€‚</p>
<h2 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h2><p>OSIæ¨¡å‹çš„ç¬¬å››å±‚ï¼Œä¼ è¾“å±‚æä¾›ç«¯åˆ°ç«¯çš„äº¤æ¢æ•°æ®çš„æœºåˆ¶ï¼Œæ£€æŸ¥åˆ†ç»„ç¼–å·ä¸æ¬¡åºã€‚ä¼ è¾“å±‚å¯¹å…¶ä¸Šä¸‰å±‚å¦‚ä¼šè¯å±‚ç­‰ï¼Œæä¾›å¯é çš„ä¼ è¾“æœåŠ¡ï¼Œå¯¹ç½‘ç»œå±‚æä¾›å¯é çš„ç›®çš„åœ°ç«™ç‚¹ä¿¡æ¯ã€‚è¿™ä¸€å±‚çš„åè®®ä¸»è¦åŒ…æ‹¬ï¼šTCPã€UDPã€SPXã€‚æ•°æ®åœ¨è¿™å±‚çš„å­˜åœ¨å½¢å¼ï¼šSegmentsæ•°æ®æ®µã€‚</p>
<h2 id="ä¼šè¯å±‚"><a href="#ä¼šè¯å±‚" class="headerlink" title="ä¼šè¯å±‚"></a>ä¼šè¯å±‚</h2><p>ä¼šè¯å±‚æ˜¯OSIæ¨¡å‹çš„ç¬¬äº”å±‚ï¼Œè´Ÿè´£åœ¨ç½‘ç»œä¸­çš„ä¸¤èŠ‚ç‚¹ä¹‹é—´å»ºç«‹ã€ç»´æŒå’Œç»ˆæ­¢é€šä¿¡ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼šå»ºç«‹é€šä¿¡é“¾æ¥ï¼Œä¿æŒä¼šè¯è¿‡ç¨‹é€šä¿¡é“¾æ¥çš„ç•…é€šï¼ŒåŒæ­¥ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å¯¹è¯ï¼Œå†³å®šé€šä¿¡æ˜¯å¦è¢«ä¸­æ–­ä»¥åŠé€šä¿¡ä¸­æ–­æ—¶å†³å®šä»ä½•å¤„é‡æ–°å‘é€ã€‚æ•°æ®åœ¨ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚ä¸­çš„å­˜åœ¨å½¢å¼æ˜¯Dataæ•°æ®ã€‚</p>
<h2 id="è¡¨ç¤ºå±‚"><a href="#è¡¨ç¤ºå±‚" class="headerlink" title="è¡¨ç¤ºå±‚"></a>è¡¨ç¤ºå±‚</h2><p>åœ¨è¡¨ç¤ºå±‚ä¸­ï¼Œæ•°æ®å°†æŒ‰ç…§ç½‘ç»œèƒ½ç†è§£çš„æ–¹æ¡ˆè¿›è¡Œæ ¼å¼åŒ–ï¼›è¿™ç§æ ¼å¼åŒ–ä¹Ÿå› æ‰€ä½¿ç”¨ç½‘ç»œçš„ç±»å‹ä¸åŒè€Œä¸åŒï¼Œç®¡ç†æ•°æ®çš„è§£å¯†ä¸åŠ å¯†ï¼Œå¦‚ç³»ç»Ÿå£ä»¤çš„å¤„ç†ã€‚</p>
<h2 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h2><p>åº”ç”¨å±‚æ˜¯OSIæ¨¡å‹çš„æœ€é«˜å±‚ï¼Œç›´æ¥å’Œåº”ç”¨ç¨‹åºæ¥å£å¹¶æä¾›å¸¸è§çš„ç½‘ç»œåº”ç”¨æœåŠ¡ã€‚åº”ç”¨å±‚ä¹Ÿå‘ç¬¬å…­å±‚è¡¨ç¤ºå±‚å‘å‡ºè¯·æ±‚ã€‚è¿™ä¸€å±‚çš„åè®®ä¸»è¦æœ‰ï¼šHTTPã€SMTPã€DNSã€FTPã€TelNetç­‰ã€‚</p>
<h1 id="çŸ¥åç«¯å£å·"><a href="#çŸ¥åç«¯å£å·" class="headerlink" title="çŸ¥åç«¯å£å·"></a>çŸ¥åç«¯å£å·</h1><p>çŸ¥åç«¯å£å·ï¼ˆwell-known port numbersï¼‰å°±æ˜¯é‚£äº›ç”±äº’è”ç½‘åç§°ä¸æ•°å­—åœ°å€åˆ†é…æœºæ„ï¼ˆICANNï¼‰é¢„ç•™ç»™ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰å’Œç”¨æˆ·æ•°æ®åŒ…åè®®ï¼ˆUDPï¼‰ä½¿ç”¨çš„ç«¯å£å·ã€‚<br>20/21ç«¯å£ä¸»è¦ç”¨ä½œTFPæœåŠ¡ï¼›23ç”¨äºTelnetæœåŠ¡ï¼›25æ˜¯SMTPï¼ˆä¸»è¦ç”¨ä½œå‘é€é‚®ä»¶ï¼‰ï¼›53ç«¯å£ä¸ºDNSæœåŠ¡å™¨å¼€æ”¾ï¼Œä¸»è¦ç”¨ä½œåŸŸåè§£æï¼›80ç«¯å£æ˜¯httpå¸¸ç”¨Webç«¯å£ï¼›110ç«¯å£ä¸ºPOP3æœåŠ¡å¼€æ”¾ï¼Œä¸»è¦ç”¨ä½œé‚®ä»¶æ¥æ”¶ï¼›443ä¸»è¦ç”¨äºhttpsæœåŠ¡ï¼Œæ˜¯æä¾›åŠ å¯†å’Œé€šè¿‡å®‰å…¨ç«¯å£ä¼ è¾“çš„å¦ä¸€ç§httpã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[åˆ©ç”¨redisåˆ¶ä½œé¡µé¢è®¿é—®è®¡æ•°å™¨]]></title>
      <url>/2015/10/05/%E5%88%A9%E7%94%A8redis%E5%88%B6%E4%BD%9C%E9%A1%B5%E9%9D%A2%E8%AE%BF%E9%97%AE%E8%AE%A1%E6%95%B0%E5%99%A8/</url>
      <content type="html"><![CDATA[<p>ä»¥å‰åšå®¢çš„é¡µé¢è®¡æ•°å™¨ä½¿ç”¨çš„æ˜¯åœç®—å­,ä½¿ç”¨æ–¹æ³•ç‚¹å‡»<a href="http://ibruce.info/2015/04/04/busuanzi/" target="_blank" rel="external">è¿™é‡Œ</a>æŸ¥çœ‹,ä½†æ˜¯é¡µé¢åœ¨åŠ è½½çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯å¾ˆå¿«,äºæ˜¯è‡ªå·±ä½¿ç”¨Redisåˆ¶ä½œäº†ä¸€ä¸ªç®€å•çš„é¡µé¢è®¡æ•°å·¥å…·ã€‚<br><a id="more"></a></p>
<h1 id="åå°ä»£ç "><a href="#åå°ä»£ç " class="headerlink" title="åå°ä»£ç "></a>åå°ä»£ç </h1><p>æˆ‘åœ¨åå°ä½¿ç”¨çš„æ˜¯Node.jsï¼Œä½¿ç”¨<a href="https://github.com/luin/ioredis" target="_blank" rel="external">ioredis</a>æ¥å¯¹Redisè¿›è¡Œæ“ä½œï¼Œä»è€Œä¿å­˜é¡µé¢çš„è®¿é—®æ¬¡æ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">var redis = require(&apos;ioredis&apos;);</div><div class="line">var client = new redis();</div><div class="line">var http = require(&apos;http&apos;);</div><div class="line">var url = require(&quot;url&quot;);</div><div class="line"></div><div class="line">http.createServer(function (req, res) &#123;</div><div class="line">    var arg = url.parse(req.url, true).query;</div><div class="line">        console.log(&apos;æ•°æ®æ¥æ”¶å®Œæ¯•&apos;);</div><div class="line">        //æˆªå–url</div><div class="line">        console.log(arg.path);</div><div class="line">        console.log(arg.subpath);</div><div class="line"></div><div class="line">        res.setHeader(&quot;Access-Control-Allow-Origin&quot;,&quot;*&quot;);	//å…è®¸è·¨åŸŸè®¿é—®</div><div class="line">        res.setHeader(&apos;Content-Type&apos;,&apos;text/html&apos;);</div><div class="line">        res.writeHead(200, &#123;</div><div class="line">            &quot;Content-Type&quot;: &quot;text/plain;charset=utf-8&quot;</div><div class="line">        &#125;);</div><div class="line">        var v=&quot;&quot;;</div><div class="line">		//æ¯æ¬¡è®¿é—®ï¼Œå¢åŠ åœ¨redisä¸­å­˜å‚¨é”®å€¼</div><div class="line">        client.incr(arg.path);</div><div class="line">        client.incr(arg.subpath);</div><div class="line">        //è¿”å›é¡µé¢è®¿é—®æ¬¡æ•°</div><div class="line">        client.get(arg.path).then(function(result)&#123;</div><div class="line">            client.get(arg.subpath).then(function(subreuslt)&#123;</div><div class="line">                res.write(JSON.stringify(result));</div><div class="line">                res.write(&apos;,&apos;);</div><div class="line">                res.write(JSON.stringify(subreuslt));</div><div class="line">                res.end();</div><div class="line">            &#125;);</div><div class="line">        &#125;);</div><div class="line">&#125;).listen(8000, &quot;127.0.0.1&quot;);</div><div class="line">console.log(&apos;Server running at http://127.0.0.1:8000/&apos;);</div></pre></td></tr></table></figure></p>
<p>è§£æurlè·å–å…¶ä¸­çš„å‚æ•°ï¼Œå°†å¯¹åº”çš„é”®å€¼è¯¥æ”¹å˜ï¼Œå¹¶ä¸”è¿”å›æŠ€æœ¯ç»“æœã€‚</p>
<h1 id="é¡µé¢ä»£ç "><a href="#é¡µé¢ä»£ç " class="headerlink" title="é¡µé¢ä»£ç "></a>é¡µé¢ä»£ç </h1><p>å‰ç«¯é¡µé¢ä¸­ï¼Œé€šè¿‡è®¿é—®åå°ä»£ç è·å–é¡µé¢è®¿é—®æ•°é‡ï¼Œå®æ—¶è·å–é¡µé¢è®¿é—®æ¬¡æ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">var xmlhttp;</div><div class="line">  var url=location.href;</div><div class="line">  var host=location.hostname;</div><div class="line">    if (window.XMLHttpRequest)</div><div class="line">      &#123;// code for IE7+, Firefox, Chrome, Opera, Safari</div><div class="line">      xmlhttp=new XMLHttpRequest();</div><div class="line">      &#125;</div><div class="line">    else</div><div class="line">      &#123;// code for IE6, IE5</div><div class="line">      xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      xmlhttp.open(&quot;GET&quot;,&quot;http://59.173.238.35:2222?&quot;+&quot;path=&quot;+host+&apos;&amp;&apos;+&quot;subpath=&quot;+url,true);   </div><div class="line">      </div><div class="line">      xmlhttp.onreadystatechange=function()</div><div class="line">      &#123;</div><div class="line">      if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)</div><div class="line">        &#123;</div><div class="line">            result=xmlhttp.responseText;</div><div class="line">            result=result.replace(/&quot;/,&quot;&quot;);</div><div class="line">            result=result.replace(/&quot;/,&quot;&quot;);</div><div class="line">            result=result.replace(/&quot;/,&quot;&quot;);</div><div class="line">            result=result.replace(/&quot;/,&quot;&quot;);</div><div class="line">            result=result.split(&quot;,&quot;);</div><div class="line">            document.getElementById(&quot;busuanzi_value_site_pv&quot;).innerHTML= result[0];</div><div class="line">            document.getElementById(&quot;busuanzi_value_page_pv&quot;).innerHTML= result[1];</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">xmlhttp.send();</div></pre></td></tr></table></figure></p>
<h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>å¦‚æœéœ€è¦ä½¿ç”¨ï¼Œè¦åšçš„å¾ˆç®€å•ï¼š</p>
<h2 id="åŠ å…¥è„šæœ¬"><a href="#åŠ å…¥è„šæœ¬" class="headerlink" title="åŠ å…¥è„šæœ¬"></a>åŠ å…¥è„šæœ¬</h2><p>åœ¨éœ€è¦çš„é¡µé¢ä¸­å¢åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;http://7xkswi.com1.z0.glb.clouddn.com/eclipsesv_jspvcount.js&quot; async=&quot;async&quot;&gt;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼ŒæŠŠjsæˆ–è€…å›¾ç‰‡ç­‰é™æ€æ–‡ä»¶æ‰˜ç®¡åœ¨<a href="http://www.qiniu.com/" target="_blank" rel="external">ä¸ƒç‰›äº‘å­˜å‚¨</a>ä¸Šï¼Œå¯ä»¥æé«˜é¡µé¢çš„è®¿é—®é€Ÿåº¦ã€‚</p>
<h2 id="å¢åŠ æ ‡ç­¾"><a href="#å¢åŠ æ ‡ç­¾" class="headerlink" title="å¢åŠ æ ‡ç­¾"></a>å¢åŠ æ ‡ç­¾</h2><p>åœ¨é¡µé¢é€‚å½“çš„ä½ç½®å¢åŠ æ ‡ç­¾ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;span id=&quot;busuanzi_container_site_pv&quot;&gt;</div><div class="line">  æœ¬ç«™æ€»è®¿é—®é‡&lt;span id=&quot;busuanzi_value_site_pv&quot;&gt;&lt;/span&gt;æ¬¡</div><div class="line">&lt;/span&gt;</div><div class="line">&lt;span id=&quot;busuanzi_container_page_pv&quot;&gt;</div><div class="line">  æœ¬é¡µæ€»è®¿é—®é‡&lt;span id=&quot;busuanzi_value_page_pv&quot;&gt;&lt;/span&gt;æ¬¡</div><div class="line">&lt;/span&gt;</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ï¼Œå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨é¡µé¢è®¡æ•°å™¨äº†ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> Redis </tag>
            
            <tag> Node.js </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å­¦ä¹ èµ„æ–™]]></title>
      <url>/2015/09/09/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/</url>
      <content type="html"><![CDATA[<p>å‰äº›å¤©åœ¨å›¾ä¹¦é¦†å€Ÿçš„å‡ æœ¬ä¹¦ï¼Œæœ€è¿‘çœ‹äº†ï¼Œå‘ç°éƒ½è¿˜ä¸é”™ï¼Œä¸€æœ¬æ˜¯<a href="http://book.douban.com/subject/6889456/" target="_blank" rel="external">Linux shellè„šæœ¬æ”»ç•¥</a>å¦å¤–ä¸€æœ¬<a href="http://book.douban.com/subject/25856314/" target="_blank" rel="external">Webæ€§èƒ½æƒå¨æŒ‡å—</a>ã€‚<br>ç¬¬ä¸€æœ¬ä¹¦ï¼Œæ˜¯å°åº¦ä¸€ä¸ªåœ¨æ ¡å¤§å­¦ç”Ÿå†™çš„ï¼Œé‡Œè¾¹çš„å†…å®¹éƒ½æ¯”è¾ƒå…·æœ‰å®æˆ˜å‹ï¼Œå¯ä»¥åœ¨æ—¥å¸¸å·¥ä½œä¸­æä¾›ä¸åŒçš„è§£å†³é—®é¢˜çš„æ€è·¯ã€‚è€Œç¬¬äºŒæœ¬ä¹¦åˆ™æ˜¯éå¸¸ç³»ç»Ÿæ€§çš„æä¾›äº†ä¸åŒè§’åº¦çš„ä¼˜åŒ–webåº”ç”¨çš„æ–¹æ³•ï¼Œæˆ‘è‡ªå·±æ¯”è¾ƒæ„Ÿå…´è¶£çš„æ˜¯å…¶ä¸­å¯¹ä¸HTTP/2çš„è®²è§£ã€‚<br>ä¸‹ä¸€æ­¥æ‰“ç®—æ›´æ–°nginxå¼€å§‹ä½¿ç”¨HTTP/2ï¼Œè€ƒè™‘ç°åœ¨çš„ç¼“å­˜æµç¨‹ï¼Œæ”¹å˜æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„æ¶æ„ã€‚</p>
]]></content>
      
        <categories>
            
            <category> å­¦ä¹  </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Nginx </tag>
            
            <tag> Webæ€§èƒ½ä¼˜åŒ– </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœ€è¿‘çš„ä¸€äº›æƒ³æ³•]]></title>
      <url>/2015/08/27/%E6%9C%80%E8%BF%91%E7%9A%84%E4%B8%80%E4%BA%9B%E6%83%B3%E6%B3%95/</url>
      <content type="html"><![CDATA[<p>å·²ç»æœ‰ä¸€æ®µæ—¶é—´æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œä¸€æ¥æ˜¯ç³Ÿå¿ƒäº‹å¤ªå¤šï¼Œä¸€ç›´åœ¨åšç€ååˆ†ä¸æƒ³åšçš„äº‹æƒ…ï¼ŒäºŒæ¥æ˜¯ç”±äºæœ€è¿‘ä¹Ÿå¼€å§‹æ‰¾å·¥ä½œäº†ï¼ŒèŠ±è´¹äº†å¾ˆå¤šæ—¶é—´è¡¥ä¸€è¡¥ä»¥å‰æ¬ ä¸‹çš„çŸ¥è¯†ã€‚<br>ä½†æ˜¯ä¹Ÿæ²¡æœ‰åœä¸‹å­¦ä¹ çš„è„šæ­¥ï¼ŒæŠŠä»å›¾ä¹¦é¦†å€Ÿäº†ä¸¤ä¸ªå¤šæœˆçš„ã€Šé¾™æªä¼ æ‰¿ã€‹å’Œå¦å¤–ä¸€æœ¬å°è¯´åŸå°ä¸åŠ¨çš„è¿˜äº†å›å»ï¼Œåˆå€Ÿäº†å››æœ¬å’ŒæœåŠ¡å™¨ç›¸å…³çš„ä¹¦ï¼Œåœ¨ä¸‹å­¦æœŸæƒ³è¦å¤šèŠ±ç‚¹ç²¾åŠ›å­¦ä¹ Node.jsã€‚MongoDBå’ŒRedisçš„GEOç‰¹æ€§ä¹Ÿååˆ†å€¼å¾—æ·±å…¥å­¦ä¹ ã€‚<br><a id="more"></a><br>è¿‘æœŸçš„ç›®æ ‡ï¼š</p>
<ul>
<li>èµ¶å¿«æŠŠç°åœ¨åšçš„é¡¹ç›®ç›¸å…³çš„å†…å®¹å®Œæˆï¼Œåšä¸æ„¿æ„åšçš„äº‹æƒ…ï¼ŒçœŸçš„æ˜¯éš¾å—ï¼›</li>
<li>ç»“åˆGDALå’ŒMongoDBç»„ç»‡ç®¡ç†çŸ¢é‡æ•°æ®ï¼Œæ•°æ®ç»„ç»‡å¥½ä¹‹åï¼Œåˆæ­¥æ‰“ç®—åˆ©ç”¨Cesiumåˆ¶ä½œä¸€ä¸ªå°å‹çš„appï¼›</li>
<li>æ‹¥æœ‰éé˜»å¡IOç‰¹æ€§çš„Nginxå’ŒNode.jså¯ä»¥å¾ˆå¥½çš„ç»“åˆèµ·æ¥ï¼Œå‰è€…è´Ÿè´£è¯·æ±‚çš„è½¬å‘å’Œè´Ÿè½½å‡è¡¡ï¼Œåè€…ç”¨æ¥æ“ä½œç›¸å…³çš„æ•°æ®åº“ï¼Œè¿™æ ·é‡æ„ä¸€ä¸‹ä»¥å‰çš„å¤šçº§ç¼“å­˜æ¶æ„ï¼Œå¾ˆæœŸå¾…åˆ°æ—¶å€™æ€§èƒ½çš„æå‡ï¼ˆç°åœ¨çš„Nginx+Luaåœ¨å¯¹æ•°æ®åº“çš„æ“ä½œè¿‡ç¨‹ä¸­ï¼ŒIOé˜»å¡å¯¹æ€§èƒ½çš„å½±å“è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼‰ã€‚</li>
<li>è¡¥å……å®Œå–„è‡ªå·±çš„çŸ¥è¯†ç³»ç»Ÿï¼ŒåŒ…æ‹¬è®¡ç®—æœºåŸç†ï¼Œè®¡ç®—æœºç½‘ç»œå’Œä¸€äº›å¸¸ç”¨çš„ç®—æ³•ï¼Œå“¦å¯¹äº†ï¼Œè¿˜æœ‰å¾ˆä¹…æ²¡æœ‰ç”¨è¿‡çš„SQLï¼Œè²Œä¼¼åœ¨æ‰¾å·¥ä½œçš„æ—¶å€™ç¬”è¯•ç»å¸¸ç”¨åˆ°æã€‚</li>
</ul>
<p>åˆ«çš„ä¸å¤šè¯´å•¦ï¼Œå‹åŠ›å¾ˆå¤§ï¼Œè¦å¥½å¥½åŠªåŠ›æ‰æ˜¯ï¼</p>
]]></content>
      
        
        <tags>
            
            <tag> å¿ƒæƒ…æ–‡å­— </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mongodbå‰¯æœ¬é›†åœ¨nginx-gridfsä¸­çš„ä½¿ç”¨]]></title>
      <url>/2015/08/17/Mongodb%E5%89%AF%E6%9C%AC%E9%9B%86%E5%9C%A8nginx-gridfs%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p><a href="https://www.mongodb.org/" target="_blank" rel="external">Mongodb</a>ä½œä¸ºä¸€æ¬¾éå¸¸æµè¡Œçš„NOSQLæ•°æ®åº“ï¼Œåº”ç”¨èŒƒå›´éå¸¸å¹¿æ³›ï¼Œå®ƒå’Œ<a href="https://github.com/mdirolf/nginx-gridfs" target="_blank" rel="external">Nginx-gridfs</a>ç»„åˆå¯ä»¥æ„å»ºæ€§èƒ½éå¸¸å‡ºè‰²çš„åº”ç”¨ã€‚ä¸‹è¾¹ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•æ­å»ºè¿™å¥—åº”ç”¨ã€‚<br><a id="more"></a></p>
<h1 id="Mongodbå‰¯æœ¬é›†çš„æ­å»º"><a href="#Mongodbå‰¯æœ¬é›†çš„æ­å»º" class="headerlink" title="Mongodbå‰¯æœ¬é›†çš„æ­å»º"></a>Mongodbå‰¯æœ¬é›†çš„æ­å»º</h1><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½¿ç”¨å•å®ä¾‹çš„Mongodbæ˜¾ç„¶ä¸èƒ½æ‰¿æ‹…é‡ä»»ã€‚<a href="http://docs.mongodb.org/manual/core/replication-introduction/" target="_blank" rel="external">Mongodbçš„å‰¯æœ¬é›†</a>æ˜¯ä¸€ä¸ªmongodè¿›ç¨‹å®ä¾‹ç°‡ï¼Œæ•°æ®åœ¨è¿™ä¸ªç°‡ä¸­ç›¸äº’å¤åˆ¶ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨è¿›è¡Œæ•…éšœåˆ‡æ¢ã€‚è¿™ä¸ªè¿‡ç¨‹è™½ç„¶å¢åŠ äº†æ•°æ®å†—ä½™ï¼Œä½†æ˜¯ç¡®ä¿äº†é«˜å¯ç”¨æ€§ï¼Œç®€åŒ–äº†ç®¡ç†ä»»åŠ¡ã€‚åŒæ—¶ï¼Œå‰¯æœ¬é›†ä¹Ÿä½¿åˆ†å¸ƒå¼å­˜å‚¨æˆä¸ºäº†å¯èƒ½ã€‚ä¸‹é¢å°±å¯æ˜¯æ­å»ºä¸€ä¸ªç®€å•çš„å‰¯æœ¬é›†ï¼š</p>
<h2 id="ä¸‹è½½è§£å‹Mongodb"><a href="#ä¸‹è½½è§£å‹Mongodb" class="headerlink" title="ä¸‹è½½è§£å‹Mongodb"></a>ä¸‹è½½è§£å‹Mongodb</h2><p>æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬æ˜¯<a href="https://fastdl.mongodb.org/src/mongodb-src-r3.0.5.tar.gz?_ga=1.74584210.1075743892.1439139049" target="_blank" rel="external">3.0.5</a>,å°†ä¸‹è½½ä¸‹æ¥çš„å®‰è£…åŒ…è§£å‹åˆ°æŒ‡å®šä½ç½®ï¼Œå°†è§£å‹åçš„binæ–‡ä»¶å¤¹çš„æ–‡ä»¶åˆ†åˆ«å¤åˆ¶åˆ°/usr/local/Mongorepset/1/ã€/usr/local/Mongorepset/2/ã€/usr/local/Mongorepset/3/ä¸­ï¼Œå¹¶åœ¨è¿™ä¸‰ä¸ªæ–‡ä»¶å¤¹ä¸­åˆ†åˆ«å»ºç«‹dataæ–‡ä»¶å¤¹ã€‚</p>
<h2 id="å¯åŠ¨mongodåˆå§‹åŒ–å‰¯æœ¬é›†"><a href="#å¯åŠ¨mongodåˆå§‹åŒ–å‰¯æœ¬é›†" class="headerlink" title="å¯åŠ¨mongodåˆå§‹åŒ–å‰¯æœ¬é›†"></a>å¯åŠ¨mongodåˆå§‹åŒ–å‰¯æœ¬é›†</h2><p>åˆ†åˆ«åœ¨ä¸Šè¿°ä¸‰ä¸ªæ–‡ä»¶å¤¹ä¸­å¯åŠ¨mongodï¼Œç«¯å£å·å’Œæ—¥å¿—æ–‡ä»¶åˆ†åˆ«å¯¹åº”å„è‡ªçš„æ–‡ä»¶å¤¹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/Mongorepset/3</div><div class="line">./mongod --dbpath=./data --port=33333 --replSet repset --logpath=./data/1.log --fork</div></pre></td></tr></table></figure></p>
<p>å¯åŠ¨mongodä¹‹åï¼Œå¯åŠ¨ä»»æ„ä¸€ä¸ªmongoï¼Œåˆå§‹åŒ–å‰¯æœ¬é›†ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/Mongorepset/3</div><div class="line">./mongo --port=33333</div><div class="line"></div><div class="line">&gt; use admin</div><div class="line">switched to db admin</div><div class="line">&gt; config=&#123; _id:&quot;repset&quot;,members:[</div><div class="line">... &#123;_id:0,host:&quot;127.0.0.1:11111&quot;&#125;,</div><div class="line">... &#123;_id:1,host:&quot;127.0.0.1:22222&quot;&#125;,</div><div class="line">... &#123;_id:2,host:&quot;127.0.0.1:33333&quot;&#125;]</div><div class="line">... &#125;</div><div class="line">&gt; rs.initiate(config);</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ï¼ŒMongodbå‰¯æœ¬é›†å°±ç®—æ­å»ºå®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ç°åœ¨å‰¯æœ¬é›†çš„çŠ¶æ€ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">repset:SECONDARY&gt; rs.status();</div><div class="line">&#123;</div><div class="line">	&quot;set&quot; : &quot;repset&quot;,</div><div class="line">	&quot;date&quot; : ISODate(&quot;2015-08-17T12:59:59.910Z&quot;),</div><div class="line">	&quot;myState&quot; : 2,</div><div class="line">	&quot;members&quot; : [</div><div class="line">		&#123;</div><div class="line">			&quot;_id&quot; : 0,</div><div class="line">			&quot;name&quot; : &quot;127.0.0.1:11111&quot;,</div><div class="line">			&quot;health&quot; : 1,</div><div class="line">			&quot;state&quot; : 2,</div><div class="line">			&quot;stateStr&quot; : &quot;SECONDARY&quot;,</div><div class="line">			&quot;uptime&quot; : 693,</div><div class="line">			&quot;optime&quot; : Timestamp(1439816203, 1),</div><div class="line">			&quot;optimeDate&quot; : ISODate(&quot;2015-08-17T12:56:43Z&quot;),</div><div class="line">			&quot;configVersion&quot; : 1,</div><div class="line">			&quot;self&quot; : true</div><div class="line">		&#125;,</div><div class="line">		&#123;</div><div class="line">			&quot;_id&quot; : 1,</div><div class="line">			&quot;name&quot; : &quot;127.0.0.1:22222&quot;,</div><div class="line">			&quot;health&quot; : 1,</div><div class="line">			&quot;state&quot; : 2,</div><div class="line">			&quot;stateStr&quot; : &quot;SECONDARY&quot;,</div><div class="line">			&quot;uptime&quot; : 196,</div><div class="line">			&quot;optime&quot; : Timestamp(1439816203, 1),</div><div class="line">			&quot;optimeDate&quot; : ISODate(&quot;2015-08-17T12:56:43Z&quot;),</div><div class="line">			&quot;lastHeartbeat&quot; : ISODate(&quot;2015-08-17T12:59:59.561Z&quot;),</div><div class="line">			&quot;lastHeartbeatRecv&quot; : ISODate(&quot;2015-08-17T12:59:59.561Z&quot;),</div><div class="line">			&quot;pingMs&quot; : 0,</div><div class="line">			&quot;configVersion&quot; : 1</div><div class="line">		&#125;,</div><div class="line">		&#123;</div><div class="line">			&quot;_id&quot; : 2,</div><div class="line">			&quot;name&quot; : &quot;127.0.0.1:33333&quot;,</div><div class="line">			&quot;health&quot; : 1,</div><div class="line">			&quot;state&quot; : 1,</div><div class="line">			&quot;stateStr&quot; : &quot;PRIMARY&quot;,</div><div class="line">			&quot;uptime&quot; : 196,</div><div class="line">			&quot;optime&quot; : Timestamp(1439816203, 1),</div><div class="line">			&quot;optimeDate&quot; : ISODate(&quot;2015-08-17T12:56:43Z&quot;),</div><div class="line">			&quot;lastHeartbeat&quot; : ISODate(&quot;2015-08-17T12:59:59.562Z&quot;),</div><div class="line">			&quot;lastHeartbeatRecv&quot; : ISODate(&quot;2015-08-17T12:59:59.362Z&quot;),</div><div class="line">			&quot;pingMs&quot; : 0,</div><div class="line">			&quot;electionTime&quot; : Timestamp(1439816205, 1),</div><div class="line">			&quot;electionDate&quot; : ISODate(&quot;2015-08-17T12:56:45Z&quot;),</div><div class="line">			&quot;configVersion&quot; : 1</div><div class="line">		&#125;</div><div class="line">	],</div><div class="line">	&quot;ok&quot; : 1</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æœ‰ä¸€ä¸ªPRIMARYå’Œä¸¤ä¸ªSECONDARYèŠ‚ç‚¹ï¼Œä»–ä»¬çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼š<br><img src="http://docs.mongodb.org/manual/_images/replica-set-read-write-operations-primary.png" alt="">ï¼Œåœ¨åº”ç”¨ä¸­ï¼ŒPRIMARYèŠ‚ç‚¹è´Ÿè´£å†™å…¥å’Œè¯»å–æ•°æ®ï¼ŒSECONDARYèŠ‚ç‚¹è´Ÿè´£å¤‡ä»½PRIMARYä¸­æ•°æ®ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡å¿ƒè·³åŒ…æ¥æ£€æµ‹å½¼æ­¤çš„è¿è¡ŒçŠ¶æ€ï¼Œå¦‚æœä¸»èŠ‚ç‚¹æŒ‚æ‰ï¼Œå®ƒä»¬åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å°±å¯ä»¥é‡æ–°æ¨é€‰å‡ºä¸€ä¸ªæ–°çš„PRIMARYï¼Œä¿è¯æ•°æ®åº“çš„é«˜å¯ç”¨æ€§ã€‚</p>
<h1 id="Nginx-gridfsä¸­å‰¯æœ¬é›†çš„ä½¿ç”¨"><a href="#Nginx-gridfsä¸­å‰¯æœ¬é›†çš„ä½¿ç”¨" class="headerlink" title="Nginx-gridfsä¸­å‰¯æœ¬é›†çš„ä½¿ç”¨"></a>Nginx-gridfsä¸­å‰¯æœ¬é›†çš„ä½¿ç”¨</h1><p>Nginx-gridfsä¸ºNginxæä¾›äº†ç›´æ¥è®¿é—®Mongodbçš„èƒ½åŠ›ï¼Œé…ç½®Mongodbçš„å‰¯æœ¬é›†ä¹Ÿååˆ†ç®€å•ï¼Œåªéœ€è¦åœ¨nginxé…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„locationå¢åŠ å­—æ®µå°±å¯ä»¥äº†ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">location /gridfs/ &#123;</div><div class="line">    gridfs my_app field=filename type=string;</div><div class="line">    mongo &quot;repset&quot;</div><div class="line">          127.0.0.1:11111</div><div class="line">          127.0.0.1:22222</div><div class="line">          127.0.0.1:33333;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­Locationä¸­çš„å­—æ®µgridfs å¯¹åº”çš„æ˜¯æ•°æ®åº“åï¼›filedå¯¹åº”çš„æ˜¯æ£€ç´¢å­—æ®µï¼Œnginx-gridfsæä¾›äº†å¯¹_idå’Œfilenameçš„æ”¯æŒï¼›mongoå¯¹åº”çš„â€fooâ€æ˜¯å‰¯æœ¬é›†çš„åç§°ï¼›ä¸‹è¾¹åˆ™æ˜¯è¿™ä¸ªå‰¯æœ¬é›†çš„èŠ‚ç‚¹ã€‚<br>ä¿å­˜æ›´æ–°ä¹‹åçš„nginxé…ç½®æ–‡ä»¶ï¼Œé‡å¯nginxï¼Œå°±å¯ä»¥æ„‰å¿«åœ°é€šè¿‡Nginxè®¿é—®Mongodbå‰¯æœ¬é›†å•¦ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Mongodb </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mongodb </tag>
            
            <tag> Nginx </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[phpæ‰§è¡ŒæœåŠ¡å™¨ç«¯è„šæœ¬]]></title>
      <url>/2015/08/14/php%E6%89%A7%E8%A1%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%84%9A%E6%9C%AC/</url>
      <content type="html"><![CDATA[<h1 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h1><p>æœ€è¿‘åœ¨åšä¸€ä¸ªåœ¨å®¢æˆ·ç«¯è¿›è¡Œmongodbæ•°æ®é›†é€‰æ‹©ï¼Œç„¶åé‡å†™Nginxé…ç½®æ–‡ä»¶ï¼Œæœ€åé‡å¯Nginxçš„å°å·¥å…·ã€‚é‡åˆ°æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œç°åœ¨ç”Ÿæˆäº†Nginxé…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æ³•é‡å¯Nginxï¼Œä½¿ç”Ÿæˆçš„é…ç½®æ–‡ä»¶å³åˆ»ç”Ÿæ•ˆã€‚<br>äºæ˜¯æƒ³åˆ°äº†ä¸€ä¸ªåŠæ³•ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå†™ä¸€ä¸ªé‡å¯Nginxçš„è„šæœ¬ï¼Œä½¿ç”¨phpæ¥è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œå®¢æˆ·ç«¯é€šè¿‡httpè®¿é—®phpæ¥å®ŒæˆNginxçš„é‡å¯ã€‚<br><a id="more"></a></p>
<h1 id="Nginxé‡å¯è„šæœ¬"><a href="#Nginxé‡å¯è„šæœ¬" class="headerlink" title="Nginxé‡å¯è„šæœ¬"></a>Nginxé‡å¯è„šæœ¬</h1><p>æŒ‰ç…§ä¸Šè¾¹çš„æ€è·¯ï¼Œç¬¬ä¸€æ­¥è¦åšçš„å°±æ˜¯å…ˆæä¸€ä¸ªç®¡ç†Nginxçš„è„šæœ¬ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">#</div><div class="line"># nginx - this script starts and stops the nginx daemin</div><div class="line">#</div><div class="line"># chkconfig:   - 85 15 </div><div class="line"># description:  Nginx is an HTTP(S) server, HTTP(S) reverse \</div><div class="line">#               proxy and IMAP/POP3 proxy server</div><div class="line"># processname: nginx</div><div class="line"># config:      /usr/local/nginx/conf/nginx.conf</div><div class="line"># pidfile:     /usr/local/nginx/logs/nginx.pid</div><div class="line"></div><div class="line"># Source function library.</div><div class="line">. /etc/rc.d/init.d/functions</div><div class="line"></div><div class="line"># Source networking configuration.</div><div class="line">. /etc/sysconfig/network</div><div class="line"></div><div class="line"># Check that networking is up.</div><div class="line">[ &quot;$NETWORKING&quot; = &quot;no&quot; ] &amp;&amp; exit 0</div><div class="line"></div><div class="line">nginx=&quot;/usr/local/nginx/sbin/nginx&quot;</div><div class="line">prog=$(basename $nginx)</div><div class="line"></div><div class="line">NGINX_CONF_FILE=&quot;/usr/local/nginx/conf/nginx.conf&quot;</div><div class="line"></div><div class="line">lockfile=/var/lock/subsys/nginx</div><div class="line"></div><div class="line">start() &#123;</div><div class="line">    [ -x $nginx ] || exit 5</div><div class="line">    [ -f $NGINX_CONF_FILE ] || exit 6</div><div class="line">    echo -n $&quot;Starting $prog: &quot;</div><div class="line">    daemon $nginx -c $NGINX_CONF_FILE</div><div class="line">    retval=$?</div><div class="line">    echo</div><div class="line">    [ $retval -eq 0 ] &amp;&amp; touch $lockfile</div><div class="line">    return $retval</div><div class="line">&#125;</div><div class="line"></div><div class="line">stop() &#123;</div><div class="line">    echo -n $&quot;Stopping $prog: &quot;</div><div class="line">    killproc $prog -QUIT</div><div class="line">    retval=$?</div><div class="line">    echo</div><div class="line">    [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile</div><div class="line">    return $retval</div><div class="line">&#125;</div><div class="line"></div><div class="line">restart() &#123;</div><div class="line">    configtest || return $?</div><div class="line">    stop</div><div class="line">    start</div><div class="line">&#125;</div><div class="line"></div><div class="line">reload() &#123;</div><div class="line">    configtest || return $?</div><div class="line">    echo -n $&quot;Reloading $prog: &quot;</div><div class="line">    killproc $nginx -HUP</div><div class="line">    RETVAL=$?</div><div class="line">    echo</div><div class="line">&#125;</div><div class="line"></div><div class="line">force_reload() &#123;</div><div class="line">    restart</div><div class="line">&#125;</div><div class="line"></div><div class="line">configtest() &#123;</div><div class="line">  $nginx -t -c $NGINX_CONF_FILE</div><div class="line">&#125;</div><div class="line"></div><div class="line">rh_status() &#123;</div><div class="line">    status $prog</div><div class="line">&#125;</div><div class="line"></div><div class="line">rh_status_q() &#123;</div><div class="line">    rh_status &gt;/dev/null 2&gt;&amp;1</div><div class="line">&#125;</div><div class="line"></div><div class="line">case &quot;$1&quot; in</div><div class="line">    start)</div><div class="line">        rh_status_q &amp;&amp; exit 0</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    stop)</div><div class="line">        rh_status_q || exit 0</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    restart|configtest)</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    reload)</div><div class="line">        rh_status_q || exit 7</div><div class="line">        $1</div><div class="line">        ;;</div><div class="line">    force-reload)</div><div class="line">        force_reload</div><div class="line">        ;;</div><div class="line">    status)</div><div class="line">        rh_status</div><div class="line">        ;;</div><div class="line">    condrestart|try-restart)</div><div class="line">        rh_status_q || exit 0</div><div class="line">            ;;</div><div class="line">    *)</div><div class="line">        echo $&quot;Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;&quot;</div><div class="line">        exit 2</div><div class="line">esac</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥æŠŠè¿™ä¸ªè„šæœ¬æ”¾åœ¨æŒ‡å®šçš„ä½ç½®ï¼Œæ¯”å¦‚è¯´/etc/init.d/ã€‚</p>
<h1 id="phpè¿è¡ŒNginxæ§åˆ¶è„šæœ¬"><a href="#phpè¿è¡ŒNginxæ§åˆ¶è„šæœ¬" class="headerlink" title="phpè¿è¡ŒNginxæ§åˆ¶è„šæœ¬"></a>phpè¿è¡ŒNginxæ§åˆ¶è„šæœ¬</h1><p>ç°åœ¨ç®¡ç†Nginxçš„è„šæœ¬æœ‰äº†ï¼Œå†™å‡ è¡Œphpä»£ç ï¼Œè¿è¡Œè¿™ä¸ªè„šæœ¬å°±å¥½äº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">	$result2 = exec(&quot;/usr/bin/sudo /etc/init.d/nginx reload&quot;,$result);</div><div class="line">	echo $result2;</div><div class="line">?&gt;</div></pre></td></tr></table></figure></p>
<p>å†™å¥½æŠŠè¿™ä¸ªæ–‡ä»¶å‘½åä¸ºreload.phpä¸¢åœ¨/usr/local/nginx/html/é‡Œè¾¹ï¼Œåœ¨æµè§ˆå™¨é‡Œè¾¹è¾“å…¥ <a href="http://127.0.0.1/reload.php" target="_blank" rel="external">http://127.0.0.1/reload.php</a> å°±å¥½å•¦ã€‚<br>ä½†æ˜¯ï¼Œå¥½åƒæ²¡æœ‰ä»€ä¹ˆååº”å¯¹å§ã€‚åŸå› å°±æ˜¯ï¼Œ<strong>è¿è¡Œphp-fpmå·¥ä½œè¿›ç¨‹çš„ç”¨æˆ·ï¼Œå¹¶æ²¡æœ‰è¿è¡ŒNginxæ§åˆ¶è„šæœ¬çš„æƒé™</strong>ã€‚</p>
<h1 id="ç»™php-fpmææƒé™"><a href="#ç»™php-fpmææƒé™" class="headerlink" title="ç»™php-fpmææƒé™"></a>ç»™php-fpmææƒé™</h1><h2 id="æ›´æ”¹å·¥ä½œè¿›ç¨‹ç”¨æˆ·"><a href="#æ›´æ”¹å·¥ä½œè¿›ç¨‹ç”¨æˆ·" class="headerlink" title="æ›´æ”¹å·¥ä½œè¿›ç¨‹ç”¨æˆ·"></a>æ›´æ”¹å·¥ä½œè¿›ç¨‹ç”¨æˆ·</h2><p>é¦–å…ˆï¼Œè¦çœ‹ä¸€ä¸‹php-fpmçš„å·¥ä½œè¿›ç¨‹ç”¨æˆ·æ˜¯è°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps -ef | grep php-fpm</div></pre></td></tr></table></figure></p>
<p>è¿”å›ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">root       2665      1  0 14:08 ?        00:00:00 php-fpm: master process (/usr/local/php/etc/php-fpm.conf)</div><div class="line">nobody     2666   2665  0 14:08 ?        00:00:00 php-fpm: pool www</div><div class="line">nobody     2667   2665  0 14:08 ?        00:00:00 php-fpm: pool www</div><div class="line">root       4933   4371  0 14:49 pts/2    00:00:00 grep --color=auto php-fpm</div></pre></td></tr></table></figure></p>
<p>å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ï¼Œå½“å‰php-fpmè¿è¡Œçš„masterè¿›ç¨‹æ˜¯ç”±rootå¯åŠ¨çš„ï¼Œè€Œå·¥ä½œè¿›ç¨‹åˆ™æ˜¯é»˜è®¤çš„nobodyè¿è¡Œã€‚å¾—åˆ°è¿™äº›ä¿¡æ¯å°±å¯ä»¥ä¿®æ”¹php-fpmçš„å·¥ä½œè¿›è¡Œç”¨æˆ·ã€‚<br>æ·»åŠ ç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">groupadd reload</div><div class="line">adduser -g reload reload</div></pre></td></tr></table></figure></p>
<p>æ‰“å¼€/usr/local/php/etc/php-fpm.confæ–‡ä»¶ï¼Œè¿›è¡Œé…ç½®ã€‚ä¿®æ”¹å…¶ä¸­çš„userå’Œgroupä¸ºreloadï¼Œé‡å¯phpã€‚å¯ä»¥çœ‹åˆ°php-fpmçš„å·¥ä½œè¿›ç¨‹ç”¨æˆ·æ”¹å˜äº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ps -ef | grep php-fpm</div><div class="line"></div><div class="line">root       5326      1  0 15:00 ?        00:00:00 php-fpm: master process (/usr/local/php/etc/php-fpm.conf)</div><div class="line">reload     5327   5326  0 15:00 ?        00:00:00 php-fpm: pool www</div><div class="line">reload     5328   5326  0 15:00 ?        00:00:00 php-fpm: pool www</div><div class="line">root       5473   3935  0 15:03 pts/0    00:00:00 grep --color=auto php-fpm</div></pre></td></tr></table></figure></p>
<h2 id="æ›´æ”¹-etc-sudoersæ–‡ä»¶"><a href="#æ›´æ”¹-etc-sudoersæ–‡ä»¶" class="headerlink" title="æ›´æ”¹/etc/sudoersæ–‡ä»¶"></a>æ›´æ”¹/etc/sudoersæ–‡ä»¶</h2><p>åœ¨æ›´æ”¹äº†phpå·¥ä½œè¿›ç¨‹ç”¨æˆ·ä¹‹åï¼Œéœ€è¦åšçš„å°±ç»™è¿™ä¸ªç”¨æˆ·èµ‹äºˆæ“ä½œNginxæ§åˆ¶è„šæœ¬çš„æƒé™ã€‚<br>æ­¥éª¤å¦‚ä¸‹ï¼š<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œ/etc/sudoersæ–‡ä»¶æ˜¯ä¸å¯å†™çš„ï¼Œä½¿ç”¨rootæƒé™ä¿®æ”¹æ–‡ä»¶çš„æ“ä½œæƒé™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod u+w /etc/sudoers</div></pre></td></tr></table></figure></p>
<p>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€sudoersæ–‡ä»¶ï¼Œåœ¨æœ«å°¾è¡Œå¢åŠ ä¸€æ¡ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">reload   ALL=(root)      NOPASSWD: /etc/init.d/nginx</div></pre></td></tr></table></figure></p>
<p>å¹¶ä¸”éœ€è¦æŠŠsudoersæ–‡ä»¶ä¸­çš„â€œDefaults    requirettyâ€ä¸€è¡Œå‰å¢åŠ #ï¼Œå°†å…¶å±è”½ã€‚<br>ä¿®æ”¹å®Œæˆï¼Œä¿å­˜æ–‡ä»¶ï¼Œä¿®æ”¹sudoersæ–‡ä»¶æ“ä½œæƒé™ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod u-w /etc/sudoers</div></pre></td></tr></table></figure></p>
<h1 id="å®Œæˆé‡å¯"><a href="#å®Œæˆé‡å¯" class="headerlink" title="å®Œæˆé‡å¯"></a>å®Œæˆé‡å¯</h1><p>è‡³æ­¤ï¼Œéœ€è¦åšçš„å·²ç»å®Œæˆï¼Œåœ¨æµè§ˆå™¨é‡Œè¾¹è¾“å…¥<a href="http://127.0.0.1/reload.php" target="_blank" rel="external">http://127.0.0.1/reload.php</a> å°±å¯ä»¥æ­£å¸¸é‡å¯Nginxäº†ã€‚</p>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> php </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[redisçš„GEOæ‰©å±•]]></title>
      <url>/2015/08/11/redisGeo/</url>
      <content type="html"><![CDATA[<p>åœ¨redis3.2ç‰ˆæœ¬ä¸­ï¼Œå¢åŠ äº†geohashçš„æ‰©å±•ï¼Œè¿™ä¸‹å¯ä»¥ä½¿ç”¨Redisæ¥ä½œæ›´å¤šæœ‰æ„æ€çš„äº‹æƒ…äº†ã€‚<br><a id="more"></a></p>
<h1 id="GEOç›¸å…³å‘½ä»¤"><a href="#GEOç›¸å…³å‘½ä»¤" class="headerlink" title="GEOç›¸å…³å‘½ä»¤"></a>GEOç›¸å…³å‘½ä»¤</h1><p>ä¸»è¦ç›¸å…³çš„å‘½ä»¤æœ‰ä¸€ä¸‹è¿™äº›</p>
<ul>
<li>GEOADD</li>
<li>GEODIST</li>
<li>GEOHASH</li>
<li>GEOPOS</li>
<li>GEORADIUS</li>
<li>GEORADIUSBYMEMBER</li>
</ul>
<p>ä¸‹é¢å¼€å§‹ä¸€ä¸€è¯´æ˜è¿™äº›å‘½ä»¤çš„ä½œç”¨ï¼š</p>
<h2 id="GEOADD"><a href="#GEOADD" class="headerlink" title="GEOADD"></a>GEOADD</h2><p>ä»è¿™ä¸ªå‘½ä»¤çš„åå­—æ¥å¼€ï¼Œå¤§æ¦‚å°±å¯ä»¥çŒœæµ‹åˆ°å®ƒçš„ä½œç”¨ï¼Œå³å‘REDISä¸­å¢åŠ ä¸€æ¡å’Œåœ°ç†ä½ç½®ç›¸å…³çš„æ•°æ®ã€‚<br>ä½¿ç”¨è¯­æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GEOADD dataset latitude longtitude place [latitude longtitude place]...</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­,datasetè¡¨ç¤ºä¸€ä¸ªæ•°æ®é›†ï¼Œåœ¨è¿™ä¸ªæ•°æ®é›†ä¸­å¯ä»¥å­˜å‚¨å¤šä¸ªåœ°å(place)ï¼Œlatitudeå’Œlongtitudeå„è¡¨ç¤ºçº¬åº¦å’Œç»åº¦ï¼Œä¸€æ¬¡GEOADDå¯ä»¥æ·»åŠ å¤šä¸ªplaceã€‚<br>ç¤ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GEOADD Sicily 13.361389 38.115556 &quot;Palermo&quot; 15.087269 37.502669 &quot;Catania&quot;</div></pre></td></tr></table></figure></p>
<p>ä¸Šè¾¹çš„æ“ä½œï¼Œå°±å®Œæˆäº†å‘Sicilyæ•°æ®é›†ä¸­å¢åŠ Palermoå’ŒCataniaè¿™ä¸¤æ¡ä¿¡æ¯ï¼Œåœ¨å¢åŠ å®Œæˆæ—¶ï¼Œredis-cliè¿”å›å®Œæˆæ·»åŠ çš„æ•°æ®æ¡ç›®æ•°ã€‚</p>
<h2 id="GEODIST"><a href="#GEODIST" class="headerlink" title="GEODIST"></a>GEODIST</h2><p>è¿™æ¡å‘½ä»¤ä¼šè¿”å›åœ¨ä¸€ä¸ªGEOæ•°æ®é›†ä¸­ä¸¤ä¸ªåœ°ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªåœ°ç‚¹éƒ½ä¸å†GEOæ•°æ®é›†ä¸­ï¼Œè¿”å›NULLã€‚<br>è¿”å›çš„è·ç¦»é»˜è®¤å•ä½æ˜¯ç±³ï¼Œä¸è¿‡è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„å•ä½ä¸»è¦åŒ…æ‹¬ï¼š</p>
<ul>
<li>kmï¼ˆåƒç±³ï¼‰</li>
<li>mi (è‹±é‡Œ)</li>
<li>ft (è‹±å°º)</li>
</ul>
<p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">GEODIST Sicily Palermo Catania</div><div class="line">GEODIST Sicily Palermo Catania km</div><div class="line">GEODIST Sicily Palermo Catania mi</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ï¼Œæ ¹æ®æœ€åçš„å•ä½ï¼Œè¿”å›ä¸åŒçš„æ•°å€¼ã€‚</p>
<h2 id="GEOHASH"><a href="#GEOHASH" class="headerlink" title="GEOHASH"></a>GEOHASH</h2><p>ç”¨è¿™æ¡å‘½ä»¤å¯ä»¥è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªå·²ç»å­˜å…¥redisåœ°ç‚¹çš„11ä½Geohashç ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GEOHASH Sicily Palermo Catania</div></pre></td></tr></table></figure></p>
<p>è¿”å›ç»“æœæ˜¯è¿™æ ·çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1) &quot;sqc8b49rny0&quot;</div><div class="line">2) &quot;sqdtr74hyu0&quot;</div></pre></td></tr></table></figure></p>
<h2 id="GEOPOS"><a href="#GEOPOS" class="headerlink" title="GEOPOS"></a>GEOPOS</h2><p>è¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥è¿”å›åœ¨GEOSETé‡Œè¾¹æŒ‡å®šåœ°ç‚¹çš„ç»çº¬åº¦ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GEOPOS Sicily Palermo Catania</div></pre></td></tr></table></figure></p>
<p>è¿”å›ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1) 1) &quot;13.361389338970184&quot;</div><div class="line">   2) &quot;38.115556395496299&quot;</div><div class="line">2) 1) &quot;15.087267458438873&quot;</div><div class="line">   2) &quot;37.50266842333162&quot;</div></pre></td></tr></table></figure></p>
<h2 id="GEORADIUS"><a href="#GEORADIUS" class="headerlink" title="GEORADIUS"></a>GEORADIUS</h2><p>é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªå‘½ä»¤è¿”å›çš„æ˜¯æŒ‡å®šåœ°ç‚¹åŠå¾„èŒƒå›´å†…çš„æ‰€æœ‰åŒ¹é…åœ°ç‚¹ï¼Œç±»ä¼¼ä¸ç¼“å†²åŒºåˆ†æï¼Œè¿™ä¸ªç¼“å†²åŒºçš„èŒƒå›´å•ä½è·ŸGEODISTå‘½ä»¤ä¸­æ‰€ç”¨çš„ä¸€æ ·æœ‰m(ç±³),km(åƒç±³),mi(è‹±é‡Œ),ft(è‹±å°º)ã€‚<br>å¦å¤–è¿™ä¸ªå‘½ä»¤è¿˜æœ‰å¦å¤–çš„é€‰é¡¹ï¼š</p>
<ul>
<li>WITHDIST è¿”å›ç»“æœé™¤äº†åŒ¹é…ç‚¹ä»¥å¤–ï¼Œè¿˜è¿”å›åŒ¹é…ç‚¹è·ç¦»ä¸­å¿ƒç‚¹çš„è·ç¦»ï¼›</li>
<li>WITHCOORD è¿”å›ç»“æœé™¤åŒ¹é…ç‚¹å¤–ï¼Œè¿˜åŒ…å«åŒ¹é…ç‚¹çš„ç»çº¬åº¦ï¼›</li>
<li>WITHASH è¿”å›ç»“æœåˆåŒ¹é…ç‚¹å¤–ï¼Œè¿˜åŒ…å«åŒ¹é…ç‚¹çš„geohashç ã€‚</li>
</ul>
<p>é»˜è®¤çš„è¿”å›ç»“æœæ˜¯ä¸€ä¸ªæ— åºçš„é›†åˆï¼Œä½¿ç”¨å‘½ä»¤ASCæˆ–DESCå¯ä»¥ä½¿åŒ¹é…ç‚¹æŒ‰ç…§è·ç¦»ä¸­å¿ƒç‚¹çš„è¿œè¿‘æ’åºè¿”å›ã€‚<br>åŒæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ¹é…ç‚¹ä¼šå…¨æ•°è¿”å›ï¼Œå¢åŠ COUNTå‘½ä»¤ï¼Œå¯ä»¥è¿”å›æŒ‡å®šæ•°é‡çš„åŒ¹é…ç»“æœã€‚<br>å‘½ä»¤ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<h3 id="WITHDIST"><a href="#WITHDIST" class="headerlink" title="WITHDIST"></a>WITHDIST</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GEORADIUS Sicily 15 37 200 km WITHDIST</div></pre></td></tr></table></figure>
<p>å¯¹åº”è¿”å›<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1) 1) &quot;Palermo&quot;</div><div class="line">   2) &quot;190.4424&quot;</div><div class="line">2) 1) &quot;Catania&quot;</div><div class="line">   2) &quot;56.4413&quot;</div></pre></td></tr></table></figure></p>
<h3 id="WITHCOORD"><a href="#WITHCOORD" class="headerlink" title="WITHCOORD"></a>WITHCOORD</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GEORADIUS Sicily 15 37 200 km WITHCOORD</div></pre></td></tr></table></figure>
<p>å¯¹åº”è¿”å›<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">1) 1) &quot;Palermo&quot;</div><div class="line">   2) 1) &quot;13.361389338970184&quot;</div><div class="line">      2) &quot;38.115556395496299&quot;</div><div class="line">2) 1) &quot;Catania&quot;</div><div class="line">   2) 1) &quot;15.087267458438873&quot;</div><div class="line">      2) &quot;37.50266842333162&quot;</div></pre></td></tr></table></figure></p>
<h2 id="GEORADIUSBYMEMBER"><a href="#GEORADIUSBYMEMBER" class="headerlink" title="GEORADIUSBYMEMBER"></a>GEORADIUSBYMEMBER</h2><p>è¿™ä¸ªå‘½ä»¤å’ŒGEORADIUSä½¿ç”¨æ–¹æ³•ç±»ä¼¼ï¼Œä¸è¿‡è¿™ä¸ªæŒ‡å®šä¸­å¿ƒç‚¹ä¸æ˜¯ç»çº¬åº¦ï¼Œè€Œæ˜¯ä¸€ä¸ªåœ°ç‚¹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GEORADIUSBYMEMBER Sicily Palermo  200 km</div></pre></td></tr></table></figure></p>
<p>è¿”å›å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1) &quot;Palermo&quot;</div><div class="line">2) &quot;Catania&quot;</div></pre></td></tr></table></figure></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¢åŠ äº†GEOç‰¹æ€§çš„redisï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†å‘æŒ¥æƒ³è±¡åŠ›ï¼Œå¥½å¥½åˆ©ç”¨ä¸€ä¸‹å®ƒï¼Œåœ¨æ¥ä¸‹æ¥çš„å‡ ç¯‡åšå®¢ï¼Œæˆ‘ä¼šæ·±å…¥ç ”ç©¶ä¸€ä¸‹GEOHASHçš„ç‰¹æ€§ï¼Œå¦å¤–ï¼ŒMongodbçš„GEOç‰¹æ€§ä¹Ÿéå¸¸ä¹‹çš„ç ”ç©¶ã€‚</p>
]]></content>
      
        <categories>
            
            <category> æ•°æ®åº“ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Linuxä¸‹ç¨‹åºå¼€æœºè‡ªå¯åŠ¨]]></title>
      <url>/2015/08/07/Linux%E4%B8%8B%E7%A8%8B%E5%BA%8F%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8/</url>
      <content type="html"><![CDATA[<p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œéšç€æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„æœåŠ¡çš„å¢å¤šï¼Œæ¯æ¬¡æœåŠ¡å™¨é‡å¯ä¹‹åï¼Œéƒ½éœ€è¦é€ä¸€å°†æœåŠ¡å¯åŠ¨ï¼Œè¿™ä¸ªè¿‡ç¨‹è€—æ—¶è€Œä¸”éº»çƒ¦ã€‚äºæ˜¯ï¼Œå°†ä¸€äº›æœåŠ¡åœ¨æœåŠ¡å™¨å¯åŠ¨ä¹‹åè‡ªåŠ¨å¯åŠ¨å˜å¾—å¾ˆæ–¹ä¾¿ã€‚<br><a id="more"></a><br>åœ¨Linuxä¸‹è®¾ç½®å¼€æœºè‡ªå¯åŠ¨ç¨‹åºï¼Œé€šå¸¸çš„åšæ³•æ˜¯ä¿®æ”¹/etc/rc.d/rc.localæ–‡ä»¶ï¼Œè¿‡ç¨‹ååˆ†ç®€å•ï¼Œåªéœ€è¦åœ¨è¿™ä¸ªæ–‡ä»¶è¿½åŠ ä½ éœ€è¦çš„å‘½ä»¤å°±å¯ä»¥äº†ã€‚<br>æ¯”å¦‚è¯´ï¼Œæˆ‘ç°åœ¨éœ€è¦å¼€æœºè‡ªå¯åŠ¨Mongodb,php-fpm,nginxï¼Œç®€è¦åšæ³•å¦‚ä¸‹ï¼š<br>å°†mongodbå¯åŠ¨çš„å‘½ä»¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/Mongodb3.0/bin/mongod --dbpath=/usr/local/Mongodb3.0/db --logpath=/usr/local/Mongodb3.0/log/mongodb.log --fork --pidfilepath=/usr/local/Mongodb3.0/log/mongo.pid</div></pre></td></tr></table></figure></p>
<p>php-fpmå¯åŠ¨çš„å‘½ä»¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/php/sbin/php-fpm -c /usr/local/php/etc/php.ini -y /usr/local/php/etc/php-fpm.conf</div></pre></td></tr></table></figure></p>
<p>ä»¥åŠnginxå¯åŠ¨çš„å‘½ä»¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/nginx/sbin/nginx</div></pre></td></tr></table></figure></p>
<p>æ”¾åœ¨/etc/rc.d/rc.localæ–‡ä»¶æœ«å°¾ã€‚<br>è¿˜æœ‰ä¸€æ­¥ååˆ†é‡è¦ï¼Œå°±æ˜¯ä¿®æ”¹rc.localæ–‡ä»¶çš„æ“ä½œæƒé™ï¼Œchmod a+w /etc/rc.d/rc.loaclï¼Œèµ‹äºˆæ‰€æœ‰ç”¨æˆ·æ“ä½œrc.localæ–‡ä»¶çš„æƒé™ã€‚è¿™æ ·åœ¨é‡å¯ç³»ç»Ÿä¹‹åï¼Œè¿™äº›ç¨‹åºéƒ½ä¼šå¦‚æ„¿è‡ªåŠ¨å¯åŠ¨ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Linuxå‘½ä»¤ </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœåŠ¡å™¨ç«¯ç¼“å­˜ç¯å¢ƒé…ç½®(ä¸‰)]]></title>
      <url>/2015/08/04/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E7%BC%93%E5%AD%98%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-%E4%B8%89/</url>
      <content type="html"><![CDATA[<h1 id="nginxçš„Luaæ‰©å±•"><a href="#nginxçš„Luaæ‰©å±•" class="headerlink" title="nginxçš„Luaæ‰©å±•"></a><strong>nginxçš„Luaæ‰©å±•</strong></h1><p>æ¥ç€ä¸Šä¸¤ç¯‡åšå®¢ï¼Œç°åœ¨å¼€å§‹æ­å»ºnginxçš„LUAå’Œmongodbæ‰©å±•ï¼Œå®Œæˆæ•´ä¸ªæµç¨‹çš„æœ€åä¸€æ­¥é…ç½®ã€‚<br>Luaæ˜¯ä¸€ä¸ªå¯ä»¥åµŒå…¥åˆ°nginxé…ç½®æ–‡ä»¶çš„åŠ¨æ€è„šæœ¬è¯­è¨€ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨nginxè¯·æ±‚å¤„ç†çš„å„ä¸ªé˜¶æ®µæ‰§è¡Œå„ç§è¿›è¡Œé€»è¾‘æ§åˆ¶çš„Luaä»£ç ã€‚<br>æƒ³è¦åœ¨nginxé‡Œè¾¹å¢åŠ luaæ‰©å±•ï¼Œéœ€è¦çš„æ¨¡å—å¦‚ä¸‹ï¼š</p>
<ul>
<li><a href="http://luajit.org" target="_blank" rel="external">luajit</a></li>
<li><a href="https://github.com/simpl/ngx_devel_kit" target="_blank" rel="external">ngx_devel_kit</a></li>
<li><a href="https://github.com/chaoslawful/lua-nginx-module" target="_blank" rel="external">lua_nginx_module</a></li>
</ul>
<a id="more"></a>
<h2 id="å®‰è£…luajit"><a href="#å®‰è£…luajit" class="headerlink" title="å®‰è£…luajit"></a>å®‰è£…luajit</h2><p>æƒ¯ä¾‹ï¼Œå…ˆè¦ä¸‹è½½å®‰è£…ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">wget http://luajit.org/download/LuaJIT-2.0.0-beta9.tar.gz </div><div class="line">tar -zxvf LuaJIT-2.0.0-beta9.tar.gz</div><div class="line">cd LuaJIT-2.0.0-beta9/</div><div class="line">make</div><div class="line">make install PREFIX=/usr/local/luajit</div><div class="line">ln -sf luajit-2.0.0-beta9 /usr/local/luajit/bin/luajit</div></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥ï¼Œé…ç½®luajitçš„ç¯å¢ƒå˜é‡ï¼Œè¿™ä¸ªåœ¨nginxé‡æ–°ç¼–è¯‘çš„æ—¶å€™éœ€è¦ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">export LUAJIT_LIB=/usr/local/luajit/lib  </div><div class="line">export LUAJIT_INC=/usr/local/luajit/include/luajit-2.0</div></pre></td></tr></table></figure></p>
<h2 id="å®‰è£…ngx-devel-kit"><a href="#å®‰è£…ngx-devel-kit" class="headerlink" title="å®‰è£…ngx_devel_kit"></a>å®‰è£…ngx_devel_kit</h2><p><a href="https://github.com/simpl/ngx_devel_kit.git" target="_blank" rel="external">ç‚¹å‡»è·å–ngx_devel_kit</a>ï¼Œå°†å…¶æ”¾åœ¨/usr/localç›®å½•ä¸‹ï¼Œæˆ–è€…ä½¿ç”¨gitæ¥å¿«æ·è·å–ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local</div><div class="line">git clone https://github.com/simpl/ngx_devel_kit.git</div></pre></td></tr></table></figure></p>
<h2 id="å®‰è£…lua-nginx-module"><a href="#å®‰è£…lua-nginx-module" class="headerlink" title="å®‰è£…lua-nginx-module"></a>å®‰è£…lua-nginx-module</h2><p><a href="https://github.com/chaoslawful/lua-nginx-module.git" target="_blank" rel="external">ç‚¹å‡»è·å–lua-nginx-kit</a>ï¼Œè·Ÿngx_devel_kitä¸€æ ·ï¼Œå°†å…¶è§£å‹æ”¾äº/usr/localç›®å½•ä¸‹ã€‚æˆ–è€…ä½¿ç”¨gitå¿«æ·è·å–ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/</div><div class="line">git clone https://github.com/chaoslawful/lua-nginx-module.git</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨gitæ¥è·å–githubä¸Šçš„èµ„æºï¼Œæ˜¯ä¸æ˜¯ååˆ†æ–¹ä¾¿ï¼Ÿ</p>
<h2 id="é‡æ–°ç¼–è¯‘nginx"><a href="#é‡æ–°ç¼–è¯‘nginx" class="headerlink" title="é‡æ–°ç¼–è¯‘nginx"></a>é‡æ–°ç¼–è¯‘nginx</h2><p>è¿›å…¥nginxæºç æ”¾ç½®çš„æ–‡ä»¶å¤¹ï¼Œé‡æ–°é…ç½®configureï¼Œå†æ¬¡makeï¼Œå¢åŠ nginxçš„æ‰©å±•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/nginx-1.8.0/</div><div class="line">./configure --prefix=/usr/local/nginx --with-ld-opt=&quot;-Wl,-rpath,$LUAJIT_LIB&quot; --add-module=/usr/local/ngx_devel_kit --add-module=/usr/local/lua-nginx-module</div><div class="line">make -j2 </div><div class="line">make install</div></pre></td></tr></table></figure></p>
<p>è‡³æ­¤ï¼Œnginxçš„lua æ‰©å±•æ¨¡å—å·²ç»å®‰è£…å®Œæ¯•ï¼Œä¸‹é¢è¿›è¡Œä¸€ä¸‹æµ‹è¯•ã€‚</p>
<h2 id="æµ‹è¯•luaæ¨¡å—"><a href="#æµ‹è¯•luaæ¨¡å—" class="headerlink" title="æµ‹è¯•luaæ¨¡å—"></a>æµ‹è¯•luaæ¨¡å—</h2><p>åœ¨nginxçš„é…ç½®æ–‡ä»¶ä¸­å¢åŠ ä¸€æ®µä»£ç å°±OKäº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gedit /usr/local/nginx/conf/nginx.conf</div></pre></td></tr></table></figure></p>
<p>åœ¨ç›‘å¬80ç«¯å£çš„serverä¸­å¢åŠ ä¸€ä¸‹å†…å®¹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">location /lua &#123;</div><div class="line">	    default_type &apos;text/plain&apos;;</div><div class="line">	    content_by_lua &apos;ngx.say(&quot;I am lua in nginx&quot;)&apos;;</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>å¯åŠ¨nginx<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/nginx/sbin/nginx</div></pre></td></tr></table></figure></p>
<p>ç°åœ¨åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://127.0.0.1/lua" target="_blank" rel="external">127.0.0.1/lua</a>ï¼Œå°±å¯ä»¥çœ‹åˆ°â€œI am lua in nginxâ€ã€‚è¿™æ ·å°±è¯´æ˜ï¼Œnginxçš„luaæ¨¡å—ä¹Ÿå®‰è£…æˆåŠŸäº†ã€‚</p>
<h1 id="nginxçš„mongodb-gridfsæ‰©å±•"><a href="#nginxçš„mongodb-gridfsæ‰©å±•" class="headerlink" title="nginxçš„mongodb gridfsæ‰©å±•"></a><strong>nginxçš„mongodb gridfsæ‰©å±•</strong></h1><p>å…ˆä»githubä¸Šå°†nginx-gridfsæ¨¡å—ä¸‹è½½ä¸‹æ¥ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cd /usr/local</div><div class="line">git clone https://github.com/mdirolf/nginx-gridfs.git</div><div class="line">cd nginx-gridfs/</div><div class="line">git submodule init</div><div class="line">git submodule update</div></pre></td></tr></table></figure></p>
<p>é‡æ–°ç¼–è¯‘nginxï¼Œè¿™é‡Œè¦æ³¨æ„ï¼Œç”±äºä¸Šè¾¹å·²ç»å¢åŠ äº†nginxçš„luaæ‰©å±•ï¼Œç°åœ¨éœ€è¦å¢åŠ æ¨¡å—ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/nginx/sbin/nginx -V</div></pre></td></tr></table></figure></p>
<p>è·å–å½“å‰nginxå·²æœ‰çš„æ¨¡å—ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">nginx version: nginx/1.8.0</div><div class="line">built by gcc 4.8.3 20140911 (Red Hat 4.8.3-9) (GCC) </div><div class="line">configure arguments: --prefix=/usr/local/nginx --with-ld-opt=-Wl,-rpath,/usr/local/luajit/lib --add-module=/usr/local/ngx_devel_kit --add-module=/usr/local/lua-nginx-module</div></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œconfigure argumentsåè¾¹çš„å‚æ•°ï¼Œå°†ä»–ä»¬æ‹·è´ï¼Œä¾›ç­‰ä¸‹ä½¿ç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/nginx-1.8.0/</div><div class="line">./configure --prefix=/usr/local/nginx --with-ld-opt=-Wl,-rpath,/usr/local/luajit/lib --add-module=/usr/local/ngx_devel_kit --add-module=/usr/local/lua-nginx-module --with-openssl=/usr/include/openssl --with-http_stub_status_module --add-module=/usr/local/nginx-gridfs</div><div class="line">make </div><div class="line">make install</div></pre></td></tr></table></figure></p>
<p>è¿™æ ·ï¼Œnginx-gridfsæ¨¡å—å°±ä¹Ÿå®‰è£…å®Œæˆäº†ï¼Œç°åœ¨å°±å¯ä»¥ä½¿ç”¨nginxæ¥ç›´æ¥æ“ä½œmongodbä¸­çš„gridfsäº†ã€‚</p>
<h1 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a><strong>ç»“æŸ</strong></h1><p>åˆ°è¿™é‡Œï¼Œæ•´ä¸ªæµç¨‹çš„ç¯å¢ƒå®‰è£…å’Œé…ç½®å°±ç®—å®Œæˆäº†ã€‚åè¾¹çš„åšå®¢ä¼šç»§ç»­è®°å½•æˆ‘åœ¨å­¦ä¹ è¿™äº›å†…å®¹çš„è¿‡ç¨‹ã€‚<br>æœ€åï¼Œå†æ¥å¼ ç¾å›¾å§<br><img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipsesv_jpgIMG_1877.JPG" alt=""><br>~~ æ­¦æ±‰æœ€è¿‘çš„å¤©æ°”ï¼Œç¡®å®å¾ˆå¥½ï¼</p>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mongodb </tag>
            
            <tag> Nginx </tag>
            
            <tag> Redis </tag>
            
            <tag> Lua </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœåŠ¡å™¨ç«¯ç¼“å­˜ç¯å¢ƒé…ç½®(äºŒ)]]></title>
      <url>/2015/08/02/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E7%BC%93%E5%AD%98%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-%E4%BA%8C/</url>
      <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡åšå®¢è®²è§£äº†æ•´ä¸ªç¼“å­˜æµç¨‹ä¸­æ•°æ®åº“éƒ¨åˆ†çš„æ­å»ºï¼Œæœ‰äº†æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œç°åœ¨å¯ä»¥æ­å»ºä¸Šå±‚çš„å†…å®¹äº†ã€‚</p>
<a id="more"></a>
<h1 id="WebæœåŠ¡å™¨"><a href="#WebæœåŠ¡å™¨" class="headerlink" title="WebæœåŠ¡å™¨"></a><strong>WebæœåŠ¡å™¨</strong></h1><p>æ•´ä¸ªç¼“å­˜æµç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯éƒ½æ˜¯ä»¥HTTPè¯·æ±‚çš„æ–¹å¼è·å–æœåŠ¡å™¨ä¸Šæ•°æ®åº“ä¸­çš„æ•°æ®ã€‚æˆ‘ä»¬é€‰æ‹©äº†Nginxä½œä¸ºHTTPè¯·æ±‚è§£æå’Œè´Ÿè½½å‡è¡¡çš„å·¥å…·ã€‚<br>Nginxä½œä¸ºä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªIMAP/POP3/SMTP ä»£ç†æœåŠ¡å™¨ã€‚å®ƒä»¥ç¨³å®šæ€§ã€ä¸°å¯Œçš„åŠŸèƒ½å’Œç¬¬ç³»ç»Ÿèµ„æºæ¶ˆè€—è€Œé—»åã€‚ä¸‹é¢å¼€å§‹ä»‹ç»Nginxçš„å®‰è£…å’Œé…ç½®ï¼š<br>ä»¥å¾€çš„å®‰è£…æ–¹å¼éƒ½æ˜¯ç›´æ¥ç¼–è¯‘æºç ï¼Œè¿™æ¬¡æ¥ç‚¹æ–°çš„ã€‚</p>
<h2 id="Ngxinæ‰“åŒ…å®‰è£…"><a href="#Ngxinæ‰“åŒ…å®‰è£…" class="headerlink" title="Ngxinæ‰“åŒ…å®‰è£…"></a>Ngxinæ‰“åŒ…å®‰è£…</h2><p>æŒ‰ç…§<a href="http://nginx.org/en/linux_packages.html" target="_blank" rel="external">nginxå®˜ç½‘</a>ä¸Šçš„æ–¹æ³•æ¥è¿›è¡Œæ“ä½œã€‚<br>é¦–å…ˆæ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥/usr/localç›®å½•ï¼Œä¸‹è½½rpmæ–‡ä»¶ï¼š</p>
<pre><code>[wangmeg@localhost ~]$ cd /usr/local
[root@localhost local]# wget http://nginx.org/packages/centos/7/noarch/RPMS/nginx-    release-centos-7-0.el7.ngx.noarch.rpm
</code></pre><p>ä¹‹åå®‰è£…rpmæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨yum å‘½ä»¤è¿›è¡ŒNginxçš„è‡ªåŠ¨å®‰è£…ï¼š</p>
<pre><code>[root@localhost local]# rpm -i nginx-release-centos-7-0.el7.ngx.noarch.rpm 
[root@localhost local]# yum install nginx
</code></pre><p>ç¨ç­‰ç‰‡åˆ»ï¼Œç»ˆç«¯å‡ºç°</p>
<pre><code>----------------------------------------------------------------------

Thanks for using nginx!

Please find the official documentation for nginx here:
* http://nginx.org/en/docs/

Commercial subscriptions for nginx are available on:
* http://nginx.com/products/

----------------------------------------------------------------------
  Verifying  : 1:nginx-1.8.0-1.el7.ngx.x86_64                               1/1 

Installed:
  nginx.x86_64 1:1.8.0-1.el7.ngx                                                

Complete!
</code></pre><p>è¡¨ç¤ºNginxå®‰è£…å®Œæ¯•ã€‚ç°åœ¨ï¼Œåœ¨ç»ˆç«¯é”®å…¥å‘½ä»¤nginxå¯åŠ¨nginxï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥http:127.0.0.1ä¹‹åå‡ºç°<br><img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipsesv_jpgScreenshot%20from%202015-08-02%2020%3A29%3A42.png" alt=""><br>è¿™æ ·ï¼ŒNginxå°±ç®—å®‰è£…å®Œæ¯•äº†ã€‚<br>å¯ä»¥åœ¨ç»ˆç«¯é”®å…¥å‘½ä»¤ï¼š nginx -V æ¥æŸ¥çœ‹è¿™æ ·é»˜è®¤å®‰è£…çš„ç›¸å…³é…ç½®ã€‚</p>
<pre><code>[root@localhost local]# nginx -V
nginx version: nginx/1.8.0
built by gcc 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC) 
built with OpenSSL 1.0.1e-fips 11 Feb 2013
TLS SNI support enabled
configure arguments: --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-mail --with-mail_ssl_module --with-file-aio --with-ipv6 --with-http_spdy_module --with-cc-opt=&apos;-O2 -g -pipe -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic&apos;
</code></pre><h2 id="Nginxæºç ç¼–è¯‘"><a href="#Nginxæºç ç¼–è¯‘" class="headerlink" title="Nginxæºç ç¼–è¯‘"></a>Nginxæºç ç¼–è¯‘</h2><p>ç›¸å¯¹äºä¸Šè¿°ä½¿ç”¨yumå®‰è£…nginxï¼Œæˆ‘æ›´ä¹ æƒ¯ç¼–è¯‘æºç å®‰è£…ã€‚<br>åœ¨è¿›è¡Œå®‰è£…ä»¥å‰ï¼Œéœ€è¦å®‰è£…pcreå’Œzlibã€‚</p>
<h3 id="pcreå®‰è£…"><a href="#pcreå®‰è£…" class="headerlink" title="pcreå®‰è£…"></a>pcreå®‰è£…</h3><pre><code>[root@localhost etc]# cd /usr/local
[root@localhost local]# wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.37.tar.gz
[root@localhost local]# tar -zxvf pcre-8.37.tar.gz 
[root@localhost pcre-8.37]# cd pcre-8.37/
[root@localhost pcre-8.37]# ./configure 
[root@localhost pcre-8.37]# make 
[root@localhost pcre-8.37]# make install
</code></pre><p>è¿™æ ·ï¼Œpcreå°±ç®—å®‰è£…å®Œæˆã€‚</p>
<h3 id="zlibå®‰è£…"><a href="#zlibå®‰è£…" class="headerlink" title="zlibå®‰è£…"></a>zlibå®‰è£…</h3><pre><code>[root@localhost local]# wget http://zlib.net/zlib-1.2.8.tar.gz
[root@localhost local]# tar -zxvcf zlib-1.2.8.tar.gz 
[root@localhost local]# cd zlib-1.2.8/
[root@localhost zlib-1.2.8]# make &amp;&amp; make install
</code></pre><p>OKï¼Œzlibä¹Ÿå®‰è£…å®Œæ¯•ã€‚</p>
<h3 id="Nginxæºç ç¼–è¯‘å®‰è£…"><a href="#Nginxæºç ç¼–è¯‘å®‰è£…" class="headerlink" title="Nginxæºç ç¼–è¯‘å®‰è£…"></a>Nginxæºç ç¼–è¯‘å®‰è£…</h3><p>æ¥ä¸‹æ¥ä¸‹è½½nginxæºç ï¼Œå®Œæˆåç»­çš„å®‰è£…å’Œé…ç½®ã€‚</p>
<p>[root@localhost pcre-8.37]# cd /usr/local<br>[root@localhost local]# wget <a href="http://nginx.org/download/nginx-1.8.0.tar.gz" target="_blank" rel="external">http://nginx.org/download/nginx-1.8.0.tar.gz</a><br>[root@localhost local]# tar -zxvf nginx-1.8.0.tar.gz<br>[root@localhost local]# cd ./nginx-1.8.0/<br>[root@localhost nginx-1.8.0]# ./configure â€“prefix=/usr/local/nginx<br>[root@localhost nginx-1.8.0]# make &amp;&amp; make install</p>
<p>å¦‚æœæ²¡æœ‰é”™è¯¯æç¤ºï¼Œåˆ™è¡¨ç¤ºnginxç¼–è¯‘å®‰è£…å®Œæˆã€‚<br>ç°åœ¨é”®å…¥å‘½ä»¤/usr/local/nginx/sbin/nginxå°±å¯ä»¥å¯åŠ¨nginxäº†ã€‚<br>å¦å¤–ï¼Œç»ˆæ­¢nginxçš„å‘½ä»¤ä½¿ç”¨ï¼š/usr/local/nginx/sbin/nginx -s stopï¼›è¿›è¡Œnginxå¹³æ»‘é‡å¯ä½¿ç”¨å‘½ä»¤/usr/local/nginx/sbin/nginx -s reloadã€‚</p>
<h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a><strong>PHP</strong></h1><p>ä¸Šè¾¹çš„æ“ä½œï¼Œç®—æ˜¯å®Œæˆäº†nginxçš„åˆæ­¥å®‰è£…ï¼Œæ¥ä¸‹æ¥å¼€å§‹è¿›è¡ŒPHPçš„å®‰è£…ã€‚<br>é¦–å…ˆï¼Œéœ€è¦ä¸‹è½½PHPï¼Œå¯ä»¥ä»å®˜ç½‘ä¸Šè¿›è¡Œä¸‹è½½ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯5.4.43ç‰ˆæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost Desktop]# cd /usr/local</div><div class="line">[root@localhost local]# wget http://php.net/distributions/php-5.4.43.tar.gz</div></pre></td></tr></table></figure>
<p>å®Œæˆè§£å‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost local]# tar -zxvf php-5.4.43.tar.gz</div></pre></td></tr></table></figure></p>
<p>è¿›è¡Œå®‰è£…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost local]# cd php-5.4.43/</div><div class="line">[root@localhost php-5.4.43]# ./configure --prefix=/usr/local/php --enable-fpm</div></pre></td></tr></table></figure></p>
<p>æ£€æŸ¥é…ç½®çš„è¿‡ç¨‹ï¼Œæˆ‘çš„æœºå™¨ä¸Šå‡ºç°äº†é”™è¯¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">checking for xml2-config path... </div><div class="line">configure: error: xml2-config not found. Please check your libxml2 installation.</div></pre></td></tr></table></figure></p>
<p>è¡¨ç¤ºç¼ºå°‘libxml2ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œä½¿ç”¨yum å®‰è£…ä¾¿æ˜¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost php-5.4.43]# yum install libxml2 </div><div class="line">[root@localhost php-5.4.43]# yum install libxml2-devel -y</div></pre></td></tr></table></figure></p>
<p>å†æ¬¡è¿›è¡Œé…ç½®æ£€æŸ¥ï¼Œå‡ºç°ä¸‹é¢è¿™äº›åˆ™å¯è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Thank you for using PHP.</div><div class="line"></div><div class="line">config.status: creating php5.spec</div><div class="line">config.status: creating main/build-defs.h</div><div class="line">config.status: creating scripts/phpize</div><div class="line">config.status: creating scripts/man1/phpize.1</div><div class="line">config.status: creating scripts/php-config</div><div class="line">config.status: creating scripts/man1/php-config.1</div><div class="line">config.status: creating sapi/cli/php.1</div><div class="line">config.status: creating sapi/fpm/php-fpm.conf</div><div class="line">config.status: creating sapi/fpm/init.d.php-fpm</div><div class="line">config.status: creating sapi/fpm/php-fpm.service</div><div class="line">config.status: creating sapi/fpm/php-fpm.8</div><div class="line">config.status: creating sapi/fpm/status.html</div><div class="line">config.status: creating sapi/cgi/php-cgi.1</div><div class="line">config.status: creating ext/phar/phar.1</div><div class="line">config.status: creating ext/phar/phar.phar.1</div><div class="line">config.status: creating main/php_config.h</div><div class="line">config.status: executing default commands</div></pre></td></tr></table></figure></p>
<p>é…ç½®ç¯å¢ƒæ²¡é—®é¢˜ï¼Œå°±å¯ä»¥è¿›è¡Œmake &amp;&amp; make installï¼Œå®Œæˆå®‰è£…äº†ã€‚<br>å®‰è£…å®Œæˆä¹‹åï¼Œä¸è¦å¿˜è®°å°†PHPé…ç½®æ–‡ä»¶æ”¾åˆ°æŒ‡å®šä½ç½®ã€‚<br><code>[root@localhost php-5.4.43]# cp ./php.ini-development /usr/local/php/etc/php.ini</code><br>å®ŒæˆPHPå®‰è£…ä¹‹åï¼Œå’±ä»¬æ¥ç»™å®ƒåŠ ç‚¹æ–™ï¼Œå‰è¾¹è¯´äº†ï¼Œæ•´ä¸ªæµç¨‹ï¼Œéœ€è¦ä½¿ç”¨PHPæ¥è·å–Mongodbä¸­çš„æ•°æ®é›†ä¿¡æ¯ï¼Œå’±ä»¬é¡ºåŠ¿æŠŠmongodbçš„æ‰©å±•ä¹Ÿè£…ä¸ŠæŠŠã€‚</p>
<p>å…ˆä»githubä¸Šå°†<a href="https://github.com/mongodb/mongo-php-driver" target="_blank" rel="external">phpçš„mongodbæ‰©å±•</a>ä¸‹è½½ã€‚æŒ‰ç…§ç½‘é¡µä¸­çš„æ–¹æ³•è¿›è¡Œå®‰è£…é…ç½®ã€‚<br>éœ€è¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯ã€‚phpizeçš„é»˜è®¤å®‰è£…ä½ç½®æ˜¯/usr/local/php/bin/phpizeï¼›php-configé»˜è®¤ä½ç½®æ˜¯/usr/local/php/bin/php-configã€‚<br>è¿™æ ·ã€‚PHPçš„å®‰è£…å’Œéœ€è¦çš„æ‰©å±•å·²ç»å®‰è£…å®Œæ¯•ã€‚</p>
<h1 id="Nginx-phpçš„é…ç½®"><a href="#Nginx-phpçš„é…ç½®" class="headerlink" title="Nginx+phpçš„é…ç½®"></a>Nginx+phpçš„é…ç½®</h1><p>ç°åœ¨nginxå’Œphpéƒ½å·²ç»åˆ†åˆ«å®‰è£…å®Œæˆï¼Œç°åœ¨å¯ä»¥æ£€éªŒä¸€ä¸‹ä»–ä»¬åœ¨ä¸€èµ·èƒ½å¦æ­£å¸¸è¿è¡Œã€‚</p>
<ol>
<li><p>ä¿®æ”¹nginxé…ç½®æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]# gedit /usr/local/nginx/conf/nginx.conf</div></pre></td></tr></table></figure>
</li>
<li><p>æ‰¾åˆ°è¿™ä¸€æ®µï¼Œå–æ¶ˆå‰è¾¹çš„æ³¨é‡Šâ€œ#â€,ä¿®æ”¹å…¶ä¸­å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">location ~ \.php$ &#123;</div><div class="line">            root           html;</div><div class="line">            fastcgi_pass   127.0.0.1:9000;</div><div class="line">            fastcgi_index  index.php;</div><div class="line">            fastcgi_param  SCRIPT_FILENAME  /usr/local/nginx/html/$fastcgi_script_name;</div><div class="line">            include        fastcgi_params;</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨/usr/lcoal/nginx/html/æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºæ–‡ä»¶info.phpï¼Œå†™å…¥å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">   echo phpinfo();</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>å¯åŠ¨nginxå’Œphp-fpm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]# /usr/local/nginx/sbin/nginx </div><div class="line">[root@localhost ~]# /usr/local/php/sbin/php-fpm -c /usr/local/php/etc/php.ini -y /usr/local/php/etc/php-fpm.conf</div></pre></td></tr></table></figure>
</li>
<li><p>å¯åŠ¨firefox,åœ°å€æ ä¸­è¾“å…¥â€127.0.0.1/info.phpâ€ï¼Œå‡ºç°å¦‚ä¸‹ç»“æœåˆ™è¡¨æ˜è¿è¡Œæ­£å¸¸ã€‚<br><img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipsesv_jpgScreenshot%20from%202015-08-04%2001%3A11%3A35.png" alt=""></p>
</li>
<li><p>è¿™ä¸ªç½‘é¡µå¾€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ ·çš„ç»“æœï¼Œè¡¨ç¤ºmongodbçš„æ‰©å±•ä¹Ÿå®‰è£…æˆåŠŸã€‚<br><img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipsesv_jpgScreenshot%20from%202015-08-04%2001%3A12%3A07.png" alt=""></p>
</li>
</ol>
<h1 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a><strong>æœªå®Œå¾…ç»­</strong></h1><p>æ•´ä¸ªæµç¨‹å†…å®¹è¾ƒå¤šï¼Œä¸‹ä¸€ç¯‡åšå®¢ï¼Œç»ä¼šä»‹ç»å¦‚ä½•å®‰è£…é…ç½®nginxçš„Luaæ‰©å±•ï¼Œå®Œæˆæ•´ä¸ªæµç¨‹çš„æ­å»ºã€‚<br>æœ€åï¼Œä»¥ä¸€å¼ ç¾å›¾æ¥ç»“æŸè¿™ç¯‡åšå®¢ã€‚<br><img src="http://7xkswi.com1.z0.glb.clouddn.com/eclipsesv_jpgIMG_1858.JPG" alt="é›¨ååˆæ™´çš„æ­¦æ±‰"></p>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mongodb </tag>
            
            <tag> Nginx </tag>
            
            <tag> Redis </tag>
            
            <tag> Lua </tag>
            
            <tag> PHP </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æœåŠ¡å™¨ç«¯ç¼“å­˜ç¯å¢ƒé…ç½®]]></title>
      <url>/2015/07/31/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E7%BC%93%E5%AD%98%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<h1 id="åŸææ–™"><a href="#åŸææ–™" class="headerlink" title="åŸææ–™"></a><strong>åŸææ–™</strong></h1><p>æ­£æ‰€è°“â€œå·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šâ€ï¼Œåœ¨è¿›è¡ŒæœåŠ¡å™¨ç«¯ç¼“å­˜æ­å»ºä¹‹å‰ï¼Œéœ€è¦å°†æ•´ä¸ªæµç¨‹æ‰€éœ€çš„å…ƒç´ å‡†å¤‡å¥½ã€‚</p>
<ul>
<li><a href="http://nginx.org/" title="ä½œä¸ºWebæœåŠ¡å™¨çš„å­˜åœ¨" target="_blank" rel="external">Nginx</a>ä½œä¸ºWebæœåŠ¡å™¨çš„å­˜åœ¨</li>
<li><a href="https://www.mongodb.org/" title="ç£ç›˜æ•°æ®åº“" target="_blank" rel="external">Mongodb</a>ç£ç›˜æ•°æ®åº“</li>
<li><a href="http://www.lua.org/" title="ä¸Nginxç»“åˆï¼Œè¿›è¡ŒæœåŠ¡å™¨ç«¯çš„é€»è¾‘æ§åˆ¶" target="_blank" rel="external">Lua</a>ä¸Nginxç»“åˆï¼Œè¿›è¡ŒæœåŠ¡å™¨ç«¯çš„é€»è¾‘æ§åˆ¶</li>
<li><a href="http://redis.io/" title="é«˜é€Ÿç¼“å­˜" target="_blank" rel="external">Redis</a>å†…å­˜æ•°æ®åº“ï¼Œé«˜é€Ÿç¼“å­˜</li>
<li><a href="http://www.php.net/" title="è¿”å›æ•°æ®åº“ä¿¡æ¯ç»™å®¢æˆ·ç«¯" target="_blank" rel="external">PHP</a>è¯»å–ç£ç›˜æ•°æ®åº“ä¿¡æ¯ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯</li>
</ul>
<a id="more"></a>
<h1 id="è°ƒæ–™åŒ…"><a href="#è°ƒæ–™åŒ…" class="headerlink" title="è°ƒæ–™åŒ…"></a><strong>è°ƒæ–™åŒ…</strong></h1><p>æœ‰äº†åŸææ–™ï¼Œå½“ç„¶éœ€è¦å°†å®ƒä»¬èåˆåœ¨ä¸€èµ·ï¼Œæ‰èƒ½çƒ¹è°ƒå‡ºç¾å‘³ï¼Œä¸‹é¢è¿™äº›å†…å®¹åˆ™å¯ä»¥ç§°ä¹‹ä¸ºè°ƒæ–™åŒ…ï¼š</p>
<ul>
<li><strong>Nginxçš„Luaæ‰©å±•</strong><br><a href="http://luajit.org" target="_blank" rel="external">LuaJit</a><br><a href="https://github.com/simpl/ngx_devel_kit" target="_blank" rel="external">ngx_devel_kit</a><br><a href="https://github.com/chaoslawful/lua-nginx-module" target="_blank" rel="external">lua-nginx-module</a></li>
<li><strong>Nginxçš„Mongodbæ‰©å±•</strong><br><a href="https://github.com/mdirolf/nginx-gridfs" target="_blank" rel="external">Nginx-gridfs</a></li>
<li><strong>PHPçš„Mongodbæ‰©å±•</strong><br><a href="https://github.com/mongodb/mongo-php-driver" target="_blank" rel="external">Mongo-php-driver</a></li>
<li><a href="https://github.com/h4lflife/lua-resty-redis" target="_blank" rel="external"><strong>Luaçš„Redisæ‰©å±•</strong></a></li>
</ul>
<h1 id="Mongodbçš„å®‰è£…é…ç½®"><a href="#Mongodbçš„å®‰è£…é…ç½®" class="headerlink" title="Mongodbçš„å®‰è£…é…ç½®"></a><strong>Mongodbçš„å®‰è£…é…ç½®</strong></h1><p>æŸ¿å­å…ˆæŒ‘è½¯çš„æï¼Œæ•´ä¸ªæµç¨‹ä¸­éœ€è¦å®‰è£…å’Œé…ç½®çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œç›¸æ¯”æ¥è¯´ï¼ŒMongodbç®—æ˜¯æœ€ç®€å•çš„ä¸€ä¸ªäº†ã€‚</p>
<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>åœ¨å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ï¼Œæœ€æ–°çš„Mongodbç‰ˆæœ¬æ˜¯<a href="https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-3.0.5.tgz" target="_blank" rel="external">3.0.5</a>ï¼Œä¸‹è½½çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$ cd /usr/local</div><div class="line">$ su</div><div class="line">Password: </div><div class="line"># wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-3.0.5.tgz</div><div class="line">	--2015-08-01 11:06:41--  https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-3.0.5.tgz</div><div class="line">	Resolving fastdl.mongodb.org (fastdl.mongodb.org)... 54.230.156.11, 54.230.156.102, 54.230.156.123, ...</div><div class="line">	Connecting to fastdl.mongodb.org (fastdl.mongodb.org)|54.230.156.11|:443... connected.</div><div class="line">	HTTP request sent, awaiting response... 200 OK</div><div class="line">	Length: 50203367 (48M) [application/x-gzip]</div><div class="line">	Saving to: â€˜mongodb-linux-x86_64-rhel70-3.0.5.tgzâ€™</div><div class="line"></div><div class="line">100%[======================================&gt;] 50,203,367   582KB/s   in 4m 40s </div><div class="line"></div><div class="line">	2015-08-01 11:11:31 (175 KB/s) - â€˜mongodb-linux-x86_64-rhel70-3.0.5.tgzâ€™ saved [50203367/50203367]</div></pre></td></tr></table></figure>
<p>é¦–å…ˆè¿›å…¥/usr/localç›®å½•ï¼Œä¸‹è½½è¿™ä¸ªæ–‡ä»¶éœ€è¦rootæƒé™ï¼Œè¾“å…¥suä¹‹åï¼Œè¾“å…¥è‡ªå·±çš„rootå¯†ç ï¼Œä½¿ç”¨wgetå‘½ä»¤ï¼Œä¸‹è½½MongoDBåˆ°/usr/localç›®å½•ä¸‹ï¼›<br>æœ‰çš„æ—¶å€™å®˜ç½‘ä¸Šèµ„æºä¸å®¹æ˜“ä¸‹è½½ï¼Œæä¾›ä¸‹è½½åœ°å€<a href="http://yunpan.cn/cdARXPYP7FRPT" target="_blank" rel="external">MongoDB3.0.5ç‚¹å‡»ä¸‹è½½ï¼Œè®¿é—®å¯†ç 0cdf</a>ã€‚</p>
<h2 id="è§£å‹ç¼©"><a href="#è§£å‹ç¼©" class="headerlink" title="è§£å‹ç¼©"></a>è§£å‹ç¼©</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># tar zxvf mongodb-linux-x86_64-rhel70-3.0.5.tgz </div><div class="line"># mv ./mongodb-linux-x86_64-rhel70-3.0.5 /usr/local/Mongodb3.0</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨tar zxvf è§£å‹ç¼©*.tgzæ–‡ä»¶ï¼Œmv å‘½ä»¤å°†è§£å‹ç¼©åçš„æ–‡ä»¶å¤¹é‡å‘½åä¸ºMongodb3.0ï¼›</p>
<h2 id="è¿è¡Œèµ·æ¥"><a href="#è¿è¡Œèµ·æ¥" class="headerlink" title="è¿è¡Œèµ·æ¥"></a>è¿è¡Œèµ·æ¥</h2><p>åœ¨è¿è¡Œä¹‹å‰ï¼Œéœ€è¦å»ºç«‹ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼š</p>
<pre><code>[root@localhost local]# cd Mongodb3.0/
[root@localhost Mongodb3.0]# mkdir ./db
[root@localhost Mongodb3.0]# mkdir ./log
</code></pre><p>å…ˆè¿›å…¥/usr/local/Mongodb3.0æ–‡ä»¶å¤¹ï¼šcd Mongodb3.0/ ï¼Œåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­å»ºç«‹dbå’Œlogæ–‡ä»¶å¤¹ã€‚</p>
<pre><code>[root@localhost Mongodb3.0]# cd ./bin/
[root@localhost bin]# ls
bsondump  mongodump    mongoimport  mongorestore  mongotop
mongo     mongoexport  mongooplog   mongos
mongod    mongofiles   mongoperf    mongostat
[root@localhost bin]# ./mongod --dbpath=../db --port=27017 --logpath=../log/mongodb.log --fork
about to fork child process, waiting until server is ready for connections.
forked process: 12246
child process started successfully, parent exiting
</code></pre><p>è¿›å…¥/usr/local/Mongodb3.0/bin/æ–‡ä»¶å¤¹ï¼šcd ./bin/ï¼›<br>binæ–‡ä»¶å¤¹ä¸‹mongodä¸ºmongodbå¯åŠ¨æ–‡ä»¶ï¼Œè¿è¡Œå‘½ä»¤ ./mongod â€“dbpath=../db â€“port=27017 â€“logpath=../log/mongodb.log â€“fork å¯åŠ¨Mongodbã€‚<br>â€“dbpath ä»£è¡¨Mongodbæ•°æ®å­˜å‚¨çš„ä½ç½®ï¼› â€“port è¡¨ç¤ºMongodbæ‰€å ç”¨çš„ç«¯å£å·ï¼› â€“logpath è¡¨ç¤ºæ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ï¼›â€“fork è¡¨ç¤ºMongodbä»¥å®ˆæŠ¤è¿›ç¨‹çš„å½¢å¼å¯åŠ¨ã€‚<br>ç°åœ¨å¯ä»¥çœ‹åˆ°<br>about to fork child process, waiting until server is ready for connections.<br>forked process: 12246<br>child process started successfully, parent exiting<br>è¡¨ç¤ºMongodbå·²ç»æ­£å¸¸å¯åŠ¨ï¼</p>
<h2 id="åœæ­¢Mongodb"><a href="#åœæ­¢Mongodb" class="headerlink" title="åœæ­¢Mongodb"></a>åœæ­¢Mongodb</h2><p>æŒ‰ç…§ä¸Šè¾¹çš„æ­¥éª¤ï¼Œå¯ä»¥å·²å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å¯åŠ¨Mongodbï¼Œåœ¨éœ€è¦åœæ­¢Mongodbçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ“ä½œï¼š</p>
<pre><code>[root@localhost bin]# ps -e | grep mongod
 12246 ?        00:00:04 mongod
</code></pre><p>é”®å…¥å‘½ä»¤ ps -e | grep mongodï¼Œå¯ä»¥çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„Mongodbçš„pidï¼ˆè¿›ç¨‹å·ï¼‰;</p>
<pre><code>[root@localhost bin]# kill 12246
[root@localhost bin]# ps -e | grep mongod
[root@localhost bin]# 
</code></pre><p>å¾—åˆ°è¿›ç¨‹å·ä¹‹åï¼Œä½¿ç”¨killå‘½ä»¤æ¥åœæ­¢Mongodbï¼Œå†æ¬¡è¾“å…¥ps -e | grep mongod ç»ˆç«¯å°±ä¸ä¼šå†æœ‰æ˜¾ç¤ºï¼Œè¡¨ç¤ºè¿›ç¨‹å·²è¢«æ€æ­»ã€‚</p>
<h1 id="Redis-é›†ç¾¤çš„æ­å»º"><a href="#Redis-é›†ç¾¤çš„æ­å»º" class="headerlink" title="Redis é›†ç¾¤çš„æ­å»º"></a>Redis é›†ç¾¤çš„æ­å»º</h1><p>è¿™é‡Œéœ€è¦è¯´æ˜ä»¥ä¸‹ï¼Œä¸‹è½½çš„æ—¶å€™é€‰æ‹©æ”¯æŒé›†ç¾¤æ¨¡å¼çš„Redis3.0ä¹‹åçš„ç‰ˆæœ¬ã€‚</p>
<h2 id="ä¸‹è½½-1"><a href="#ä¸‹è½½-1" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p>è·ŸMongodbä¸€æ ·ï¼Œç¬¬ä¸€æ­¥è‚¯å®šæ˜¯å…ˆæŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼š</p>
<pre><code>[root@localhost bin]# cd /usr/local
[root@localhost local]# wget http://download.redis.io/releases/redis-3.0.3.tar.gz
--2015-08-01 13:02:27--  http://download.redis.io/releases/redis-3.0.3.tar.gz
Resolving download.redis.io (download.redis.io)... 109.74.203.151
Connecting to download.redis.io (download.redis.io)|109.74.203.151|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1360959 (1.3M) [application/x-gzip]
Saving to: â€˜redis-3.0.3.tar.gz.1â€™

100%[======================================&gt;] 1,360,959    149KB/s   in 1m 41s 

2015-08-01 13:04:20 (13.2 KB/s) - â€˜redis-3.0.3.tar.gz.1â€™ saved [1360959/1360959]
</code></pre><p>ç›¸æ¯”Mongodbï¼ŒRedisæ–‡ä»¶è¿˜æ˜¯å¾ˆå°çš„ã€‚<br>åŒæ ·ï¼Œåœ¨ä¸‹è½½å¤±è´¥çš„æ—¶å€™ï¼Œå¯ä»¥<a href="http://yunpan.cn/cdABZJ4uNn7vQ" target="_blank" rel="external">ç‚¹å‡»ä¸‹è½½Redis3.0.3 è®¿é—®å¯†ç dc5a</a>ã€‚</p>
<h2 id="è§£å‹ç¼©-1"><a href="#è§£å‹ç¼©-1" class="headerlink" title="è§£å‹ç¼©"></a>è§£å‹ç¼©</h2><pre><code>[root@localhost local]# tar -zxvf redis-3.0.3.tar.gz.1 
</code></pre><p>å°†æ–‡ä»¶è§£å‹ç¼©åˆ°/usr/localæ–‡ä»¶å¤¹ä¸‹ã€‚</p>
<h2 id="å•ç‹¬å®ä¾‹å…ˆRunèµ·æ¥"><a href="#å•ç‹¬å®ä¾‹å…ˆRunèµ·æ¥" class="headerlink" title="å•ç‹¬å®ä¾‹å…ˆRunèµ·æ¥"></a>å•ç‹¬å®ä¾‹å…ˆRunèµ·æ¥</h2><p>è¿™é‡Œä¸Mongodbä¸å¤ªä¸€æ ·ï¼Œè¿è¡Œä¹‹å‰éœ€è¦ç¼–è¯‘ä¸€ä¸‹ï¼š</p>
<pre><code>[root@localhost local]# cd redis-3.0.3/
[root@localhost redis-3.0.3]# make 
</code></pre><p>éœ€è¦ç¨ç­‰ä¸€ä¸‹ï¼Œç»ˆç«¯æ˜¾ç¤º</p>
<pre><code>Hint: It&apos;s a good idea to run &apos;make test&apos; ;)

make[1]: Leaving directory `/usr/local/redis-3.0.3/src&apos;
</code></pre><p>åˆ™è¡¨ç¤ºmakeæˆåŠŸã€‚</p>
<pre><code>[root@localhost redis-3.0.3]# cd src/
[root@localhost src]# ./redis-server ../redis.conf 

16790:M 01 Aug 13:15:44.020 * The server is now ready to accept connections on port 6379
</code></pre><p>è¿›å…¥srcæ–‡ä»¶å¤¹ä¸‹ï¼Œé”®å…¥å‘½ä»¤ï¼š./redis-server ../redis.conf ï¼Œå°±å¯ä»¥å¯åŠ¨Rediså®ä¾‹ã€‚æ­£å¸¸çš„è¿è¡Œç»“æœåˆ™å¦‚ä¸Šæ‰€ç¤ºã€‚</p>
<p>åœ¨è¿™é‡Œï¼Œå› ä¸ºä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„å½¢å¼å¯åŠ¨çš„Redisï¼Œå¦‚æœéœ€è¦åœæ­¢è¿›è¡Œï¼Œåœ¨è¿è¡ŒRedisçš„ç»ˆç«¯ä½¿ç”¨Ctrl+Cæ¥åœæ­¢è¿›ç¨‹ã€‚</p>
<pre><code>^C16790:signal-handler (1438406388) Received SIGINT scheduling shutdown...
16790:M 01 Aug 13:19:48.465 # User requested shutdown...
16790:M 01 Aug 13:19:48.465 * Saving the final RDB snapshot before exiting.
16790:M 01 Aug 13:19:48.507 * DB saved on disk
16790:M 01 Aug 13:19:48.507 # Redis is now ready to exit, bye bye...
</code></pre><h2 id="Redisé›†ç¾¤ï¼ŒHighèµ·æ¥"><a href="#Redisé›†ç¾¤ï¼ŒHighèµ·æ¥" class="headerlink" title="Redisé›†ç¾¤ï¼ŒHighèµ·æ¥"></a>Redisé›†ç¾¤ï¼ŒHighèµ·æ¥</h2><p>Redisä½œä¸ºä¸€ä¸ªå†…å­˜æ•°æ®åº“ï¼Œåœ¨å®é™…çš„ä½¿ç”¨ç¯å¢ƒä¸­ï¼Œç»å¸¸ä¼šå—åˆ°æœºå™¨å†…å­˜å¤§å°çš„é™åˆ¶ï¼Œåœ¨3.0ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œé›†ç¾¤éœ€è¦é‡‡ç”¨proxyçš„æ–¹æ³•ï¼Œç°åœ¨redisè‡ªèº«æä¾›äº†clusterçš„æ”¯æŒã€‚</p>
<h3 id="é›†ç¾¤æ­å»ºå‡†å¤‡å·¥ä½œ"><a href="#é›†ç¾¤æ­å»ºå‡†å¤‡å·¥ä½œ" class="headerlink" title="é›†ç¾¤æ­å»ºå‡†å¤‡å·¥ä½œ"></a>é›†ç¾¤æ­å»ºå‡†å¤‡å·¥ä½œ</h3><p>é›†ç¾¤çš„æ­å»ºéœ€è¦ä½¿ç”¨Redisä¸‹srcæ–‡ä»¶å¤¹ä¸­redis-trib.rbï¼Œè¿™æ˜¯ä¸€ä¸ªrubyç¨‹åºï¼Œå› æ­¤éœ€è¦ç³»ç»Ÿä¸­æœ‰rubyç¯å¢ƒã€‚</p>
<pre><code>root@localhost src]# yum install ruby 
[root@localhost src]# gem install redis
</code></pre><p>é”®å…¥ä¸Šè¾¹çš„å‘½ä»¤ï¼Œå®‰è£…ruby å’Œ ruby çš„redis æ‰©å±•ã€‚åœ¨å®‰è£…æ‰©å±•çš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½ä¸èƒ½å®‰è£…ï¼Œå¯èƒ½æ˜¯èµ„æºè¢«å¢™äº†ã€‚å¯ä»¥ä½¿ç”¨æˆ‘è‡ªå·±ä¸‹è½½åˆ°çš„èµ„æº<a href="http://yunpan.cn/cdABc69IzjVvG" target="_blank" rel="external">redis.gem è®¿é—®å¯†ç 9727</a>è¿›è¡Œæœ¬åœ°å®‰è£…ã€‚</p>
<pre><code>[root@localhost src]# gem install --local /usr/local/redis-3.0.0.gem 
</code></pre><p>å°†ä¸‹è½½åˆ°çš„gemæ–‡ä»¶æ”¾åˆ°/usr/localç›®å½•ä¸‹ï¼Œä½¿ç”¨ä¸Šè¾¹çš„å‘½ä»¤è¿›è¡Œå®‰è£…ã€‚è¿™æ ·ï¼ŒRedisé›†ç¾¤çš„è¿è¡Œç¯å¢ƒå°±æ­å»ºå®Œæ¯•ã€‚</p>
<p>è¦åšredisé›†ç¾¤ï¼Œè‡³å°‘éœ€è¦3ä¸ªMasterå®ä¾‹ã€‚<br>å…ˆæŠŠredisçš„é…ç½®æ–‡ä»¶redis.confå’Œredis-serveræ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼š</p>
<pre><code>[root@localhost local]# cd /usr/local
[root@localhost local]# mkdir -p ./redis-cluster/6379
[root@localhost local]# cp ./redis-3.0.3/redis.conf ./redis-3.0.3/src/redis-server ./redis-cluster/6379/
</code></pre><p>ç„¶åå°†æ–‡ä»¶å¤¹6379å¤åˆ¶ä¸¤ä»½ï¼š</p>
<pre><code>[root@localhost local]# cd ./redis-cluster/
[root@localhost redis-cluster]# cp -rf ./6379/ ./6380
[root@localhost redis-cluster]# cp -rf ./6379 ./6381
</code></pre><p>æ¥ä¸‹æ¥ï¼Œéœ€è¦ä½œçš„å°±æ˜¯ä¿®æ”¹å¯¹åº”æ–‡ä»¶å¤¹ä¸‹çš„redis.confæ–‡ä»¶ã€‚</p>
<pre><code>port 6379 #ä¸åŒç›®å½•ï¼Œè¿™é‡Œç«¯å£å¯¹åº”ä¸åŒ
cluster-enabled yes #å¼€å¯é›†ç¾¤åŠŸèƒ½
cluster-config-file nodes.conf #èŠ‚ç‚¹é…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯æœåŠ¡å¯åŠ¨æ—¶è‡ªå·±é…ç½®åˆ›å»ºçš„
cluster-node-timeout 6000
appendonly yes
</code></pre><p>å»ºè®®å°†confæ–‡ä»¶ä¸­çš„saveå­—æ®µéƒ½å±è”½äº†ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå‘ç°å¼€å¯ä¹‹åï¼Œrediså†™rdbæ–‡ä»¶çš„æ—¶å€™å¯¹é›†ç¾¤æ€§èƒ½æœ‰å¾ˆå¤§å½±å“ã€‚</p>
<h3 id="é›†ç¾¤-èµ°èµ·"><a href="#é›†ç¾¤-èµ°èµ·" class="headerlink" title="é›†ç¾¤ èµ°èµ·"></a>é›†ç¾¤ èµ°èµ·</h3><p>ä¸Šè¾¹çš„æ­¥éª¤ï¼Œå®Œæˆäº†é›†ç¾¤æ­å»ºçš„å‡†å¤‡å·¥ä½œã€‚ä¸‹è¾¹è¦å¼€å§‹è¿è¡Œèµ·æ¥äº†ï¼<br>å…ˆæŠŠä¸‰ä¸ªrediså®ä¾‹å¯åŠ¨èµ·æ¥ã€‚</p>
<pre><code>[root@localhost src]# ps -ef | grep redis
root      18979  18297  0 14:24 pts/0    00:00:00 ./redis-server *:6379 [cluster]
root      19094  19057  0 14:25 pts/4    00:00:00 ./redis-server *:6380 [cluster]
root      19181  19146  0 14:25 pts/7    00:00:00 ./redis-server *:6381 [cluster]
</code></pre><p>é”®å…¥ ps -ef | grep redis å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªrediså®ä¾‹éƒ½åœ¨è¿è¡Œã€‚<br>æ¥ä¸‹æ¥ä½¿ç”¨redis-trib.rbæ¥å°†ä¸‰ä¸ªå®ä¾‹è¿æ¥èµ·æ¥ã€‚</p>
<pre><code>[root@localhost src]# cd /usr/local/redis-3.0.3/src/
[root@localhost src]# ./redis-trib.rb create --replicas 0 127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381
</code></pre><p>ç»ˆç«¯ä¼šæœ‰è¿™æ ·çš„æ˜¾ç¤ºï¼š</p>
<pre><code>&gt;&gt;&gt; Performing hash slots allocation on 3 nodes...
Using 3 masters:
127.0.0.1:6379
127.0.0.1:6380
127.0.0.1:6381
M: 4ee119039aebd0e1d48b3f52149a7940db34c6fb 127.0.0.1:6379
   slots:0-5460 (5461 slots) master
M: f6ad85a038a05e297130f6e112e223db54c47ea5 127.0.0.1:6380
   slots:5461-10922 (5462 slots) master
M: 0b97e4a7f8e5ced1f2f2471694b76dcf77ce1fc7 127.0.0.1:6381
   slots:10923-16383 (5461 slots) master
Can I set the above configuration? (type &apos;yes&apos; to accept):
</code></pre><p>é”®å…¥ yes </p>
<pre><code>&gt;&gt;&gt; Nodes configuration updated
&gt;&gt;&gt; Assign a different config epoch to each node
&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster
Waiting for the cluster to join.
&gt;&gt;&gt; Performing Cluster Check (using node 127.0.0.1:6379)
M: 4ee119039aebd0e1d48b3f52149a7940db34c6fb 127.0.0.1:6379
   slots:0-5460 (5461 slots) master
M: f6ad85a038a05e297130f6e112e223db54c47ea5 127.0.0.1:6380
   slots:5461-10922 (5462 slots) master
M: 0b97e4a7f8e5ced1f2f2471694b76dcf77ce1fc7 127.0.0.1:6381
   slots:10923-16383 (5461 slots) master
[OK] All nodes agree about slots configuration.
&gt;&gt;&gt; Check for open slots...
&gt;&gt;&gt; Check slots coverage...
[OK] All 16384 slots covered.
</code></pre><p>æµ‹è¯•ä¸€ä¸‹ï¼Œé›†ç¾¤æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
<pre><code>[root@localhost src]# ./redis-cli -c -h 127.0.0.1 -p 6379
127.0.0.1:6379&gt; set key values
-&gt; Redirected to slot [12539] located at 127.0.0.1:6381
OK
</code></pre><p>è¿™æ ·ï¼Œé›†ç¾¤å°±ç®—æ­å»ºå®Œæˆäº†ã€‚å“ˆå“ˆå“ˆã€‚</p>
<h1 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a>æœªå®Œå¾…ç»­</h1><p>è‡³æ­¤ï¼Œæ•´ä¸ªæœåŠ¡å™¨ç¼“å­˜æµç¨‹ä¸­çš„æ•°æ®åº“éƒ¨åˆ†å·²ç»æ­å»ºå®Œæ¯•ï¼Œæ¥ä¸‹æ¥è¦é…ç½®çš„æ˜¯WebæœåŠ¡å™¨å’ŒPHPçš„å®‰è£…é…ç½®ï¼Œæˆ‘ä¼šåœ¨åç»­çš„æ–‡ç« ä¸­ç»§ç»­æ›´æ–°ã€‚</p>
]]></content>
      
        <categories>
            
            <category> æœåŠ¡å™¨ </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Mongodb </tag>
            
            <tag> Nginx </tag>
            
            <tag> Redis </tag>
            
            <tag> Lua </tag>
            
            <tag> PHP </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[é€ç»™è‡ªå·±]]></title>
      <url>/2015/07/31/%E9%80%81%E7%BB%99%E8%87%AA%E5%B7%B1/</url>
      <content type="html"><![CDATA[<p><strong>æ€»æœ‰ä¸€å¤©ï¼Œä½ å°†ç ´èŒ§è€Œå‡º</strong><br><strong>æˆé•¿çš„æ¯”äººä»¬æœŸå¾…çš„è¿˜è¦ç¾ä¸½</strong></p>
<p><strong>ä½†è¿™ä¸ªè¿‡ç¨‹ä¼šå¾ˆç—›</strong><br><strong>ä¼šå¾ˆè¾›è‹¦</strong></p>
<p><strong>é¢å¯¹ç€æ±¹æ¶Œè€Œæ¥çš„ç°å®</strong><br><strong>è§‰å¾—è‡ªå·±æ¸ºå°æ— åŠ›</strong></p>
<p><strong>ä½†è¿™ ä¹Ÿæ˜¯ç”Ÿå‘½çš„ä¸€éƒ¨åˆ†</strong><br><strong>åšå¥½ç°åœ¨ä½ èƒ½åšçš„ ç„¶å ä¸€åˆ‡éƒ½ä¼šå¥½çš„</strong><br><strong>æˆ‘ä»¬éƒ½å°†å­¤ç‹¬åœ°é•¿å¤§ ä¸è¦å®³æ€•</strong></p>
]]></content>
      
        <categories>
            
            <category> å¿ƒæƒ…æ–‡å­— </category>
            
        </categories>
        
        
    </entry>
    
  
  
</search>
